(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92902,       2431]
NotebookOptionsPosition[     87355,       2334]
NotebookOutlinePosition[     87770,       2351]
CellTagsIndexPosition[     87727,       2348]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["One-Way Quantum Computation", "Title",
 CellChangeTimes->{{3.8133556202441883`*^9, 
  3.8133556302822533`*^9}},ExpressionUUID->"4061fecb-e999-4daa-80a9-\
5db539b314ec"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellChangeTimes->{{3.757656577043529*^9, 3.757656583441247*^9}, 
   3.8132987243185043`*^9, {3.826581207619049*^9, 3.8265812083602247`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"117142bf-a0cd-4674-bbaf-7981816c24f8"],

Cell[CellGroupData[{

Cell[TextData[{
 "Elementary Idea: Rotation ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "(", "\[Phi]", ")"}], TraditionalForm]],ExpressionUUID->
  "172e07ad-65aa-4d14-a6d3-4be8a0c057b4"]
}], "Section",ExpressionUUID->"9194e6a5-f774-40d1-97b0-cbf6954269aa"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellChangeTimes->{{3.757656823938943*^9, 3.757656827323608*^9}, {
   3.757657066446066*^9, 3.757657066609345*^9}, {3.75788847877194*^9, 
   3.757888478906226*^9}, 3.7580792815707703`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"1a51bd7d-3647-49aa-af0e-26681fffc6b3"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.757888459098827*^9, 3.757888469011306*^9}, {
  3.757888624831584*^9, 3.757888631710669*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"1c1c7eac-215b-41ca-a67e-d38acaa28a21"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", "\"\<R\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"v0", "=", 
  RowBox[{"ProductState", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "0", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], ",", 
       RowBox[{"c", "[", "1", "]"}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "]"}], ".", 
      RowBox[{"Dagger", "@", 
       RowBox[{"c", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "\[Rule]", "1"}], "}"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.757909239064898*^9, 3.757909243310844*^9}, {
   3.757915094343938*^9, 3.757915127060977*^9}, {3.757920518335712*^9, 
   3.7579205323219624`*^9}, 3.78618413973387*^9, {3.817791408410001*^9, 
   3.817791409511211*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"dd857675-58db-4783-9d34-dde05de8001f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`c[0]], " ", 
        TemplateBox[{"0"},
         "Ket"]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]], " ", 
        TemplateBox[{"1"},
         "Ket"]}]}], ")"}], 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`S[0, Q3`$]]],
    DisplayForm], "\[CircleTimes]", 
   TagBox[
    SubscriptBox[
     RowBox[{"(", 
      TemplateBox[{"0"},
       "Ket"], ")"}], 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]]],
    DisplayForm]}],
  Q3`ProductState[<|$CellContext`S[0, Q3`$] -> {
      $CellContext`c[0], 
      $CellContext`c[1]}, $CellContext`S[1, Q3`$] -> {1, 0}|>]]], "Output",
 CellChangeTimes->{3.932623445594537*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"e867730d-8174-448c-a5eb-f0ee0f71e0ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v0", ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "R0", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"0", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"ce312e05-0bfa-4326-99a2-e32ead8b669a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{5, -1}, {6, -1}}}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {6, -2}}}], {InsetBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`c[0]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`c[1]],
         TraditionalForm]}]}], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"R\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
     CircleBox[{5, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->324,
   PlotRange->{{0, 6}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Q3`ProductState[<|$CellContext`S[0, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}, $CellContext`S[1, Q3`$] -> {1, 0}|>]], 
   $CellContext`S[1, 6], 
   Q3`CZ[{
     $CellContext`S[0, Q3`$], 
     $CellContext`S[1, Q3`$]}], 
   Q3`Rotation[$CellContext`\[Alpha], {0, 0, 1}, 
    $CellContext`S[0, Q3`$], Label -> "R"], 
   $CellContext`S[0, 6], 
   Q3`Measurement[
    $CellContext`S[0, 3]], "PortSize" -> {2, 1}]]], "Output",
 CellChangeTimes->{3.932623446313114*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"8bc87bfb-2f78-4cdd-970a-e10a76b38b4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.7579206252716503`*^9, 3.757920629264233*^9}, {
  3.846125036838644*^9, 3.846125037747817*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"55041d67-f952-48f4-be8a-cc261e15cf4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
            $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[0, Q3`$] -> 0, $CellContext`S[1, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
            $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[0, Q3`$] -> 0, $CellContext`S[1, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{3.9326234475082493`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"929f8c4a-bae2-4a50-be11-e71d4538829b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v", "=", 
  RowBox[{
   RowBox[{"v", "/.", "rules"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"vv", "=", 
  RowBox[{
   RowBox[{"KetFactor", "[", 
    RowBox[{"v", ",", 
     RowBox[{"S", "[", "0", "]"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"w", "=", 
  RowBox[{"vv", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.757914859703829*^9, 3.757914881999783*^9}, {
   3.757914941614622*^9, 3.757915029234832*^9}, {3.757915177115369*^9, 
   3.7579151815668163`*^9}, 3.757920640205359*^9, {3.846125052724743*^9, 
   3.8461250537113743`*^9}, {3.932623458678816*^9, 3.9326234639164886`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"ae2bbe46-6f6d-4717-9fe4-fda205f458e0"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
              $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[0, Q3`$] -> 0, $CellContext`S[1, Q3`$] -> 0|>]]}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
              $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[0, Q3`$] -> 0, $CellContext`S[1, Q3`$] -> 
        1|>]]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.932623448389295*^9, 3.932623479219051*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"8949ed8e-2147-41ba-ba5d-898ba16c4772"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
             $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[0, Q3`$] -> 0|>]],
    HoldForm], "\[CircleTimes]", 
   TemplateBox[{"\"(\"", 
     RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
       RowBox[{"(", 
         RowBox[{
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 InterpretationBox[
                  SubscriptBox["c", 
                   TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                  $CellContext`c[0]], "+", 
                 RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                   InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]]}]}], ")"}], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["0", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]}, "Ket"], 
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 InterpretationBox[
                  SubscriptBox["c", 
                   TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                  $CellContext`c[0]], "-", 
                 RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                   InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]]}]}], ")"}], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]}, "Ket"], 
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}]}], "\")\""},
    "RowDefault"]}],
  Q3`OSlash[
   Ket[<|$CellContext`S[0, Q3`$] -> 0|>], Rational[1, 2] E^(Complex[0, 
       Rational[-1, 2]] $CellContext`\[Alpha]) (($CellContext`c[0] + 
      E^(Complex[0, 1] $CellContext`\[Alpha]) $CellContext`c[1]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + ($CellContext`c[0] - 
      E^(Complex[0, 1] $CellContext`\[Alpha]) $CellContext`c[1]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>])]]], "Output",
 CellChangeTimes->{{3.932623448389295*^9, 3.93262347922113*^9}},
 CellLabel->"Out[51]=",ExpressionUUID->"221ad63c-d5ee-49b8-8342-187910256238"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.932623448389295*^9, 3.9326234792234173`*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"9440b763-95f5-481a-84e1-b2c8179d0034"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v0", ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", "R0",
     ",", 
    RowBox[{"S", "[", 
     RowBox[{"0", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"61c711e6-355f-4f02-9fdc-a9158b2e6e49"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{5, -1}, {8, -1}}}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {8, -2}}}], {InsetBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`c[0]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`c[1]],
         TraditionalForm]}]}], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"R\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
     CircleBox[{5, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
     LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], {CircleBox[{6, -2}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -2}, {6.266666666666667, -2}}, {{
         6, -2.2666666666666666`}, {6, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->396,
   PlotRange->{{0, 8}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Q3`ProductState[<|$CellContext`S[0, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}, $CellContext`S[1, Q3`$] -> {1, 0}|>]], 
   $CellContext`S[1, 6], 
   Q3`CZ[{
     $CellContext`S[0, Q3`$], 
     $CellContext`S[1, Q3`$]}], 
   Q3`Rotation[$CellContext`\[Alpha], {0, 0, 1}, 
    $CellContext`S[0, Q3`$], Label -> "R"], 
   $CellContext`S[0, 6], 
   Q3`Measurement[
    $CellContext`S[0, 3]], 
   Q3`CNOT[{$CellContext`S[0, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   $CellContext`S[1, 6], "PortSize" -> {2, 1}]]], "Output",
 CellChangeTimes->{3.932623480516306*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"c55abdf4-a5df-4026-8ea3-144fb2d2fc18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Elaborate", "[", "qc", "]"}], "/.", "rules"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"v1", "=", 
  RowBox[{
   RowBox[{"KetFactor", "[", 
    RowBox[{"v1", ",", 
     RowBox[{"S", "[", "0", "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7579208145461597`*^9, 3.757920910803339*^9}, {
  3.757920963048493*^9, 3.757920976932559*^9}, {3.7579211859962797`*^9, 
  3.75792118971605*^9}, {3.7579790999113398`*^9, 3.757979124738173*^9}, {
  3.757979200228537*^9, 3.757979200314581*^9}, {3.7952418991061907`*^9, 
  3.7952419055955257`*^9}, {3.846125070569828*^9, 3.846125078336833*^9}, {
  3.932623497949676*^9, 3.932623520868309*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d8a96545-5030-4884-ba0f-933f3ce735fa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["S", 
                TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
               $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["S", 
                TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
               $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
          "RowWithSeparators"]},
        "Ket"],
       Ket[<|$CellContext`S[0, Q3`$] -> 0, $CellContext`S[1, Q3`$] -> 0|>]]}],
      "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["S", 
                TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
               $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
           SubscriptBox["1", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["S", 
                TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
               $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
          "RowWithSeparators"]},
        "Ket"],
       Ket[<|$CellContext`S[0, Q3`$] -> 0, $CellContext`S[1, Q3`$] -> 
         1|>]]}]}], ")"}]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{3.93262348269201*^9, 3.932623521572755*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"64424b88-a452-423a-abfa-997b2ed64d54"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "0"},
       "RowWithSeparators"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]], " ", 
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.93262348269201*^9, 3.932623521576313*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"78110f5b-dd51-4bae-982d-c025680852ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rotation", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "**", 
     RowBox[{"ProductState", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"c", "@", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], "//", "Elaborate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", "-", "v1"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.932623530727055*^9, 3.9326235313564453`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"8e867f72-6273-4e7c-b9ad-53cfa0e13598"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "2"}], "+", 
    SqrtBox["2"]}], ")"}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.932623525002719*^9, 3.932623531845251*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"70ec11b1-34bc-442d-ab18-86530a6baeb7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Single-Qubit Rotations", "Section",ExpressionUUID->"92d825dc-2528-4fd1-bede-3ac9c2b09b47"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"7cb6f7fe-5c72-4db2-a1e3-9b0058ae2527"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", "\"\<R\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Beta]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", 
      RowBox[{"Superscript", "[", 
       RowBox[{"\"\<R\>\"", ",", "\[Prime]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Gamma]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", 
      RowBox[{"Superscript", "[", 
       RowBox[{"\"\<R\>\"", ",", "\[DoublePrime]"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.757888441276161*^9, 3.757888532196735*^9}, {
   3.757888687694727*^9, 3.7578886886057673`*^9}, 3.757909224472875*^9, {
   3.7579213888441973`*^9, 3.7579213889512663`*^9}, {3.817792475657712*^9, 
   3.81779248565965*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"08eebeaf-2ffa-49d0-a09e-b56963a501ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jj", "=", 
  RowBox[{"Range", "[", "4", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kk", "=", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "None"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.813355842830373*^9, 3.813355873495274*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"00814601-c0b8-445b-8aec-030c05da7a24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.932623539090407*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"eb940793-05d2-4bb0-9c71-d48b6e9955ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.932623539091254*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"c4fae430-2886-401e-b6f5-aaedfc6a2658"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`S[0, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, Q3`$]]}], "}"}]], "Output",
 CellChangeTimes->{3.9326235390921173`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"a73eae2e-19dd-47b1-a954-2d990d5a8529"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "0", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], ",", 
         RowBox[{"c", "[", "1", "]"}]}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"0", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "R1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "R2", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "R3", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9326235530703382`*^9, 3.932623580691671*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"efdd35b7-a18b-4b96-91fb-8dfdbfb6a3c8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{7, -1}, {20, -1}}, {{11, -2}, {20, -2}}, {{15, -3}, {
      20, -3}}, {{19, -4}, {20, -4}}}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {15, -3}}, {{
     0, -4}, {19, -4}}, {{0, -5}, {20, -5}}}], {InsetBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`c[0]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`c[1]],
         TraditionalForm]}]}], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -4.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -5.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -4.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -5.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -2}, {2, -3}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -3}, 0.09]}, {LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], DiskBox[{3, -4}, 0.09]}, {
     LineBox[{{4, -4}, {4, -5}}], DiskBox[{4, -4}, 0.09], 
     DiskBox[{4, -5}, 0.09]}, {LineBox[{{5, -1}, {5, -2}}], 
     DiskBox[{5, -1}, 0.09], DiskBox[{5, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
     CircleBox[{7, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{7, -1.2}, {7.24, -0.76}}]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox["\<\"R\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {9., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {10., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, 
     CircleBox[{11, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{11, -2.2}, {11.24, -1.76}}]}, {
     LineBox[{{12, -2}, {12, -3}}], 
     DiskBox[{12, -2}, 0.09], {CircleBox[{12, -3}, 0.26666666666666666], 
      LineBox[{{{11.733333333333333`, -3}, {12.266666666666667`, -3}}, {{
         12, -3.2666666666666666`}, {12, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -3.4}, {13.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"R\"", "\[Prime]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {13., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{13.6, -3.4}, {14.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {14., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{14.6, -3.4}, {15.4, -2.6}]}, 
     CircleBox[{15, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{15, -3.2}, {15.24, -2.76}}]}, {
     LineBox[{{16, -3}, {16, -4}}], 
     DiskBox[{16, -3}, 0.09], {CircleBox[{16, -4}, 0.26666666666666666], 
      LineBox[{{{15.733333333333333`, -4}, {16.266666666666666`, -4}}, {{
         16, -4.266666666666667}, {16, -3.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{16.6, -4.4}, {17.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"R\"", "\[DoublePrime]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {17., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{17.6, -4.4}, {18.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {18., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{18.6, -4.4}, {19.4, -3.6}]}, 
     CircleBox[{19, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{19, -4.2}, {19.24, -3.76}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->828,
   PlotRange->{{0, 20}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Q3`ProductState[<|$CellContext`S[0, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}, $CellContext`S[1, Q3`$] -> {1, 0}, $CellContext`S[
       2, Q3`$] -> {1, 0}, $CellContext`S[3, Q3`$] -> {1, 0}, $CellContext`S[
       4, Q3`$] -> {1, 0}|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, 
   Q3`CZ[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$]}], 
   Q3`CZ[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}], 
   Q3`CZ[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   Q3`CZ[{
     $CellContext`S[0, Q3`$], 
     $CellContext`S[1, Q3`$]}], 
   $CellContext`S[0, 6], 
   Q3`Measurement[
    $CellContext`S[0, 3]], 
   Q3`CNOT[{$CellContext`S[0, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`Rotation[$CellContext`\[Alpha], {0, 0, 1}, 
    $CellContext`S[1, Q3`$], Label -> "R"], 
   $CellContext`S[1, 6], 
   Q3`Measurement[
    $CellContext`S[1, 3]], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`Rotation[$CellContext`\[Beta], {0, 0, 1}, 
    $CellContext`S[2, Q3`$], Label -> 
    Superscript["R", $CellContext`\[Prime]]], 
   $CellContext`S[2, 6], 
   Q3`Measurement[
    $CellContext`S[2, 3]], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`Rotation[$CellContext`\[Gamma], {0, 0, 1}, 
    $CellContext`S[3, Q3`$], Label -> 
    Superscript["R", $CellContext`\[DoublePrime]]], 
   $CellContext`S[3, 6], 
   Q3`Measurement[
    $CellContext`S[3, 3]], "PortSize" -> {2, 1}]]], "Output",
 CellChangeTimes->{{3.932623540598979*^9, 3.9326235814713087`*^9}},
 CellLabel->"Out[75]=",ExpressionUUID->"4abe0f86-c517-4657-bb02-864d39e93e16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], 
       RowBox[{"Conjugate", "[", 
        RowBox[{"c", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"c", "[", "1", "]"}], 
       RowBox[{"Conjugate", "[", 
        RowBox[{"c", "[", "1", "]"}], "]"}]}]}], "\[Rule]", "1"}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7578888625526123`*^9, 3.757888869319091*^9}, {
   3.757889048054686*^9, 3.757889076958262*^9}, {3.757889825903118*^9, 
   3.757889826754305*^9}, {3.757889866115164*^9, 3.757889897566753*^9}, {
   3.757890029456252*^9, 3.757890087076215*^9}, 3.757893682565064*^9, {
   3.757893797998975*^9, 3.757893801060066*^9}, {3.813355699827824*^9, 
   3.813355786763239*^9}, {3.8133558882108183`*^9, 3.813355917592924*^9}, {
   3.846125106342503*^9, 3.846125109692597*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"aeadb300-2d04-40a2-ab35-885fc0d810b2"],

Cell[BoxData[
 TemplateBox[{
  "Measurement", "num", 
   "\"Probability half is assumed for a state without explicitly numeric \
coefficients.\"", 2, 76, 5, 18694792135592144982, "Local", "Q3`Measurement"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.932623587901012*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"66278d40-49f8-4fe7-bdd5-5c7d1ea3d0e9"],

Cell[BoxData[
 TemplateBox[{
  "Measurement", "num", 
   "\"Probability half is assumed for a state without explicitly numeric \
coefficients.\"", 2, 76, 6, 18694792135592144982, "Local", "Q3`Measurement"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.932623588268396*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"8159bed4-c760-4cbe-a4ec-95e011aee698"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.704301`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.757893756592835*^9, 3.757905525149961*^9, 3.757906818922183*^9, 
   3.757921369213612*^9, 3.75792141343368*^9, 3.7579287981693497`*^9, 
   3.757979244418467*^9, 3.782543322988205*^9, 3.782543436507251*^9, 
   3.785104034173658*^9, 3.785111714262795*^9, 3.78618572475142*^9, 
   3.786317923878824*^9, 3.787184005114418*^9, 3.795131093988811*^9, 
   3.79524197692832*^9, 3.795838020179234*^9, 3.813298771619989*^9, 
   3.813355712617078*^9, {3.8133557708065166`*^9, 3.813355793464888*^9}, {
   3.813355890927075*^9, 3.813355918353895*^9}, 3.817792497360914*^9, 
   3.826581247645554*^9, 3.8461251119628963`*^9, 3.932623588279564*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"48c9580c-75be-4124-b468-4df981085e5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "16"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "+", "\[Gamma]"}], ")"}]}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]]}], 
       ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "+", "\[Gamma]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]]}], 
       ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
            $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[0, Q3`$] -> 1, $CellContext`S[1, Q3`$] -> 
      1, $CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
      1, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "+", "\[Gamma]"}], ")"}]}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]]}], 
       ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "+", "\[Gamma]"}], ")"}]}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]]}], 
       ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
            $CellContext`S[0, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[0, Q3`$] -> 1, $CellContext`S[1, Q3`$] -> 
      1, $CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
      1, $CellContext`S[4, Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{
  3.757893756592835*^9, 3.757905525149961*^9, 3.757906818922183*^9, 
   3.757921369213612*^9, 3.75792141343368*^9, 3.7579287981693497`*^9, 
   3.757979244418467*^9, 3.782543322988205*^9, 3.782543436507251*^9, 
   3.785104034173658*^9, 3.785111714262795*^9, 3.78618572475142*^9, 
   3.786317923878824*^9, 3.787184005114418*^9, 3.795131093988811*^9, 
   3.79524197692832*^9, 3.795838020179234*^9, 3.813298771619989*^9, 
   3.813355712617078*^9, {3.8133557708065166`*^9, 3.813355793464888*^9}, {
   3.813355890927075*^9, 3.813355918353895*^9}, 3.817792497360914*^9, 
   3.826581247645554*^9, 3.8461251119628963`*^9, 3.9326235883042383`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"8a3a0a1f-ad4c-40f2-9723-b74856c48775"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magic State Injection", "Section",ExpressionUUID->"a798cc03-9037-4d66-8b8c-08b8123785e1"],

Cell[TextData[{
 "Unlike the Clifford gates, the so-called ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "d38c12dc-6eb1-46a1-b8b3-981dda68d8e8"],
 "-gate (a phase gate by phase angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "8"}]}]}], TraditionalForm]],ExpressionUUID->
  "00412b02-305f-4be5-a2bf-846265bef4c5"],
 ") turns out to be difficult to implement in a fault-tolerant way. As a \
workaround, magic state injection method has been suggested. It is a special \
case of the measurement-based quantum computing."
}], "Text",ExpressionUUID->"589f3f44-8ac8-42c5-a654-82e1b387b643"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"29868f19-479d-4581-bfac-22f3ddd142c8"],

Cell[TextData[{
 "First, generate the magic state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "1e47d28f-e501-4bc0-ba50-5d65ae90de20"],
 ". Of course, we are interested in the case of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "8"}]}]}], TraditionalForm]],ExpressionUUID->
  "d4e35b8f-1570-45d8-98f4-46926f0f100d"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      RowBox[{"\[Phi]", "=", 
        RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "8"}]}]}]},
     "Ket"], "\[Congruent]", 
    TemplateBox[{"T"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "bfc60f95-4595-4c66-9ee4-438c6cd07997"],
 "."
}], "Text",ExpressionUUID->"9c3f60cf-0162-4911-8fdf-e143a9f7df89"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mgc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"S", "@", 
      RowBox[{"{", "2", "}"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "mgc", "]"}]}], "Input",
 CellChangeTimes->{{3.9326236369708633`*^9, 3.9326236763288813`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"b2b955c1-2c87-405c-abcc-44a1dda5ab99"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], InsetBox[
     TemplateBox[{"0"},
      "Ket"], {-0.2, -2.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Y\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>]], 
   $CellContext`S[2, 6], 
   Q3`Phase[$CellContext`\[Phi], 
    $CellContext`S[2]]]]], "Output",
 CellChangeTimes->{
  3.9326236240210667`*^9, {3.932623657922151*^9, 3.9326236767468*^9}},
 CellLabel->"Out[87]=",ExpressionUUID->"f9080b82-a3a6-4dbb-ae62-b8134a4f6b47"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["S", 
             $CellContext`S[Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["S", 
             $CellContext`S[Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["S", 
             $CellContext`S[Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["S", 
             $CellContext`S[Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{
  3.9326236240210667`*^9, {3.932623657922151*^9, 3.932623676770047*^9}},
 CellLabel->"Out[88]=",ExpressionUUID->"8c2384a1-c6e6-436f-a745-2519deab4239"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "->", 
      RowBox[{"c", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], ",", 
     RowBox[{"\"\<Label\>\"", "->", 
      RowBox[{"Ket", "[", 
       RowBox[{"{", "\[Psi]", "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
   "in", ",", "mgc", ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"Phase", "[", 
       RowBox[{
        RowBox[{"2", "\[Phi]"}], ",", 
        RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "\[Phi]"}], "]"}]}]}], "}"}]}], ",", 
      RowBox[{"\"\<Label\>\"", "->", 
       RowBox[{"DisplayForm", "@", 
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Superscript", "[", 
            RowBox[{"\"\<Z\>\"", ",", "\"\<\[Phi]\>\""}], "]"}], ",", 
           RowBox[{"Ket", "[", 
            RowBox[{"{", "\[Psi]", "}"}], "]"}]}], "}"}]}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.932623707024135*^9, 3.9326237241222486`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"7d7908c1-55a8-489e-80d0-00fd8c7c0958"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{5, -3}, {7, -3}}}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {5, -3}}}], 
    InsetBox[
     TemplateBox[{"\[Psi]"},
      "Ket"], {-0.2, -2.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], InsetBox[
     TemplateBox[{"0"},
      "Ket"], {-0.2, -3.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Y\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{3, Rational[-7, 2]}, {3, Rational[-1, 2]}}, {{
        3, -3.5}, {3, -0.5}}]]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     CircleBox[{5, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -3.2}, {5.24, -2.76}}]}, {
     LineBox[{{6, -3}, {6, -1}}], DiskBox[{6, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"X\"", 
         RowBox[{"2", " ", "\[Phi]"}]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, InsetBox[
     TagBox[
      RowBox[{
       TemplateBox[{"\"Z\"", "\"\[Phi]\""},
        "Superscript"], 
       TemplateBox[{"\[Psi]"},
        "Ket"]}],
      DisplayForm], {7.2, -2.}, NCache[
     ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1, 
     0}]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{38.160000000000004`, 110.16}, {7.2, 7.2}},
   ImageSize->396,
   PlotRange->{{0, 7}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}|>, "Label" -> Ket[{$CellContext`\[Psi]}]], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>]], 
   $CellContext`S[2, 6], 
   Q3`Phase[$CellContext`\[Phi], 
    $CellContext`S[2]], "Separator", 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`Measurement[
    $CellContext`S[2, 3]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`Phase[2 $CellContext`\[Phi], 
     $CellContext`S[1]]], 
   Q3`PortOut[
    Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
        $CellContext`c[0], 
        E^(Complex[0, 1] $CellContext`\[Phi]) $CellContext`c[1]}|>, "Label" -> 
     DisplayForm[
       RowBox[{
         Superscript["Z", "\[Phi]"], 
         Ket[{$CellContext`\[Psi]}]}]]]], "PortSize" -> {1, 3}]]], "Output",
 CellChangeTimes->{{3.932623692504599*^9, 3.932623724421212*^9}},
 CellLabel->"Out[98]=",ExpressionUUID->"dba3a2dd-014d-4651-bc3e-56d9f96989d3"]
}, Open  ]],

Cell[TextData[{
 "Check that regardless of the measurement result, the state prepared in the \
first qubit (up to a global phase) becomes the desired state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["Z", "\[Phi]"], 
    TemplateBox[{"\[Psi]"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "b83178d9-19c6-46f7-a38d-79f7a62bbcf8"],
 "."
}], "Text",ExpressionUUID->"9fccfb53-8b9d-4612-89c0-fdc900b3027a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"Elaborate", "[", "qc", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"KetFactor", "@", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"34b7928c-ec28-483e-b384-cb65afefe2b3"],

Cell[BoxData[
 TemplateBox[{
  "Q3General", "renamed", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"LogicalForm\\\\\\\"\\\"}]\\) has \
been renamed \\!\\(\\*RowBox[{\\\"\\\\\\\"KetRegulate\\\\\\\"\\\"}]\\).\"", 2,
    100, 12, 18694792135592144982, "Local", "Q3`Q3General"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.932623733320746*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"923088e8-5318-4d97-8cad-cb8b7ff2d7b7"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox["2"]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "+", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["0", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox["S", 
                 $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[Q3`$] -> 0|>]], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox["S", 
                  $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox["S", 
                  $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox["S", 
                  $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox["S", 
                 $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[Q3`$] -> 1|>]], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox["S", 
                  $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[Q3`$] -> 1|>]]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox["S", 
                  $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[Q3`$] -> 1|>]]}], "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox["S", 
                  $CellContext`S[Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`c[0]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`c[1]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           SubscriptBox["1", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["S", 
                TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
               $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
          "RowWithSeparators"]},
        "Ket"],
       Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}],
     HoldForm],
    Q3`OTimes[
    Ket[<|$CellContext`S[Q3`$] -> 0|>] + 
     Complex[0, -1] E^(Complex[0, 1] $CellContext`\[Phi]) 
      Ket[<|$CellContext`S[Q3`$] -> 0|>] + 
     Complex[0, -1] E^(Complex[0, 2] $CellContext`\[Phi]) 
      Ket[<|$CellContext`S[Q3`$] -> 0|>] + 
     E^(Complex[0, 3] $CellContext`\[Phi]) Ket[<|$CellContext`S[Q3`$] -> 0|>] + 
     Ket[<|$CellContext`S[Q3`$] -> 1|>] + 
     Complex[0, -1] E^(Complex[0, 1] $CellContext`\[Phi]) 
      Ket[<|$CellContext`S[Q3`$] -> 1|>] + 
     Complex[0, 1] E^(Complex[0, 2] $CellContext`\[Phi]) 
      Ket[<|$CellContext`S[Q3`$] -> 1|>] - 
     E^(Complex[0, 3] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[Q3`$] -> 1|>], $CellContext`c[0] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
     Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]]}]}]], "Output",
 CellChangeTimes->{3.932623733326837*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"467c4f1d-f35b-4c71-9606-4e753ea385b7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Saveable->False,
WindowSize->{853, 1395},
WindowMargins->{{Automatic, 678}, {Automatic, 0}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"PlaybookNub.nb",
ExpressionUUID->"68529164-1e3a-4aa2-a2cb-31c258d3d8da"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 174, 3, 96, "Title",ExpressionUUID->"4061fecb-e999-4daa-80a9-5db539b314ec"],
Cell[757, 27, 268, 4, 29, "Input",ExpressionUUID->"117142bf-a0cd-4674-bbaf-7981816c24f8"],
Cell[CellGroupData[{
Cell[1050, 35, 257, 6, 66, "Section",ExpressionUUID->"9194e6a5-f774-40d1-97b0-cbf6954269aa"],
Cell[1310, 43, 351, 6, 29, "Input",ExpressionUUID->"1a51bd7d-3647-49aa-af0e-26681fffc6b3"],
Cell[1664, 51, 407, 8, 49, "Input",ExpressionUUID->"1c1c7eac-215b-41ca-a67e-d38acaa28a21"],
Cell[CellGroupData[{
Cell[2096, 63, 1350, 39, 70, "Input",ExpressionUUID->"dd857675-58db-4783-9d34-dde05de8001f"],
Cell[3449, 104, 1312, 44, 38, "Output",ExpressionUUID->"e867730d-8174-448c-a5eb-f0ee0f71e0ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4798, 153, 818, 20, 151, "Input",ExpressionUUID->"ce312e05-0bfa-4326-99a2-e32ead8b669a"],
Cell[5619, 175, 3346, 86, 101, "Output",ExpressionUUID->"8bc87bfb-2f78-4cdd-970a-e10a76b38b4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9002, 266, 282, 5, 29, "Input",ExpressionUUID->"55041d67-f952-48f4-be8a-cc261e15cf4b"],
Cell[9287, 273, 2945, 83, 46, "Output",ExpressionUUID->"929f8c4a-bae2-4a50-be11-e71d4538829b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12269, 361, 766, 18, 70, "Input",ExpressionUUID->"ae2bbe46-6f6d-4717-9fe4-fda205f458e0"],
Cell[13038, 381, 2968, 80, 46, "Output",ExpressionUUID->"8949ed8e-2147-41ba-ba5d-898ba16c4772"],
Cell[16009, 463, 3779, 85, 46, "Output",ExpressionUUID->"221ad63c-d5ee-49b8-8342-187910256238"],
Cell[19791, 550, 2356, 66, 46, "Output",ExpressionUUID->"9440b763-95f5-481a-84e1-b2c8179d0034"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22184, 621, 1040, 26, 172, "Input",ExpressionUUID->"61c711e6-355f-4f02-9fdc-a9158b2e6e49"],
Cell[23227, 649, 4021, 102, 102, "Output",ExpressionUUID->"c55abdf4-a5df-4026-8ea3-144fb2d2fc18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27285, 756, 843, 18, 49, "Input",ExpressionUUID->"d8a96545-5030-4884-ba0f-933f3ce735fa"],
Cell[28131, 776, 2440, 63, 62, "Output",ExpressionUUID->"64424b88-a452-423a-abfa-997b2ed64d54"],
Cell[30574, 841, 1761, 50, 62, "Output",ExpressionUUID->"78110f5b-dd51-4bae-982d-c025680852ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32372, 896, 691, 19, 49, "Input",ExpressionUUID->"8e867f72-6273-4e7c-b9ad-53cfa0e13598"],
Cell[33066, 917, 1879, 53, 46, "Output",ExpressionUUID->"70ec11b1-34bc-442d-ab18-86530a6baeb7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34994, 976, 104, 0, 66, "Section",ExpressionUUID->"92d825dc-2528-4fd1-bede-3ac9c2b09b47"],
Cell[35101, 978, 376, 8, 70, "Input",ExpressionUUID->"7cb6f7fe-5c72-4db2-a1e3-9b0058ae2527"],
Cell[35480, 988, 1238, 33, 70, "Input",ExpressionUUID->"08eebeaf-2ffa-49d0-a09e-b56963a501ab"],
Cell[CellGroupData[{
Cell[36743, 1025, 443, 10, 70, "Input",ExpressionUUID->"00814601-c0b8-445b-8aec-030c05da7a24"],
Cell[37189, 1037, 214, 4, 33, "Output",ExpressionUUID->"eb940793-05d2-4bb0-9c71-d48b6e9955ca"],
Cell[37406, 1043, 224, 4, 33, "Output",ExpressionUUID->"c4fae430-2886-401e-b6f5-aaedfc6a2658"],
Cell[37633, 1049, 916, 29, 33, "Output",ExpressionUUID->"a73eae2e-19dd-47b1-a954-2d990d5a8529"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38586, 1083, 2855, 76, 294, "Input",ExpressionUUID->"efdd35b7-a18b-4b96-91fb-8dfdbfb6a3c8"],
Cell[41444, 1161, 10286, 244, 210, "Output",ExpressionUUID->"4abe0f86-c517-4657-bb02-864d39e93e16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51767, 1410, 1196, 28, 49, "Input",ExpressionUUID->"aeadb300-2d04-40a2-ab35-885fc0d810b2"],
Cell[52966, 1440, 395, 9, 26, "Message",ExpressionUUID->"66278d40-49f8-4fe7-bdd5-5c7d1ea3d0e9"],
Cell[53364, 1451, 395, 9, 26, "Message",ExpressionUUID->"8159bed4-c760-4cbe-a4ec-95e011aee698"],
Cell[53762, 1462, 819, 13, 33, "Output",ExpressionUUID->"48c9580c-75be-4124-b468-4df981085e5f"],
Cell[54584, 1477, 9679, 234, 130, "Output",ExpressionUUID->"8a3a0a1f-ad4c-40f2-9723-b74856c48775"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64312, 1717, 95, 0, 66, "Section",ExpressionUUID->"a798cc03-9037-4d66-8b8c-08b8123785e1"],
Cell[64410, 1719, 667, 15, 77, "Text",ExpressionUUID->"589f3f44-8ac8-42c5-a654-82e1b387b643"],
Cell[65080, 1736, 338, 7, 70, "Input",ExpressionUUID->"29868f19-479d-4581-bfac-22f3ddd142c8"],
Cell[65421, 1745, 816, 27, 38, "Text",ExpressionUUID->"9c3f60cf-0162-4911-8fdf-e143a9f7df89"],
Cell[CellGroupData[{
Cell[66262, 1776, 580, 14, 49, "Input",ExpressionUUID->"b2b955c1-2c87-405c-abcc-44a1dda5ab99"],
Cell[66845, 1792, 1679, 43, 100, "Output",ExpressionUUID->"f9080b82-a3a6-4dbb-ae62-b8134a4f6b47"],
Cell[68527, 1837, 3806, 102, 56, "Output",ExpressionUUID->"8c2384a1-c6e6-436f-a745-2519deab4239"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72370, 1944, 2117, 59, 172, "Input",ExpressionUUID->"7d7908c1-55a8-489e-80d0-00fd8c7c0958"],
Cell[74490, 2005, 4026, 98, 137, "Output",ExpressionUUID->"dba3a2dd-014d-4651-bc3e-56d9f96989d3"]
}, Open  ]],
Cell[78531, 2106, 425, 11, 60, "Text",ExpressionUUID->"9fccfb53-8b9d-4612-89c0-fdc900b3027a"],
Cell[CellGroupData[{
Cell[78981, 2121, 424, 12, 49, "Input",ExpressionUUID->"34b7928c-ec28-483e-b384-cb65afefe2b3"],
Cell[79408, 2135, 461, 10, 26, "Message",ExpressionUUID->"923088e8-5318-4d97-8cad-cb8b7ff2d7b7"],
Cell[79872, 2147, 7443, 182, 76, "Output",ExpressionUUID->"467c4f1d-f35b-4c71-9606-4e753ea385b7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

