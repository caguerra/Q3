(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87392,       2478]
NotebookOptionsPosition[     81936,       2381]
NotebookOutlinePosition[     82334,       2397]
CellTagsIndexPosition[     82291,       2394]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["One-Way Quantum Computation", "Title",
 CellChangeTimes->{{3.8133556202441883`*^9, 
  3.8133556302822533`*^9}},ExpressionUUID->"4061fecb-e999-4daa-80a9-\
5db539b314ec"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellChangeTimes->{{3.757656577043529*^9, 3.757656583441247*^9}, 
   3.8132987243185043`*^9, {3.826581207619049*^9, 3.8265812083602247`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"117142bf-a0cd-4674-bbaf-7981816c24f8"],

Cell[CellGroupData[{

Cell[TextData[{
 "Elementary Idea: Rotation ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "(", "\[Phi]", ")"}], TraditionalForm]],ExpressionUUID->
  "172e07ad-65aa-4d14-a6d3-4be8a0c057b4"]
}], "Section",ExpressionUUID->"9194e6a5-f774-40d1-97b0-cbf6954269aa"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellChangeTimes->{{3.757656823938943*^9, 3.757656827323608*^9}, {
   3.757657066446066*^9, 3.757657066609345*^9}, {3.75788847877194*^9, 
   3.757888478906226*^9}, 3.7580792815707703`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"1a51bd7d-3647-49aa-af0e-26681fffc6b3"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.757888459098827*^9, 3.757888469011306*^9}, {
  3.757888624831584*^9, 3.757888631710669*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"1c1c7eac-215b-41ca-a67e-d38acaa28a21"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", "\"\<R\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"v0", "=", 
  RowBox[{"ProductState", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "0", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], ",", 
       RowBox[{"c", "[", "1", "]"}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "]"}], ".", 
      RowBox[{"Dagger", "@", 
       RowBox[{"c", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "\[Rule]", "1"}], "}"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.757909239064898*^9, 3.757909243310844*^9}, {
   3.757915094343938*^9, 3.757915127060977*^9}, {3.757920518335712*^9, 
   3.7579205323219624`*^9}, 3.78618413973387*^9, {3.817791408410001*^9, 
   3.817791409511211*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"dd857675-58db-4783-9d34-dde05de8001f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`c[0]], " ", 
        TemplateBox[{"0"},
         "Ket"]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]], " ", 
        TemplateBox[{"1"},
         "Ket"]}]}], ")"}], 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]],
      $CellContext`S[0, None]]],
    DisplayForm], "\[CircleTimes]", 
   TagBox[
    SubscriptBox[
     RowBox[{"(", 
      TemplateBox[{"0"},
       "Ket"], ")"}], 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`S[1, None]]],
    DisplayForm]}],
  Q3`ProductState[<|$CellContext`S[0, None] -> {
      $CellContext`c[0], 
      $CellContext`c[1]}, $CellContext`S[1, None] -> {1, 0}|>]]], "Output",
 CellLabel->"Out[6]=",ExpressionUUID->"bfebc819-aeff-4f48-b962-540832ea8509"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v0", ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "R0", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"0", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"ce312e05-0bfa-4326-99a2-e32ead8b669a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{5, -1}, {6, -1}}}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {6, -2}}}], {InsetBox[
      StyleBox[
       RowBox[{
        RowBox[{
         TemplateBox[{"0"},
          "Ket"], " ", 
         FormBox[
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"c"},
             "RowDefault"], 
            TemplateBox[{"0"},
             "RowDefault"]],
           $CellContext`c[0]],
          TraditionalForm]}], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], " ", 
         FormBox[
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"c"},
             "RowDefault"], 
            TemplateBox[{"1"},
             "RowDefault"]],
           $CellContext`c[1]],
          TraditionalForm]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
      3.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
      LineBox[{{4.6, -1.4}, {5.4, -1.4}, {5.4, -0.6}, {4.6, -0.6}, {
       4.6, -1.4}}]}, 
     CircleBox[{5, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{72, 36}, {1, 1}},
   ImageSize->324,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuissoIn[
    Q3`ProductState[<|$CellContext`S[0, None] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}, $CellContext`S[1, None] -> {1, 0}|>]], 
   $CellContext`S[1, 6], 
   Q3`CZ[{
     $CellContext`S[0, None]}, {
     $CellContext`S[1, None]}], 
   Q3`Rotation[$CellContext`\[Alpha], 
    $CellContext`S[0, 3], Label -> "R"], 
   $CellContext`S[0, 6], 
   Q3`Measurement[
    $CellContext`S[0, 3]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[8]=",ExpressionUUID->"d6480379-f51c-4e8d-834d-8651e2122541"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.7579206252716503`*^9, 3.757920629264233*^9}, {
  3.846125036838644*^9, 3.846125037747817*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"55041d67-f952-48f4-be8a-cc261e15cf4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]],
      $CellContext`c[0]], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]], 
          $CellContext`S[0, None]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[0, None] -> 1|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]],
      $CellContext`c[0]], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]], 
          $CellContext`S[0, None]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, None]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[0, None] -> 1, $CellContext`S[1, None] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"57f8b066-affb-4860-a350-045b94777820"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "/.", "rules"}], "//", "Simplify"}], "//", 
    "LogicalForm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vv", "=", 
  RowBox[{
   RowBox[{"KetFactor", "[", 
    RowBox[{"v", ",", 
     RowBox[{"S", "[", "0", "]"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"w", "=", 
  RowBox[{"vv", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.757914859703829*^9, 3.757914881999783*^9}, {
   3.757914941614622*^9, 3.757915029234832*^9}, {3.757915177115369*^9, 
   3.7579151815668163`*^9}, 3.757920640205359*^9, {3.846125052724743*^9, 
   3.8461250537113743`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ae2bbe46-6f6d-4717-9fe4-fda205f458e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"0"}, "RowDefault"]], 
           $CellContext`S[0, None]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[0, None] -> 1|>]],
    HoldForm], "\[CircleTimes]", 
   TemplateBox[{"\"(\"", 
     RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
       RowBox[{"(", 
         RowBox[{
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 InterpretationBox[
                  SubscriptBox[
                   TemplateBox[{"c"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]], 
                  $CellContext`c[0]], "-", 
                 RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"c"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`c[1]]}]}], ")"}], " ", 
             InterpretationBox[
              TemplateBox[{"\"\[SpaceIndicator]\""}, "Ket"], 
              Ket[<||>]]}], "+", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 InterpretationBox[
                  SubscriptBox[
                   TemplateBox[{"c"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]], 
                  $CellContext`c[0]], "+", 
                 RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"c"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`c[1]]}]}], ")"}], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, None]]]}, "RowDefault"]}, "Ket"], 
              Ket[<|$CellContext`S[1, None] -> 1|>]]}]}], ")"}]}], "\")\""},
    "RowDefault"]}],
  Q3`OSlash[
   Ket[<|$CellContext`S[0, None] -> 1|>], Rational[1, 2] E^(Complex[0, 
       Rational[-1, 2]] $CellContext`\[Alpha]) (($CellContext`c[0] - 
      E^(Complex[0, 1] $CellContext`\[Alpha]) $CellContext`c[1]) 
     Ket[<||>] + ($CellContext`c[0] + 
      E^(Complex[0, 1] $CellContext`\[Alpha]) $CellContext`c[1]) 
     Ket[<|$CellContext`S[1, None] -> 1|>])]]], "Output",
 CellLabel->"Out[11]=",ExpressionUUID->"3d51b0f5-ef10-4472-8371-941d5a119167"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"c"},
          "RowDefault"], 
         TemplateBox[{"0"},
          "RowDefault"]],
        $CellContext`c[0]], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"\"\[SpaceIndicator]\""},
       "Ket"],
      Ket[<||>]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"c"},
          "RowDefault"], 
         TemplateBox[{"0"},
          "RowDefault"]],
        $CellContext`c[0]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, None]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, None] -> 1|>]]}]}], ")"}]}]], "Output",
 CellLabel->"Out[12]=",ExpressionUUID->"c83ceb3b-42b0-473a-bb29-db338271155f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v0", ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", "R0",
     ",", 
    RowBox[{"S", "[", 
     RowBox[{"0", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"61c711e6-355f-4f02-9fdc-a9158b2e6e49"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{5, -1}, {8, -1}}}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {8, -2}}}], {InsetBox[
      StyleBox[
       RowBox[{
        RowBox[{
         TemplateBox[{"0"},
          "Ket"], " ", 
         FormBox[
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"c"},
             "RowDefault"], 
            TemplateBox[{"0"},
             "RowDefault"]],
           $CellContext`c[0]],
          TraditionalForm]}], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], " ", 
         FormBox[
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"c"},
             "RowDefault"], 
            TemplateBox[{"1"},
             "RowDefault"]],
           $CellContext`c[1]],
          TraditionalForm]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
      3.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
      LineBox[{{4.6, -1.4}, {5.4, -1.4}, {5.4, -0.6}, {4.6, -0.6}, {
       4.6, -1.4}}]}, 
     CircleBox[{5, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
     LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], {CircleBox[{6, -2}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -2}, {6.266666666666667, -2}}, {{
         6, -2.2666666666666666`}, {6, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, 
     LineBox[{{6.6, -2.4}, {7.4, -2.4}, {7.4, -1.6}, {6.6, -1.6}, {
      6.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{72, 36}, {1, 1}},
   ImageSize->396,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuissoIn[
    Q3`ProductState[<|$CellContext`S[0, None] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}, $CellContext`S[1, None] -> {1, 0}|>]], 
   $CellContext`S[1, 6], 
   Q3`CZ[{
     $CellContext`S[0, None]}, {
     $CellContext`S[1, None]}], 
   Q3`Rotation[$CellContext`\[Alpha], 
    $CellContext`S[0, 3], Label -> "R"], 
   $CellContext`S[0, 6], 
   Q3`Measurement[
    $CellContext`S[0, 3]], 
   Q3`CNOT[{
      $CellContext`S[0, None]} -> {1}, {
     $CellContext`S[1, None]}], 
   $CellContext`S[1, 6], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[13]=",ExpressionUUID->"cbd11fdf-13ca-4cd2-aa04-2bc077a928e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v1", "=", 
  RowBox[{
   RowBox[{"LogicalForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Elaborate", "[", "qc", "]"}], "/.", "rules"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"v1", "=", 
  RowBox[{
   RowBox[{"KetFactor", "[", 
    RowBox[{"v1", ",", 
     RowBox[{"S", "[", "0", "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7579208145461597`*^9, 3.757920910803339*^9}, {
  3.757920963048493*^9, 3.757920976932559*^9}, {3.7579211859962797`*^9, 
  3.75792118971605*^9}, {3.7579790999113398`*^9, 3.757979124738173*^9}, {
  3.757979200228537*^9, 3.757979200314581*^9}, {3.7952418991061907`*^9, 
  3.7952419055955257`*^9}, {3.846125070569828*^9, 3.846125078336833*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d8a96545-5030-4884-ba0f-933f3ce735fa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]],
       $CellContext`c[0]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"0"}, "RowDefault"]], 
             $CellContext`S[0, None]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]], 
             $CellContext`S[1, None]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[0, None] -> 0, $CellContext`S[1, None] -> 0|>]]}],
      "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`c[1]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"0"}, "RowDefault"]], 
             $CellContext`S[0, None]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]], 
             $CellContext`S[1, None]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[0, None] -> 0, $CellContext`S[1, None] -> 
         1|>]]}]}], ")"}]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[14]=",ExpressionUUID->"830e2c7f-e07c-4718-8f00-02670ebb4fd3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]],
       $CellContext`c[0]], " ", 
      InterpretationBox[
       TemplateBox[{"\"\[SpaceIndicator]\""},
        "Ket"],
       Ket[<||>]]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`c[1]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]], 
             $CellContext`S[1, None]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[1, None] -> 1|>]]}]}], ")"}]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[15]=",ExpressionUUID->"9bf45ff5-a6cd-40b5-85c5-44d230bdbd59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rotation", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "**", 
     RowBox[{"ProductState", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"c", "@", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], "//", "Elaborate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v2", "-", "v1"}], "//", "Simplify"}], "//", 
  "LogicalForm"}]}], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"8e867f72-6273-4e7c-b9ad-53cfa0e13598"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "2"}], "+", 
    SqrtBox["2"]}], ")"}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]],
      $CellContext`c[0]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, None]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, None] -> 0|>]]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`c[1]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, None]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, None] -> 1|>]]}]}], ")"}]}]], "Output",
 CellLabel->"Out[23]=",ExpressionUUID->"437178e3-7441-42c1-b83f-237fe17c4174"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Single-Qubit Rotations", "Section",ExpressionUUID->"92d825dc-2528-4fd1-bede-3ac9c2b09b47"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"7cb6f7fe-5c72-4db2-a1e3-9b0058ae2527"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", "\"\<R\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Beta]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", 
      RowBox[{"Superscript", "[", 
       RowBox[{"\"\<R\>\"", ",", "\[Prime]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Gamma]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}], ",", 
     RowBox[{"Label", "\[Rule]", 
      RowBox[{"Superscript", "[", 
       RowBox[{"\"\<R\>\"", ",", "\[DoublePrime]"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.757888441276161*^9, 3.757888532196735*^9}, {
   3.757888687694727*^9, 3.7578886886057673`*^9}, 3.757909224472875*^9, {
   3.7579213888441973`*^9, 3.7579213889512663`*^9}, {3.817792475657712*^9, 
   3.81779248565965*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"08eebeaf-2ffa-49d0-a09e-b56963a501ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"jj", "=", 
  RowBox[{"Range", "[", "4", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"kk", "=", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "None"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.813355842830373*^9, 3.813355873495274*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"00814601-c0b8-445b-8aec-030c05da7a24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellLabel->"Out[12]=",ExpressionUUID->"334a8ceb-195b-459a-9157-ba85e74b15bf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellLabel->"Out[13]=",ExpressionUUID->"de110733-ebec-416a-9a15-d45b94bb94a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`S[0, None]], ",", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`S[1, None]], ",", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`S[2, None]], ",", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]],
    $CellContext`S[3, None]], ",", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"4"},
      "RowDefault"]],
    $CellContext`S[4, None]]}], "}"}]], "Output",
 CellLabel->"Out[14]=",ExpressionUUID->"a4180ca7-ddec-4046-9c17-8435d976633b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc", "=", 
   RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProductState", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", "0", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], 
        "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"jj", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CZ", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"CZ", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
     RowBox[{"CZ", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], ",", 
       RowBox[{"S", "[", "4", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CZ", "[", 
      RowBox[{
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"0", ",", "6"}], "]"}], ",", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", 
       RowBox[{"0", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "R1", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "R2", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}], ",", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "R3", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "6"}], "]"}], ",", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{"qc", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"efdd35b7-a18b-4b96-91fb-8dfdbfb6a3c8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{7, -1}, {20, -1}}, {{11, -2}, {20, -2}}, {{15, -3}, {
     20, -3}}, {{19, -4}, {20, -4}}}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {15, -3}}, {{
    0, -4}, {19, -4}}, {{0, -5}, {20, -5}}}], {InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"0"},
            "RowDefault"]],
          $CellContext`c[0]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`c[1]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.016000000000000004`],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.016000000000000004`],
      FontWeight->"Light"], {-0.1, -2}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.016000000000000004`],
      FontWeight->"Light"], {-0.1, -3}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.016000000000000004`],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.016000000000000004`],
      FontWeight->"Light"], {-0.1, -5}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, 
     LineBox[{{0.6, -5.4}, {1.4, -5.4}, {1.4, -4.6}, {0.6, -4.6}, {
      0.6, -5.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -2}, {2, -3}}], 
    DiskBox[{2, -2}, 0.09], DiskBox[{2, -3}, 0.09]}, {
    LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
    DiskBox[{3, -4}, 0.09]}, {LineBox[{{4, -4}, {4, -5}}], 
    DiskBox[{4, -4}, 0.09], DiskBox[{4, -5}, 0.09]}, {
    LineBox[{{5, -1}, {5, -2}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -2}, 0.09]}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
    LineBox[{{5.6, -1.4}, {6.4, -1.4}, {6.4, -0.6}, {5.6, -0.6}, {
     5.6, -1.4}}], InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {6, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
     LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
      6.6, -1.4}}]}, 
    CircleBox[{7, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{7, -1.2}, {7.24, -0.76}}]}, {
    LineBox[{{8, -1}, {8, -2}}], 
    DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
        8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, 
    LineBox[{{8.6, -2.4}, {9.4, -2.4}, {9.4, -1.6}, {8.6, -1.6}, {
     8.6, -2.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {9, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, 
    LineBox[{{9.6, -2.4}, {10.4, -2.4}, {10.4, -1.6}, {9.6, -1.6}, {
     9.6, -2.4}}], InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{10.6, -2.4}, {11.4, -1.6}]},
      LineBox[{{10.6, -2.4}, {11.4, -2.4}, {11.4, -1.6}, {10.6, -1.6}, {
      10.6, -2.4}}]}, 
    CircleBox[{11, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{11, -2.2}, {11.24, -1.76}}]}, {
    LineBox[{{12, -2}, {12, -3}}], 
    DiskBox[{12, -2}, 0.09], {CircleBox[{12, -3}, 0.26666666666666666], 
     LineBox[{{{11.733333333333333`, -3}, {12.266666666666667`, -3}}, {{
        12, -3.2666666666666666`}, {12, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{12.6, -3.4}, {13.4, -2.6}]}, 
    LineBox[{{12.6, -3.4}, {13.4, -3.4}, {13.4, -2.6}, {12.6, -2.6}, {
     12.6, -3.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {13, -3}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{13.6, -3.4}, {14.4, -2.6}]}, 
    LineBox[{{13.6, -3.4}, {14.4, -3.4}, {14.4, -2.6}, {13.6, -2.6}, {
     13.6, -3.4}}], InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {14, -3}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{14.6, -3.4}, {15.4, -2.6}]},
      LineBox[{{14.6, -3.4}, {15.4, -3.4}, {15.4, -2.6}, {14.6, -2.6}, {
      14.6, -3.4}}]}, 
    CircleBox[{15, -3.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{15, -3.2}, {15.24, -2.76}}]}, {
    LineBox[{{16, -3}, {16, -4}}], 
    DiskBox[{16, -3}, 0.09], {CircleBox[{16, -4}, 0.26666666666666666], 
     LineBox[{{{15.733333333333333`, -4}, {16.266666666666666`, -4}}, {{
        16, -4.266666666666667}, {16, -3.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{16.6, -4.4}, {17.4, -3.6}]}, 
    LineBox[{{16.6, -4.4}, {17.4, -4.4}, {17.4, -3.6}, {16.6, -3.6}, {
     16.6, -4.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {17, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{17.6, -4.4}, {18.4, -3.6}]}, 
    LineBox[{{17.6, -4.4}, {18.4, -4.4}, {18.4, -3.6}, {17.6, -3.6}, {
     17.6, -4.4}}], InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.020000000000000004`],
      FontWeight->"Light",
      FontSlant->Italic], {18, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{18.6, -4.4}, {19.4, -3.6}]},
      LineBox[{{18.6, -4.4}, {19.4, -4.4}, {19.4, -3.6}, {18.6, -3.6}, {
      18.6, -4.4}}]}, 
    CircleBox[{19, -4.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{19, -4.2}, {19.24, -3.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->Large,
  PlotRange->NCache[{Full, {
      Rational[-11, 2], 
      Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[37]=",ExpressionUUID->"930563ea-5fa6-4e43-ab1d-6078aa6e2672"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], 
       RowBox[{"Conjugate", "[", 
        RowBox[{"c", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"c", "[", "1", "]"}], 
       RowBox[{"Conjugate", "[", 
        RowBox[{"c", "[", "1", "]"}], "]"}]}]}], "\[Rule]", "1"}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7578888625526123`*^9, 3.757888869319091*^9}, {
   3.757889048054686*^9, 3.757889076958262*^9}, {3.757889825903118*^9, 
   3.757889826754305*^9}, {3.757889866115164*^9, 3.757889897566753*^9}, {
   3.757890029456252*^9, 3.757890087076215*^9}, 3.757893682565064*^9, {
   3.757893797998975*^9, 3.757893801060066*^9}, {3.813355699827824*^9, 
   3.813355786763239*^9}, {3.8133558882108183`*^9, 3.813355917592924*^9}, {
   3.846125106342503*^9, 3.846125109692597*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"aeadb300-2d04-40a2-ab35-885fc0d810b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.032692`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.757893756592835*^9, 3.757905525149961*^9, 3.757906818922183*^9, 
   3.757921369213612*^9, 3.75792141343368*^9, 3.7579287981693497`*^9, 
   3.757979244418467*^9, 3.782543322988205*^9, 3.782543436507251*^9, 
   3.785104034173658*^9, 3.785111714262795*^9, 3.78618572475142*^9, 
   3.786317923878824*^9, 3.787184005114418*^9, 3.795131093988811*^9, 
   3.79524197692832*^9, 3.795838020179234*^9, 3.813298771619989*^9, 
   3.813355712617078*^9, {3.8133557708065166`*^9, 3.813355793464888*^9}, {
   3.813355890927075*^9, 3.813355918353895*^9}, 3.817792497360914*^9, 
   3.826581247645554*^9, 3.8461251119628963`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"02c065cb-06aa-4ec8-a7ed-c73ae7e89b0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox["\[Alpha]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "+", 
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox["\[Alpha]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "+", 
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"0"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.757893756592835*^9, 3.757905525149961*^9, 3.757906818922183*^9, 
   3.757921369213612*^9, 3.75792141343368*^9, 3.7579287981693497`*^9, 
   3.757979244418467*^9, 3.782543322988205*^9, 3.782543436507251*^9, 
   3.785104034173658*^9, 3.785111714262795*^9, 3.78618572475142*^9, 
   3.786317923878824*^9, 3.787184005114418*^9, 3.795131093988811*^9, 
   3.79524197692832*^9, 3.795838020179234*^9, 3.813298771619989*^9, 
   3.813355712617078*^9, {3.8133557708065166`*^9, 3.813355793464888*^9}, {
   3.813355890927075*^9, 3.813355918353895*^9}, 3.817792497360914*^9, 
   3.826581247645554*^9, 3.846125111972148*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"3d64241d-acc3-4bb8-84f9-bbc8a174c817"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LogicalForm", "[", 
   RowBox[{"expr", ",", "SS"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7579078895244703`*^9, 3.757907914484387*^9}, {
  3.757921433699985*^9, 3.757921448612454*^9}, {3.795241925552854*^9, 
  3.7952419278007812`*^9}, {3.813355803603506*^9, 3.81335580395158*^9}, {
  3.813355922555244*^9, 3.813355926435348*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"baa585b7-29b4-44ba-81ea-0edc4435e0ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox["\[Alpha]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "+", 
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox["\[Alpha]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Beta]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]], " ", 
            RowBox[{"Cos", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}], "+", 
           RowBox[{
            SubscriptBox[
             TemplateBox[{"c"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Gamma]", "2"], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"0"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "-", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}], 
       "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.757907892260652*^9, 3.757907915265974*^9}, {
   3.7579214265545797`*^9, 3.757921449302104*^9}, 3.757979245789583*^9, 
   3.7825434385039997`*^9, 3.78510403429136*^9, 3.7851117143612947`*^9, 
   3.786185724824554*^9, 3.7863179239844513`*^9, 3.7871840051932793`*^9, 
   3.795131094029291*^9, 3.795241977066926*^9, 3.795838020230131*^9, 
   3.813298771678463*^9, {3.813355795248197*^9, 3.813355804700529*^9}, 
   3.813355927013336*^9, 3.817792499209115*^9, 3.826581248087359*^9, 
   3.846125113361699*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"9f8df248-28d8-41d7-9248-f0c0b6430f6c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Magic State Injection", "Section",ExpressionUUID->"a798cc03-9037-4d66-8b8c-08b8123785e1"],

Cell[TextData[{
 "Unlike the Clifford gates, the so-called ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d38c12dc-6eb1-46a1-b8b3-981dda68d8e8"],
 "-gate (a phase gate by phase angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "8"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "00412b02-305f-4be5-a2bf-846265bef4c5"],
 ") turns out to be difficult to implement in a fault-tolerant way. As a \
workaround, magic state injection method has been suggested. It is a special \
case of the measurement-based quantum computing."
}], "Text",ExpressionUUID->"589f3f44-8ac8-42c5-a654-82e1b387b643"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"29868f19-479d-4581-bfac-22f3ddd142c8"],

Cell[TextData[{
 "First, generate the magic state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1e47d28f-e501-4bc0-ba50-5d65ae90de20"],
 ". Of course, we are interested in the case of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "8"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d4e35b8f-1570-45d8-98f4-46926f0f100d"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      RowBox[{"\[Phi]", "=", 
        RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "8"}]}]}]},
     "Ket"], "\[Congruent]", 
    TemplateBox[{"T"},
     "Ket"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bfc60f95-4595-4c66-9ee4-438c6cd07997"],
 "."
}], "Text",ExpressionUUID->"9c3f60cf-0162-4911-8fdf-e143a9f7df89"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mgc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"S", "[", "2", "]"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Elaborate", "[", "in", "]"}], "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"b2b955c1-2c87-405c-abcc-44a1dda5ab99"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuissoIn[
    Ket[<|$CellContext`S[2, None] -> 0|>]], 
   $CellContext`S[2, 6], 
   Q3`Phase[$CellContext`\[Phi], 
    $CellContext`S[2, None]]]]], "Output",
 CellLabel->"Out[67]=",ExpressionUUID->"ab2736fd-ab8a-471b-b052-53706bb10870"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, None]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[2, None] -> 0|>]], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, None]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[2, None] -> 1|>]]}], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[68]=",ExpressionUUID->"0eb09b64-ad72-4ecc-b314-e3aad35267fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "->", 
      RowBox[{"c", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], ",", 
     RowBox[{"\"\<Label\>\"", "->", 
      RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
   "in", ",", "mgc", ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"Phase", "[", 
       RowBox[{
        RowBox[{"2", "\[Phi]"}], ",", 
        RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "\[Phi]"}], "]"}]}]}], "}"}]}], ",", 
      RowBox[{"\"\<Label\>\"", "->", 
       RowBox[{"DisplayForm", "@", 
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Superscript", "[", 
            RowBox[{"\"\<Z\>\"", ",", "\"\<\[Phi]\>\""}], "]"}], ",", 
           RowBox[{"Ket", "[", "\[Psi]", "]"}]}], "}"}]}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[144]:=",ExpressionUUID->"7d7908c1-55a8-489e-80d0-00fd8c7c0958"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{5, -2}, {7, -2}}}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {5, -2}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"\[Psi]"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
      1.6, -2.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{3, Rational[-5, 2]}, {3, Rational[-1, 2]}}, {{
        3, -2.5}, {3, -0.5}}]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
      LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
       4.6, -2.4}}]}, 
     CircleBox[{5, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
     LineBox[{{6, -2}, {6, -1}}], DiskBox[{6, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
     LineBox[{{5.6, -1.4}, {6.4, -1.4}, {6.4, -0.6}, {5.6, -0.6}, {
      5.6, -1.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", 
         RowBox[{"2", " ", "\[Phi]"}]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, InsetBox[
     StyleBox[
      TagBox[
       RowBox[{
        TemplateBox[{"\"Z\"", "\"\[Phi]\""},
         "Superscript"], 
        TemplateBox[{"\[Psi]"},
         "Ket"]}],
       DisplayForm],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {7.1, -1}, NCache[
     ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{36, 108}, {1, 1}},
   ImageSize->396,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuissoIn[
    Q3`ProductState[<|$CellContext`S[1, None] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}|>, "Label" -> Ket[$CellContext`\[Psi]]], 
    Ket[<|$CellContext`S[2, None] -> 0|>]], 
   $CellContext`S[2, 6], 
   Q3`Phase[$CellContext`\[Phi], 
    $CellContext`S[2, None]], "Separator", 
   Q3`CNOT[{
      $CellContext`S[1, None]} -> {1}, {
     $CellContext`S[2, None]}], 
   Q3`Measurement[
    $CellContext`S[2, 3]], 
   Q3`ControlledU[{
      $CellContext`S[2, None]} -> {1}, 
    Q3`Phase[2 $CellContext`\[Phi], 
     $CellContext`S[1, None]]], 
   Q3`QuissoOut[
    Q3`ProductState[<|$CellContext`S[1, None] -> {
        $CellContext`c[0], 
        E^(Complex[0, 1] $CellContext`\[Phi]) $CellContext`c[1]}|>, "Label" -> 
     DisplayForm[
       RowBox[{
         Superscript["Z", "\[Phi]"], 
         Ket[$CellContext`\[Psi]]}]]]], "PortSize" -> {1, 3}]]], "Output",
 CellLabel->
  "Out[145]=",ExpressionUUID->"23984429-92fe-456e-a0ef-d292266791b3"]
}, Open  ]],

Cell[TextData[{
 "Check that regardless of the measurement result, the state prepared in the \
first qubit (up to a global phase) becomes the desired state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["Z", "\[Phi]"], 
    TemplateBox[{"\[Psi]"},
     "Ket"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b83178d9-19c6-46f7-a38d-79f7a62bbcf8"],
 "."
}], "Text",ExpressionUUID->"9fccfb53-8b9d-4612-89c0-fdc900b3027a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"Elaborate", "[", "qc", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"KetFactor", "@", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"34b7928c-ec28-483e-b384-cb65afefe2b3"],

Cell[BoxData[
 TemplateBox[{
  "Measurement", "nonum", 
   "\"Probability half is assumed for a state without explicitly numeric \
coefficients.\"", 2, 146, 26, 33914117193412443062, "Local", "Q3`Measurement"},
  "MessageTemplate2"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[146]:=",ExpressionUUID->"4845d3f2-c1cd-4c71-bcda-e8ebd238dcaa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"0"},
            "RowDefault"]],
          $CellContext`c[0]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, None]]]}, "RowDefault"]},
           "Ket"],
          Ket[<|$CellContext`S[1, None] -> 0|>]]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`c[1]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, None]]]}, "RowDefault"]},
           "Ket"],
          Ket[<|$CellContext`S[1, None] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]], 
             $CellContext`S[2, None]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[2, None] -> 1|>]]}],
     HoldForm],
    Q3`OTimes[$CellContext`c[0] Ket[<|$CellContext`S[1, None] -> 0|>] + 
     E^(Complex[0, 1] $CellContext`\[Phi]) $CellContext`c[1] 
      Ket[<|$CellContext`S[1, None] -> 1|>], 
     Ket[<|$CellContext`S[2, None] -> 1|>]]]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->
  "Out[147]=",ExpressionUUID->"dc0b3f31-e1a9-4a83-ab5a-7d9be65f2dd5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{853, 1395},
WindowMargins->{{Automatic, 678}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"68529164-1e3a-4aa2-a2cb-31c258d3d8da"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 174, 3, 98, "Title",ExpressionUUID->"4061fecb-e999-4daa-80a9-5db539b314ec"],
Cell[757, 27, 267, 4, 30, "Input",ExpressionUUID->"117142bf-a0cd-4674-bbaf-7981816c24f8"],
Cell[CellGroupData[{
Cell[1049, 35, 257, 6, 68, "Section",ExpressionUUID->"9194e6a5-f774-40d1-97b0-cbf6954269aa"],
Cell[1309, 43, 350, 6, 30, "Input",ExpressionUUID->"1a51bd7d-3647-49aa-af0e-26681fffc6b3"],
Cell[1662, 51, 406, 8, 52, "Input",ExpressionUUID->"1c1c7eac-215b-41ca-a67e-d38acaa28a21"],
Cell[CellGroupData[{
Cell[2093, 63, 1349, 39, 73, "Input",ExpressionUUID->"dd857675-58db-4783-9d34-dde05de8001f"],
Cell[3445, 104, 1377, 51, 41, "Output",ExpressionUUID->"bfebc819-aeff-4f48-b962-540832ea8509"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4859, 160, 817, 20, 157, "Input",ExpressionUUID->"ce312e05-0bfa-4326-99a2-e32ead8b669a"],
Cell[5679, 182, 3894, 102, 90, "Output",ExpressionUUID->"d6480379-f51c-4e8d-834d-8651e2122541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9610, 289, 281, 5, 30, "Input",ExpressionUUID->"55041d67-f952-48f4-be8a-cc261e15cf4b"],
Cell[9894, 296, 2447, 81, 50, "Output",ExpressionUUID->"57f8b066-affb-4860-a350-045b94777820"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12378, 382, 776, 20, 73, "Input",ExpressionUUID->"ae2bbe46-6f6d-4717-9fe4-fda205f458e0"],
Cell[13157, 404, 3153, 78, 50, "Output",ExpressionUUID->"3d51b0f5-ef10-4472-8371-941d5a119167"],
Cell[16313, 484, 1923, 64, 50, "Output",ExpressionUUID->"c83ceb3b-42b0-473a-bb29-db338271155f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18273, 553, 1040, 26, 178, "Input",ExpressionUUID->"61c711e6-355f-4f02-9fdc-a9158b2e6e49"],
Cell[19316, 581, 4635, 120, 90, "Output",ExpressionUUID->"cbd11fdf-13ca-4cd2-aa04-2bc077a928e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23988, 706, 948, 22, 52, "Input",ExpressionUUID->"d8a96545-5030-4884-ba0f-933f3ce735fa"],
Cell[24939, 730, 2113, 64, 68, "Output",ExpressionUUID->"830e2c7f-e07c-4718-8f00-02670ebb4fd3"],
Cell[27055, 796, 1311, 43, 68, "Output",ExpressionUUID->"9bf45ff5-a6cd-40b5-85c5-44d230bdbd59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28403, 844, 661, 20, 52, "Input",ExpressionUUID->"8e867f72-6273-4e7c-b9ad-53cfa0e13598"],
Cell[29067, 866, 1643, 54, 50, "Output",ExpressionUUID->"437178e3-7441-42c1-b83f-237fe17c4174"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30759, 926, 104, 0, 67, "Section",ExpressionUUID->"92d825dc-2528-4fd1-bede-3ac9c2b09b47"],
Cell[30866, 928, 375, 8, 73, "Input",ExpressionUUID->"7cb6f7fe-5c72-4db2-a1e3-9b0058ae2527"],
Cell[31244, 938, 1237, 33, 73, "Input",ExpressionUUID->"08eebeaf-2ffa-49d0-a09e-b56963a501ab"],
Cell[CellGroupData[{
Cell[32506, 975, 443, 10, 73, "Input",ExpressionUUID->"00814601-c0b8-445b-8aec-030c05da7a24"],
Cell[32952, 987, 172, 3, 34, "Output",ExpressionUUID->"334a8ceb-195b-459a-9157-ba85e74b15bf"],
Cell[33127, 992, 182, 3, 34, "Output",ExpressionUUID->"de110733-ebec-416a-9a15-d45b94bb94a9"],
Cell[33312, 997, 972, 38, 34, "Output",ExpressionUUID->"a4180ca7-ddec-4046-9c17-8435d976633b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34321, 1040, 2918, 79, 304, "Input",ExpressionUUID->"efdd35b7-a18b-4b96-91fb-8dfdbfb6a3c8"],
Cell[37242, 1121, 9950, 228, 151, "Output",ExpressionUUID->"930563ea-5fa6-4e43-ab1d-6078aa6e2672"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47229, 1354, 1196, 28, 52, "Input",ExpressionUUID->"aeadb300-2d04-40a2-ab35-885fc0d810b2"],
Cell[48428, 1384, 797, 13, 34, "Output",ExpressionUUID->"02c065cb-06aa-4ec8-a7ed-c73ae7e89b0c"],
Cell[49228, 1399, 8035, 248, 201, "Output",ExpressionUUID->"3d64241d-acc3-4bb8-84f9-bbc8a174c817"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57300, 1652, 464, 8, 30, "Input",ExpressionUUID->"baa585b7-29b4-44ba-81ea-0edc4435e0ca"],
Cell[57767, 1662, 8362, 258, 201, "Output",ExpressionUUID->"9f8df248-28d8-41d7-9248-f0c0b6430f6c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[66178, 1926, 95, 0, 53, "Section",ExpressionUUID->"a798cc03-9037-4d66-8b8c-08b8123785e1"],
Cell[66276, 1928, 729, 17, 81, "Text",ExpressionUUID->"589f3f44-8ac8-42c5-a654-82e1b387b643"],
Cell[67008, 1947, 338, 7, 73, "Input",ExpressionUUID->"29868f19-479d-4581-bfac-22f3ddd142c8"],
Cell[67349, 1956, 909, 30, 41, "Text",ExpressionUUID->"9c3f60cf-0162-4911-8fdf-e143a9f7df89"],
Cell[CellGroupData[{
Cell[68283, 1990, 521, 13, 52, "Input",ExpressionUUID->"b2b955c1-2c87-405c-abcc-44a1dda5ab99"],
Cell[68807, 2005, 1870, 48, 54, "Output",ExpressionUUID->"ab2736fd-ab8a-471b-b052-53706bb10870"],
Cell[70680, 2055, 993, 31, 60, "Output",ExpressionUUID->"0eb09b64-ad72-4ecc-b314-e3aad35267fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71710, 2091, 1989, 57, 178, "Input",ExpressionUUID->"7d7908c1-55a8-489e-80d0-00fd8c7c0958"],
Cell[73702, 2150, 4557, 114, 89, "Output",ExpressionUUID->"23984429-92fe-456e-a0ef-d292266791b3"]
}, Open  ]],
Cell[78274, 2267, 456, 12, 64, "Text",ExpressionUUID->"9fccfb53-8b9d-4612-89c0-fdc900b3027a"],
Cell[CellGroupData[{
Cell[78755, 2283, 428, 13, 52, "Input",ExpressionUUID->"34b7928c-ec28-483e-b384-cb65afefe2b3"],
Cell[79186, 2298, 358, 8, 28, "Message",ExpressionUUID->"4845d3f2-c1cd-4c71-bcda-e8ebd238dcaa"],
Cell[79547, 2308, 2349, 68, 60, "Output",ExpressionUUID->"dc0b3f31-e1a9-4a83-ab5a-7d9be65f2dd5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

