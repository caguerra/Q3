(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11789,        342]
NotebookOptionsPosition[      9589,        295]
NotebookOutlinePosition[      9983,        311]
CellTagsIndexPosition[      9940,        308]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q3 Application", "Title",
 CellChangeTimes->{{3.8132986857522*^9, 
  3.813298689790423*^9}},ExpressionUUID->"f272a78a-3527-4909-9307-\
e571d470517d"],

Cell["Examples and Tests", "Subtitle",
 CellChangeTimes->{{3.8132988113293047`*^9, 
  3.8132988216558*^9}},ExpressionUUID->"c11d7683-a59a-463f-aaa3-8b4a1ac08cb0"],

Cell[CellGroupData[{

Cell["Optimizations", "Chapter",
 CellChangeTimes->{{3.795285504372512*^9, 3.795285509063141*^9}, {
  3.79534730603648*^9, 
  3.7953473178021383`*^9}},ExpressionUUID->"6d6a8535-3933-416f-888e-\
e9e7d5a0e0f9"],

Cell[CellGroupData[{

Cell["Matrix", "Section",
 CellChangeTimes->{{3.7952855139467154`*^9, 3.795285515554147*^9}, 
   3.806771690423246*^9},ExpressionUUID->"3e7944ec-7790-481b-a8b9-\
1849c732b515"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.795340730953327*^9, 3.795340732657209*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"1b662391-1775-44fa-8ee3-393994c5ded9"],

Cell[BoxData[
 RowBox[{"<<", "Q3`Quisso`"}]], "Input",
 CellChangeTimes->{{3.7953407344484797`*^9, 3.7953407461677647`*^9}, {
  3.813062217091564*^9, 3.813062217911806*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"51143473-4006-497d-a83b-810f3545f9ee"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellChangeTimes->{{3.795340752065062*^9, 3.795340755212181*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"0714816f-6263-45ed-b49f-20e200ded4cd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$N", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", 
   RowBox[{"Range", "[", "$N", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"NN", ",", "None"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", "SS"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", "I"}], ",", 
       RowBox[{"1", "+", "I"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "bs"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"bs", ".", "vv"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795345087020472*^9, 3.795345131759391*^9}, {
   3.795345300335505*^9, 3.795345325622779*^9}, {3.7953453795536947`*^9, 
   3.795345418216834*^9}, {3.795345478561496*^9, 3.79534549442264*^9}, {
   3.7953455391963243`*^9, 3.795345583822423*^9}, {3.795346621057581*^9, 
   3.7953466214280252`*^9}, {3.795346663367669*^9, 3.79534666617844*^9}, 
   3.806771622406907*^9, {3.813062963307234*^9, 3.813062971720538*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"dde05c3e-f587-472d-bbb3-1877dc0ed8c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"4"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"5"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"6"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"7"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"8"},
      "RowDefault"]],
    DisplayForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.795345584126079*^9, 3.7953463161427107`*^9, {3.795346618194705*^9, 
   3.795346666732808*^9}, {3.813062234777959*^9, 3.813062252021978*^9}, 
   3.8130624704754333`*^9, {3.813062965499909*^9, 3.813062972124359*^9}, 
   3.813063383284354*^9, 3.813298789539174*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"6126e1ec-ab12-4dbb-8f8c-bf696b77f0f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"v1", "=", 
    RowBox[{"Matrix", "[", "expr", "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.795345426160419*^9, 3.7953454419546137`*^9}, 
   3.806771690432564*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"167dbe41-3d3b-4a5e-8b15-1d7e83386306"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.268661`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.795345474952622*^9, 3.7953455060087957`*^9}, 
   3.795345597846202*^9, 3.795346327123094*^9, {3.795346628523746*^9, 
   3.7953466766488447`*^9}, 3.813062317211096*^9, {3.8130629585363693`*^9, 
   3.813062973568915*^9}, 3.8130633846917257`*^9, 3.8132987905584707`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"7a3f095e-5e08-4da7-8b26-99c776e9e5f7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$N", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$N", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"Multiply", "@@@", 
    RowBox[{"Tuples", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"j", ",", "Full"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "$N"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "I"}], ")"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
     RowBox[{"Length", "@", "op"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"vv", ".", "op"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795346098140297*^9, 3.7953462473585997`*^9}, {
  3.795346338267149*^9, 3.795346338389394*^9}, {3.795346381352866*^9, 
  3.7953463939396467`*^9}, {3.7953464367789707`*^9, 3.795346443089026*^9}, {
  3.79534675211436*^9, 3.7953468010555267`*^9}, {3.7953468323051653`*^9, 
  3.795346846884226*^9}, {3.795347010522287*^9, 3.79534701200616*^9}, {
  3.795347164483306*^9, 3.795347194090789*^9}, {3.813063298315599*^9, 
  3.813063328215493*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"eb51fd26-0878-4ad2-a22f-7017bb49eeca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"m1", "=", 
    RowBox[{"Matrix", "[", "expr", "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.795346249737541*^9, 3.795346272760779*^9}, 
   3.8067716904340153`*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"80f7f457-711f-4de1-bf06-ad203f381359"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.356165`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.795346269444821*^9, 3.795346273177595*^9}, {
   3.7953463280597143`*^9, 3.795346438381254*^9}, 3.7953467014615107`*^9, {
   3.795346778352345*^9, 3.795346805008863*^9}, 3.795346838363295*^9, {
   3.795347001152287*^9, 3.795347026750186*^9}, 3.795347167466816*^9, 
   3.7953472087957163`*^9, 3.81306297900369*^9, 3.813063180264596*^9, 
   3.813063234334325*^9, {3.813063300946334*^9, 3.813063330089692*^9}, 
   3.813063387289303*^9, 3.8132987923989887`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"afd0235f-a3f6-4c4e-bef2-6c9060cb9cdf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"expr2", "=", 
    RowBox[{"QuissoExpression", "[", 
     RowBox[{"m1", ",", "SS"}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.813063243103468*^9, 3.8130632501783657`*^9}, {
  3.813063316787022*^9, 3.813063336844037*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"6e4de983-fb9a-4b51-be6c-5f4cb4eb5531"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19.068962`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.8130632937722263`*^9, 3.813063324314906*^9}, 
   3.813063357808107*^9, 3.813063406446393*^9, 3.813298816925233*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"5805ac77-0256-4a12-9487-647e4640c1e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expr2", "-", "expr"}], "//", "QuissoExpand"}], "//", "Garner"}], 
  "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.8130633467219467`*^9, 3.8130633589829407`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"c3509b2d-6017-43eb-8763-7a0c6cbf6226"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.813063360475775*^9, 3.813063409881406*^9, {3.8132987974975443`*^9, 
   3.8132988179399567`*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"6b2557a1-5411-4465-a781-57f791278a60"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{853, 1395},
WindowMargins->{{144, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3212b05d-2b6f-43da-ae45-ea95a7fac4ed"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 155, 3, 98, "Title",ExpressionUUID->"f272a78a-3527-4909-9307-e571d470517d"],
Cell[738, 27, 162, 2, 53, "Subtitle",ExpressionUUID->"c11d7683-a59a-463f-aaa3-8b4a1ac08cb0"],
Cell[CellGroupData[{
Cell[925, 33, 208, 4, 69, "Chapter",ExpressionUUID->"6d6a8535-3933-416f-888e-e9e7d5a0e0f9"],
Cell[CellGroupData[{
Cell[1158, 41, 176, 3, 67, "Section",ExpressionUUID->"3e7944ec-7790-481b-a8b9-1849c732b515"],
Cell[1337, 46, 201, 4, 30, "Input",ExpressionUUID->"1b662391-1775-44fa-8ee3-393994c5ded9"],
Cell[1541, 52, 252, 4, 30, "Input",ExpressionUUID->"51143473-4006-497d-a83b-810f3545f9ee"],
Cell[1796, 58, 228, 4, 30, "Input",ExpressionUUID->"0714816f-6263-45ed-b49f-20e200ded4cd"],
Cell[CellGroupData[{
Cell[2049, 66, 1288, 31, 136, "Input",ExpressionUUID->"dde05c3e-f587-472d-bbb3-1877dc0ed8c3"],
Cell[3340, 99, 1579, 64, 34, "Output",ExpressionUUID->"6126e1ec-ab12-4dbb-8f8c-bf696b77f0f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4956, 168, 313, 7, 30, "Input",ExpressionUUID->"167dbe41-3d3b-4a5e-8b15-1d7e83386306"],
Cell[5272, 177, 453, 7, 34, "Output",ExpressionUUID->"7a3f095e-5e08-4da7-8b26-99c776e9e5f7"]
}, Open  ]],
Cell[5740, 187, 1528, 41, 115, "Input",ExpressionUUID->"eb51fd26-0878-4ad2-a22f-7017bb49eeca"],
Cell[CellGroupData[{
Cell[7293, 232, 313, 7, 30, "Input",ExpressionUUID->"80f7f457-711f-4de1-bf06-ad203f381359"],
Cell[7609, 241, 642, 10, 34, "Output",ExpressionUUID->"afd0235f-a3f6-4c4e-bef2-6c9060cb9cdf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8288, 256, 374, 8, 30, "Input",ExpressionUUID->"6e4de983-fb9a-4b51-be6c-5f4cb4eb5531"],
Cell[8665, 266, 302, 5, 34, "Output",ExpressionUUID->"5805ac77-0256-4a12-9487-647e4640c1e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9004, 276, 302, 7, 30, "Input",ExpressionUUID->"c3509b2d-6017-43eb-8763-7a0c6cbf6226"],
Cell[9309, 285, 228, 4, 34, "Output",ExpressionUUID->"6b2557a1-5411-4465-a781-57f791278a60"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

