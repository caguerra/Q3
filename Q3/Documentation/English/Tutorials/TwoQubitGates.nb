(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    405238,      11167]
NotebookOptionsPosition[    354561,      10175]
NotebookOutlinePosition[    360674,      10317]
CellTagsIndexPosition[    360220,      10300]
WindowTitle->Two-Qubit Gates
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "890d3f58-900a-41ce-831a-d4247ed9cf63"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "be06508e-918b-4942-9790-62e31233e46c"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[Cell[BoxData[
     TagBox[
      ActionMenuBox[
       FrameBox[Cell[TextData[{
         "URL",
         " ",
         Cell[BoxData[
          GraphicsBox[
           {GrayLevel[0.66667], Thickness[0.13], 
            LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
           AspectRatio->1,
           AxesStyle->Large,
           FrameStyle->Large,
           ImageSize->20,
           PlotRange->{{-3, 4}, {-1, 1}},
           PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
          "096a1883-82ee-4ea3-9623-74d3f2282443"]
        }],ExpressionUUID->"7de12146-511a-40c2-ba0b-45f288eb8ebb"],
        StripOnInput->False], {"\<\"Q3/tutorial/TwoQubitGates\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/TwoQubitGates"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
TwoQubitGates.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$29712], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"] <> 
            "Q3/tutorial/TwoQubitGates" <> ".html"], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"],
      MouseAppearanceTag["LinkHand"]]],
     LineSpacing->{1.4, 0},ExpressionUUID->
     "d339b8c8-fbd5-4174-8e2b-23b98d374eb1"]], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "b9477593-14d9-44b7-a87e-019f1fac77a6"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1,ExpressionUUID->"f77de626-9f92-43ff-a6f0-d6bb9b97ce8f"],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "TechNoteTitle",
 CellID->1379112571,ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Controlled-NOT Gate (CNOT)"], 
      "paclet:Q3/tutorial/TwoQubitGates#1585062394", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Controlled-Unitary Gates"], 
      "paclet:Q3/tutorial/TwoQubitGates#1455445268", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Controlled-Z Gate (CZ)"], 
      "paclet:Q3/tutorial/TwoQubitGates#29167796", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["General Unitary Gates"], 
      "paclet:Q3/tutorial/TwoQubitGates#1476129218", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["SWAP Gate"], "paclet:Q3/tutorial/TwoQubitGates#1218939314", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"65a393e6-cee1-438b-b0b0-\
9e1d7fc568a9"],

Cell[TextData[{
 "See also Section 2.2 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "011d1bed-6ccc-4675-a186-9e146775ef49"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383"],

Cell[TextData[{
 "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4\[Times]4 unitary matrices. We \
will see that any two-qubit gate operations can be decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 ". A ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " acts a unitary operator on one qubit depending on the logical state of the \
other qubit. A controlled-unitary gate on two qubits can be further \
decomposed into factors including only the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " and single-qubit rotation gates. In this sense, the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " alone is sufficient for any two-qubit gate."
}], "TechNoteText",
 CellID->1465929903,ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c"],

Cell[TextData[{
 "The ",
 ButtonBox["controlled-unitary",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " and ",
 ButtonBox["CNOT gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " have various interesting properties that make them useful in implementing \
quantum algorithms. In this document, we first examine the basic properties \
of the CNOT gate, and in particular, how it is used to generate an \
entanglement between two qubits. Then, we discuss the properties of the ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " and describe how to implement a controlled-unitary gate in terms of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates#1113797362"],
 ". Finally, we discuss how an arbitrary two-qubit unitary operation can be \
decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 "."
}], "TechNoteText",
 CellID->1951481337,ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-NOT or CNOT gate", "TechNoteTableText",ExpressionUUID->
     "fd2154fb-d8e1-4837-800b-09a7ff1ebc5d"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:Q3/ref/CZ", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-Z or CZ gate", "TechNoteTableText",ExpressionUUID->
     "4bbf74e4-e4fb-4367-aa6f-1364552cd4cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["SWAP"]], "paclet:Q3/ref/SWAP", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The SWAP gate exchanging the states between two qubits", 
     "TechNoteTableText",ExpressionUUID->
     "309b92d2-10a9-4ceb-a3cb-d80c05cc177f"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledGate"]], "paclet:Q3/ref/ControlledGate", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-unitary gates", "TechNoteTableText",ExpressionUUID->
     "51fb4670-e668-485b-a64e-5a3fd7e559cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents two-level unitary transformation", "TechNoteTableText",
     ExpressionUUID->"abd02730-9c1c-412f-aeed-26c5964b494e"]},
   {
    TemplateBox[{
      Cell[
       TextData["FromTwoLevelU"]], "paclet:Q3/ref/FromTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrite a two-level unitary transformation in terms of the controlled-unitary \
and CNOT gates\
\>", "TechNoteTableText",ExpressionUUID->
     "c1fa8cb0-e32c-4e45-a2bf-734eb208424a"]}
  }]], "DefinitionBox",
 CellID->407539380,ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5"],

Cell["Two-qubit gates available in Q3.", "TechNoteCaption",
 CellID->1189009377,ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[210]:=",
 CellID->853967906,ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6"],

Cell[TextData[{
 "Throughout this documentation, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[211]:=",
 CellID->403330096,ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736"],

Cell[CellGroupData[{

Cell["Controlled-NOT Gate (CNOT)", "TechNoteSection",
 CellTags->"Section11",
 CellID->1585062394,ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458"],

Cell[TextData[{
 "The  controlled-NOT or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e620a8c8-0da2-4add-9e60-e9b95269af8c"],
 " gate is a quantum logic gate on two qubits that maps the logical basis \
states as"
}], "TechNoteText",
 CellID->609014923,ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CNOT", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        RowBox[{"c", "\[CirclePlus]", "t"}]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d65b82c4-da31-4b40-8e51-3f9ddd06ee1b"]
}], "TechNoteText",
 CellID->806749259,ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "9029aa68-1d83-41e2-8780-ffac38998045"],
 ", where the first qubit is typically called the ",
 StyleBox["control qubit",
  FontSlant->"Italic"],
 " (c) and the second qubit the ",
 StyleBox["target qubit",
  FontSlant->"Italic"],
 " (t)."
}], "TechNoteText",
 CellID->1970532502,ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[213]:=",
 CellID->246957080,ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"2"},
       "RowDefault"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[213]=",
 CellID->1152974404,ExpressionUUID->"fe2e115f-8f73-4d54-a16d-57c15fe1732c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[214]:=",
 CellID->149239284,ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXlsDe8ax6utapTm2hshdWNL2oilYguVK4pbRKgldv1F/Yili3LTBA3X
kvgDN4pIQ6K2iB8JSRFpomIpf9BSS5AQa1xNkItar/c+t29M5vf2nDnvzJkz
8870+0lIz5w58zzn+Z4zy+ny+etvuVMWRUdFRa2Mp/+mZP/jbwUF2UVZf6Eb
01asXPL7ipyFf19RmPN7TsGQ32Jo4R/07z/07/9fMwAAAAAANejQoYPbLbhP
bm7ujh073O4iAEiHWUoHcyO2b9/et29ft7sIANJhltLB3IjHjx/T1TT973Yj
IkiHWUoHc+PQ3mDbtm1udyGCdDhm08HcOMXFxenp6W53IYJ0OGbTCTm32tra
1atX0zZTU1MXLFhw8ODB8BoMjfMViZqampiYmLq6OgdqyYN0OGbTMZ7bmTNn
WrVqFfVnsrOzv337ZkezSlTU6Nat2759+yJdxRRIR8NUOgZze/ToEb1BqO2J
EydWV1e/fPmypKQkNjaWlhQVFdnUrMsV9eTl5VHdSFcxBdLRMJWOwdyWLVtG
DY8YMUL/Tty/fz8tbNOmzcePH8NtVIGKeiorK+Pj4yNdxRRIR8NUOsHm9unT
p4SEBGr4xIkT+uXfv39PSkqi5aWlpTb06mpFgR8/frRv316o7i5IR8NUOsHm
dvfuXWq1ZcuWjU+Zli5dSnfl5uaG26jbFRtDp4hz5syxZVP379/ftGlTmBtB
Onrk0wk2t/Pnz1OrPXr0YA1vk7Vr186aNevOnTt0c+vWrXRXVlaWjQ27UrEx
p06dooMp7X/C3xQ/Yubn54ezEaSjRz6dYHPj50vDhw+nr8vLy/nV7qRJk+hm
WVkZfT1kyBDhIe/evaOLiLdv31rr2fmKjamvr6fjbEVFhS1bO3fuXIsWLQoK
CixvAenokU8n2Nz27NlDrY4aNYo1fJ7Dn8WECRPo5rFjx+jrfv36aSvT1XFG
Rob2UQ+9o2kdsz07XzEgU6ZMocsiWzbFGp4IvbALCwutPRzpCEimE2xutLen
fvr06cN+HXHmz5/Pjzg7d+6ku8aPH8/X/PLlS8+ePZs1azZ79uy9e/du2LCh
V69etEJVVZWphp2vGBDa83Tp0kVy5f9KcPr06ebNm69atcpCM0hHQDKdYHO7
ceMGdRLw3jVr1tBdixYt4jevXr2qf1Ks4Xr56NGjZht2vmJAnjx5EiX3szS3
bt2KMsPJkyfNNoN0BCTTCTa3uro6ervRFmpqaoS7Bg0aRMs3b97Mb/LjUfhH
becrBoTmn5SU9PPnz5Br0mXLQwlog9Qt7bhov222GaQjIJmOwef848aNa9ze
7du3aWF0dLT2fqHLgXbt2tFTzsvLe/bsWcBN0YXD4cOHZ8yYQadnBs3YVZF2
LMuXL09LS0tJSaGijYMwgNbXdjvhc/PmzbZt286cOZOO2hYejnQEJNMxmNvZ
s2ep4ZiYmEOHDvElr1696t27Ny2cPHmyfs0rV64kJyfzlbOysi5fvqy/d8uW
LfxtTuTk5Bg0Y0tFOpeLi4uj19L06dNpdLQOndbSqyvkKIivX78mJibS3kZm
5ZBUV1fzNqy9pBnS+TPy6RjMjfbz8+bNo7r0rKmBzMxM2ibd7Nq164MHDxpX
PHDgwMCBA/l86D1FS/hd165do50A/1TTeG62VFy3bl16err2gRKdzdK906ZN
CzkK1vBZXOvWrel6R2ZlY+ism3ZZU6dODefTb6SjRz4d458KoydCV7v0zuK9
xcbGjhw58sWLFwYPuXTpUv/+/fUnWpw3b96EnJtdFfX7Rjqb7dixY2pqqnFd
zuLFiyUnHBK6aMrOzg7zGzpIR498OjI/l07P5d69e1VVVXQxK7NNepr0LMaM
GaNfKDk3GytyaBeRkJBAOxaZop07d6YzTJmKzoB09EXl0wn/ty0qKysLCwvr
6+u1JfywMnfuXP1qpuZmS0VOSUkJ3UWncyE3e/36dTrHo0un8Du0C6SjYSqd
8OdGp0zUWPfu3VeuXLlr1y6aDG2Tjk106NGvZuPcJCuyht+hiI+PHzZsmMyn
akVFRaNHjw6/PRtBOhqm0gl/bnRo2L17N10LR0dH89Mt+rq8vFxYzca5SVas
ra2lcza6lnn69KnMZlNSUmjXEX57NoJ0NEylY+Pve3748KG6ujrYL5fZODeZ
irQfoKfWqVOnxpfnAXn48CG19/z5cxvbCx+kwzGbjmO/xRyJuQWjoqIiMTEx
OTlZcmis4ccp09LSItqVBZAOx2w6kZ4bvcv+1cD69etpbkOHDuU3L1y4EKGK
R44ciYuLo1r5+fkbN2785y8uXrxo8Cg6u6N1ItSSZZAOx2w6kZ7b8ePHowKx
cOHCCFUcPHhwwIrFxcXBHvL69Ws6CaQzvQi1ZBmkwyylg7+jQpSWltI1u9td
BADpMEvpYG6s4cMoyz/YH1GQDrOUDuamMkjHGpibyiAda2BuKoN0AAAAAAAA
AAAAAAAAAAAAAAAgcuB7sgwec7WBx9wa8JirDDzm1oDHXGXgMbcMPOYqA4+5
NeAxVxkfeMyJz58/l5WVLVmyxLGLOHjM5VE/HdVM2fv378/IyOB/QpYYMGBA
hAo1Bh7zkHglHaVM2URmZqY+IyfnBo95SLySjlKmbOL9+/f/boA7dJycGzzm
IfFKOuqYsgXomtfhucFjLo/i6ahjyhZwfm4MHnNpFE9HHVO2gCtzg8dcEsXT
UceULSAzN3jMGdIJhDqmbAHjubluypbENx5zAcXTUceULWAwNxVM2Zym4zEX
UDwddUzZAgZzU8GUzZqYx1xA8XTUMWULGMxNBVM2a2IecwHF01HKlK3HYG4q
mLIl8ZPHXI/i6ShlytZjfD3iuilbBp95zPUono5Spmy6wu34C+3ndrQlY8eO
lakIjznSUcqUzc8Jg6H/tMq4IjzmwWgi6ahpyjYLPOZIRw9M2RrwmPsmHZiy
NeAx9006MGVrwGPum3RgyubAY+6ndGDK5sBj7qd0YMrmwGPup3RgymbwmPsu
HfwdFQaPudrAY24NeMxVBh5zn4F0rIG5qQzSsQbmpjJIBwAAAAAAAAAAAAAA
AAAAAAAAIge+J8vgMVcbeMytAY+5ysBjbg14zFUGHnPLwGOuMvCYWwMec5Wx
3WPOHPdWu+Lm9qjHnLlhFfe6x9x5b7Xzbm4Nz3nMnU/HBx5z5ri32hU3t4a3
PObMDau4DzzmzHFvtStubg1vecyZG1Zxr3vMBRxwobru5vaQx1zAeVOtRz3m
Ag48C9fd3Mw7HnOBpvCqZnZ4zAUceBauu7mZdzzmAk3kVR2+x1zAAW+1625u
5h2PuYDzVnGPeswFHPBWu+7m5njCYy7gvFXcox5zAQe81a67uTme8JgLOG8V
96jHXMABb7Xrbm6OJzzmAs5bxT3qMRdwwFvtupub4wmPuYDzVnHvesz1hOOt
ZtKmbLvc3E3BY67HmXTsquiux1yPZW81M2PKtsXN3UQ85nqcSceWiq57zG3x
VjMzpmxb3NxNxGPufDr+8Jjb5a3mSFqibHFzNwWPufPp+MxjbpbwTdm2uLk5
vveYmwUecxmapinbGZCOBjzmGvCYN810YMrWgMfcN+nAlM2Bx9xP6cCUzYHH
3E/pwJTNgcfcT+nAlM3gMfddOvg7Kgwec7WBx9wa8JirDDzmPgPpWANzUxmk
Yw3MTWWQDgAAAAAAAAAAAAAAAAAAAAAARA58T5bBY6428JhbAx5zlYHH3Brw
mKsMPOaWgcdcZeAxtwY85irjA4+5KxXhMZfEE5Z5mLI14DEPiVcs8zBla8Bj
boyHLPMwZWvAY26MhyzzsK9qwGNugLcs8+rMzfWKDB7z4HjLMq/O3FyvyOAx
D463LPMwZeuBxzwY3rLMw5QtAI95QLxlmYcpWwAe84B4yzIPU7YAPOYB8ZZl
HqZsAXjMA+ItyzxM2QLwmAfDQ5Z5mLL1wGNuUMVDlnmYsvXAY27QjIcs8zBl
64HH3Lgfr1jmYcrWgMfcN5Z5mLI14DH3TTowZWvAY+6bdGDK1oDH3DfpwJTN
gcfcT+nAlM2Bx9xP6cCUzYHH3E/pwJTN4DH3XTr4OyoMHnO1gcfcGvCYqww8
5j4D6VgDc1MZpGMNzE1lkA4AAAAAgIL8DyKGbVw=
    "], {{0, 86.}, {121., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{121., 86.},
  PlotRange->{{0, 121.}, {0, 86.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[216]//TableForm=",
 CellID->530374917,ExpressionUUID->"053a4a87-ff4a-424b-a209-3f11b1fe452c"]
}, Open  ]],

Cell["\<\
It has the following matrix representation in the logical basis\
\>", "TechNoteText",
 CellID->690265281,ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[217]:=",
 CellID->581916673,ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[218]//MatrixForm=",
 CellID->1139072542,ExpressionUUID->"76bc7b3d-6509-4b7d-a764-7aab206090f3"]
}, Open  ]],

Cell["\<\
and is expressed in terms of the Pauli operators on the control and target \
qubit as\
\>", "TechNoteText",
 CellID->107481873,ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "op", "]"}]], "Input",
 CellLabel->"In[219]:=",
 CellID->414092384,ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]], "2"]}]], "Output",
 CellLabel->"Out[219]=",
 CellID->1648780965,ExpressionUUID->"3d2b8ae7-65a3-40ff-9e72-5bfd6b0a9926"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "op", "]"}], "//", "PauliForm"}]], "Input",
 CellLabel->"In[220]:=",
 CellID->597624604,ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"],
   Rational[1, 2]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}],
    $CellContext`S[2, 1]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 3]], "2"], "-", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]], "2"]}]], "Output",
 CellLabel->"Out[220]=",
 CellID->1762698537,ExpressionUUID->"e826762f-96cf-47ec-a302-0afd6de2df43"]
}, Open  ]],

Cell["\<\
In quantum circuit model, it is represented as the following circuit element\
\>", "TechNoteText",
 CellID->1181321350,ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[221]:=",
 CellID->981612935,ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[221]=",
 CellID->1626835991,ExpressionUUID->"cc02625d-5031-401b-a16b-23f9257752d4"]
}, Open  ]],

Cell["\<\
where the smaller filled circle indicates the dependence on the state of the \
control qubit and the circled-plus sign denotes the conditional NOT action on \
the target qubit.\
\>", "TechNoteText",
 CellID->606925297,ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39"],

Cell[TextData[{
 "A simple yet important feature of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5880ef7f-73b8-4ab6-82cc-87dc0d31f1eb"],
 " is to copy the logical state of the control qubit to the target bit \
provided that the target bit is initially set to |0\:27e9; or the reversed \
state when the target qubit is in |1\:27e9. A vital implication is that CNOT \
generates an entangled state when the control qubit is in a superposition:"
}], "TechNoteText",
 CellID->46143429,ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "->", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"in", "->", "out"}], "//", "LogicalForm"}], "//", "KetFactor"}], "//",
   "LogicalForm"}]}], "Input",
 CellLabel->"In[222]:=",
 CellID->291014636,ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 0|>]]}],
    HoldForm],
   Q3`OTimes[$CellContext`c[0] 
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>]]], "\[Rule]", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
   "+", 
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1|>]]}]}]}]], "Output",
 CellLabel->"Out[224]=",
 CellID->983209819,ExpressionUUID->"9a84de5d-cf2e-446e-8144-2eed26757756"]
}, Open  ]],

Cell[TextData[{
 "Applying a single qubit rotation such the Hadamard gate on the control \
qubit prior to CNOT, one can thus generate entangled states from logical \
states. In this sense, such a circuit is called a ",
 StyleBox["quantum entangler circuit",
  FontSlant->"Italic"],
 ".  In general, the different product states in the logical basis are \
transformed to different ",
 StyleBox[ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/BellState"],
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->1152615977,ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "op"}], "]"}]}]], "Input",
 CellLabel->"In[225]:=",
 CellID->1714229499,ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[225]=",
 CellID->1173409259,ExpressionUUID->"64b683a6-e817-482f-9509-75c983b7eb8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[226]:=",
 CellID->1435008719,ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[228]//TableForm=",
 CellID->541551460,ExpressionUUID->"9d756645-9e9d-4276-ad94-ab8bda04194e"]
}, Open  ]],

Cell[TextData[{
 "One can further generalize the above procedure to generate maximally \
entangled states between larger systems: Consider two quantum registers, each \
consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "af6575a1-43d0-4455-97df-db7ec963065c"],
 " qubits. We respectively call them the \[OpenCurlyQuote]control\
\[CloseCurlyQuote] and \[OpenCurlyQuote]target\[CloseCurlyQuote] register for \
the reason that will be clear below. Upon applying the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "901a47ec-7470-4146-b686-042c18f982bb"],
 " gate on each pair of the corresponding qubits in the two registers as in \
the quantum circuit,"
}], "TechNoteText",
 CellID->1854176847,ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"2", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{"CNOT", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[229]:=",
 CellID->1015065912,ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}, {{0, -6}, {4, -6}}, {{0, -7}, {4, -7}}}], {
     LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -7}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[232]=",
 CellID->1843607700,ExpressionUUID->"7517601d-7b97-4b4f-9c1f-37b88bb78cac"]
}, Open  ]],

Cell["the logical basis states are transformed as", "TechNoteText",
 CellID->1898388060,ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       RowBox[{"c", "\[CirclePlus]", "t"}]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "d41dd958-8763-4d29-b6bc-67bf58980937"],
 " ."
}], "TechNoteText",
 CellID->1043580941,ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775"],

Cell[TextData[{
 "The above association rule is formally the same as the one in (2.29) for a \
single pair of qubits. Here, however, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"c"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["c", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "18193fb8-fe63-46e6-9adb-b49b66691c9d"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"t"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["t", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "383ed95f-2d83-49c9-ab80-3650c110e70c"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[CirclePlus]", " ", "t"}], TraditionalForm]],
  ExpressionUUID->"30dfbfdc-abc1-4a43-91e4-a024c634e3b0"],
 " denotes the bit-wise exclusive OR (or XOR),"
}], "TechNoteText",
 CellID->965930338,ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "\[CirclePlus]", "t"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["t", "1"]}], ",", 
      RowBox[{
       SubscriptBox["c", "2"], "\[CirclePlus]", 
       SubscriptBox["t", "2"]}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["c", "n"], "\[CirclePlus]", 
       SubscriptBox["t", "n"]}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "9e89c491-b7a9-4bcf-a5bc-3c8c03b067f7"],
 " ,"
}], "TechNoteText",
 CellID->1562303093,ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98"],

Cell[TextData[{
 "for the n-bit strings ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", 
      SubscriptBox["c", "2"], ",", "...", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "91a8d8cd-fe5c-488a-9717-c0bf12b93c97"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["t", "1"], ",", 
      SubscriptBox["t", "2"], ",", "...", ",", 
      SubscriptBox["t", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1fef8f88-4c88-4714-b329-9a1d4305b835"],
 ". When the target register is prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "391653d4-d933-4e3c-bfda-d4c2b5266109"],
 ", the logical basis state of the control register is copied to the target \
register,"
}], "TechNoteText",
 CellID->345532182,ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "4192506e-ca86-4264-86b6-2c76afde6035"]
}], "TechNoteText",
 CellID->563601386,ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547"],

Cell[TextData[{
 "under the set of CNOT gates on paired qubits. More interestingly, when the \
control register is prepared in a superposition, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "7621ce2f-1c13-42ff-8aaa-50dbcc2924dd"],
 ", and the target register x=0 is in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "709dc516-26c0-43cb-8ffe-0b30b3555103"],
 ", the CNOT gate makes a copy of each logical state of the control register \
to the target register, leading to a maximally entangled state,"
}], "TechNoteText",
 CellID->2045611232,ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"n", "/", "2"}]]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"x", "=", "0"}], 
          RowBox[{
           SuperscriptBox["2", "n"], "-", "1"}]], 
         TemplateBox[{"x"},
          "Ket"]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], "\[RightTeeArrow]", 
     TemplateBox[{"\[CapitalPhi]"},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3c877f12-3f98-4a5b-a91c-f841483a1dff"]
}], "TechNoteText",
 CellID->1522271401,ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe"],

Cell[TextData[{
 "between the two registers (rather than single qubits). Since the \
superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "1a3df944-a9d2-4c37-90ff-bc9e60e7f1ab"],
 " is obtained just by the ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/Hadamard"],
 ", the maximally entangled state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3a3d096e-4106-4349-bb5a-6c3a2214bc3f"],
 " can be generated from the logical state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "cb7d677d-5c29-463c-af58-230e5263bea6"],
 " through the following quantum circuit."
}], "TechNoteText",
 CellID->1842749896,ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qce", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[233]:=",
 CellID->88345038,ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -5}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
         2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -7}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[233]=",
 CellID->1846523718,ExpressionUUID->"cb1c8806-e8a0-4cd2-8a70-8ef8191ac699"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qce", "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[234]:=",
 CellID->1915435092,ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<||>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[3, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
      1, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[235]=",
 CellID->117912760,ExpressionUUID->"cda4f566-70fc-42fb-b312-1185e11e39e4"]
}, Open  ]],

Cell["\<\
It is also interesting to note that even though |\[CapitalPhi]\:27e9 is a \
maximally entangled state between the control and target registers, it is a \
product state of n maximally entangled pairs\
\>", "TechNoteText",
 CellID->716147443,ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "38a75842-a8e5-4adf-850b-3ff2f0bcef8e"],
 " ."
}], "TechNoteText",
 CellID->1791716713,ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182"],

Cell["\<\
The entanglement strongly depends on how you partition the system.\
\>", "TechNoteText",
 CellID->1367097157,ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b"],

Cell["\<\
Another generalization of copying logical basis states to a series of qubits \
by consecutively applying CNOT gates with a single control qubit on multiple \
target qubits is shown in the following quantum circuit,\
\>", "TechNoteText",
 CellID->874378446,ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "List"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[236]:=",
 CellID->447945501,ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -4}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[240]=",
 CellID->1832243388,ExpressionUUID->"f9a97108-2ef5-4ce9-8bdb-d1e6bbb9c183"]
}, Open  ]],

Cell["or equivalently,", "TechNoteText",
 CellID->880946029,ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"CNOT", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[241]:=",
 CellID->1307646985,ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[244]=",
 CellID->185321968,ExpressionUUID->"1729fab3-f1c9-42d6-9e91-05b91e4e38a6"]
}, Open  ]],

Cell["\<\
When the target qubits are all prepared in the logical basis state |0\:27e9, \
the series of CNOT gates makes the transformation\
\>", "TechNoteText",
 CellID->169608441,ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "e54c9567-fcf6-4bb6-aa51-ad46d78abac5"]
}], "TechNoteText",
 CellID->898268318,ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1"}], TraditionalForm]],ExpressionUUID->
  "180a4472-59f2-40f1-bee7-baf558860f8d"],
 ". Therefore, a simple application of the Hadamard gate in the control qubit \
before the CNOT gates, "
}], "TechNoteText",
 CellID->385582216,ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}}], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{3, -1}, {3, -3}}], 
      DiskBox[{3, -1}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
       LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
          3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
      LineBox[{{4, -1}, {4, -4}}], 
      DiskBox[{4, -1}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
       LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
          4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->226.79999999999998`,
    PlotRangePadding->Scaled[0.025]], ","}]}]], "TechNoteText",
 CellID->1620101282,ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc"],

Cell["can generate a state of the form", "TechNoteText",
 CellID->712578174,ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"GHZ"},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"]}]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "0ba762a6-c203-49b1-a60e-a6e8325930d1"],
 " ."
}], "TechNoteText",
 CellID->1522141313,ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621"],

Cell["\<\
The above state, which is known as the Greenberger-Horne-Zeilinger (GHZ) \
state (Greenberger et al., 1989), exhibits a quantum entanglement of more \
than two particles. It has stimulated tests of non-locality of quantum \
mechanics beyond Bell inequalities (Bouwmeester et al., 1999; Pan et al., \
2000).\
\>", "TechNoteText",
 CellID->1803844527,ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929"],

Cell[TextData[{
 "Quantum entanglement is a valuable resource in quantum information \
processing and in quantum communication. The most popular example of such is ",
 ButtonBox["quantum teleportation",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"],
 "."
}], "TechNoteText",
 CellID->1188320590,ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed"],

Cell["\<\
In the above consideration, CNOT gates with the same control qubit are \
applied on different target qubits. The opposite setting brings forth \
additional applications of CNOT as illustrated in the following quantum \
circuit.\
\>", "TechNoteText",
 CellID->506239030,ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, InsetBox[
     StyleBox[
      TemplateBox[{
        RowBox[{
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, Rational[1, 2]}]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->1226753413,ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3"],

Cell["\<\
 In this quantum circuit, the successive application of the CNOT gates on the \
same target qubit with different control qubits results in the accumulation \
of the logical bit values of all qubits. The same goal may be achieved by \
applying the CNOT gates on the consecutive pairs of qubits as\
\>", "TechNoteText",
 CellID->365203462,ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -3}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->977674470,ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38"],

Cell[TextData[{
 "In this case, not only the last qubit but also the qubits in the middle are \
modified. However, this makes little difference since the quantum circuit \
block is mostly used to conditionally control the operation of an unitary \
gate on a different qubit and the whole block must be undone anyway (see, for \
example, the ",
 ButtonBox["quantum circuit of conditional unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1379525988"],
 ")."
}], "TechNoteText",
 CellID->833871357,ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Z Gate (CZ)", "TechNoteSection",
 CellTags->"Section12",
 CellID->29167796,ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[245]:=",
 CellID->754200946,ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[246]:=",
 CellID->1406814828,ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b"],

Cell["\<\
An interesting variant of CNOT gates is the so-called controlled-Z or CZ \
gate. This is a quantum logic gate on two qubits that maps the logical basis \
states as\
\>", "TechNoteText",
 CellID->596875856,ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CZ", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"t"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"c", " ", "t"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "1ea385c0-0dbd-4923-90b1-9729933fa242"]
}], "TechNoteText",
 CellID->796396655,ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "a224194f-7edc-4912-ab58-d4d4eb23fe22"],
 "."
}], "TechNoteText",
 CellID->1920492481,ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[248]:=",
 CellID->1037913757,ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`S[1, Q3`$]], "}"}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"2"},
       "RowDefault"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[248]=",
 CellID->145705421,ExpressionUUID->"9e032700-e1f3-4bcc-bc58-f9345f5572f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[249]:=",
 CellID->1887946780,ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]], 
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]], 
               $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[251]//TableForm=",
 CellID->1336050652,ExpressionUUID->"d23eb902-f700-4114-a599-c86d67b1d71b"]
}, Open  ]],

Cell["\<\
The matrix representation of the CZ gate in the logical basis is given by\
\>", "TechNoteText",
 CellID->1230965299,ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[252]:=",
 CellID->2123808742,ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellLabel->"Out[252]//MatrixForm=",
 CellID->1974100761,ExpressionUUID->"db23aa5a-646a-4422-858d-c2499a5e5a75"]
}, Open  ]],

Cell["\<\
Since it is symmetric for the two qubits, a distinction of the control and \
target qubit is meaningless. Accordingly, in quantum circuit model, the gate \
is depicted by the following quantum circuit element\
\>", "TechNoteText",
 CellID->776960470,ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[253]:=",
 CellID->1674045530,ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CZ[{
     $CellContext`S[1, Q3`$]}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[253]=",
 CellID->38252119,ExpressionUUID->"d9f3c2bc-6fb3-4a5d-b8b3-8d3f6a04c05a"]
}, Open  ]],

Cell["\<\
The filled circles on both qubit lines (rather than a square box on either \
qubit) indicate that the bit values of both qubits remain unchanged.\
\>", "TechNoteText",
 CellID->573709808,ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f"],

Cell[TextData[{
 "Noting the identity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", " ", "Z", " ", "H"}], "=", "X"}], TraditionalForm]],
  ExpressionUUID->"7a83536f-3ac5-4c9f-bee5-cbbd8e9da49f"],
 ", one can regard that the CZ gate is equal to the CNOT gate up to the \
Hadamard gate on the target qubit. The relation between the CNOT and CZ gate \
is illustrated in the following quantum circuits"
}], "TechNoteText",
 CellID->139168026,ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}]}], "]"}]}]}], "Input",\

 CellLabel->"In[254]:=",
 CellID->387321399,ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[254]=",
 CellID->1354589583,ExpressionUUID->"bb49bb7c-9692-4456-a57e-515c52f25113"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[2, 6], 
   Q3`CZ[{
     $CellContext`S[1, Q3`$]}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[2, 6]]]], "Output",
 CellLabel->"Out[255]=",
 CellID->1112979634,ExpressionUUID->"2b03427d-61b2-4d9a-8629-0db1f8a7624b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
       2.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
       2.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}, 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}]]], "Output",
 CellLabel->"Out[256]=",
 CellID->1266143268,ExpressionUUID->"108ca4ff-d1cd-42f8-9e61-04b8114e4de8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnot", "==", "cz1", "==", "cz2"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[257]:=",
 CellID->1606586072,ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[257]=",
 CellID->129656043,ExpressionUUID->"00a959e2-af00-4ebd-9061-074027732ba5"]
}, Open  ]],

Cell["\<\
Depending on the Hamiltonian of a particular physical system, direct \
realization of the CNOT gate may be considerably difficult while the CZ gate \
is relatively easier to implement. In such a case, the above identity offers \
a straightforward workaround for a physical implementation of the CNOT gate.\
\>", "TechNoteText",
 CellID->799932562,ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SWAP Gate", "TechNoteSection",
 CellTags->"Section13",
 CellID->1218939314,ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[258]:=",
 CellID->1843914595,ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[259]:=",
 CellID->336088308,ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5"],

Cell[TextData[{
 "Another interesting two-qubit gate is the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:Q3/ref/SWAP", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1a92bc4f-5431-495f-93a4-bf7492e7da3f"],
 " gate that \[OpenCurlyQuote]swaps\[CloseCurlyQuote] the states of the two \
qubits and maps the logical basis states as"
}], "TechNoteText",
 CellID->1866541665,ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"SWAP", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "70e7957f-f62a-492d-b2fd-298b150e232a"]
}], "TechNoteText",
 CellID->524648279,ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e"],

Cell[BoxData[
 RowBox[{"for", " ", 
  RowBox[{Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Element]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
    "ff8569d5-2c51-4925-acc6-cd64fc41399b"]],ExpressionUUID->
    "9a7b9477-6dc2-4a42-bce9-11aaf19a2ff3"], "."}]}]], "TechNoteText",
 CellID->195770571,ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[261]:=",
 CellID->371039593,ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXlsDe8ax6utapTm2hshdWNL2oilYguVK4pbRKgldv0FP2Lpotw0QcO1
JP7AjSLSkKgt4kdCUkQkiKX8QWsPEmKNqwlyUev13uf2jcn83p4zZ2bOzLzv
TL+fhPTMmTPPc57vnDkzp8vnr7/lTZgfGxMTsyyR/puQ+4+/FRbmFuf8hW5M
Wrps4e9L5839+9Kieb/PKxzwWxwt/IP+/Yf+/f9rBgAAAACgBm3atJHdgnzy
8vK2bt0qu4sQIB1mKx3MjdiyZUvPnj1ldxECpMNspYO5EY8fP6arafpfdiMi
SIfZSgdz49DRYPPmzbK7EEE6HKvpYG6ckpKSzMxM2V2IIB2O1XQizu327dsr
Vqygbaanp8+ZM2ffvn3RNRgZ7ysS1dXVcXFxNTU1HtQyD9LhWE3HeG4nT55s
1qxZzJ/Jzc399u2bE80qUVGjU6dOu3fvdruKJZCOhqV0DOb26NEjeoFQ22PH
jq2qqnr58mVpaWl8fDwtKS4udqhZyRX15OfnU123q1gC6WhYSsdgbosXL6aG
hwwZon8l7tmzhxa2aNHi48eP0TaqQEU958+fT0xMdLuKJZCOhqV0ws3t06dP
SUlJ1PDRo0f1y79//56SkkLLy8rKHOhVakWBHz9+tG7dWqguF6SjYSmdcHO7
e/cutdq0adP6p0yLFi2iu/Ly8qJtVHbF+tAp4owZMxzZ1P3799evXx/lRpCO
HvPphJvbmTNnqNUuXbqwupfJqlWrpk2bdufOHbq5adMmuisnJ8fBhqVUrM/x
48fpzZSOP9Fvir9jFhQURLMRpKPHfDrh5sbPlwYPHkxfV1RU8KvdcePG0c3y
8nL6esCAAcJD3r17RxcRb9++tdez9xXrU1tbS++zZ8+edWRrp0+fbtKkSWFh
oe0tIB095tMJN7edO3dSq8OGDWN1n+fwZzFmzBi6efjwYfq6V69e2sp0dZyV
laV91EOvaFrHas/eVwzJhAkT6LLIkU2xuidCO3ZRUZG9hyMdAZPphJsbHe2p
nx49erBf7zizZ8/m7zjbtm2ju0aPHs3X/PLlS9euXRs1ajR9+vRdu3atXbu2
W7dutEJlZaWlhr2vGBI68nTo0MHkyv81wYkTJxo3brx8+XIbzSAdAZPphJvb
9evXqZOQ965cuZLumj9/Pr955coV/ZNiddfLhw4dstqw9xVD8uTJkxhzP0tz
8+bNGCscO3bMajNIR8BkOuHmVlNTQy832kJ1dbVwV79+/Wj5hg0b+E3+fhT9
u7b3FUNC809JSfn582fENemy5aEJaIPULR246LhttRmkI2AyHYPP+UeNGlW/
vVu3btHC2NhY7fVClwOtWrWip5yfn//s2bOQm6ILhwMHDkyZMoVOzwyacaoi
HViWLFmSkZGRlpZGResHYQCtrx12oufGjRstW7acOnUqvWvbeDjSETCZjsHc
Tp06RQ3HxcXt37+fL3n16lX37t1p4fjx4/VrXr58OTU1la+ck5Nz6dIl/b0b
N27kL3Ni3rx5Bs04UpHO5RISEmhfmjx5Mo2O1qHTWtq7Io6C+Pr1a3JyMh1t
zKwckaqqKt6GvV2aIZ0/Yz4dg7nRcX7WrFlUl541NZCdnU3bpJsdO3Z88OBB
/Yp79+7t27cvnw+9pmgJv+vq1at0EOCfahrPzZGKq1evzszM1D5QorNZunfS
pEkRR8HqPotr3rw5Xe+YWdkYOuumQ9bEiROj+fQb6egxn47xT4XRE6GrXXpl
8d7i4+OHDh364sULg4dcvHixd+/e+hMtzps3byLOzamK+mMjnc22bds2PT3d
uC5nwYIFJiccEbpoys3NjfIbOkhHj/l0zPxcOj2Xe/fuVVZW0sWsmW3S06Rn
MWLECP1Ck3NzsCKHDhFJSUl0YDFTtH379nSGaaaiNyAdfVHz6UT/2xbnz58v
Kiqqra3VlvC3lZkzZ+pXszQ3RypySktL6S46nYu42WvXrtE5Hl06Rd+hUyAd
DUvpRD83OmWixjp37rxs2bLt27fTZGib9N5Ebz361Rycm8mKrO53KBITEwcN
GmTmU7Xi4uLhw4dH356DIB0NS+lEPzd6a9ixYwddC8fGxvLTLfq6oqJCWM3B
uZmsePv2bTpno2uZp0+fmtlsWloaHTqib89BkI6GpXQc/H3PDx8+VFVVhfvl
MgfnZqYiHQfoqbVr167+5XlIHj58SO09f/7cwfaiB+lwrKbj2W8xuzG3cJw9
ezY5OTk1NdXk0Fjdj1NmZGS42pUNkA7Hajpuz41eZf+qY82aNTS3gQMH8pvn
zp1zqeLBgwcTEhKoVkFBwbp16/75iwsXLhg8is7uaB2XWrIN0uFYTcftuR05
ciQmFHPnznWpYv/+/UNWLCkpCfeQ169f00kgnem51JJtkA6zlQ7+jgpRVlZG
1+yyuwgB0mG20sHcWN2HUbZ/sN9VkA6zlQ7mpjJIxx6Ym8ogHXtgbiqDdAAA
AAAAAAAAAAAAAAAAAAAAwD3wPVkGj7nawGNuD3jMVQYec3vAY64y8JjbBh5z
lYHH3B7wmKtMADzmxOfPn8vLyxcuXOjZRZxPPebM81nBY26DPXv2ZGVl8T8h
S/Tp08elQvXxncfc+1nBY26P7Oxs/cS83Kv95TFnns8KHnPbvH///t91cIeO
l3u1vzzmzPNZwWMePXTN6/Fe7SOPuYAHs5K+P/jUYy7g/V7N/OMxF/BgVtL3
B+ZPj7mAlL3aLx5zAQ9mJX1/YP70mAuYSarBeswFPJiV9P2B+dNjLmCclHRT
tklc8pgLeDAr6fsDx3cecwGDpFQwZXNkecwFPJiV9P2B4zuPuYBBUiqYsplU
j7mAB7OSvj9wfOcxFzBISgVTNpPqMRfwYFbS9weOHz3megySUsGUbRL3POZ6
opkVg8fcZVO2HuMrIOmmbDO46jHXY3tWDB5z903ZdIXb9hfaT9FoS0aOHGmm
YgPxmDsyKwaPufumbH6GFg79Z0fGFRuCx9ypWXHgMY9I9KZsqzRkj7lV4DE3
Q8M0ZXsD0tGAx1wDHvOGmQ5M2RrwmAcmHZiyOfCYBykdmLI58JgHKR2Ysjnw
mAcpHZiyGTzmgUsHf0eFwWOuNvCY2wMec5WBxzxgIB17YG4qg3TsgbmpDNIB
AAAAAAAAAAAAAAAAAAAAAAD3wPdkGTzmagOPuT3gMVcZeMztAY+5ysBjbht4
zFUGHnN7wGOuMo57zBlM2fKAZZ7jrMccpmy5wDKv4ZTHnMGULRtY5jWc8pgz
mLJlA8u8hiMecwGYsqUAy7yGIx5zAZiyreKqx1z6rBS3zKuzV/vLlB0RVz3m
0meluGUepmw9fvGYS5+V4pZ5mLIFfOExlz4rxS3zMGUL+MJjLn1WilvmYcoW
8IXHXPqsFLfMw5Qt4AuPufRZKW6ZhylbwC8ec1jmDYApW4+PPOawzBsAU7Ye
H3nMYZk3AKZsPT7ymDNY5sMDU7a+qB895rDM1wembA14zAOTDkzZGvCYByYd
mLI14DEPTDowZXPgMQ9SOjBlc+AxD1I6MGVz4DEPUjowZTN4zAOXDv6OCoPH
XG3gMbcHPOYqA495wEA69sDcVAbp2ANzUxmkAwAAAAAAAAAAAAAAAAAAAAAA
7oHvyTJ4zNUGHnN7wGOuMvCY2wMec5WBx9w28JirDDzm9oDHXGUC4DGXUtGn
HnOGdEKhmsfcL6Zsb0A6Gv71mEupqOEvjzlDOuFRymMupaKGvzzmDOmERx03
rvSKPvKYCyAdAcxNj1885gJIRwBz0+MXj7kA0hFQx2MuvSLzj8dcAOkIqOMx
l16R4wuPuQDSEVDHYy69IscXHnMBpCOgjsdcekWOLzzmAkhHQB2PufSKHF94
zAWQjoBSHnOnKjYEj7kepCOglMfckYoNxGOuB+kIKOUx95EpOyJue8yRjgFK
ecx9ZMqOiNsec6RjgJoec0cqcgLvMbdKQ0gHpmwNeMwDkw5M2RrwmAcmHZiy
NeAxD0w6MGVz4DEPUjowZXPgMQ9SOjBlc+AxD1I6MGUzeMwDlw7+jgqDx1xt
4DG3BzzmKgOPecBAOvbA3FQG6dgDc1MZpAMAAAAAoCD/A8/RbVw=
    "], {{0, 86.}, {121., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{121., 86.},
  PlotRange->{{0, 121.}, {0, 86.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[264]//TableForm=",
 CellID->1954094969,ExpressionUUID->"6f60ca83-a134-4625-8cd2-58a3e2e0b2f1"]
}, Open  ]],

Cell[TextData[{
 "Given that the states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e1a70f29-c7a7-4611-be34-d93daa35de1b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"1"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e28214a6-d024-4028-b68a-dabbdac76c95"],
 " are not altered by the operation, the\nmatrix representation is given by"
}], "TechNoteText",
 CellID->809087288,ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[265]:=",
 CellID->463596612,ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellLabel->"Out[265]//MatrixForm=",
 CellID->230580141,ExpressionUUID->"de1359bd-c3d4-4e18-8ac5-f04f00216479"]
}, Open  ]],

Cell["In quantum circuit model, it is depicted as", "TechNoteText",
 CellID->2003915004,ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[266]:=",
 CellID->813436327,ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {
      1.09, -1.09}}}], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`SWAP[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellLabel->"Out[266]=",
 CellID->82891276,ExpressionUUID->"41435906-8b52-4f25-a2b9-6b00fb873bc0"]
}, Open  ]],

Cell[TextData[{
 "The SWAP gate can be implemented using the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/CNOT"],
 ". To see this, first note that a simultaneous exchange of the second and \
fourth columns and rows of the above matrix leads to"
}], "TechNoteText",
 CellID->534468518,ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[267]:=",
 CellID->2035770272,ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[267]//MatrixForm=",
 CellID->1184949968,ExpressionUUID->"2fbcbe43-c4f6-4734-aa64-d14d8b4f4248"]
}, Open  ]],

Cell[TextData[{
 "which is nothing other than the matrix representation of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/CNOT"],
 ". On the other hand, the exchange of the second and fourth columns and rows \
is equivalent to flipping the bit values of the first qubit only when the \
second qubit is set to |1\:27e9. Hence, it corresponds to the CNOT gate with \
the second and first qubit as the control and target qubit, respectively. In \
short, the ",
 ButtonBox["SWAP gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/SWAP"],
 " can be achieved by a combination of the CNOT gates as follows"
}], "TechNoteText",
 CellID->1603079182,ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"swap", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[268]:=",
 CellID->621976612,ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {
      1.09, -1.09}}}], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`SWAP[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellLabel->"Out[268]=",
 CellID->398461209,ExpressionUUID->"4ea7d5cd-8fe1-4426-8fbe-2a04f2d8948e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellLabel->"Out[269]=",
 CellID->1083528317,ExpressionUUID->"6a582c01-e06d-4290-9ccc-234a69231d40"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"swap", "==", "cnot"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[270]:=",
 CellID->661500490,ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[270]=",
 CellID->773724114,ExpressionUUID->"5524438e-7f65-44c9-a4cd-aa85ca34d0fc"]
}, Open  ]],

Cell[TextData[{
 "Interestingly, the SWAP gate itself is not universal, but the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0f9dfc0b-39d9-453c-a675-eb518d512950"],
 " gate\[LongDash]the gate that equals SWAP when squared\[LongDash]is \
universal. That is, any quantum gate on a multi-qubit system can be \
implemented by combining ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0b05be5e-8692-4a5b-84d8-b5a054b0849e"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates"],
 ". Indeed, one can combine the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "f0151c4b-fa75-4924-af0f-5c265bda68bc"],
 " gate with single-qubit rotations to construct the CZ gate (see the \
demonstration below). As discussed above, the CZ gate requires just two more ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates#347838345"],
 " to implement the CNOT gate, and it is hence universal."
}], "TechNoteText",
 CellID->666193793,ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7"],

Cell[TextData[{
 "Let us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "b7315c05-edda-4aa9-bb66-bffa244fc647"],
 "gate. Here is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "454ba21f-a0fc-4433-a9bc-caa72aa86329"],
 "gate."
}], "TechNoteText",
 CellID->1938247085,ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"SWAP", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[271]:=",
 CellID->1040933486,ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[272]//MatrixForm=",
 CellID->56596892,ExpressionUUID->"7ecde8a5-85e7-47b7-bcc0-63151663e951"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "e185c8f7-1091-455a-a7b5-decc7ef41d04"],
 "gate in terms of the Pauli operators."
}], "TechNoteText",
 CellID->771058470,ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSWAP", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Elaborate", "@", 
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[273]:=",
 CellID->1895203240,ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 1]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 1]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 2]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellLabel->"Out[273]=",
 CellID->681016261,ExpressionUUID->"7bf0a82b-e84d-4502-863e-50907c12d0a4"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0c02f098-8315-4a01-9535-1f16c7d29832"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "4f9c9fdf-a314-48eb-8ca5-c122c290c0f3"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "41972265-9899-479d-9dd8-e197cf8f3815"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "104915d6-026f-4c72-8e03-32e76e59fedd"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "TechNoteText",
 CellID->27233292,ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSWAP", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSWAP", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[274]:=",
 CellID->1505230369,ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{3, Rational[-3, 2]}, {3, -1.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
      LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
       3.6, -1.4}}], InsetBox[
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
      LineBox[{{3.6, -2.4}, {4.4, -2.4}, {4.4, -1.6}, {3.6, -1.6}, {
       3.6, -2.4}}], InsetBox[
       StyleBox[
        TemplateBox[{"\"S\"", "\"\[Dagger]\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, 
   $CellContext`S[1, 3], {Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, {
    $CellContext`S[1, 7], 
    $CellContext`S[2, -7]}]]], "Output",
 CellLabel->"Out[274]=",
 CellID->64454701,ExpressionUUID->"72457fc0-e368-469f-8e22-7ca1d2727677"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "TechNoteText",
 CellID->535686806,ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[275]:=",
 CellID->851721286,ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {2}, {3}, {1}, {4}}}, {1, 0, 1,
       0, 0, 1, 0, -1}}]]]]], "Output",
 CellLabel->"Out[275]//MatrixForm=",
 CellID->1583742823,ExpressionUUID->"515bd3e7-818d-42df-9d6f-5bd7c6e544d3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "TechNoteSection",
 CellTags->"Section14",
 CellID->1455445268,ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[276]:=",
 CellID->214055128,ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[277]:=",
 CellID->167122186,ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellTags->"Section15",
 CellID->1829879946,ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13"],

Cell[TextData[{
 "Consider two qubits that are once again called control and target qubits. \
Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "7df1b7ef-7bf9-4bb2-8e0a-c82a10de8dd1"],
 " be a unitary operator on the target qubit. The controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d6c81065-e5e8-45aa-8e8b-48a9d091c461"],
 " gate is a unitary operator on the two-qubit Hilbert space defined, \
analogously to CNOT, by"
}], "TechNoteText",
 CellID->678943735,ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["U", "c"], 
        TemplateBox[{"t"},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "b45eb968-4f6f-4d2e-aac4-e40cc028b521"],
 "."
}], "TechNoteText",
 CellID->1426737634,ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8"],

Cell["or equivalently,", "TechNoteText",
 CellID->377012236,ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"0"},
        "Bra"], "\[CircleTimes]", "I"}]}], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"1"},
        "Bra"], "\[CircleTimes]", "U"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"cd25fdd5-a143-4446-9955-56a71898c384"],
 "."
}], "TechNoteText",
 CellID->1367891802,ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165"],

Cell[TextData[{
 "If the control qubit is in |0\:27e9, then it does nothing. On the other \
hand, if the control qubit is in |1\:27e9, then it operates unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ee6fbbb7-d521-4262-b0a5-534ed0a3ddee"],
 " on the target qubit."
}], "TechNoteText",
 CellID->1345075079,ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b"],

Cell["\<\
Analogously to the CNOT gate, the matrix representation of the \
controlled-unitary gate is thus given by\
\>", "TechNoteText",
 CellID->819163313,ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"]},
       {"0", "0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55c085e5-4781-4627-a020-167c0d577b9c"],
 " ."
}], "TechNoteText",
 CellID->116500784,ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"i", " ", "j"}]], TraditionalForm]],ExpressionUUID->
  "67b2053c-b485-4ced-8776-ec6fe6dff079"],
 " are the elements of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "e6087d59-fe37-45d4-9881-210a8577b0c0"],
 "."
}], "TechNoteText",
 CellID->1671074271,ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48"],

Cell["\<\
In quantum circuit model, a controlled-unitary gate is depicted as\
\>", "TechNoteText",
 CellID->1953344721,ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
      LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->118.8,
    PlotRangePadding->Scaled[0.025]], "."}]}]], "Picture",
 CellID->954137231,ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329"],

Cell["\<\
The filled circle connected to the quantum circuit element on the target \
qubit indicates the conditional operation of the element conditioned on the \
state of the control qubit.\
\>", "TechNoteText",
 CellID->924049268,ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1"],

Cell[TextData[{
 "For demonstration, consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,$]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "TechNoteMathCaption",
 CellID->2041795819,ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", "ExpToTrig"}], "//",
   "MatrixForm"}]}], "Input",
 CellLabel->"In[279]:=",
 CellID->1821134520,ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[281]//MatrixForm=",
 CellID->627569432,ExpressionUUID->"34521db2-50a6-4dd9-a309-21287cb3f07b"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "TechNoteMathCaption",
 CellID->1443037598,ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[282]:=",
 CellID->1600084015,ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[2, 2], "Label" -> "U"]]]]], "Output",
 CellLabel->"Out[282]=",
 CellID->1225191363,ExpressionUUID->"2f15baf9-66da-4140-8e41-561723964ece"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate  in terms of the \
Pauli operators.\
\>", "TechNoteMathCaption",
 CellID->378680471,ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "qc", "]"}]], "Input",
 CellLabel->"In[283]:=",
 CellID->1488630036,ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 2]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[283]=",
 CellID->747238466,ExpressionUUID->"1aea0464-4bf1-4f63-a5c0-1e91dc73b832"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "TechNoteMathCaption",
 CellID->641929970,ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[284]:=",
 CellID->2106646909,ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], "-", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[286]//TableForm=",
 CellID->551180730,ExpressionUUID->"dcd25521-b00e-43a1-a7ab-512905f0db77"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "TechNoteMathCaption",
 CellID->1736236263,ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"in", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[287]:=",
 CellID->915076805,ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0|>]]}]], "Output",
 CellLabel->"Out[288]=",
 CellID->58792315,ExpressionUUID->"e07251dc-f97b-4d15-8199-8b5b87a4902b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[289]:=",
 CellID->1955961279,ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[290]=",
 CellID->523161457,ExpressionUUID->"0ad699b0-19e2-42ea-9c03-432800f1a9e6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Acquisition", "Subsection",
 CellTags->"Section16",
 CellID->715838931,ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7"],

Cell[TextData[{
 "An important aspect of a controlled-unitary operator is that it induces \
relative phase shifts on the control qubit when the target qubit has been \
prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d72c7574-e55f-417f-84bc-b2adcf4fe225"],
 ". At first glace, it may sound counterintuitive since the definition given \
above seems to indicate that it changes only the target qubit depending on \
the state of the control qubit and keeps the latter intact. This is another \
feature distinguishing quantum gates from their classical counterparts."
}], "TechNoteText",
 CellID->901522823,ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b"],

Cell[TextData[{
 "Let us take a closer look to see how this works. Prepare the control qubit \
in a superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Psi]"},
     "Ket"], "=", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     TemplateBox[{"1"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "04b33533-0562-4608-b725-a96fec102669"],
 " and the target qubit in an eigenstate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d991046d-2cc8-41b9-a6b5-85cf5e124ead"],
 " of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "6b111da1-5fab-4ed2-a869-76d903e38487"],
 " with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"2b44b691-1c48-49c9-baf3-c1f5dcd541b9"],
 ". The controlled-unitary gate transforms the state to"
}], "TechNoteText",
 CellID->1396956576,ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"\[Psi]"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Phi]"},
      "Ket"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"\[Phi]"},
         "Ket"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], ")"}], 
      "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d52d9159-830d-4d51-a642-e0b209cbb6bd"],
 " ."
}], "TechNoteText",
 CellID->210460181,ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d"],

Cell[TextData[{
 "This feature is extended to multi-control unitary gates and plays a crucial \
role in many quantum algorithms. In particular, the ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumPhaseEstimation"],
 " algorithm is a direct consequence of this feature."
}], "TechNoteText",
 CellID->298695458,ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4"],

Cell[TextData[{
 "For demonstration, consider the phase gate. Recall that state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"c8b87316-432d-4b48-a729-bbc90d23c883"],
 " is an eigenstate of it with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"840f2f8e-aaae-4feb-84ba-8e7fee414a46"],
 "."
}], "TechNoteMathCaption",
 CellID->1505279567,ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[291]:=",
 CellID->1876320909,ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        $CellContext`S[2, 3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  Q3`Phase[$CellContext`\[Phi], 
   $CellContext`S[2, 3]]]], "Output",
 CellLabel->"Out[291]=",
 CellID->345257463,ExpressionUUID->"310cc4eb-4560-4978-b360-1d14a620a3cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, 1] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[292]//MatrixForm=",
 CellID->241366447,ExpressionUUID->"9ded7436-4987-4303-8a31-bd199ebfc477"]
}, Open  ]],

Cell["We are interested in the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->774865820,ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "op", "]"}]}], "Input",
 CellLabel->"In[293]:=",
 CellID->2117896949,ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[294]=",
 CellID->2011447308,ExpressionUUID->"55c65e4b-1210-4956-ad5b-4d08732b527d"]
}, Open  ]],

Cell["\<\
Prepare the target qubit in the eigenstate with a finite phase shift. In \
addition, prepare the control qubit in a linear superposition of the \
computational basis states in order to pick up the phase shift.\
\>", "TechNoteMathCaption",
 CellID->193224567,ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "->", "1"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "op"}], 
   "]"}]}]], "Input",
 CellLabel->"In[295]:=",
 CellID->1062235589,ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"1"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{
        2, -2.5}, {2, -0.5}}]]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
   $CellContext`S[1, 6], "Separator", 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[295]=",
 CellID->1028657360,ExpressionUUID->"044a9957-765a-47cb-b546-ae36b62bc1d0"]
}, Open  ]],

Cell["\<\
Observe that the state does not change on the target qubit while the phase \
shift induced by the phase gate has been picked up by the state in the \
control qubit.\
\>", "TechNoteMathCaption",
 CellID->581406343,ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "//", "KetFactor"}], "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[296]:=",
 CellID->1127477995,ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[297]=",
 CellID->1256781002,ExpressionUUID->"81f5af5f-851c-4339-9cbd-d8d5d78aa790"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Conditional Operation", "Subsection",
 CellTags->"Section17",
 CellID->1379525988,ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff"],

Cell[TextData[{
 "The CNOT gate and the controlled-unitary gate can be combined to achieve a \
variety of conditional gate operations. For example, consider a system \
consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2b922721-8f59-4475-9ecf-8081bcea1f50"],
 " qubits and a target register of a single qubit. Suppose that you want to \
operate a unitary gate ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4a95e72d-7750-4e2d-a2c8-9969571d6e6b"],
 " on the target qubit only when an odd number of the control qubits is set \
to |1\:27e9,"
}], "TechNoteText",
 CellID->1459827304,ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", 
        RowBox[{
         SubscriptBox["c", "1"], "\[CirclePlus]", 
         SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
         "\[CirclePlus]", 
         SubscriptBox["c", "n"]}]], 
       TemplateBox[{"t"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "c961d966-d0ec-45a8-b10c-fe492251e4c2"],
 " ."
}], "TechNoteText",
 CellID->316831353,ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8"],

Cell[TextData[{
 "First, operate the CNOT gates consecutively with the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "\[Minus]", " ", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"384b0335-b827-4145-becb-ab9f85d6d828"],
 " qubits in the control register as the control qubit and the last qubit in \
the control register as the target qubit. This transforms the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "1c7bb7e1-187a-4b4d-8a6d-64bba07245c8"],
 " qubit to",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
       "\[CirclePlus]", 
       SubscriptBox["c", "n"]}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "bb8c910c-1b1c-453e-bde2-bbf806d46593"],
 ". Then, the desired operation is implemented by applying the controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "798627e2-491f-450f-a1ad-8c50cb24997d"],
 " gate controlled by the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "c34cdc58-10ba-4e1a-a673-f9d4b09fb9e4"],
 " qubit. To get the control qubits back to the original state, operate the \
CNOT gates in the reverse order. Overall, the following quantum circuit \
implements the conditional operation"
}], "TechNoteText",
 CellID->1372588958,ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -4}, {6, -4}}, {{
     0, -5}, {6, -5}}}], InsetBox[
     StyleBox["\<\"\[VerticalEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -4}, {3, -5}}], DiskBox[{3, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -2}, {4, -4}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
         4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -4}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -4}, {5.266666666666667, -4}}, {{
         5, -4.266666666666667}, {5, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]], "."}]], "TechNoteText",
 TextAlignment->Center,
 CellID->833281032,ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a"],

Cell["\<\
This method is used to implement a multi-control unitary gate based on the \
Gray code.\
\>", "TechNoteText",
 CellID->1213442737,ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9"],

Cell["\<\
As a demonstration, consider a three-qubit control register. Suppose that we \
want to operate a rotation around the y-axis on the target qubit.\
\>", "TechNoteText",
 CellID->1827368847,ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
       RowBox[{
        RowBox[{"Most", "[", "ss", "]"}], ",", 
        RowBox[{"Last", "@", "ss"}]}], "]"}], ",", "List"}], "]"}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", "cnot"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "$n", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Reverse", "[", "cnot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[298]:=",
 CellID->1424575782,ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[4, 2]]], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[302]=",
 CellID->762690432,ExpressionUUID->"0e790814-d30d-4396-b86b-e82aaaca6b92"]
}, Open  ]],

Cell["\<\
Note the way the logical basis states are transformed through the above \
quantum circuit.\
\>", "TechNoteText",
 CellID->873169809,ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[303]:=",
 CellID->1609219912,ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[305]//TableForm=",
 CellID->480119493,ExpressionUUID->"a328c3b4-87a3-4c0d-ae0f-3bd08b2a74b7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Elementary Gates", "Subsection",
 CellTags->"Section18",
 CellID->1847739219,ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15"],

Cell["\<\
How can you implement a controlled-unitary gate? The operation involves only \
two qubits, and in principle, it should be possible to implement any specific \
controlled-unitary gate. However, the requirements for a physical \
implementation of two-qubit gates is far more difficult to fulfill on \
realistic systems than for single-qubit gates. Fortunately, any \
controlled-unitary gate can be implemented using only the CNOT gate and \
single-qubit gates. This is one of the basic steps in establishing universal \
quantum computation.\
\>", "TechNoteText",
 CellID->192034466,ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "72ee3eec-70a2-4218-a514-c4b738fe7643"],
 " be a unitary gate on the second (target) qubit controlled by the first \
(control) qubit. Suppose that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "482d7c8e-0411-496b-8c03-b7622118e9d2"],
 " has Euler angles \[Alpha], \[Beta], and \[Gamma] and an additional phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], TraditionalForm]],
  ExpressionUUID->"f01f05ed-7b40-4560-9389-996b1c3a264d"],
 ", "
}], "TechNoteText",
 CellID->2002832268,ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"1ceb2f79-208c-43ea-b423-55cfb3cd22d4"],
 " ."
}], "TechNoteText",
 CellID->1943245198,ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9"],

Cell[TextData[{
 "Then one can always find three unitary operators ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "13fc0fd8-64b4-4a1b-91cf-e35261027499"],
 ", ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "d25d1512-d841-4f79-8ecf-3aa53afe092a"],
 ", and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "ed6c3a87-b67c-4830-b6bc-ee86b25be7b7"],
 " such that"
}], "TechNoteText",
 CellID->1190739210,ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "A", " ", "X", " ", "B",
      " ", "X", " ", "C"}]}], TraditionalForm]],ExpressionUUID->
  "74ab9d9c-f73d-409c-b8b4-06573b856aa5"],
 " ,\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "B", " ", "C"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"91f71196-5736-41cc-b04f-8c1e7c12218c"],
 " ,"
}], "TechNoteText",
 CellID->353796077,ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9"],

Cell["\<\
where X is the Pauli X operator. More explicitly, a common choice is\
\>", "TechNoteText",
 CellID->2015931243,ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{"\[Beta]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"faa23ecb-b643-490f-9a46-588cf6441d7f"],
 " ,"
}], "TechNoteText",
 CellID->906902382,ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}], "/", "2"}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "4654d436-6508-4610-abb5-0be68d6d88fc"],
 " ,"
}], "TechNoteText",
 CellID->1616891515,ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "=", 
    RowBox[{
     SubscriptBox["U", "z"], "(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Gamma]"}], ")"}]}], "/", "2"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"d0e584d1-6b09-480b-bdbc-36ca96bc9da7"],
 " ."
}], "TechNoteText",
 CellID->837623467,ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"y", "/", "z"}]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{"X", " ", 
     RowBox[{
      SubscriptBox["U", 
       RowBox[{"y", "/", "z"}]], "(", 
      RowBox[{"-", "\[Phi]"}], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"2b861489-f486-4764-a02d-ad68575af15c"],
 " for any \[Phi], the above choice satisfies the desired properties. These \
properties imply that the controlled-unitary gate can be implemented as in \
the following quantum circuit"
}], "TechNoteText",
 CellID->1182303784,ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->118.8,
   PlotRangePadding->Scaled[0.025]], "=", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[ExponentialE]\\), \\(\
\[ImaginaryI]\\\\ \[CurlyPhi]\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->313511997,ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b"],

Cell[TextData[{
 "where the last gate on the first qubit is the relative phase shift by \
\[CurlyPhi], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"04c67e1e-6647-4538-bbb6-b9def3f5571a"],
 ". Indeed, when the control qubit is in |0\:27e9, the two CNOT gates in the \
middle do nothing, and the combined operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", " ", "B", " ", "C"}], TraditionalForm]],ExpressionUUID->
  "656b77d4-b90f-4de0-b5b0-b6c3dc41a145"],
 " on the target qubit ends up with the identity operator. With the control \
qubit in |1\:27e9, on the other hand, the two CNOT gates are operational and \
the overall operator on the target qubit becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "X", " ", "B", " ", "X", " ", "C"}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], "U"}]}], 
   TraditionalForm]],ExpressionUUID->"07005521-c279-4c9c-8d8c-bafd3d51d026"],
 ", where the phase factor is canceled by the opposite phase from the control \
qubit."
}], "TechNoteText",
 CellID->1418747488,ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd"],

Cell["\<\
For demonstration, consider a unitary matrix to be applied conditionally on \
the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1378098175,ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[306]:=",
 CellID->1028095504,ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"3", "/", "4"}]]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[307]//MatrixForm=",
 CellID->649252782,ExpressionUUID->"2dcd2c74-b1bb-470b-9cf5-544cae7cb938"]
}, Open  ]],

Cell["We want to implement the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->1646790355,ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[308]:=",
 CellID->1153761970,ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, Complex[0, 
       Rational[1, 2]] 
     3^Rational[1, 2] + (Rational[-1, 2] (-1)^Rational[3, 4]) $CellContext`S[
      2, 4] + (Rational[1, 2] (-1)^Rational[1, 4]) $CellContext`S[2, 5], 
    "Label" -> "U"]]]], "Output",
 CellLabel->"Out[309]=",
 CellID->627111379,ExpressionUUID->"e83ef963-0867-4bdb-98cd-89c52fc95420"]
}, Open  ]],

Cell["\<\
First, find the Euler angles of the unitary operator and the global phase \
factor.\
\>", "TechNoteMathCaption",
 CellID->1240176371,ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"det", "=", 
   RowBox[{"Det", "[", "mat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "det", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"mat", "/", 
    RowBox[{"Sqrt", "[", "det", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[310]:=",
 CellID->167989615,ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "4"]}], ",", 
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "4"]}], "}"}]], "Output",
 CellLabel->"Out[312]=",
 CellID->1747926082,ExpressionUUID->"69659bd9-9213-42c1-93f8-ab4461731a27"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", \
"TechNoteMathCaption",
 CellID->833485781,ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[313]:=",
 CellID->359691886,ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c"],

Cell["Finally, construct the equivalent quantum circuit model.", \
"TechNoteMathCaption",
 CellID->175061697,ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellLabel->"In[317]:=",
 CellID->209345089,ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
     LineBox[{{5.6, -1.4}, {6.4, -1.4}, {6.4, -0.6}, {5.6, -0.6}, {
      5.6, -1.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", 
         FractionBox["\[Pi]", "2"]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->298.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`EulerRotation[{0, 0, Rational[1, 4] Pi}, 
    $CellContext`S[2, Q3`$], "Label" -> "C"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{0, Rational[-1, 6] Pi, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "B"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{Rational[-1, 4] Pi, Rational[1, 6] Pi, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "A"], 
   Q3`Phase[Rational[1, 2] Pi, 
    $CellContext`S[1, 3]]]]], "Output",
 CellLabel->"Out[317]=",
 CellID->744848903,ExpressionUUID->"18271b2f-f5ff-42d0-aab2-ff7c800ae32b"]
}, Open  ]],

Cell["Check the result.", "TechNoteMathCaption",
 CellID->2073812678,ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "//", "Chop"}]], "Input",
 CellLabel->"In[318]:=",
 CellID->1395051790,ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[318]=",
 CellID->1036828254,ExpressionUUID->"9870d4a3-6ac5-49ee-8145-3ffc589dbb78"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "TechNoteSection",
 CellTags->"Section19",
 CellID->1476129218,ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[319]:=",
 CellID->384188579,ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[320]:=",
 CellID->1721604371,ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408"],

Cell[TextData[{
 "Here we ",
 ButtonBox["decompose",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/TwoLevelDecomposition"],
 " an arbitrary two-qubit unitary gate into factors of controlled-unitary \
gates only. This is a remarkable advantage when one tries to build a quantum \
computer as you can just focus on how to implement the CNOT gate and \
single-qubit gates. Moreover, the same idea eventually leads to the proof of \
universal quantum computation on a larger system."
}], "TechNoteText",
 CellID->1572676782,ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c"],

Cell[CellGroupData[{

Cell["Two-Level Unitary Transforms", "Subsection",
 CellTags->"Section20",
 CellID->749947798,ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c"],

Cell[TextData[{
 "Consider an arbitrary two-qubit unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "74bbef41-b239-4256-b5d5-f4bb071f8944"],
 ". In the logical basis, it is represented by a unitary matrix"
}], "TechNoteText",
 CellID->791116743,ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "13"], 
        SubscriptBox["U", "14"]},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "23"], 
        SubscriptBox["U", "24"]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubscriptBox["U", "33"], 
        SubscriptBox["U", "34"]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubscriptBox["U", "43"], 
        SubscriptBox["U", "44"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "49d60377-f5d7-4dc8-bd55-98e85746207e"],
 " ."
}], "TechNoteText",
 CellID->1227841024,ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e"],

Cell[TextData[{
 "To break the unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b52a1ed7-0ba7-40e2-bf4c-cf1f5def16ab"],
 " down into more elementary quantum logic gates, we make use of ",
 StyleBox[ButtonBox["two-level unitary transformations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/TwoLevelU"],
  FontSlant->"Italic"],
 ". A two-level unitary transformation is a unitary operation with matrix \
representation that acts only on the two columns and rows of other matrices \
or column or row vectors. The descriptive word \
\[OpenCurlyDoubleQuote]two-level\[CloseCurlyDoubleQuote] should not be \
confused with \[OpenCurlyDoubleQuote]two-qubit\[CloseCurlyDoubleQuote]. A \
two-level transformation acts on multiple qubits, but it just transforms only \
two rows or columns at a time in the representation."
}], "TechNoteText",
 CellID->1153726345,ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704"],

Cell["\<\
Let us start with a two-level unitary transformation of the form\
\>", "TechNoteText",
 CellID->1048831652,ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "13", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         SubscriptBox["U", "14"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "14", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d87e6b00-b56f-4bd7-803c-399755863cf5"],
 " "
}], "TechNoteText",
 CellID->1167800588,ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalN]", "1"], ":=", 
    SqrtBox[
     RowBox[{"|", 
      SubscriptBox["U", "13"], 
      SuperscriptBox["|", "2"], 
      RowBox[{"+", 
       RowBox[{"|", 
        SubscriptBox["U", "14"], 
        SuperscriptBox["|", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "3d868cb0-ebb3-4c78-8ddc-f1586c530df3"],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "1"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "1", "\[Dagger]"], 
      SubscriptBox["T", "1"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"1f35209a-1fbf-48f3-884f-67e21e6eb28c"],
 ". When it multiplies ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0055e7ce-786a-4e76-a5cf-7513877c3e78"],
 " from the right, it does not change the first two columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "feffd3c2-fd2b-499c-902f-353dd544563e"],
 ". It only alters the last two columns, and hence the name \
\[OpenCurlyQuote]two-level transformation\[CloseCurlyQuote]. The elements in \
the lower-right sub-block of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "de482d28-90a1-4a5c-a353-187cebeb0110"],
 " have been chosen so that the first element of the last column is \
canceled:"
}], "TechNoteText",
 CellID->1371432583,ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubsuperscriptBox["U", "13", 
         RowBox[{" ", "\[Prime]"}]], "0"},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubsuperscriptBox["U", "23", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubsuperscriptBox["U", "33", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubsuperscriptBox["U", "43", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "229bae80-0c62-4782-80d7-bb21170e88c2"],
 " ."
}], "TechNoteText",
 CellID->725439230,ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06"],

Cell["\<\
Now take another two-level unitary transformation, this time, of the form\
\>", "TechNoteText",
 CellID->1192474591,ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "2"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "12", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", "\[Prime]"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", 
           RowBox[{"\[Prime]", "*"}]}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "933ff944-3d93-4984-8319-45b52f0f25c3"],
 " ,"
}], "TechNoteText",
 CellID->1603057133,ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "2"], TraditionalForm]],ExpressionUUID->
  "42f4f8eb-8a60-4f33-83b1-ef413e77ab43"],
 " is a normalization factor like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "1"], TraditionalForm]],ExpressionUUID->
  "b145126e-e49a-4ffe-87d5-cdb331e6d340"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "2"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "2", "\[Dagger]"], 
      SubscriptBox["T", "2"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"9779262d-c14b-4c29-b0c0-8b11b570a42d"],
 ". It removes ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "13", 
    RowBox[{" ", "\[Prime]"}]], TraditionalForm]],ExpressionUUID->
  "e0a76015-ec0e-46ac-b6cf-de3ff7920c4f"],
 " while keeping the first and last column as they are:"
}], "TechNoteText",
 CellID->251399069,ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubsuperscriptBox["U", "12", "\[DoublePrime]"], "0", "0"},
       {
        SubscriptBox["U", "21"], 
        SubsuperscriptBox["U", "22", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubsuperscriptBox["U", "32", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubsuperscriptBox["U", "42", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "979aec3f-ddc0-42d0-893c-fc1f3e50ff73"],
 " ."
}], "TechNoteText",
 CellID->1163819034,ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720"],

Cell["Similarly, we go further with the two-level unitary matrix", \
"TechNoteText",
 CellID->1025447562,ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "3"], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["U", "11", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         SubsuperscriptBox["U", "12", "\[DoublePrime]"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {
        RowBox[{
         SubsuperscriptBox["U", "12", 
          RowBox[{"\[DoublePrime]", "*"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "11"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dae78453-2ab9-4d05-ae48-8aae8af0a905"],
 " "
}], "TechNoteText",
 CellID->1140907359,ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb"],

Cell[TextData[{
 "to remove element ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "12", "\[DoublePrime]"], TraditionalForm]],
  ExpressionUUID->"58b02cc1-973b-4a66-bcf7-475a5111e0b7"],
 " and get"
}], "TechNoteText",
 CellID->348498650,ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "3"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["U", "11", "\[Prime]\[Prime]\[Prime]"], "0", "0", 
        "0"},
       {"0", 
        SubsuperscriptBox["U", "22", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "32", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "42", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "505f2971-b178-4f6c-846a-f26ff01a3e47"],
 " ."
}], "TechNoteText",
 CellID->1028905181,ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb"],

Cell[TextData[{
 "At this stage, all elements except for the first of the first column vanish \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "21", "\[Prime]\[Prime]\[Prime]"], "=", 
    RowBox[{
     SubsuperscriptBox["U", "31", "\[Prime]\[Prime]\[Prime]"], "=", 
     RowBox[{
      SubsuperscriptBox["U", "41", "\[Prime]\[Prime]\[Prime]"], "=", 
      "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "06ee66e5-d340-4277-8501-c84a3cdeb493"],
 ") the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", 
    SubscriptBox["T", "1"], 
    SubscriptBox["T", "2"], 
    SubscriptBox["T", "3"]}], TraditionalForm]],ExpressionUUID->
  "9fc42948-ccec-4b1f-9f6b-3150b50e591b"],
 " is a unitary matrix. "
}], "TechNoteText",
 CellID->1271051423,ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70"],

Cell["\<\
Repeating the procedure, we can remove all off-diagonal elements to get\
\>", "TechNoteText",
 CellID->1541429652,ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "L"]}], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "8ea5b480-8693-4958-ad10-aae38ff8a622"],
 " ."
}], "TechNoteText",
 CellID->1712927403,ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351"],

Cell[TextData[{
 "As Tj are all unitary, it enables us to rewrite ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "75eab368-2039-46a2-8453-a51d75dee9a1"],
 " in a combination of two-level unitary transformations, that is,"
}], "TechNoteText",
 CellID->5090539,ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "=", 
    RowBox[{
     SubsuperscriptBox["T", "L", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "2", "\[Dagger]"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}]}], TraditionalForm]],
  ExpressionUUID->"c92fea36-6858-4b54-9a85-a0bea3369da5"],
 " ."
}], "TechNoteText",
 CellID->1804826740,ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83"],

Cell["\<\
For demonstration, consider a Hermitian operator on a two-qubit system. \
Physically, it corresponds to a transverse-field Ising model.\
\>", "TechNoteMathCaption",
 CellID->516505305,ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "H", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[322]:=",
 CellID->775759961,ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[322]=",
 CellID->519072425,ExpressionUUID->"9a37890a-3a3f-4ea0-905f-0d9bcd362d46"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellLabel->"Out[323]//MatrixForm=",
 CellID->971672861,ExpressionUUID->"6d5cd115-ba71-44b0-8f43-02c09ce7c13d"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "TechNoteMathCaption",
 CellID->595736468,ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[324]:=",
 CellID->974055362,ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowDefault"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[(Complex[0, 
      Rational[-1, 4]] Pi) (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[324]=",
 CellID->271180049,ExpressionUUID->"6c053b3b-b601-48e7-be39-0cef6295c9c9"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "TechNoteMathCaption",
 CellID->1817782849,ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[325]:=",
 CellID->1373980921,ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[326]//MatrixForm=",
 CellID->1847665689,ExpressionUUID->"485a025d-5293-4d7d-b2b9-e49c04b6ffcb"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["TwoLevelU", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->642635412,ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[327]:=",
 CellID->1078108721,ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            FractionBox["3", "2"], "+", 
            FractionBox[
             RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
           SqrtBox["7"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}], ",", 
         SqrtBox[
          FractionBox["14", "19"]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["14", "19"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[328]=",
 CellID->1631716762,ExpressionUUID->"55568ef4-2530-41a1-9233-646bdf1de26c"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["TwoLevelU", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "TechNoteMathCaption",
 CellID->1155771237,ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[329]:=",
 CellID->1057593144,ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[329]=",
 CellID->219100384,ExpressionUUID->"26c3c44f-b13f-49fa-9f00-03c88d1ebae5"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "TechNoteMathCaption",
 CellID->1969536942,ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "twl"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[330]:=",
 CellID->694449336,ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[331]//MatrixForm=",
 CellID->791608791,ExpressionUUID->"3e4cf378-e6aa-413a-8290-0540d240c917"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Two-Level Unitary Transformations with Controlled-Unitary Gates\
\>", "Subsection",
 CellTags->"Section22",
 CellID->1363502801,ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0"],

Cell["\<\
We are still to express the two-level unitary transformations in terms of \
controlled-unitary gates. The two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->593579270,ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e083befc-a7e0-4768-988b-1f27cc7af22e"],
 " "
}], "TechNoteText",
 CellID->1225250575,ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3"],

Cell["\<\
is already in the form of the matrix representation of a controlled-unitary \
gate, and just corresponds to a single controlled-unitary\
\>", "TechNoteText",
 CellID->565722942,ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "8f633567-5d40-438e-aba9-efed74c06e17"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "2d010309-ce55-49c2-83d0-d75b6330abac"],
 "."
}], "TechNoteText",
 CellID->1195380925,ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963"],

Cell["A two-level unitary matrix of the form", "TechNoteText",
 CellID->1057688790,ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "6c480a58-bff4-4f80-9c35-7dda6b9ea4c8"],
 " "
}], "TechNoteText",
 CellID->1853347311,ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec"],

Cell["\<\
also corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged. Here, the first qubit is the target qubit and the \
second the control qubit:\
\>", "TechNoteText",
 CellID->2105439889,ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e38a6c68-2602-4891-bc34-1311b80dde5d"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "4d558d0d-ffca-4755-8bde-b9812f09c2c1"],
 "."
}], "TechNoteText",
 CellID->2040162804,ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b"],

Cell["\<\
\tMore complicated is the two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->144855179,ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "37c16ac8-7e58-4468-b68c-6d10cb79975f"],
 " . "
}], "TechNoteText",
 CellID->1482021402,ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3"],

Cell["\<\
As it affects both qubits, it cannot be represented by a single \
controlled-unitary gate. However, it is possible to bring it to the second of \
the above two forms by simultaneously exchanging the last two columns and \
rows.\
\>", "TechNoteText",
 CellID->1818365508,ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], "0", 
        SubscriptBox["U", "12"]},
       {"0", "0", "1", "0"},
       {"0", 
        SubscriptBox["U", "21"], "0", 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7a86ab8c-235e-4dd8-8ed7-c6ce57b24b88"],
 " . "
}], "TechNoteText",
 CellID->429312499,ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f"],

Cell["\<\
The specified exchanges correspond to flipping the bit values of the second \
qubit only when the first qubit has a value of 1, and they can be implemented \
by applying the CNOT gate with the first qubit as the control qubit and the \
second qubit as the target qubit. These observations lead to the following \
equivalence,\
\>", "TechNoteText",
 CellID->2057600420,ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "fd0b029d-8d4b-4398-8da1-87506b4b2332"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "3cdee78c-a236-4778-a65c-f5b50fb80706"],
 ". "
}], "TechNoteText",
 CellID->1161091299,ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd"],

Cell["\<\
which allows us to implement the two-level unitary transformation with two \
CNOT gates and a controlled-unitary gate.\
\>", "TechNoteText",
 CellID->277562004,ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b"],

Cell["\<\
Of course, the way is not unique. For example, it is also possible to bring \
the same two-level unitary matrix to the first two-level unitary form, this \
time, by simultaneously exchanging the second and fourth columns and rows.\
\>", "TechNoteText",
 CellID->650119944,ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "21"]},
       {"0", "0", 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "11"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "10683ca9-7618-42dc-a15d-b71e59a3adf7"],
 " . "
}], "TechNoteText",
 CellID->169102872,ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4"],

Cell[TextData[{
 "These exchanges correspond to flipping the bit values of the first qubit \
only when the second qubit has a value of 1, that is, to applying the CNOT \
gate with the second qubit as the control qubit and the first qubit as the \
target qubit. Note that in this case, unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4084441d-9e5a-4132-baea-8f23cd937a23"],
 " itself is modified through the exchanges, and the rows and columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "32a80573-6a45-46d2-8c11-76524149bbfd"],
 " are exchanged. This is equivalent to the basis change by the Pauli X \
matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", "\[RightArrow]", " ", 
     SuperscriptBox[
      RowBox[{"U", " "}], "\[Prime]"]}], " ", "=", " ", 
    RowBox[{"X", " ", "U", " ", "X"}]}], TraditionalForm]],ExpressionUUID->
  "7c5991a1-4d8d-48e2-8f28-7d190e4d8098"],
 ". Putting all together, the two-level unitary matrix is implemented as"
}], "TechNoteText",
 CellID->991104723,ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "89f4fe62-4810-4870-b7fa-c07e8a70e33c"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U'\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b1853fbd-2d28-48c7-81bc-05f3cde24749"],
 ". "
}], "TechNoteText",
 CellID->1613913329,ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b"],

Cell["\<\
\tIn a similar manner, we can implement another form of two-level unitary \
matrix as\
\>", "TechNoteText",
 CellID->175375246,ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["U", "11"], "0", "0", 
       SubscriptBox["U", "12"]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       SubscriptBox["U", "21"], "0", "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "f5f73d4b-faa8-47cd-99b4-95b842181aa8"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->295.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "9af252a6-d7fe-4869-ae7f-3fceeb977059"],
 "= ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->367.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "88048059-bb49-4867-aa3c-b3d2e0a1135c"],
 "."
}], "TechNoteText",
 CellID->1184195838,ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad"],

Cell["\<\
For a demonstration, consider a single-qubit rotation around the y-axis.\
\>", "TechNoteText",
 CellID->2048492517,ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "U", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[332]:=",
 CellID->555904515,ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[333]//MatrixForm=",
 CellID->166953061,ExpressionUUID->"d772d448-f82e-4ac4-9c5a-c0e790e58abb"]
}, Open  ]],

Cell["\<\
This is the two-level unitary transformation to be implemented with \
elementary gates.\
\>", "TechNoteMathCaption",
 CellID->691274085,ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"Matrix", "[", "U", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "op", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[334]:=",
 CellID->357016325,ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], 1, 1, Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[335]//MatrixForm=",
 CellID->602843045,ExpressionUUID->"58604c50-9bfe-45c4-a811-6d833a0d08a0"]
}, Open  ]],

Cell["This quantum circuit shows one implementation.", "TechNoteMathCaption",
 CellID->1549413286,ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[336]:=",
 CellID->602394280,ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
      3.6, -1.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {1, 1}},
   ImageSize->295.2,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], "Spacer", 
   $CellContext`S[2, 1], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[1, 2], "Label" -> "U"]], 
   $CellContext`S[2, 1], "Spacer", 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[336]=",
 CellID->1615120424,ExpressionUUID->"12458ec2-3149-438b-adf0-1c04318db945"]
}, Open  ]],

Cell["This is another implementation.", "TechNoteMathCaption",
 CellID->389328403,ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[337]:=",
 CellID->59796812,ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -1}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
     LineBox[{{4.6, -1.4}, {5.4, -1.4}, {5.4, -0.6}, {4.6, -0.6}, {
      4.6, -1.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
     LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
      6.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, 
     LineBox[{{8.6, -1.4}, {9.4, -1.4}, {9.4, -0.6}, {8.6, -0.6}, {
      8.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {1, 1}},
   ImageSize->367.2,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 1], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 1], "Spacer", 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[1, 2], "Label" -> "U"]], "Spacer", 
   $CellContext`S[1, 1], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 1], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[337]=",
 CellID->1205470810,ExpressionUUID->"7dbeed34-2026-4d17-b0a1-a83b72859f5c"]
}, Open  ]],

Cell["\<\
Check the equivalence of the two-level unitary matrix and the implementations\
\
\>", "TechNoteMathCaption",
 CellID->834281808,ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc2", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[338]:=",
 CellID->853615793,ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[338]//MatrixForm=",
 CellID->1232547394,ExpressionUUID->"0c31beac-1f7d-4d8b-92b4-6444e55632ef"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[339]//MatrixForm=",
 CellID->796791996,ExpressionUUID->"da9f2aca-b451-4205-b74b-f4ffde8e08de"]
}, Open  ]],

Cell[TextData[{
 "So far, we have determined the implementations of 4 \[Times] 4 two-level \
unitary matrices of different forms just by inspection, that is, in an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " manner. For more than two qubits, the size of the two-level unitary \
matrices is much larger, and it is difficult to find proper implementations \
in such a way. Fortunately, there is a ",
 ButtonBox["systematic way based on the Gray code",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/FromTwoLevelU"],
 "."
}], "TechNoteText",
 CellID->645391397,ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellTags->"Section23",
 CellID->153308382,ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9"],

Cell["\<\
In the above, we have shown that an arbitrary two-qubit unitary gate can be \
carried out by first decomposing its matrix representation into two-level \
unitary matrices and then implementing the two-level unitary matrices by \
means of the CNOT and controlled-unitary gates. Here we demonstrate the whole \
procedure.\
\>", "TechNoteText",
 CellID->1821083521,ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6"],

Cell["\<\
Consider a two-qubit model. Physically, it describes two qubits coupled with \
each other through an Ising-type couping and subject to an external magnetic \
field..\
\>", "TechNoteMathCaption",
 CellID->1013800403,ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellLabel->"In[340]:=",
 CellID->808117923,ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[340]=",
 CellID->1925328158,ExpressionUUID->"4cbad4e1-379b-4eb6-8951-4e20fc0d0159"]
}, Open  ]],

Cell["\<\
We are interested in simulating the time-evolution operator governed by the \
above Hamiltonian.\
\>", "TechNoteMathCaption",
 CellID->322701359,ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", "*", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[341]:=",
 CellID->1245532038,ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowDefault"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[(Complex[0, 
      Rational[-1, 4]] Pi) (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[341]=",
 CellID->950743364,ExpressionUUID->"1ace35c0-7fbe-4ff4-8f67-41feb382762f"]
}, Open  ]],

Cell["\<\
This is the 4\[Times]4 unitary matrix to implement in terms of elementary \
gates.\
\>", "TechNoteMathCaption",
 CellID->730080199,ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"U", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[342]:=",
 CellID->1883829282,ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[343]//MatrixForm=",
 CellID->82055122,ExpressionUUID->"5bfc289d-78bf-400d-b26a-4f6e723ae41d"]
}, Open  ]],

Cell["\<\
First, decompose the 4\[Times]4 unitary matrix into the two-level unitary \
matrices.\
\>", "TechNoteMathCaption",
 CellID->2133759026,ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "twl"}]}]}], "Input",
 CellLabel->"In[344]:=",
 CellID->1258528729,ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["5", "14"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "14"]}], 
          SqrtBox["2"]]}], 
        FractionBox[
         RowBox[{"3", " ", 
          SqrtBox["19"]}], "14"]},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SqrtBox["19"]}], "14"]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["5", "14"], "-", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "14"]}], 
          SqrtBox["2"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[-5, 14], Rational[-5, 14]] 2^Rational[-1, 2], 
         Rational[3, 14] 19^Rational[1, 2], 
         Complex[Rational[-5, 14], Rational[5, 14]] 2^Rational[-1, 2], 
         Rational[-3, 14] 19^Rational[1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
          SqrtBox["2"]]}], 
        FractionBox[
         SqrtBox["19"], "6"], "0", "0"},
       {
        RowBox[{"-", 
         FractionBox[
          SqrtBox["19"], "6"]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
          SqrtBox["2"]]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[Rational[-1, 2], Rational[-5, 6]] 2^Rational[-1, 2], 
         Rational[1, 6] 19^Rational[1, 2], 
         Complex[Rational[-1, 2], Rational[5, 6]] 2^Rational[-1, 2], 
         Rational[-1, 6] 19^Rational[1, 2], 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[-1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[345]=",
 CellID->977287003,ExpressionUUID->"c1248342-4f9d-4bbc-8c06-771ecd6038ae"]
}, Open  ]],

Cell[TextData[{
 "Next, rewrite the two-level unitary matrices in terms of the CNOT and \
controlled-unitary gates. The first element of list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "TechNoteMathCaption",
 CellID->702850526,ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FromTwoLevelU", "[", 
     RowBox[{"#", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}], "/@", 
   RowBox[{"Rest", "[", "twl", "]"}]}]}]], "Input",
 CellLabel->"In[346]:=",
 CellID->1648731982,ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 1]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 2]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 3]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"2"},
            "RowDefault"]],
          $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}]}], "]"}], ",", 
     RowBox[{"ControlledGate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["38"]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          FractionBox["14", "19"]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 2]]}], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           $CellContext`S[2, 3]]}], 
         SqrtBox["38"]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"2"},
            "RowDefault"]],
          $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["5", 
         RowBox[{"14", " ", 
          SqrtBox["2"]}]]}], "+", 
       RowBox[{
        FractionBox["3", "14"], " ", "\[ImaginaryI]", " ", 
        SqrtBox["19"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[2, 2]]}], "-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 3]]}], 
        RowBox[{"14", " ", 
         SqrtBox["2"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
       RowBox[{"{", "0", "}"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], "+", 
       RowBox[{
        FractionBox["1", "6"], " ", "\[ImaginaryI]", " ", 
        SqrtBox["19"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[2, 2]]}], "-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 3]]}], 
        RowBox[{"6", " ", 
         SqrtBox["2"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"2"},
            "RowDefault"]],
          $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}]}], "]"}], ",", 
     RowBox[{"ControlledGate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["38"]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          FractionBox["14", "19"]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 2]]}], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           $CellContext`S[2, 3]]}], 
         SqrtBox["38"]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"2"},
            "RowDefault"]],
          $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["7"]}]]}], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 1]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 2]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 3]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[346]=",
 CellID->1501115572,ExpressionUUID->"62d319c9-e90d-474c-83fc-ecd6d7ecb04c"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "TechNoteMathCaption",
 CellID->328948492,ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"Flatten", "[", "gates", "]"}]}]}]}]], "Input",
 CellLabel->"In[347]:=",
 CellID->1014397666,ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
         4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
     LineBox[{{5, -1}, {5, -2}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
     LineBox[{{5.6, -2.4}, {6.4, -2.4}, {6.4, -1.6}, {5.6, -1.6}, {
      5.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -2}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -1}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -1}, {7.266666666666667, -1}}, {{
         7, -1.2666666666666666`}, {7, -0.7333333333333334}}}]}}, {
     LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, 
     LineBox[{{7.6, -2.4}, {8.4, -2.4}, {8.4, -1.6}, {7.6, -1.6}, {
      7.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -2}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
         9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
     LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, 
     LineBox[{{9.6, -2.4}, {10.4, -2.4}, {10.4, -1.6}, {9.6, -1.6}, {
      9.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->442.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Rational[-1, 2] 7^Rational[-1, 2] + (Complex[0, 
        Rational[-3, 2]] 7^Rational[-1, 2]) $CellContext`S[2, 1] + (Complex[0, 
        Rational[3, 2]] 7^Rational[-1, 2]) $CellContext`S[2, 2] + (
      Complex[0, 
        Rational[3, 2]] 7^Rational[-1, 2]) $CellContext`S[2, 3], "Label" -> 
    "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {
     1}, -38^Rational[-1, 2] + (Complex[0, -1] 
      Rational[14, 19]^Rational[1, 2]) $CellContext`S[2, 2] + (Complex[0, -3] 
      38^Rational[-1, 2]) $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {0}, 
    Rational[-1, 2] 2^Rational[-1, 2] + (Complex[0, 
        Rational[1, 6]] 19^Rational[1, 2]) $CellContext`S[2, 2] + (
      Complex[0, 
        Rational[-5, 6]] 2^Rational[-1, 2]) $CellContext`S[2, 3], "Label" -> 
    "U"], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Rational[-5, 14] 2^Rational[-1, 2] + (Complex[0, 
        Rational[3, 14]] 19^Rational[1, 2]) $CellContext`S[2, 2] + (Complex[0, 
        Rational[-5, 14]] 2^Rational[-1, 2]) $CellContext`S[2, 3], "Label" -> 
    "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {
     1}, -38^Rational[-1, 2] + (Complex[0, -1] 
      Rational[14, 19]^Rational[1, 2]) $CellContext`S[2, 2] + (Complex[0, -3] 
      38^Rational[-1, 2]) $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Rational[1, 2] 7^Rational[-1, 2] + (Complex[0, 
        Rational[-3, 2]] 7^Rational[-1, 2]) $CellContext`S[2, 1] + (Complex[0, 
        Rational[-3, 2]] 7^Rational[-1, 2]) $CellContext`S[2, 2] + (Complex[0, 
        Rational[-3, 2]] 7^Rational[-1, 2]) $CellContext`S[2, 3], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[347]=",
 CellID->1807411484,ExpressionUUID->"30a666ff-7ab3-403c-97df-9061937894d7"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "TechNoteMathCaption",
 CellID->608232459,ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[348]:=",
 CellID->540778693,ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[349]//MatrixForm=",
 CellID->2037999504,ExpressionUUID->"6f0fd531-4ae8-4bfd-8a72-f47d64025ddd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "mat"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[350]:=",
 CellID->326787606,ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[350]//MatrixForm=",
 CellID->352183706,ExpressionUUID->"0ba80b36-dae5-4175-8696-77cdfd09c6a3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "4a34ab7c-05b0-4f6c-b807-210184726b24"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"580592ac-486c-4bfb-992f-\
0ae9353e2374"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "70de6aa0-fc83-43c9-8388-a1bac326c320"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "769e6e6d-dabe-4846-849f-cff5bf8c8365"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"ba6e6652-3079-4949-9e8b-\
fd1b502306f9"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. M. Greenberger, M. A. Horne, & A. Zeilinger, \
\[OpenCurlyDoubleQuote]Going beyond Bell\[CloseCurlyQuote]s theorem,\
\[CloseCurlyDoubleQuote]"}]]]], "http://arxiv.org/abs/0712.0921"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "d8e7c133-e0aa-42be-8afb-1ba319ea7401"]}]],ExpressionUUID->
         "1f5f7475-ad49-41e5-8ee3-ced5a5a0b122"],
        " in Bell\[CloseCurlyQuote]s Theorem, Quantum Theory, and Conceptions \
of the Universe, edited by Kafatos, M. (Kluwer Academic, Dordrecht, The \
Netherlands, 1989)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aca9bd33-36b1-4873-9af7-a58e67bfb358"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Bouwmeester, J.-W. Pan, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Phys. Rev. Lett. 82 (7), 1345 (1999)"}]]]], 
             "https://doi.org/10.1103/PhysRevLett.82.1345"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "b5e8d189-f5c9-4a88-ab4e-0ab41ecace30"]}]],ExpressionUUID->
         "25b8b2af-4bc1-4797-82e1-6a06ab74608c"],
        ", \[OpenCurlyDoubleQuote]Observation of Three-Photon Greenberger- \
Horne-Zeilinger Entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aa4c1e7d-4bdc-4382-bc6c-aa7b8343b83d"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J.-W. Pan, D. Bouwmeester, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Nature 403, 515 (2000)"}]]]], "https://doi.org/10.1038/35000514"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c60f9fce-3355-4460-bb26-8d676cd90d3b"]}]],ExpressionUUID->
         "13432bdb-3ea5-4980-8755-0b55a2e7f8c3"],
        ", \[OpenCurlyDoubleQuote]Experimental test of quantum nonlocality in \
three-photon Greenberger-Horne-Zeilinger entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "a821e7eb-6571-4a82-8b5d-fd47d4a054b1"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "a4709d3e-5f39-466f-879d-da4f28b68df4"]}]],ExpressionUUID->
         "bac169d3-70ab-44e2-8f08-8d110bf55f6f"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "bea60db6-5aa3-4b2f-a998-954dfc342bfa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "f00873d6-99b3-435c-bad4-5f1f6e443ebc"]}]],ExpressionUUID->
         "142f7821-7f6d-4809-9fd2-864bcabd8869"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "dd6b64d8-b32e-4457-a692-5aae5ec7c290"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"13bb05dc-dede-4fac-9b8a-\
4afe8a35ce1f"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"fcb01617-525c-42ea-be3d-bf17a7f6c088"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Two-Qubit Gates",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2023, 2, 16, 11, 1, 7.380993}", 
    "history" -> {"12", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tech Note", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 2.2 of the Quantum Workbook (Springer, 2022). This \
document introduces quantum logic gate operations acting on two qubits. Such \
operations are represented by 4*4 unitary matrices. We will see that any \
two-qubit gate operations can be decomposed into controlled-unitary gates. A \
controlled-unitary gate acts a unitary operator on one qubit depending on the \
logical state of the other qubit. A controlled-unitary gate on two qubits can \
be further decomposed into factors including only the CNOT gate and \
single-qubit rotation gates. In this sense, the CNOT gate alone is sufficient \
for any two-qubit gate. The controlled-unitary and CNOT gates have various \
interesting properties that make them useful in implementing quantum \
algorithms. In this document, we first examine the basic properties of the \
CNOT gate, and in particular, how it is used to generate an entanglement \
between two qubits. Then, we discuss the properties of the controlled-unitary \
gate and describe how to implement a controlled-unitary gate in terms of the \
CNOT gate and single-qubit rotations. Finally, we discuss how an arbitrary \
two-qubit unitary operation can be decomposed into controlled-unitary gates.",
     "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$29582, "title" -> 
    "Two-Qubit Gates", "titlemodifier" -> "", "windowtitle" -> 
    "Two-Qubit Gates", "type" -> "Tech Note", "uri" -> 
    "Q3/tutorial/TwoQubitGates"}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.2 for Mac OS X ARM (64-bit) (January 30, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"37dfb1c2-6c0c-4d83-b7b9-ab23b8721693"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Section11"->{
  Cell[15819, 394, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
   CellTags->"Section11",
   CellID->1585062394]},
 "RasterizedOutput"->{
  Cell[19059, 509, 4765, 84, 120, "Output",ExpressionUUID->"053a4a87-ff4a-424b-a209-3f11b1fe452c",
   CellTags->"RasterizedOutput",
   CellID->530374917],
  Cell[111152, 3135, 4717, 83, 120, "Output",ExpressionUUID->"6f60ca83-a134-4625-8cd2-58a3e2e0b2f1",
   CellTags->"RasterizedOutput",
   CellID->1954094969]},
 "Section12"->{
  Cell[88333, 2458, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
   CellTags->"Section12",
   CellID->29167796]},
 "Section13"->{
  Cell[108149, 3039, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
   CellTags->"Section13",
   CellID->1218939314]},
 "Section14"->{
  Cell[138768, 3890, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
   CellTags->"Section14",
   CellID->1455445268]},
 "Section15"->{
  Cell[139368, 3909, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
   CellTags->"Section15",
   CellID->1829879946]},
 "Section16"->{
  Cell[163553, 4647, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
   CellTags->"Section16",
   CellID->715838931]},
 "Section17"->{
  Cell[177322, 5063, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
   CellTags->"Section17",
   CellID->1379525988]},
 "Section18"->{
  Cell[213955, 6024, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
   CellTags->"Section18",
   CellID->1847739219]},
 "Section19"->{
  Cell[235256, 6640, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
   CellTags->"Section19",
   CellID->1476129218]},
 "Section20"->{
  Cell[236436, 6672, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
   CellTags->"Section20",
   CellID->749947798]},
 "Section22"->{
  Cell[269877, 7720, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
   CellTags->"Section22",
   CellID->1363502801]},
 "Section23"->{
  Cell[303072, 8656, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
   CellTags->"Section23",
   CellID->153308382]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Section11", 357831, 10242},
 {"RasterizedOutput", 358010, 10246},
 {"Section12", 358340, 10253},
 {"Section13", 358511, 10257},
 {"Section14", 358685, 10261},
 {"Section15", 358859, 10265},
 {"Section16", 359028, 10269},
 {"Section17", 359196, 10273},
 {"Section18", 359365, 10277},
 {"Section19", 359534, 10281},
 {"Section20", 359708, 10285},
 {"Section22", 359876, 10289},
 {"Section23", 360045, 10293}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 3446, 80, 57, "AnchorBarGrid",ExpressionUUID->"f77de626-9f92-43ff-a6f0-d6bb9b97ce8f",
 CellID->1],
Cell[CellGroupData[{
Cell[4058, 105, 116, 1, 68, "TechNoteTitle",ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0",
 CellID->1379112571],
Cell[4177, 108, 5481, 119, 115, "TechNoteJumpBox",ExpressionUUID->"65a393e6-cee1-438b-b0b0-9e1d7fc568a9"],
Cell[9661, 229, 418, 13, 38, "TechNoteText",ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383",
 CellID->1308734266],
Cell[10082, 244, 1099, 23, 132, "TechNoteText",ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c",
 CellID->1465929903],
Cell[11184, 269, 1318, 31, 132, "TechNoteText",ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74",
 CellID->1951481337],
Cell[12505, 302, 2110, 55, 227, "DefinitionBox",ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5",
 CellID->407539380],
Cell[14618, 359, 135, 1, 31, "TechNoteCaption",ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f",
 CellID->1189009377],
Cell[14756, 362, 288, 7, 36, "TechNoteMathCaption",ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11",
 CellID->1428640008],
Cell[15047, 371, 147, 3, 29, "Input",ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6",
 CellID->853967906],
Cell[15197, 376, 323, 6, 57, "TechNoteMathCaption",ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6",
 CellID->1937193009],
Cell[15523, 384, 271, 6, 70, "Input",ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736",
 CellID->403330096],
Cell[CellGroupData[{
Cell[15819, 394, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
 CellTags->"Section11",
 CellID->1585062394],
Cell[15975, 398, 494, 13, 70, "TechNoteText",ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443",
 CellID->609014923],
Cell[16472, 413, 554, 19, 70, "TechNoteText",ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41",
 CellID->806749259],
Cell[17029, 434, 537, 17, 70, "TechNoteText",ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f",
 CellID->1970532502],
Cell[CellGroupData[{
Cell[17591, 455, 265, 7, 70, "Input",ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf",
 CellID->246957080],
Cell[17859, 464, 623, 22, 37, "Output",ExpressionUUID->"fe2e115f-8f73-4d54-a16d-57c15fe1732c",
 CellID->1152974404]
}, Open  ]],
Cell[CellGroupData[{
Cell[18519, 491, 537, 16, 70, "Input",ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b",
 CellID->149239284],
Cell[19059, 509, 4765, 84, 120, "Output",ExpressionUUID->"053a4a87-ff4a-424b-a209-3f11b1fe452c",
 CellTags->"RasterizedOutput",
 CellID->530374917]
}, Open  ]],
Cell[23839, 596, 170, 3, 70, "TechNoteText",ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae",
 CellID->690265281],
Cell[CellGroupData[{
Cell[24034, 603, 272, 6, 70, "Input",ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02",
 CellID->581916673],
Cell[24309, 611, 806, 23, 100, "Output",ExpressionUUID->"76bc7b3d-6509-4b7d-a764-7aab206090f3",
 CellID->1139072542]
}, Open  ]],
Cell[25130, 637, 192, 4, 70, "TechNoteText",ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844",
 CellID->107481873],
Cell[CellGroupData[{
Cell[25347, 645, 163, 3, 70, "Input",ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9",
 CellID->414092384],
Cell[25513, 650, 1451, 43, 55, "Output",ExpressionUUID->"3d2b8ae7-65a3-40ff-9e72-5bfd6b0a9926",
 CellID->1648780965]
}, Open  ]],
Cell[CellGroupData[{
Cell[27001, 698, 195, 4, 70, "Input",ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665",
 CellID->597624604],
Cell[27199, 704, 707, 21, 52, "Output",ExpressionUUID->"e826762f-96cf-47ec-a302-0afd6de2df43",
 CellID->1762698537]
}, Open  ]],
Cell[27921, 728, 184, 3, 70, "TechNoteText",ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13",
 CellID->1181321350],
Cell[CellGroupData[{
Cell[28130, 735, 192, 4, 70, "Input",ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361",
 CellID->981612935],
Cell[28325, 741, 896, 22, 95, "Output",ExpressionUUID->"cc02625d-5031-401b-a16b-23f9257752d4",
 CellID->1626835991]
}, Open  ]],
Cell[29236, 766, 283, 5, 70, "TechNoteText",ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39",
 CellID->606925297],
Cell[29522, 773, 722, 15, 70, "TechNoteText",ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420",
 CellID->46143429],
Cell[CellGroupData[{
Cell[30269, 792, 675, 21, 70, "Input",ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73",
 CellID->291014636],
Cell[30947, 815, 3658, 116, 41, "Output",ExpressionUUID->"9a84de5d-cf2e-446e-8144-2eed26757756",
 CellID->983209819]
}, Open  ]],
Cell[34620, 934, 605, 14, 70, "TechNoteText",ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939",
 CellID->1152615977],
Cell[CellGroupData[{
Cell[35250, 952, 273, 7, 70, "Input",ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e",
 CellID->1714229499],
Cell[35526, 961, 1373, 32, 95, "Output",ExpressionUUID->"64b683a6-e817-482f-9509-75c983b7eb8f",
 CellID->1173409259]
}, Open  ]],
Cell[CellGroupData[{
Cell[36936, 998, 538, 16, 70, "Input",ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160",
 CellID->1435008719],
Cell[37477, 1016, 9462, 268, 172, "Output",ExpressionUUID->"9d756645-9e9d-4276-ad94-ab8bda04194e",
 CellID->541551460]
}, Open  ]],
Cell[46954, 1287, 963, 21, 70, "TechNoteText",ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1",
 CellID->1854176847],
Cell[CellGroupData[{
Cell[47942, 1312, 944, 28, 70, "Input",ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075",
 CellID->1015065912],
Cell[48889, 1342, 1712, 38, 275, "Output",ExpressionUUID->"7517601d-7b97-4b4f-9c1f-37b88bb78cac",
 CellID->1843607700]
}, Open  ]],
Cell[50616, 1383, 143, 1, 70, "TechNoteText",ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608",
 CellID->1898388060],
Cell[50762, 1386, 523, 19, 70, "TechNoteText",ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775",
 CellID->1043580941],
Cell[51288, 1407, 1369, 43, 70, "TechNoteText",ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de",
 CellID->965930338],
Cell[52660, 1452, 654, 20, 70, "TechNoteText",ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98",
 CellID->1562303093],
Cell[53317, 1474, 1170, 35, 70, "TechNoteText",ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08",
 CellID->345532182],
Cell[54490, 1511, 475, 17, 70, "TechNoteText",ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547",
 CellID->563601386],
Cell[54968, 1530, 1089, 31, 70, "TechNoteText",ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841",
 CellID->2045611232],
Cell[56060, 1563, 1119, 39, 70, "TechNoteText",ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe",
 CellID->1522271401],
Cell[57182, 1604, 1181, 38, 70, "TechNoteText",ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec",
 CellID->1842749896],
Cell[CellGroupData[{
Cell[58388, 1646, 273, 7, 70, "Input",ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d",
 CellID->88345038],
Cell[58664, 1655, 3143, 70, 275, "Output",ExpressionUUID->"cb1c8806-e8a0-4cd2-8a70-8ef8191ac699",
 CellID->1846523718]
}, Open  ]],
Cell[CellGroupData[{
Cell[61844, 1730, 418, 12, 70, "Input",ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3",
 CellID->1915435092],
Cell[62265, 1744, 3151, 88, 62, "Output",ExpressionUUID->"cda4f566-70fc-42fb-b312-1185e11e39e4",
 CellID->117912760]
}, Open  ]],
Cell[65431, 1835, 305, 5, 70, "TechNoteText",ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195",
 CellID->716147443],
Cell[65739, 1842, 1249, 45, 70, "TechNoteText",ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182",
 CellID->1791716713],
Cell[66991, 1889, 174, 3, 70, "TechNoteText",ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b",
 CellID->1367097157],
Cell[67168, 1894, 321, 5, 70, "TechNoteText",ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615",
 CellID->874378446],
Cell[CellGroupData[{
Cell[67514, 1903, 777, 23, 70, "Input",ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946",
 CellID->447945501],
Cell[68294, 1928, 1622, 36, 167, "Output",ExpressionUUID->"f9a97108-2ef5-4ce9-8bdb-d1e6bbb9c183",
 CellID->1832243388]
}, Open  ]],
Cell[69931, 1967, 115, 1, 70, "TechNoteText",ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328",
 CellID->880946029],
Cell[CellGroupData[{
Cell[70071, 1972, 735, 22, 70, "Input",ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5",
 CellID->1307646985],
Cell[70809, 1996, 1621, 36, 167, "Output",ExpressionUUID->"1729fab3-f1c9-42d6-9e91-05b91e4e38a6",
 CellID->185321968]
}, Open  ]],
Cell[72445, 2035, 235, 4, 70, "TechNoteText",ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43",
 CellID->169608441],
Cell[72683, 2041, 667, 21, 70, "TechNoteText",ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec",
 CellID->898268318],
Cell[73353, 2064, 381, 10, 70, "TechNoteText",ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb",
 CellID->385582216],
Cell[73737, 2076, 2511, 59, 70, "TechNoteText",ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc",
 CellID->1620101282],
Cell[76251, 2137, 131, 1, 70, "TechNoteText",ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167",
 CellID->712578174],
Cell[76385, 2140, 787, 27, 70, "TechNoteText",ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621",
 CellID->1522141313],
Cell[77175, 2169, 414, 7, 70, "TechNoteText",ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929",
 CellID->1803844527],
Cell[77592, 2178, 382, 8, 70, "TechNoteText",ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed",
 CellID->1188320590],
Cell[77977, 2188, 334, 6, 70, "TechNoteText",ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e",
 CellID->506239030],
Cell[78314, 2196, 3608, 92, 70, "TechNoteText",ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3",
 CellID->1226753413],
Cell[81925, 2290, 402, 6, 70, "TechNoteText",ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00",
 CellID->365203462],
Cell[82330, 2298, 5378, 142, 70, "TechNoteText",ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38",
 CellID->977674470],
Cell[87711, 2442, 585, 11, 70, "TechNoteText",ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840",
 CellID->833871357]
}, Open  ]],
Cell[CellGroupData[{
Cell[88333, 2458, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
 CellTags->"Section12",
 CellID->29167796],
Cell[88483, 2462, 147, 3, 70, "Input",ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603",
 CellID->754200946],
Cell[88633, 2467, 272, 6, 70, "Input",ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b",
 CellID->1406814828],
Cell[88908, 2475, 270, 5, 70, "TechNoteText",ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06",
 CellID->596875856],
Cell[89181, 2482, 628, 22, 70, "TechNoteText",ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45",
 CellID->796396655],
Cell[89812, 2506, 344, 11, 70, "TechNoteText",ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478",
 CellID->1920492481],
Cell[CellGroupData[{
Cell[90181, 2521, 264, 7, 70, "Input",ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1",
 CellID->1037913757],
Cell[90448, 2530, 557, 20, 37, "Output",ExpressionUUID->"9e032700-e1f3-4bcc-bc58-f9345f5572f2",
 CellID->145705421]
}, Open  ]],
Cell[CellGroupData[{
Cell[91042, 2555, 538, 16, 70, "Input",ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc",
 CellID->1887946780],
Cell[91583, 2573, 6016, 169, 120, "Output",ExpressionUUID->"d23eb902-f700-4114-a599-c86d67b1d71b",
 CellID->1336050652]
}, Open  ]],
Cell[97614, 2745, 181, 3, 70, "TechNoteText",ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb",
 CellID->1230965299],
Cell[CellGroupData[{
Cell[97820, 2752, 194, 4, 70, "Input",ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55",
 CellID->2123808742],
Cell[98017, 2758, 792, 24, 100, "Output",ExpressionUUID->"db23aa5a-646a-4422-858d-c2499a5e5a75",
 CellID->1974100761]
}, Open  ]],
Cell[98824, 2785, 315, 5, 70, "TechNoteText",ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c",
 CellID->776960470],
Cell[CellGroupData[{
Cell[99164, 2794, 169, 3, 70, "Input",ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01",
 CellID->1674045530],
Cell[99336, 2799, 726, 20, 95, "Output",ExpressionUUID->"d9f3c2bc-6fb3-4a5d-b8b3-8d3f6a04c05a",
 CellID->38252119]
}, Open  ]],
Cell[100077, 2822, 252, 4, 70, "TechNoteText",ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f",
 CellID->573709808],
Cell[100332, 2828, 505, 11, 70, "TechNoteText",ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c",
 CellID->139168026],
Cell[CellGroupData[{
Cell[100862, 2843, 1148, 35, 70, "Input",ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec",
 CellID->387321399],
Cell[102013, 2880, 896, 22, 95, "Output",ExpressionUUID->"bb49bb7c-9692-4456-a57e-515c52f25113",
 CellID->1354589583],
Cell[102912, 2904, 1638, 41, 95, "Output",ExpressionUUID->"2b03427d-61b2-4d9a-8629-0db1f8a7624b",
 CellID->1112979634],
Cell[104553, 2947, 2760, 65, 95, "Output",ExpressionUUID->"108ca4ff-d1cd-42f8-9e61-04b8114e4de8",
 CellID->1266143268]
}, Open  ]],
Cell[CellGroupData[{
Cell[107350, 3017, 201, 4, 70, "Input",ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612",
 CellID->1606586072],
Cell[107554, 3023, 131, 2, 37, "Output",ExpressionUUID->"00a959e2-af00-4ebd-9061-074027732ba5",
 CellID->129656043]
}, Open  ]],
Cell[107700, 3028, 412, 6, 70, "TechNoteText",ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710",
 CellID->799932562]
}, Open  ]],
Cell[CellGroupData[{
Cell[108149, 3039, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
 CellTags->"Section13",
 CellID->1218939314],
Cell[108288, 3043, 148, 3, 70, "Input",ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7",
 CellID->1843914595],
Cell[108439, 3048, 271, 6, 70, "Input",ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5",
 CellID->336088308],
Cell[108713, 3056, 550, 13, 70, "TechNoteText",ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a",
 CellID->1866541665],
Cell[109266, 3071, 625, 22, 70, "TechNoteText",ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e",
 CellID->524648279],
Cell[109894, 3095, 505, 12, 70, "TechNoteText",ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269",
 CellID->195770571],
Cell[CellGroupData[{
Cell[110424, 3111, 725, 22, 70, "Input",ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70",
 CellID->371039593],
Cell[111152, 3135, 4717, 83, 120, "Output",ExpressionUUID->"6f60ca83-a134-4625-8cd2-58a3e2e0b2f1",
 CellTags->"RasterizedOutput",
 CellID->1954094969]
}, Open  ]],
Cell[115884, 3221, 642, 21, 70, "TechNoteText",ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305",
 CellID->809087288],
Cell[CellGroupData[{
Cell[116551, 3246, 193, 4, 70, "Input",ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae",
 CellID->463596612],
Cell[116747, 3252, 805, 23, 100, "Output",ExpressionUUID->"de1359bd-c3d4-4e18-8ac5-f04f00216479",
 CellID->230580141]
}, Open  ]],
Cell[117567, 3278, 143, 1, 70, "TechNoteText",ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580",
 CellID->2003915004],
Cell[CellGroupData[{
Cell[117735, 3283, 192, 4, 70, "Input",ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc",
 CellID->813436327],
Cell[117930, 3289, 844, 23, 95, "Output",ExpressionUUID->"41435906-8b52-4f25-a2b9-6b00fb873bc0",
 CellID->82891276]
}, Open  ]],
Cell[118789, 3315, 371, 8, 70, "TechNoteText",ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c",
 CellID->534468518],
Cell[CellGroupData[{
Cell[119185, 3327, 311, 9, 70, "Input",ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d",
 CellID->2035770272],
Cell[119499, 3338, 806, 23, 100, "Output",ExpressionUUID->"2fbcbe43-c4f6-4734-aa64-d14d8b4f4248",
 CellID->1184949968]
}, Open  ]],
Cell[120320, 3364, 735, 15, 70, "TechNoteText",ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d",
 CellID->1603079182],
Cell[CellGroupData[{
Cell[121080, 3383, 811, 23, 70, "Input",ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454",
 CellID->621976612],
Cell[121894, 3408, 845, 23, 95, "Output",ExpressionUUID->"4ea7d5cd-8fe1-4426-8fbe-2a04f2d8948e",
 CellID->398461209],
Cell[122742, 3433, 1582, 36, 95, "Output",ExpressionUUID->"6a582c01-e06d-4290-9ccc-234a69231d40",
 CellID->1083528317]
}, Open  ]],
Cell[CellGroupData[{
Cell[124361, 3474, 188, 4, 70, "Input",ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22",
 CellID->661500490],
Cell[124552, 3480, 131, 2, 37, "Output",ExpressionUUID->"5524438e-7f65-44c9-a4cd-aa85ca34d0fc",
 CellID->773724114]
}, Open  ]],
Cell[124698, 3485, 1201, 29, 70, "TechNoteText",ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7",
 CellID->666193793],
Cell[125902, 3516, 467, 13, 70, "TechNoteText",ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[126394, 3533, 525, 14, 70, "Input",ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150",
 CellID->1040933486],
Cell[126922, 3549, 1031, 31, 116, "Output",ExpressionUUID->"7ecde8a5-85e7-47b7-bcc0-63151663e951",
 CellID->56596892]
}, Open  ]],
Cell[127968, 3583, 327, 8, 70, "TechNoteText",ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9",
 CellID->771058470],
Cell[CellGroupData[{
Cell[128320, 3595, 472, 13, 70, "Input",ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2",
 CellID->1895203240],
Cell[128795, 3610, 3196, 89, 52, "Output",ExpressionUUID->"7bf0a82b-e84d-4502-863e-50907c12d0a4",
 CellID->681016261]
}, Open  ]],
Cell[132006, 3702, 849, 23, 70, "TechNoteText",ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587",
 CellID->27233292],
Cell[CellGroupData[{
Cell[132880, 3729, 511, 14, 70, "Input",ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3",
 CellID->1505230369],
Cell[133394, 3745, 4035, 98, 95, "Output",ExpressionUUID->"72457fc0-e368-469f-8e22-7ca1d2727677",
 CellID->64454701]
}, Open  ]],
Cell[137444, 3846, 225, 4, 70, "TechNoteText",ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3",
 CellID->535686806],
Cell[CellGroupData[{
Cell[137694, 3854, 193, 4, 70, "Input",ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901",
 CellID->851721286],
Cell[137890, 3860, 829, 24, 100, "Output",ExpressionUUID->"515bd3e7-818d-42df-9d6f-5bd7c6e544d3",
 CellID->1583742823]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138768, 3890, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
 CellTags->"Section14",
 CellID->1455445268],
Cell[138922, 3894, 147, 3, 70, "Input",ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91",
 CellID->214055128],
Cell[139072, 3899, 271, 6, 70, "Input",ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87",
 CellID->167122186],
Cell[CellGroupData[{
Cell[139368, 3909, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
 CellTags->"Section15",
 CellID->1829879946],
Cell[139503, 3913, 572, 13, 70, "TechNoteText",ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644",
 CellID->678943735],
Cell[140078, 3928, 634, 23, 70, "TechNoteText",ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8",
 CellID->1426737634],
Cell[140715, 3953, 115, 1, 70, "TechNoteText",ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9",
 CellID->377012236],
Cell[140833, 3956, 584, 22, 70, "TechNoteText",ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165",
 CellID->1367891802],
Cell[141420, 3980, 400, 8, 70, "TechNoteText",ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b",
 CellID->1345075079],
Cell[141823, 3990, 212, 4, 70, "TechNoteText",ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e",
 CellID->819163313],
Cell[142038, 3996, 569, 19, 70, "TechNoteText",ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4",
 CellID->116500784],
Cell[142610, 4017, 446, 13, 70, "TechNoteText",ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48",
 CellID->1671074271],
Cell[143059, 4032, 174, 3, 70, "TechNoteText",ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd",
 CellID->1953344721],
Cell[143236, 4037, 811, 20, 70, "Picture",ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329",
 CellID->954137231],
Cell[144050, 4059, 287, 5, 70, "TechNoteText",ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1",
 CellID->924049268],
Cell[144340, 4066, 282, 5, 70, "TechNoteMathCaption",ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d",
 CellID->2041795819],
Cell[CellGroupData[{
Cell[144647, 4075, 606, 17, 70, "Input",ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668",
 CellID->1821134520],
Cell[145256, 4094, 1154, 33, 86, "Output",ExpressionUUID->"34521db2-50a6-4dd9-a309-21287cb3f07b",
 CellID->627569432]
}, Open  ]],
Cell[146425, 4130, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e",
 CellID->1443037598],
Cell[CellGroupData[{
Cell[146629, 4137, 290, 7, 70, "Input",ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767",
 CellID->1600084015],
Cell[146922, 4146, 1191, 30, 95, "Output",ExpressionUUID->"2f15baf9-66da-4140-8e41-561723964ece",
 CellID->1225191363]
}, Open  ]],
Cell[148128, 4179, 206, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171",
 CellID->378680471],
Cell[CellGroupData[{
Cell[148359, 4187, 164, 3, 70, "Input",ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f",
 CellID->1488630036],
Cell[148526, 4192, 1806, 53, 52, "Output",ExpressionUUID->"1aea0464-4bf1-4f63-a5c0-1e91dc73b832",
 CellID->747238466]
}, Open  ]],
Cell[150347, 4248, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4",
 CellID->641929970],
Cell[CellGroupData[{
Cell[150549, 4255, 538, 16, 70, "Input",ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170",
 CellID->2106646909],
Cell[151090, 4273, 7934, 222, 130, "Output",ExpressionUUID->"dcd25521-b00e-43a1-a7ab-512905f0db77",
 CellID->551180730]
}, Open  ]],
Cell[159039, 4498, 217, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b",
 CellID->1736236263],
Cell[CellGroupData[{
Cell[159281, 4506, 484, 15, 70, "Input",ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff",
 CellID->915076805],
Cell[159768, 4523, 1282, 39, 41, "Output",ExpressionUUID->"e07251dc-f97b-4d15-8199-8b5b87a4902b",
 CellID->58792315]
}, Open  ]],
Cell[CellGroupData[{
Cell[161087, 4567, 364, 10, 70, "Input",ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8",
 CellID->1955961279],
Cell[161454, 4579, 2050, 62, 52, "Output",ExpressionUUID->"0ad699b0-19e2-42ea-9c03-432800f1a9e6",
 CellID->523161457]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163553, 4647, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
 CellTags->"Section16",
 CellID->715838931],
Cell[163694, 4651, 709, 12, 70, "TechNoteText",ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b",
 CellID->901522823],
Cell[164406, 4665, 1046, 32, 70, "TechNoteText",ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8",
 CellID->1396956576],
Cell[165455, 4699, 1485, 54, 70, "TechNoteText",ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d",
 CellID->210460181],
Cell[166943, 4755, 420, 8, 70, "TechNoteText",ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4",
 CellID->298695458],
Cell[167366, 4765, 528, 13, 70, "TechNoteMathCaption",ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8",
 CellID->1505279567],
Cell[CellGroupData[{
Cell[167919, 4782, 362, 9, 70, "Input",ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c",
 CellID->1876320909],
Cell[168284, 4793, 682, 23, 39, "Output",ExpressionUUID->"310cc4eb-4560-4978-b360-1d14a620a3cf",
 CellID->345257463],
Cell[168969, 4818, 800, 23, 68, "Output",ExpressionUUID->"9ded7436-4987-4303-8a31-bd199ebfc477",
 CellID->241366447]
}, Open  ]],
Cell[169784, 4844, 167, 2, 70, "TechNoteMathCaption",ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738",
 CellID->774865820],
Cell[CellGroupData[{
Cell[169976, 4850, 341, 9, 70, "Input",ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64",
 CellID->2117896949],
Cell[170320, 4861, 1224, 32, 95, "Output",ExpressionUUID->"55c65e4b-1210-4956-ad5b-4d08732b527d",
 CellID->2011447308]
}, Open  ]],
Cell[171559, 4896, 323, 5, 70, "TechNoteMathCaption",ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50",
 CellID->193224567],
Cell[CellGroupData[{
Cell[171907, 4905, 539, 15, 70, "Input",ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1",
 CellID->1062235589],
Cell[172449, 4922, 2445, 62, 93, "Output",ExpressionUUID->"044a9957-765a-47cb-b546-ae36b62bc1d0",
 CellID->1028657360]
}, Open  ]],
Cell[174909, 4987, 278, 5, 70, "TechNoteMathCaption",ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0",
 CellID->581406343],
Cell[CellGroupData[{
Cell[175212, 4996, 305, 7, 70, "Input",ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c",
 CellID->1127477995],
Cell[175520, 5005, 1753, 52, 62, "Output",ExpressionUUID->"81f5af5f-851c-4339-9cbd-d8d5d78aa790",
 CellID->1256781002]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177322, 5063, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
 CellTags->"Section17",
 CellID->1379525988],
Cell[177481, 5067, 714, 15, 70, "TechNoteText",ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40",
 CellID->1459827304],
Cell[178198, 5084, 761, 26, 70, "TechNoteText",ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8",
 CellID->316831353],
Cell[178962, 5112, 1504, 37, 70, "TechNoteText",ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee",
 CellID->1372588958],
Cell[180469, 5151, 2053, 41, 70, "TechNoteText",ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a",
 CellID->833281032],
Cell[182525, 5194, 195, 4, 70, "TechNoteText",ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9",
 CellID->1213442737],
Cell[182723, 5200, 252, 4, 70, "TechNoteText",ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2",
 CellID->1827368847],
Cell[CellGroupData[{
Cell[183000, 5208, 1344, 40, 70, "Input",ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11",
 CellID->1424575782],
Cell[184347, 5250, 2600, 58, 167, "Output",ExpressionUUID->"0e790814-d30d-4396-b86b-e82aaaca6b92",
 CellID->762690432]
}, Open  ]],
Cell[186962, 5311, 197, 4, 70, "TechNoteText",ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787",
 CellID->873169809],
Cell[CellGroupData[{
Cell[187184, 5319, 461, 13, 70, "Input",ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117",
 CellID->1609219912],
Cell[187648, 5334, 26258, 684, 228, "Output",ExpressionUUID->"a328c3b4-87a3-4c0d-ae0f-3bd08b2a74b7",
 CellID->480119493]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[213955, 6024, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
 CellTags->"Section18",
 CellID->1847739219],
Cell[214115, 6028, 645, 10, 70, "TechNoteText",ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081",
 CellID->192034466],
Cell[214763, 6040, 733, 19, 70, "TechNoteText",ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235",
 CellID->2002832268],
Cell[215499, 6061, 567, 17, 70, "TechNoteText",ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9",
 CellID->1943245198],
Cell[216069, 6080, 521, 15, 70, "TechNoteText",ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063",
 CellID->1190739210],
Cell[216593, 6097, 587, 18, 70, "TechNoteText",ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9",
 CellID->353796077],
Cell[217183, 6117, 176, 3, 70, "TechNoteText",ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da",
 CellID->2015931243],
Cell[217362, 6122, 429, 14, 70, "TechNoteText",ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6",
 CellID->906902382],
Cell[217794, 6138, 576, 20, 70, "TechNoteText",ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0",
 CellID->1616891515],
Cell[218373, 6160, 430, 14, 70, "TechNoteText",ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc",
 CellID->837623467],
Cell[218806, 6176, 669, 18, 70, "TechNoteText",ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628",
 CellID->1182303784],
Cell[219478, 6196, 2977, 68, 70, "TechNoteText",ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b",
 CellID->313511997],
Cell[222458, 6266, 1491, 40, 70, "TechNoteText",ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd",
 CellID->1418747488],
Cell[223952, 6308, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4",
 CellID->1378098175],
Cell[CellGroupData[{
Cell[224187, 6316, 464, 13, 70, "Input",ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825",
 CellID->1028095504],
Cell[224654, 6331, 1114, 36, 86, "Output",ExpressionUUID->"2dcd2c74-b1bb-470b-9cf5-544cae7cb938",
 CellID->649252782]
}, Open  ]],
Cell[225783, 6370, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510",
 CellID->1646790355],
Cell[CellGroupData[{
Cell[225976, 6376, 527, 14, 70, "Input",ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49",
 CellID->1153761970],
Cell[226506, 6392, 1315, 32, 95, "Output",ExpressionUUID->"e83ef963-0867-4bdb-98cd-89c52fc95420",
 CellID->627111379]
}, Open  ]],
Cell[227836, 6427, 198, 4, 70, "TechNoteMathCaption",ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45",
 CellID->1240176371],
Cell[CellGroupData[{
Cell[228059, 6435, 544, 16, 70, "Input",ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5",
 CellID->167989615],
Cell[228606, 6453, 282, 8, 50, "Output",ExpressionUUID->"69659bd9-9213-42c1-93f8-ab4461731a27",
 CellID->1747926082]
}, Open  ]],
Cell[228903, 6464, 162, 2, 70, "TechNoteMathCaption",ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d",
 CellID->833485781],
Cell[229068, 6468, 1480, 46, 70, "Input",ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c",
 CellID->359691886],
Cell[230551, 6516, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1",
 CellID->175061697],
Cell[CellGroupData[{
Cell[230740, 6522, 514, 14, 70, "Input",ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea",
 CellID->209345089],
Cell[231257, 6538, 3425, 78, 95, "Output",ExpressionUUID->"18271b2f-f5ff-42d0-aab2-ff7c800ae32b",
 CellID->744848903]
}, Open  ]],
Cell[234697, 6619, 124, 1, 70, "TechNoteMathCaption",ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0",
 CellID->2073812678],
Cell[CellGroupData[{
Cell[234846, 6624, 217, 5, 70, "Input",ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65",
 CellID->1395051790],
Cell[235066, 6631, 129, 2, 37, "Output",ExpressionUUID->"9870d4a3-6ac5-49ee-8145-3ffc589dbb78",
 CellID->1036828254]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235256, 6640, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
 CellTags->"Section19",
 CellID->1476129218],
Cell[235407, 6644, 147, 3, 70, "Input",ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f",
 CellID->384188579],
Cell[235557, 6649, 272, 6, 70, "Input",ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408",
 CellID->1721604371],
Cell[235832, 6657, 579, 11, 70, "TechNoteText",ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c",
 CellID->1572676782],
Cell[CellGroupData[{
Cell[236436, 6672, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
 CellTags->"Section20",
 CellID->749947798],
Cell[236588, 6676, 337, 7, 70, "TechNoteText",ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222",
 CellID->791116743],
Cell[236928, 6685, 875, 30, 70, "TechNoteText",ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e",
 CellID->1227841024],
Cell[237806, 6717, 953, 18, 70, "TechNoteText",ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704",
 CellID->1153726345],
Cell[238762, 6737, 172, 3, 70, "TechNoteText",ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff",
 CellID->1048831652],
Cell[238937, 6742, 896, 28, 70, "TechNoteText",ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559",
 CellID->1167800588],
Cell[239836, 6772, 1548, 45, 70, "TechNoteText",ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355",
 CellID->1371432583],
Cell[241387, 6819, 1189, 38, 70, "TechNoteText",ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06",
 CellID->725439230],
Cell[242579, 6859, 181, 3, 70, "TechNoteText",ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245",
 CellID->1192474591],
Cell[242763, 6864, 1000, 31, 70, "TechNoteText",ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533",
 CellID->1603057133],
Cell[243766, 6897, 1046, 31, 70, "TechNoteText",ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a",
 CellID->251399069],
Cell[244815, 6930, 1184, 34, 70, "TechNoteText",ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720",
 CellID->1163819034],
Cell[246002, 6966, 160, 2, 70, "TechNoteText",ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42",
 CellID->1025447562],
Cell[246165, 6970, 958, 29, 70, "TechNoteText",ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb",
 CellID->1140907359],
Cell[247126, 7001, 300, 8, 70, "TechNoteText",ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d",
 CellID->348498650],
Cell[247429, 7011, 1147, 32, 70, "TechNoteText",ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb",
 CellID->1028905181],
Cell[248579, 7045, 821, 23, 70, "TechNoteText",ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70",
 CellID->1271051423],
Cell[249403, 7070, 179, 3, 70, "TechNoteText",ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7",
 CellID->1541429652],
Cell[249585, 7075, 392, 12, 70, "TechNoteText",ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351",
 CellID->1712927403],
Cell[249980, 7089, 337, 7, 70, "TechNoteText",ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54",
 CellID->5090539],
Cell[250320, 7098, 441, 12, 70, "TechNoteText",ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83",
 CellID->1804826740],
Cell[250764, 7112, 249, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11",
 CellID->516505305],
Cell[CellGroupData[{
Cell[251038, 7120, 650, 19, 70, "Input",ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4",
 CellID->775759961],
Cell[251691, 7141, 1731, 52, 39, "Output",ExpressionUUID->"9a37890a-3a3f-4ea0-905f-0d9bcd362d46",
 CellID->519072425],
Cell[253425, 7195, 1202, 31, 100, "Output",ExpressionUUID->"6d5cd115-ba71-44b0-8f43-02c09ce7c13d",
 CellID->971672861]
}, Open  ]],
Cell[254642, 7229, 185, 3, 70, "TechNoteMathCaption",ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3",
 CellID->595736468],
Cell[CellGroupData[{
Cell[254852, 7236, 268, 7, 70, "Input",ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e",
 CellID->974055362],
Cell[255123, 7245, 2348, 63, 45, "Output",ExpressionUUID->"6c053b3b-b601-48e7-be39-0cef6295c9c9",
 CellID->271180049]
}, Open  ]],
Cell[257486, 7311, 214, 5, 70, "TechNoteMathCaption",ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9",
 CellID->1817782849],
Cell[CellGroupData[{
Cell[257725, 7320, 304, 8, 70, "Input",ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd",
 CellID->1373980921],
Cell[258032, 7330, 3154, 110, 180, "Output",ExpressionUUID->"485a025d-5293-4d7d-b2b9-e49c04b6ffcb",
 CellID->1847665689]
}, Open  ]],
Cell[261201, 7443, 349, 7, 70, "TechNoteMathCaption",ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239",
 CellID->642635412],
Cell[CellGroupData[{
Cell[261575, 7454, 359, 10, 70, "Input",ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643",
 CellID->1078108721],
Cell[261937, 7466, 2260, 74, 107, "Output",ExpressionUUID->"55568ef4-2530-41a1-9233-646bdf1de26c",
 CellID->1631716762]
}, Open  ]],
Cell[264212, 7543, 306, 7, 70, "TechNoteMathCaption",ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5",
 CellID->1155771237],
Cell[CellGroupData[{
Cell[264543, 7554, 267, 7, 70, "Input",ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97",
 CellID->1057593144],
Cell[264813, 7563, 3799, 112, 127, "Output",ExpressionUUID->"26c3c44f-b13f-49fa-9f00-03c88d1ebae5",
 CellID->219100384]
}, Open  ]],
Cell[268627, 7678, 152, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877",
 CellID->1969536942],
Cell[CellGroupData[{
Cell[268804, 7683, 353, 10, 70, "Input",ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc",
 CellID->694449336],
Cell[269160, 7695, 668, 19, 100, "Output",ExpressionUUID->"3e4cf378-e6aa-413a-8290-0540d240c917",
 CellID->791608791]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[269877, 7720, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
 CellTags->"Section22",
 CellID->1363502801],
Cell[270073, 7726, 249, 4, 70, "TechNoteText",ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384",
 CellID->593579270],
Cell[270325, 7732, 492, 17, 70, "TechNoteText",ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3",
 CellID->1225250575],
Cell[270820, 7751, 242, 4, 70, "TechNoteText",ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9",
 CellID->565722942],
Cell[271065, 7757, 1214, 37, 70, "TechNoteText",ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963",
 CellID->1195380925],
Cell[272282, 7796, 138, 1, 70, "TechNoteText",ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738",
 CellID->1057688790],
Cell[272423, 7799, 492, 17, 70, "TechNoteText",ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec",
 CellID->1853347311],
Cell[272918, 7818, 285, 5, 70, "TechNoteText",ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124",
 CellID->2105439889],
Cell[273206, 7825, 1214, 37, 70, "TechNoteText",ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b",
 CellID->2040162804],
Cell[274423, 7864, 169, 3, 70, "TechNoteText",ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506",
 CellID->144855179],
Cell[274595, 7869, 494, 17, 70, "TechNoteText",ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3",
 CellID->1482021402],
Cell[275092, 7888, 335, 6, 70, "TechNoteText",ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac",
 CellID->1818365508],
Cell[275430, 7896, 810, 28, 70, "TechNoteText",ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f",
 CellID->429312499],
Cell[276243, 7926, 433, 7, 70, "TechNoteText",ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169",
 CellID->2057600420],
Cell[276679, 7935, 1701, 45, 70, "TechNoteText",ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd",
 CellID->1161091299],
Cell[278383, 7982, 225, 4, 70, "TechNoteText",ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b",
 CellID->277562004],
Cell[278611, 7988, 337, 5, 70, "TechNoteText",ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a",
 CellID->650119944],
Cell[278951, 7995, 810, 28, 70, "TechNoteText",ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4",
 CellID->169102872],
Cell[279764, 8025, 1128, 24, 70, "TechNoteText",ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be",
 CellID->991104723],
Cell[280895, 8051, 1700, 45, 70, "TechNoteText",ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b",
 CellID->1613913329],
Cell[282598, 8098, 192, 4, 70, "TechNoteText",ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0",
 CellID->175375246],
Cell[282793, 8104, 4846, 121, 70, "TechNoteText",ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad",
 CellID->1184195838],
Cell[287642, 8227, 180, 3, 70, "TechNoteText",ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e",
 CellID->2048492517],
Cell[CellGroupData[{
Cell[287847, 8234, 482, 14, 70, "Input",ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49",
 CellID->555904515],
Cell[288332, 8250, 1154, 33, 86, "Output",ExpressionUUID->"d772d448-f82e-4ac4-9c5a-c0e790e58abb",
 CellID->166953061]
}, Open  ]],
Cell[289501, 8286, 201, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac",
 CellID->691274085],
Cell[CellGroupData[{
Cell[289727, 8294, 464, 14, 70, "Input",ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208",
 CellID->357016325],
Cell[290194, 8310, 1250, 35, 120, "Output",ExpressionUUID->"58604c50-9bfe-45c4-a811-6d833a0d08a0",
 CellID->602843045]
}, Open  ]],
Cell[291459, 8348, 153, 1, 70, "TechNoteMathCaption",ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e",
 CellID->1549413286],
Cell[CellGroupData[{
Cell[291637, 8353, 906, 23, 70, "Input",ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38",
 CellID->602394280],
Cell[292546, 8378, 2766, 65, 95, "Output",ExpressionUUID->"12458ec2-3149-438b-adf0-1c04318db945",
 CellID->1615120424]
}, Open  ]],
Cell[295327, 8446, 137, 1, 70, "TechNoteMathCaption",ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228",
 CellID->389328403],
Cell[CellGroupData[{
Cell[295489, 8451, 1037, 27, 70, "Input",ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2",
 CellID->59796812],
Cell[296529, 8480, 3742, 86, 95, "Output",ExpressionUUID->"7dbeed34-2026-4d17-b0a1-a83b72859f5c",
 CellID->1205470810]
}, Open  ]],
Cell[300286, 8569, 193, 4, 70, "TechNoteMathCaption",ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76",
 CellID->834281808],
Cell[CellGroupData[{
Cell[300504, 8577, 551, 16, 70, "Input",ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2",
 CellID->853615793],
Cell[301058, 8595, 669, 19, 100, "Output",ExpressionUUID->"0c31beac-1f7d-4d8b-92b4-6444e55632ef",
 CellID->1232547394],
Cell[301730, 8616, 668, 19, 100, "Output",ExpressionUUID->"da9f2aca-b451-4205-b74b-f4ffde8e08de",
 CellID->796791996]
}, Open  ]],
Cell[302413, 8638, 622, 13, 70, "TechNoteText",ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9",
 CellID->645391397]
}, Open  ]],
Cell[CellGroupData[{
Cell[303072, 8656, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
 CellTags->"Section23",
 CellID->153308382],
Cell[303209, 8660, 427, 7, 70, "TechNoteText",ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6",
 CellID->1821083521],
Cell[303639, 8669, 280, 5, 70, "TechNoteMathCaption",ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98",
 CellID->1013800403],
Cell[CellGroupData[{
Cell[303944, 8678, 555, 17, 70, "Input",ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8",
 CellID->808117923],
Cell[304502, 8697, 1732, 52, 39, "Output",ExpressionUUID->"4cbad4e1-379b-4eb6-8951-4e20fc0d0159",
 CellID->1925328158]
}, Open  ]],
Cell[306249, 8752, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28",
 CellID->322701359],
Cell[CellGroupData[{
Cell[306484, 8760, 269, 7, 70, "Input",ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4",
 CellID->1245532038],
Cell[306756, 8769, 2348, 63, 45, "Output",ExpressionUUID->"1ace35c0-7fbe-4ff4-8f67-41feb382762f",
 CellID->950743364]
}, Open  ]],
Cell[309119, 8835, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3",
 CellID->730080199],
Cell[CellGroupData[{
Cell[309340, 8843, 377, 11, 70, "Input",ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459",
 CellID->1883829282],
Cell[309720, 8856, 3152, 110, 180, "Output",ExpressionUUID->"5bfc289d-78bf-400d-b26a-4f6e723ae41d",
 CellID->82055122]
}, Open  ]],
Cell[312887, 8969, 200, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833",
 CellID->2133759026],
Cell[CellGroupData[{
Cell[313112, 8977, 350, 9, 70, "Input",ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045",
 CellID->1258528729],
Cell[313465, 8988, 9795, 290, 239, "Output",ExpressionUUID->"c1248342-4f9d-4bbc-8c06-771ecd6038ae",
 CellID->977287003]
}, Open  ]],
Cell[323275, 9281, 371, 7, 70, "TechNoteMathCaption",ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030",
 CellID->702850526],
Cell[CellGroupData[{
Cell[323671, 9292, 383, 11, 70, "Input",ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468",
 CellID->1648731982],
Cell[324057, 9305, 11212, 349, 260, "Output",ExpressionUUID->"62d319c9-e90d-474c-83fc-ecd6d7ecb04c",
 CellID->1501115572]
}, Open  ]],
Cell[335284, 9657, 400, 6, 70, "TechNoteMathCaption",ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80",
 CellID->328948492],
Cell[CellGroupData[{
Cell[335709, 9667, 258, 6, 70, "Input",ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24",
 CellID->1014397666],
Cell[335970, 9675, 6741, 144, 95, "Output",ExpressionUUID->"30a666ff-7ab3-403c-97df-9061937894d7",
 CellID->1807411484]
}, Open  ]],
Cell[342726, 9822, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3",
 CellID->608232459],
Cell[CellGroupData[{
Cell[342947, 9830, 338, 9, 70, "Input",ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37",
 CellID->540778693],
Cell[343288, 9841, 3154, 110, 180, "Output",ExpressionUUID->"6f0fd531-4ae8-4bfd-8a72-f47d64025ddd",
 CellID->2037999504]
}, Open  ]],
Cell[CellGroupData[{
Cell[346479, 9956, 221, 6, 70, "Input",ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb",
 CellID->326787606],
Cell[346703, 9964, 668, 19, 100, "Output",ExpressionUUID->"0ba80b36-dae5-4175-8696-77cdfd09c6a3",
 CellID->352183706]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[347410, 9988, 714, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"580592ac-486c-4bfb-992f-0ae9353e2374"],
Cell[348127, 10008, 1078, 28, 70, "RelatedTutorialsSection",ExpressionUUID->"ba6e6652-3079-4949-9e8b-fd1b502306f9"],
Cell[349208, 10038, 5256, 132, 70, "TutorialRelatedLinksSection",ExpressionUUID->"13bb05dc-dede-4fac-9b8a-4afe8a35ce1f"]
}, Open  ]],
Cell[354479, 10173, 78, 0, 70, "FooterCell",ExpressionUUID->"fcb01617-525c-42ea-be3d-bf17a7f6c088"]
}
]
*)

(* End of internal cache information *)

