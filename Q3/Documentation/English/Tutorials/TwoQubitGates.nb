(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    360087,      10195]
NotebookOptionsPosition[    309912,       9213]
NotebookOutlinePosition[    315633,       9347]
CellTagsIndexPosition[    315229,       9331]
WindowTitle->Two-Qubit Gates
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "d8c9f926-1445-4cb6-9559-d8e3e2e59bf6"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "5e106413-5e2b-4e6d-867a-aaa36ba29178"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[Cell[BoxData[
     TagBox[
      ActionMenuBox[
       FrameBox[Cell[TextData[{
         "URL",
         " ",
         Cell[BoxData[
          GraphicsBox[
           {GrayLevel[0.66667], Thickness[0.13], 
            LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
           AspectRatio->1,
           AxesStyle->Large,
           FrameStyle->Large,
           ImageSize->20,
           PlotRange->{{-3, 4}, {-1, 1}},
           PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
          "ca830c0e-3d54-4dfd-a6f4-bbce43da5725"]
        }],ExpressionUUID->"4528c058-24d9-432e-8bda-236240e99294"],
        StripOnInput->False], {"\<\"Q3/tutorial/TwoQubitGates\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/TwoQubitGates"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
TwoQubitGates.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$305930], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"] <> 
            "Q3/tutorial/TwoQubitGates" <> ".html"], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"],
      MouseAppearanceTag["LinkHand"]]],
     LineSpacing->{1.4, 0},ExpressionUUID->
     "376e60c2-34c6-4552-9093-35309a793687"]], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "ac35db82-5da1-4945-8fad-7b038e9f27a0"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1,ExpressionUUID->"2cbae514-aedc-40e6-accb-132a73e029a8"],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "TechNoteTitle",
 CellID->1379112571,ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Controlled-NOT Gate (CNOT)"], 
      "paclet:Q3/tutorial/TwoQubitGates#1585062394", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Controlled-Unitary Gates"], 
      "paclet:Q3/tutorial/TwoQubitGates#1455445268", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Controlled-Z Gate (CZ)"], 
      "paclet:Q3/tutorial/TwoQubitGates#29167796", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["General Unitary Gates"], 
      "paclet:Q3/tutorial/TwoQubitGates#1476129218", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["SWAP Gate"], "paclet:Q3/tutorial/TwoQubitGates#1218939314", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"52c1917c-1084-4a21-bf78-\
c00ca5f28622"],

Cell[TextData[{
 "See also Section 2.2 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "011d1bed-6ccc-4675-a186-9e146775ef49"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383"],

Cell[TextData[{
 "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4\[Times]4 unitary matrices. We \
will see that any two-qubit gate operations can be decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 ". A ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " acts a unitary operator on one qubit depending on the logical state of the \
other qubit. A controlled-unitary gate on two qubits can be further \
decomposed into factors including only the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " and single-qubit rotation gates. In this sense, the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " alone is sufficient for any two-qubit gate."
}], "TechNoteText",
 CellID->1465929903,ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c"],

Cell[TextData[{
 "\tThe ",
 ButtonBox["controlled-unitary",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " and ",
 ButtonBox["CNOT gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " have various interesting properties that make them useful in implementing \
quantum algorithms. In this document, we first examine the basic properties \
of the CNOT gate, and in particular, how it is used to generate an \
entanglement between two qubits. Then, we discuss the properties of the ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " and describe how to implement a controlled-unitary gate in terms of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates#1113797362"],
 ". Finally, we discuss how an arbitrary two-qubit unitary operation can be \
decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 "."
}], "TechNoteText",
 CellID->1951481337,ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-NOT or CNOT gate", "TechNoteTableText",ExpressionUUID->
     "fd2154fb-d8e1-4837-800b-09a7ff1ebc5d"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:Q3/ref/CZ", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-Z or CZ gate", "TechNoteTableText",ExpressionUUID->
     "4bbf74e4-e4fb-4367-aa6f-1364552cd4cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["SWAP"]], "paclet:Q3/ref/SWAP", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The SWAP gate exchanging the states between two qubits", 
     "TechNoteTableText",ExpressionUUID->
     "309b92d2-10a9-4ceb-a3cb-d80c05cc177f"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledU"]], "paclet:Q3/ref/ControlledU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-unitary gates", "TechNoteTableText",ExpressionUUID->
     "51fb4670-e668-485b-a64e-5a3fd7e559cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents two-level unitary transformation", "TechNoteTableText",
     ExpressionUUID->"abd02730-9c1c-412f-aeed-26c5964b494e"]},
   {
    TemplateBox[{
      Cell[
       TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrite a two-level unitary transformation in terms of the controlled-unitary \
and CNOT gates\
\>", "TechNoteTableText",ExpressionUUID->
     "c1fa8cb0-e32c-4e45-a2bf-734eb208424a"]}
  }]], "DefinitionBox",
 CellID->407539380,ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5"],

Cell["Two-qubit gates available in Q3.", "TechNoteCaption",
 CellID->1189009377,ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6"],

Cell[TextData[{
 "Throughout this documentation, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->403330096,ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736"],

Cell[CellGroupData[{

Cell["Controlled-NOT Gate (CNOT)", "TechNoteSection",
 CellTags->"Section11",
 CellID->1585062394,ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458"],

Cell[TextData[{
 "The  controlled-NOT or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e620a8c8-0da2-4add-9e60-e9b95269af8c"],
 " gate is a quantum logic gate on two qubits that maps the logical basis \
states as"
}], "TechNoteText",
 CellID->609014923,ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CNOT", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        RowBox[{"c", "\[CirclePlus]", "t"}]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d65b82c4-da31-4b40-8e51-3f9ddd06ee1b"]
}], "TechNoteText",
 CellID->806749259,ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "9029aa68-1d83-41e2-8780-ffac38998045"],
 ", where the first qubit is typically called the ",
 StyleBox["control qubit",
  FontSlant->"Italic"],
 " (c) and the second qubit the ",
 StyleBox["target qubit",
  FontSlant->"Italic"],
 " (t)."
}], "TechNoteText",
 CellID->1970532502,ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->246957080,ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{"{", 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->1669237556,ExpressionUUID->"3faf1ef6-9126-440d-873e-58ebbf045bea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[11]:=",
 CellID->149239284,ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[13]//TableForm=",
 CellID->3746492,ExpressionUUID->"d647c3d4-59d2-46b1-ba0f-55eb3a2cec1e"]
}, Open  ]],

Cell["\<\
It has the following matrix representation in the logical basis\
\>", "TechNoteText",
 CellID->690265281,ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[14]:=",
 CellID->581916673,ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[15]//MatrixForm=",
 CellID->632994673,ExpressionUUID->"be102ff8-4cc9-4764-85bd-5eeeffbd4cd0"]
}, Open  ]],

Cell["\<\
and is expressed in terms of the Pauli operators on the control and target \
qubit as\
\>", "TechNoteText",
 CellID->107481873,ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "op", "]"}]], "Input",
 CellLabel->"In[17]:=",
 CellID->414092384,ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[17]=",
 CellID->1803681608,ExpressionUUID->"876f3271-2a33-4c57-a6d8-cc2220447b96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "op", "]"}], "//", "PauliForm"}]], "Input",
 CellLabel->"In[18]:=",
 CellID->597624604,ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"], "+", 
  FractionBox[
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}], "2"], "+", 
  FractionBox[
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"], "-", 
  FractionBox[
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}], "2"]}]], "Output",
 CellLabel->"Out[18]=",
 CellID->495702409,ExpressionUUID->"e0308e66-9bb8-48e1-943f-33f4ba49b60d"]
}, Open  ]],

Cell["\<\
In quantum circuit model, it is represented as the following circuit element\
\>", "TechNoteText",
 CellID->1181321350,ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->981612935,ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[19]=",
 CellID->999222291,ExpressionUUID->"1778e5fe-7b8d-4959-bf0a-22b2e7e728b5"]
}, Open  ]],

Cell["\<\
where the smaller filled circle indicates the dependence on the state of the \
control qubit and the circled-plus sign denotes the conditional NOT action on \
the target qubit.\
\>", "TechNoteText",
 CellID->606925297,ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39"],

Cell[TextData[{
 "\tA simple yet important feature of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5880ef7f-73b8-4ab6-82cc-87dc0d31f1eb"],
 " is to copy the logical state of the control qubit to the target bit \
provided that the target bit is initially set to |0\:27e9; or the reversed \
state when the target qubit is in |1\:27e9. A vital implication is that CNOT \
generates an entangled state when the control qubit is in a superposition:"
}], "TechNoteText",
 CellID->46143429,ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "->", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"in", "->", "out"}], "//", "LogicalForm"}], "//", "KetFactor"}], "//",
   "LogicalForm"}]}], "Input",
 CellLabel->"In[106]:=",
 CellID->291014636,ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]], " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}], ")"}], "\[CircleTimes]", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}],
   HoldForm], "\[Rule]", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}]}]}]], "Output",
 CellLabel->"Out[108]=",
 CellID->1262723033,ExpressionUUID->"8db4692c-b671-4347-87c0-049c75c6becd"]
}, Open  ]],

Cell[TextData[{
 "Applying a single qubit rotation such the Hadamard gate on the control \
qubit prior to CNOT, one can thus generate entangled states from logical \
states. In this sense, such a circuit is called a ",
 StyleBox["quantum entangler circuit",
  FontSlant->"Italic"],
 ".  In general, the different product states in the logical basis are \
transformed to different ",
 StyleBox[ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/BellState"],
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->1152615977,ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "op"}], "]"}]}]], "Input",
 CellLabel->"In[109]:=",
 CellID->1714229499,ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[109]=",
 CellID->414581541,ExpressionUUID->"4ba7f6c8-474b-4519-adf4-72a3d563ccd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[110]:=",
 CellID->1435008719,ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "+", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "+", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "-", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "-", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[112]//TableForm=",
 CellID->1950184423,ExpressionUUID->"52b227c9-786d-42b6-b248-17a2b9c0aaab"]
}, Open  ]],

Cell[TextData[{
 "\tOne can further generalize the above procedure to generate maximally \
entangled states between larger systems: Consider two quantum registers, each \
consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "af6575a1-43d0-4455-97df-db7ec963065c"],
 " qubits. We respectively call them the \[OpenCurlyQuote]control\
\[CloseCurlyQuote] and \[OpenCurlyQuote]target\[CloseCurlyQuote] register for \
the reason that will be clear below. Upon applying the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "901a47ec-7470-4146-b686-042c18f982bb"],
 " gate on each pair of the corresponding qubits in the two registers as in \
the quantum circuit,"
}], "TechNoteText",
 CellID->1854176847,ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"2", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"Thread", "[", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "@", "cc"}], ",", 
        RowBox[{"S", "@", "tt"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[149]:=",
 CellID->1015065912,ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -5}, {4, -5}}, {{0, -6}, {4, -6}}, {{0, -7}, {4, -7}}}], {
    LineBox[{{1, -1}, {1, -5}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
        1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
    LineBox[{{2, -2}, {2, -6}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -3}, {3, -7}}], 
    DiskBox[{3, -3}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[152]=",
 CellID->602691216,ExpressionUUID->"6924f948-da7e-4e96-89fe-724adbdece05"]
}, Open  ]],

Cell["the logical basis states are transformed as", "TechNoteText",
 CellID->1898388060,ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       RowBox[{"c", "\[CirclePlus]", "t"}]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "d41dd958-8763-4d29-b6bc-67bf58980937"],
 " ."
}], "TechNoteText",
 CellID->1043580941,ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775"],

Cell[TextData[{
 "The above association rule is formally the same as the one in (2.29) for a \
single pair of qubits. Here, however, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"c"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["c", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "18193fb8-fe63-46e6-9adb-b49b66691c9d"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"t"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["t", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "383ed95f-2d83-49c9-ab80-3650c110e70c"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[CirclePlus]", " ", "t"}], TraditionalForm]],
  ExpressionUUID->"30dfbfdc-abc1-4a43-91e4-a024c634e3b0"],
 " denotes the bit-wise exclusive OR (or XOR),"
}], "TechNoteText",
 CellID->965930338,ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "\[CirclePlus]", "t"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["t", "1"]}], ",", 
      RowBox[{
       SubscriptBox["c", "2"], "\[CirclePlus]", 
       SubscriptBox["t", "2"]}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["c", "n"], "\[CirclePlus]", 
       SubscriptBox["t", "n"]}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "9e89c491-b7a9-4bcf-a5bc-3c8c03b067f7"],
 " ,"
}], "TechNoteText",
 CellID->1562303093,ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98"],

Cell[TextData[{
 "for the n-bit strings ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", 
      SubscriptBox["c", "2"], ",", "...", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "91a8d8cd-fe5c-488a-9717-c0bf12b93c97"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["t", "1"], ",", 
      SubscriptBox["t", "2"], ",", "...", ",", 
      SubscriptBox["t", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1fef8f88-4c88-4714-b329-9a1d4305b835"],
 ". When the target register is prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "391653d4-d933-4e3c-bfda-d4c2b5266109"],
 ", the logical basis state of the control register is copied to the target \
register,"
}], "TechNoteText",
 CellID->345532182,ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "4192506e-ca86-4264-86b6-2c76afde6035"]
}], "TechNoteText",
 CellID->563601386,ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547"],

Cell[TextData[{
 "under the set of CNOT gates on paired qubits. More interestingly, when the \
control register is prepared in a superposition, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "7621ce2f-1c13-42ff-8aaa-50dbcc2924dd"],
 ", and the target register x=0 is in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "709dc516-26c0-43cb-8ffe-0b30b3555103"],
 ", the CNOT gate makes a copy of each logical state of the control register \
to the target register, leading to a maximally entangled state,"
}], "TechNoteText",
 CellID->2045611232,ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"n", "/", "2"}]]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"x", "=", "0"}], 
          RowBox[{
           SuperscriptBox["2", "n"], "-", "1"}]], 
         TemplateBox[{"x"},
          "Ket"]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], "\[RightTeeArrow]", 
     TemplateBox[{"\[CapitalPhi]"},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3c877f12-3f98-4a5b-a91c-f841483a1dff"]
}], "TechNoteText",
 CellID->1522271401,ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe"],

Cell[TextData[{
 "between the two registers (rather than single qubits). Since the \
superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "1a3df944-a9d2-4c37-90ff-bc9e60e7f1ab"],
 " is obtained just by the ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/Hadamard"],
 ", the maximally entangled state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3a3d096e-4106-4349-bb5a-6c3a2214bc3f"],
 " can be generated from the logical state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "cb7d677d-5c29-463c-af58-230e5263bea6"],
 " through the following quantum circuit."
}], "TechNoteText",
 CellID->1842749896,ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qce", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[156]:=",
 CellID->88345038,ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
    0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -5}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
        2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -6}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
        3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -7}}], 
    DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
        4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[156]=",
 CellID->903853589,ExpressionUUID->"d5f49643-6697-454d-926d-3c2955ebeb67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qce", "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[163]:=",
 CellID->1915435092,ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "0", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "0", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "1", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "1", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[164]=",
 CellID->1937722714,ExpressionUUID->"0ebf0129-501f-43bc-89c5-299a6f1c5bf2"]
}, Open  ]],

Cell["\<\
It is also interesting to note that even though |\[CapitalPhi]\:27e9 is a \
maximally entangled state between the control and target registers, it is a \
product state of n maximally entangled pairs\
\>", "TechNoteText",
 CellID->716147443,ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "38a75842-a8e5-4adf-850b-3ff2f0bcef8e"],
 " ."
}], "TechNoteText",
 CellID->1791716713,ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182"],

Cell["\<\
The entanglement strongly depends on how you partition the system.\
\>", "TechNoteText",
 CellID->1367097157,ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b"],

Cell["\<\
\tAnother generalization of copying logical basis states to a series of \
qubits by consecutively applying CNOT gates with a single control qubit on \
multiple target qubits is shown in the following quantum circuit,\
\>", "TechNoteText",
 CellID->874378446,ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "List"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[26]:=",
 CellID->447945501,ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    LineBox[{{3, -1}, {3, -4}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
        3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[30]=",
 CellID->1676325949,ExpressionUUID->"2a5e5c71-21cc-45c0-8246-777642277150"]
}, Open  ]],

Cell["or equivalently,", "TechNoteText",
 CellID->880946029,ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[22]:=",
 CellID->1307646985,ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    LineBox[{{2, -2}, {2, -3}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    LineBox[{{3, -3}, {3, -4}}], 
    DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
        3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[25]=",
 CellID->2026523596,ExpressionUUID->"e49a0da4-14db-4c31-9a5d-833868845440"]
}, Open  ]],

Cell["\<\
When the target qubits are all prepared in the logical basis state |0\:27e9, \
the series of CNOT gates makes the transformation\
\>", "TechNoteText",
 CellID->169608441,ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "e54c9567-fcf6-4bb6-aa51-ad46d78abac5"]
}], "TechNoteText",
 CellID->898268318,ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1"}], TraditionalForm]],ExpressionUUID->
  "180a4472-59f2-40f1-bee7-baf558860f8d"],
 ". Therefore, a simple application of the Hadamard gate in the control qubit \
before the CNOT gates, "
}], "TechNoteText",
 CellID->385582216,ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}}], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{3, -1}, {3, -3}}], 
      DiskBox[{3, -1}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
       LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
          3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
      LineBox[{{4, -1}, {4, -4}}], 
      DiskBox[{4, -1}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
       LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
          4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->226.79999999999998`,
    PlotRangePadding->Scaled[0.025]], ","}]}]], "TechNoteText",
 CellID->1620101282,ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc"],

Cell["can generate a state of the form", "TechNoteText",
 CellID->712578174,ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"GHZ"},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"]}]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "0ba762a6-c203-49b1-a60e-a6e8325930d1"],
 " ."
}], "TechNoteText",
 CellID->1522141313,ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621"],

Cell["\<\
The above state, which is known as the Greenberger-Horne-Zeilinger (GHZ) \
state (Greenberger et al., 1989), exhibits a quantum entanglement of more \
than two particles. It has stimulated tests of non-locality of quantum \
mechanics beyond Bell inequalities (Bouwmeester et al., 1999; Pan et al., \
2000).\
\>", "TechNoteText",
 CellID->1803844527,ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929"],

Cell[TextData[{
 "\tQuantum entanglement is a valuable resource in quantum information \
processing and in quantum communication. The most popular example of such is ",
 ButtonBox["quantum teleportation",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"],
 "."
}], "TechNoteText",
 CellID->1188320590,ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed"],

Cell["\<\
\tIn the above consideration, CNOT gates with the same control qubit are \
applied on different target qubits. The opposite setting brings forth \
additional applications of CNOT as illustrated in the following quantum \
circuit.\
\>", "TechNoteText",
 CellID->506239030,ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, InsetBox[
     StyleBox[
      TemplateBox[{
        RowBox[{
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, Rational[1, 2]}]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->1226753413,ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3"],

Cell["\<\
 In this quantum circuit, the successive application of the CNOT gates on the \
same target qubit with different control qubits results in the accumulation \
of the logical bit values of all qubits. The same goal may be achieved by \
applying the CNOT gates on the consecutive pairs of qubits as\
\>", "TechNoteText",
 CellID->365203462,ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -3}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->977674470,ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38"],

Cell[TextData[{
 "In this case, not only the last qubit but also the qubits in the middle are \
modified. However, this makes little difference since the quantum circuit \
block is mostly used to conditionally control the operation of an unitary \
gate on a different qubit and the whole block must be undone anyway (see, for \
example, the ",
 ButtonBox["quantum circuit of conditional unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1379525988"],
 ")."
}], "TechNoteText",
 CellID->833871357,ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Z Gate (CZ)", "TechNoteSection",
 CellTags->"Section12",
 CellID->29167796,ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[276]:=",
 CellID->754200946,ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[277]:=",
 CellID->1406814828,ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b"],

Cell["\<\
An interesting variant of CNOT gates is the so-called controlled-Z or CZ \
gate. This is a quantum logic gate on two qubits that maps the logical basis \
states as\
\>", "TechNoteText",
 CellID->596875856,ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CZ", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"t"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"c", " ", "t"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "1ea385c0-0dbd-4923-90b1-9729933fa242"]
}], "TechNoteText",
 CellID->796396655,ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "a224194f-7edc-4912-ab58-d4d4eb23fe22"],
 "."
}], "TechNoteText",
 CellID->1920492481,ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[218]:=",
 CellID->1037913757,ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{
   RowBox[{"{", 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[218]=",
 CellID->206849318,ExpressionUUID->"fb06d0c7-a71e-42f2-a5d4-aff88a510124"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[220]:=",
 CellID->1887946780,ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{"-", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["1", 
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]]], 
             SubscriptBox["1", 
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
           DisplayForm]},
         "Ket"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[222]//TableForm=",
 CellID->1650647035,ExpressionUUID->"4627d9ea-53f9-445c-8a2f-5b0163d3c37b"]
}, Open  ]],

Cell["\<\
The matrix representation of the CZ gate in the logical basis is given by\
\>", "TechNoteText",
 CellID->1230965299,ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[224]:=",
 CellID->2123808742,ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellLabel->"Out[224]//MatrixForm=",
 CellID->1527830007,ExpressionUUID->"243d5e76-7714-4b3f-867e-8ec65d757f06"]
}, Open  ]],

Cell["\<\
Since it is symmetric for the two qubits, a distinction of the control and \
target qubit is meaningless. Accordingly, in quantum circuit model, the gate \
is depicted by the following quantum circuit element\
\>", "TechNoteText",
 CellID->776960470,ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[226]:=",
 CellID->1674045530,ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[226]=",
 CellID->1499963363,ExpressionUUID->"dc9e97b8-0e58-43ae-bfd1-1223834c38ef"]
}, Open  ]],

Cell["\<\
The filled circles on both qubit lines (rather than a square box on either \
qubit) indicate that the bit values of both qubits remain unchanged.\
\>", "TechNoteText",
 CellID->573709808,ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f"],

Cell[TextData[{
 "\tNoting the identity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", " ", "Z", " ", "H"}], "=", "X"}], TraditionalForm]],
  ExpressionUUID->"7a83536f-3ac5-4c9f-bee5-cbbd8e9da49f"],
 ", one can regard that the CZ gate is equal to the CNOT gate up to the \
Hadamard gate on the target qubit. The relation between the CNOT and CZ gate \
is illustrated in the following quantum circuits"
}], "TechNoteText",
 CellID->139168026,ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}]}], "]"}]}]}], "Input",\

 CellLabel->"In[239]:=",
 CellID->387321399,ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[239]=",
 CellID->687818936,ExpressionUUID->"8548cc49-b767-40a9-ac25-70380f3941f2"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[240]=",
 CellID->268385551,ExpressionUUID->"e6bc177b-7b31-4ff4-b28b-80b321f00df4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[241]=",
 CellID->1040296957,ExpressionUUID->"b50dd44a-9ba0-4e72-8bd0-cb4af365a38c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnot", "==", "cz1", "==", "cz2"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[242]:=",
 CellID->1606586072,ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[242]=",
 CellID->1580218373,ExpressionUUID->"f69d9295-0e1a-4abf-a1fd-4658a46acc76"]
}, Open  ]],

Cell["\<\
Depending on the Hamiltonian of a particular physical system, direct \
realization of the CNOT gate may be considerably difficult while the CZ gate \
is relatively easier to implement. In such a case, the above identity offers \
a straightforward workaround for a physical implementation of the CNOT gate.\
\>", "TechNoteText",
 CellID->799932562,ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SWAP Gate", "TechNoteSection",
 CellTags->"Section13",
 CellID->1218939314,ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[276]:=",
 CellID->1843914595,ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[277]:=",
 CellID->336088308,ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5"],

Cell[TextData[{
 "Another interesting two-qubit gate is the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:Q3/ref/SWAP", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1a92bc4f-5431-495f-93a4-bf7492e7da3f"],
 " gate that \[OpenCurlyQuote]swaps\[CloseCurlyQuote] the states of the two \
qubits and maps the logical basis states as"
}], "TechNoteText",
 CellID->1866541665,ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"SWAP", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "70e7957f-f62a-492d-b2fd-298b150e232a"]
}], "TechNoteText",
 CellID->524648279,ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e"],

Cell[BoxData[
 RowBox[{"for", " ", 
  RowBox[{Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Element]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
    "ff8569d5-2c51-4925-acc6-cd64fc41399b"]],ExpressionUUID->
    "9a7b9477-6dc2-4a42-bce9-11aaf19a2ff3"], "."}]}]], "TechNoteText",
 CellID->195770571,ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[253]:=",
 CellID->371039593,ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[256]//TableForm=",
 CellID->1917412310,ExpressionUUID->"27110225-b050-43b0-82c5-8bce29b33c15"]
}, Open  ]],

Cell[TextData[{
 "Given that the states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e1a70f29-c7a7-4611-be34-d93daa35de1b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"1"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e28214a6-d024-4028-b68a-dabbdac76c95"],
 " are not altered by the operation, the\nmatrix representation is given by"
}], "TechNoteText",
 CellID->809087288,ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[257]:=",
 CellID->463596612,ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellLabel->"Out[257]//MatrixForm=",
 CellID->597586568,ExpressionUUID->"69da66ea-3ba6-4c64-a72b-e896a948f202"]
}, Open  ]],

Cell["In quantum circuit model, it is depicted as", "TechNoteText",
 CellID->2003915004,ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[258]:=",
 CellID->813436327,ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
     1.09, -2.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[258]=",
 CellID->543451087,ExpressionUUID->"7d914db4-cb42-49ec-876d-996856c93ac9"]
}, Open  ]],

Cell[TextData[{
 "The SWAP gate can be implemented using the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/CNOT"],
 ". To see this, first note that a simultaneous exchange of the second and \
fourth columns and rows of the above matrix leads to"
}], "TechNoteText",
 CellID->534468518,ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[259]:=",
 CellID->2035770272,ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[259]//MatrixForm=",
 CellID->1481497500,ExpressionUUID->"bb1cae5c-992a-4991-a5bb-fccff6e79a2d"]
}, Open  ]],

Cell[TextData[{
 "which is nothing other than the matrix representation of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/CNOT"],
 ". On the other hand, the exchange of the second and fourth columns and rows \
is equivalent to flipping the bit values of the first qubit only when the \
second qubit is set to |1\:27e9. Hence, it corresponds to the CNOT gate with \
the second and first qubit as the control and target qubit, respectively. In \
short, the ",
 ButtonBox["SWAP gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/SWAP"],
 " can be achieved by a combination of the CNOT gates as follows"
}], "TechNoteText",
 CellID->1603079182,ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"swap", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[261]:=",
 CellID->621976612,ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
     1.09, -2.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[261]=",
 CellID->1758007935,ExpressionUUID->"7f482271-369c-413d-8e52-f3dc7ecc2ef3"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    LineBox[{{1, -2}, {1, -1}}], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
        1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -1}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
        3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[262]=",
 CellID->1759348119,ExpressionUUID->"b2cb5b57-493e-4c95-8532-4eb804d4ced7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"swap", "==", "cnot"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[263]:=",
 CellID->661500490,ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[263]=",
 CellID->315894911,ExpressionUUID->"6548e31c-b3bc-4658-893f-23f52218d210"]
}, Open  ]],

Cell[TextData[{
 "\tInterestingly, the SWAP gate itself is not universal, but the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0f9dfc0b-39d9-453c-a675-eb518d512950"],
 " gate\[LongDash]the gate that equals SWAP when squared\[LongDash]is \
universal. That is, any quantum gate on a multi-qubit system can be \
implemented by combining ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0b05be5e-8692-4a5b-84d8-b5a054b0849e"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates"],
 ". Indeed, one can combine the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "f0151c4b-fa75-4924-af0f-5c265bda68bc"],
 " gate with single-qubit rotations to construct the CZ gate (see the \
demonstration below). As discussed above, the CZ gate requires just two more ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates#347838345"],
 " to implement the CNOT gate, and it is hence universal."
}], "TechNoteText",
 CellID->666193793,ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7"],

Cell[TextData[{
 "\tLet us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "b7315c05-edda-4aa9-bb66-bffa244fc647"],
 "gate. Here is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "454ba21f-a0fc-4433-a9bc-caa72aa86329"],
 "gate."
}], "TechNoteText",
 CellID->1938247085,ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"SWAP", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[269]:=",
 CellID->1040933486,ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[270]//MatrixForm=",
 CellID->1886827140,ExpressionUUID->"30fd9d21-2bf9-4fa6-a219-a5d3bf62bf92"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "e185c8f7-1091-455a-a7b5-decc7ef41d04"],
 "gate in terms of the Pauli operators."
}], "TechNoteText",
 CellID->771058470,ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSWAP", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[271]:=",
 CellID->1895203240,ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"+\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"-\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"-\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"+\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellLabel->"Out[271]=",
 CellID->12726731,ExpressionUUID->"4349c87f-1af1-4ba7-8cb6-3a3f7ff1e240"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0c02f098-8315-4a01-9535-1f16c7d29832"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "4f9c9fdf-a314-48eb-8ca5-c122c290c0f3"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "41972265-9899-479d-9dd8-e197cf8f3815"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "104915d6-026f-4c72-8e03-32e76e59fedd"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "TechNoteText",
 CellID->27233292,ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSWAP", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSWAP", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[272]:=",
 CellID->1505230369,ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{3, Rational[-3, 2]}, {3, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"S\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"S\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {4, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[272]=",
 CellID->1297286864,ExpressionUUID->"1ef90033-2bd1-4a1b-b857-50ddd6b30237"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "TechNoteText",
 CellID->535686806,ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[273]:=",
 CellID->851721286,ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 1,
       0, 1, 0, -1, 0}}]]]]], "Output",
 CellLabel->"Out[273]//MatrixForm=",
 CellID->98855257,ExpressionUUID->"1e1aae71-e28a-476a-b576-b7f2b8fd146d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "TechNoteSection",
 CellTags->"Section14",
 CellID->1455445268,ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->214055128,ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->167122186,ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellTags->"Section15",
 CellID->1829879946,ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13"],

Cell[TextData[{
 "Consider two qubits that are once again called control and target qubits. \
Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "7df1b7ef-7bf9-4bb2-8e0a-c82a10de8dd1"],
 " be a unitary operator on the target qubit. The controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d6c81065-e5e8-45aa-8e8b-48a9d091c461"],
 " gate is a unitary operator on the two-qubit Hilbert space defined, \
analogously to CNOT, by"
}], "TechNoteText",
 CellID->678943735,ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["U", "c"], 
        TemplateBox[{"t"},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "b45eb968-4f6f-4d2e-aac4-e40cc028b521"],
 "."
}], "TechNoteText",
 CellID->1426737634,ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8"],

Cell["or equivalently,", "TechNoteText",
 CellID->377012236,ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"0"},
        "Bra"], "\[CircleTimes]", "I"}]}], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"1"},
        "Bra"], "\[CircleTimes]", "U"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"cd25fdd5-a143-4446-9955-56a71898c384"],
 "."
}], "TechNoteText",
 CellID->1367891802,ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165"],

Cell[TextData[{
 "If the control qubit is in |0\:27e9, then it does nothing. On the other \
hand, if the control qubit is in |1\:27e9, then it operates unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ee6fbbb7-d521-4262-b0a5-534ed0a3ddee"],
 " on the target qubit."
}], "TechNoteText",
 CellID->1345075079,ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b"],

Cell["\<\
\tAnalogously to the CNOT gate, the matrix representation of the \
controlled-unitary gate is thus given by\
\>", "TechNoteText",
 CellID->819163313,ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"]},
       {"0", "0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55c085e5-4781-4627-a020-167c0d577b9c"],
 " ."
}], "TechNoteText",
 CellID->116500784,ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"i", " ", "j"}]], TraditionalForm]],ExpressionUUID->
  "67b2053c-b485-4ced-8776-ec6fe6dff079"],
 " are the elements of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "e6087d59-fe37-45d4-9881-210a8577b0c0"],
 "."
}], "TechNoteText",
 CellID->1671074271,ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48"],

Cell["\<\
\tIn quantum circuit model, a controlled-unitary gate is depicted as\
\>", "TechNoteText",
 CellID->1953344721,ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
      LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->118.8,
    PlotRangePadding->Scaled[0.025]], "."}]}]], "Picture",
 CellID->954137231,ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329"],

Cell["\<\
The filled circle connected to the quantum circuit element on the target \
qubit indicates the conditional operation of the element conditioned on the \
state of the control qubit.\
\>", "TechNoteText",
 CellID->924049268,ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1"],

Cell[TextData[{
 "For demonstration, consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,None]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "TechNoteMathCaption",
 CellID->2041795819,ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1821134520,ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->2025053772,ExpressionUUID->"aad4f053-1c32-450a-a1c4-597e2fe743ae"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "TechNoteMathCaption",
 CellID->1443037598,ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[7]:=",
 CellID->1600084015,ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->118.8,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[7]=",
 CellID->2030390600,ExpressionUUID->"06ed66f7-8e68-4751-876b-7d7fe1c70743"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate  in terms of the \
Pauli operators.\
\>", "TechNoteMathCaption",
 CellID->378680471,ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "qc", "]"}]], "Input",
 CellLabel->"In[8]:=",
 CellID->1488630036,ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->463603589,ExpressionUUID->"0d225d53-f610-4243-ad57-8b7eb51f2cf7"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "TechNoteMathCaption",
 CellID->641929970,ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[9]:=",
 CellID->2106646909,ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "+", 
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "-", 
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[11]//TableForm=",
 CellID->1590542250,ExpressionUUID->"c4e32268-0795-468c-b7a9-e5b50038df00"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "TechNoteMathCaption",
 CellID->1736236263,ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"in", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[12]:=",
 CellID->915076805,ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[13]=",
 CellID->451820721,ExpressionUUID->"4af6f8d7-84ea-4cd7-87aa-7ccec4f8af33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[14]:=",
 CellID->1955961279,ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[15]=",
 CellID->895924620,ExpressionUUID->"c88b8772-373c-4d69-b547-063d4f695c44"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Acquisition", "Subsection",
 CellTags->"Section16",
 CellID->715838931,ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7"],

Cell[TextData[{
 "An important aspect of a controlled-unitary operator is that it induces \
relative phase shifts on the control qubit when the target qubit has been \
prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d72c7574-e55f-417f-84bc-b2adcf4fe225"],
 ". At first glace, it may sound counterintuitive since the definition given \
above seems to indicate that it changes only the target qubit depending on \
the state of the control qubit and keeps the latter intact. This is another \
feature distinguishing quantum gates from their classical counterparts."
}], "TechNoteText",
 CellID->901522823,ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b"],

Cell[TextData[{
 "\tLet us take a closer look to see how this works. Prepare the control \
qubit in a superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Psi]"},
     "Ket"], "=", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     TemplateBox[{"1"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "04b33533-0562-4608-b725-a96fec102669"],
 " and the target qubit in an eigenstate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d991046d-2cc8-41b9-a6b5-85cf5e124ead"],
 " of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "6b111da1-5fab-4ed2-a869-76d903e38487"],
 " with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"2b44b691-1c48-49c9-baf3-c1f5dcd541b9"],
 ". The controlled-unitary gate transforms the state to"
}], "TechNoteText",
 CellID->1396956576,ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"\[Psi]"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Phi]"},
      "Ket"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"\[Phi]"},
         "Ket"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], ")"}], 
      "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d52d9159-830d-4d51-a642-e0b209cbb6bd"],
 " ."
}], "TechNoteText",
 CellID->210460181,ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d"],

Cell[TextData[{
 "This feature is extended to multi-control unitary gates and plays a crucial \
role in many quantum algorithms. In particular, the ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumPhaseEstimation"],
 " algorithm is a direct consequence of this feature."
}], "TechNoteText",
 CellID->298695458,ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4"],

Cell[TextData[{
 "For demonstration, consider the phase gate. Recall that state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"c8b87316-432d-4b48-a729-bbc90d23c883"],
 " is an eigenstate of it with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"840f2f8e-aaae-4feb-84ba-8e7fee414a46"],
 "."
}], "TechNoteMathCaption",
 CellID->1505279567,ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[78]:=",
 CellID->1876320909,ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c"],

Cell[BoxData[
 RowBox[{"Phase", "[", 
  RowBox[{"\[Phi]", ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]]}], "]"}]], "Output",
 CellLabel->"Out[78]=",
 CellID->1171583325,ExpressionUUID->"617ee0c5-78d0-4fc7-9554-e0cba471f638"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, 1] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[79]//MatrixForm=",
 CellID->523383932,ExpressionUUID->"471394cf-0ea2-4265-85a8-ac25b3113299"]
}, Open  ]],

Cell["We are interested in the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->774865820,ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "op", "]"}]}], "Input",
 CellLabel->"In[80]:=",
 CellID->2117896949,ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"\[Phi]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->118.8,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[81]=",
 CellID->1890287755,ExpressionUUID->"541334a7-5d91-404c-a569-0ea0fe297db5"]
}, Open  ]],

Cell["\<\
Prepare the target qubit in the eigenstate with a finite phase shift. In \
addition, prepare the control qubit in a linear superposition of the \
computational basis states in order to pick up the phase shift.\
\>", "TechNoteMathCaption",
 CellID->193224567,ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "->", "1"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "op"}], 
   "]"}]}]], "Input",
 CellLabel->"In[82]:=",
 CellID->1062235589,ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{2, -2.5}, {
       2, -0.5}}]]}, {LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"\[Phi]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->190.79999999999998`,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[82]=",
 CellID->265239778,ExpressionUUID->"ca0e74e6-6bc9-495f-8ff6-5fa3bf723904"]
}, Open  ]],

Cell["\<\
Observe that the state does not change on the target qubit while the phase \
shift induced by the phase gate has been picked up by the state in the \
control qubit.\
\>", "TechNoteMathCaption",
 CellID->581406343,ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "//", "KetFactor"}], "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[83]:=",
 CellID->1127477995,ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c"],

Cell[BoxData[
 FractionBox[
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}], ")"}], "\[CircleTimes]", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}],
   HoldForm], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[84]=",
 CellID->406828334,ExpressionUUID->"5c405cdb-f62d-47a1-8abd-14ab11c8bcfc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Conditional Operation", "Subsection",
 CellTags->"Section17",
 CellID->1379525988,ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff"],

Cell[TextData[{
 "The CNOT gate and the controlled-unitary gate can be combined to achieve a \
variety of conditional gate operations. For example, consider a system \
consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2b922721-8f59-4475-9ecf-8081bcea1f50"],
 " qubits and a target register of a single qubit. Suppose that you want to \
operate a unitary gate ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4a95e72d-7750-4e2d-a2c8-9969571d6e6b"],
 " on the target qubit only when an odd number of the control qubits is set \
to |1\:27e9,"
}], "TechNoteText",
 CellID->1459827304,ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", 
        RowBox[{
         SubscriptBox["c", "1"], "\[CirclePlus]", 
         SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
         "\[CirclePlus]", 
         SubscriptBox["c", "n"]}]], 
       TemplateBox[{"t"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "c961d966-d0ec-45a8-b10c-fe492251e4c2"],
 " ."
}], "TechNoteText",
 CellID->316831353,ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8"],

Cell[TextData[{
 "First, operate the CNOT gates consecutively with the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "\[Minus]", " ", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"384b0335-b827-4145-becb-ab9f85d6d828"],
 " qubits in the control register as the control qubit and the last qubit in \
the control register as the target qubit. This transforms the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "1c7bb7e1-187a-4b4d-8a6d-64bba07245c8"],
 " qubit to",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
       "\[CirclePlus]", 
       SubscriptBox["c", "n"]}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "bb8c910c-1b1c-453e-bde2-bbf806d46593"],
 ". Then, the desired operation is implemented by applying the controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "798627e2-491f-450f-a1ad-8c50cb24997d"],
 " gate controlled by the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "c34cdc58-10ba-4e1a-a673-f9d4b09fb9e4"],
 " qubit. To get the control qubits back to the original state, operate the \
CNOT gates in the reverse order. Overall, the following quantum circuit \
implements the conditional operation"
}], "TechNoteText",
 CellID->1372588958,ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -4}, {6, -4}}, {{
     0, -5}, {6, -5}}}], InsetBox[
     StyleBox["\<\"\[VerticalEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -4}, {3, -5}}], DiskBox[{3, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -2}, {4, -4}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
         4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -4}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -4}, {5.266666666666667, -4}}, {{
         5, -4.266666666666667}, {5, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]], "."}]], "TechNoteText",
 TextAlignment->Center,
 CellID->833281032,ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a"],

Cell["\<\
This method is used to implement a multi-control unitary gate based on the \
Gray code.\
\>", "TechNoteText",
 CellID->1213442737,ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9"],

Cell["\<\
\tAs a demonstration, consider a three-qubit control register. Suppose that \
we want to operate a rotation around the y-axis on the target qubit.\
\>", "TechNoteText",
 CellID->1827368847,ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"Most", "[", "ss", "]"}], ",", 
       RowBox[{"Last", "@", "ss"}]}], "]"}], ",", "List"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", "cnot"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "$n", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Reverse", "[", "cnot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[63]:=",
 CellID->1424575782,ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
    LineBox[{{2, -2}, {2, -3}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -3}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
        4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
    LineBox[{{5, -1}, {5, -3}}], 
    DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
        5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[67]=",
 CellID->549987671,ExpressionUUID->"0872f49a-1870-4ecd-853e-a700c27d7e99"]
}, Open  ]],

Cell["\<\
Note the way the logical basis states are transformed through the above \
quantum circuit.\
\>", "TechNoteText",
 CellID->873169809,ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[75]:=",
 CellID->1609219912,ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "+", 
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "+", 
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "+", 
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "+", 
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[77]//TableForm=",
 CellID->750010666,ExpressionUUID->"64f4def1-ea67-4e9b-8eba-3f8dd7946f0f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Elementary Gates", "Subsection",
 CellTags->"Section18",
 CellID->1847739219,ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15"],

Cell["\<\
How can you implement a controlled-unitary gate? The operation involves only \
two qubits, and in principle, it should be possible to implement any specific \
controlled-unitary gate. However, the requirements for a physical \
implementation of two-qubit gates is far more difficult to fulfill on \
realistic systems than for single-qubit gates. Fortunately, any \
controlled-unitary gate can be implemented using only the CNOT gate and \
single-qubit gates. This is one of the basic steps in establishing universal \
quantum computation.\
\>", "TechNoteText",
 CellID->192034466,ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081"],

Cell[TextData[{
 "\tLet ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "72ee3eec-70a2-4218-a514-c4b738fe7643"],
 " be a unitary gate on the second (target) qubit controlled by the first \
(control) qubit. Suppose that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "482d7c8e-0411-496b-8c03-b7622118e9d2"],
 " has Euler angles \[Alpha], \[Beta], and \[Gamma] and an additional phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], TraditionalForm]],
  ExpressionUUID->"f01f05ed-7b40-4560-9389-996b1c3a264d"],
 ", "
}], "TechNoteText",
 CellID->2002832268,ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"1ceb2f79-208c-43ea-b423-55cfb3cd22d4"],
 " ."
}], "TechNoteText",
 CellID->1943245198,ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9"],

Cell[TextData[{
 "Then one can always find three unitary operators ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "13fc0fd8-64b4-4a1b-91cf-e35261027499"],
 ", ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "d25d1512-d841-4f79-8ecf-3aa53afe092a"],
 ", and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "ed6c3a87-b67c-4830-b6bc-ee86b25be7b7"],
 " such that"
}], "TechNoteText",
 CellID->1190739210,ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "A", " ", "X", " ", "B",
      " ", "X", " ", "C"}]}], TraditionalForm]],ExpressionUUID->
  "74ab9d9c-f73d-409c-b8b4-06573b856aa5"],
 " ,\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "B", " ", "C"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"91f71196-5736-41cc-b04f-8c1e7c12218c"],
 " ,"
}], "TechNoteText",
 CellID->353796077,ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9"],

Cell["\<\
where X is the Pauli X operator. More explicitly, a common choice is\
\>", "TechNoteText",
 CellID->2015931243,ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{"\[Beta]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"faa23ecb-b643-490f-9a46-588cf6441d7f"],
 " ,"
}], "TechNoteText",
 CellID->906902382,ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}], "/", "2"}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "4654d436-6508-4610-abb5-0be68d6d88fc"],
 " ,"
}], "TechNoteText",
 CellID->1616891515,ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", "\[Gamma]"}], ")"}]}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"d0e584d1-6b09-480b-bdbc-36ca96bc9da7"],
 " ."
}], "TechNoteText",
 CellID->837623467,ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"y", "/", "z"}]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{"X", " ", 
     RowBox[{
      SubscriptBox["U", 
       RowBox[{"y", "/", "z"}]], "(", 
      RowBox[{"-", "\[Phi]"}], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"2b861489-f486-4764-a02d-ad68575af15c"],
 " for any \[Phi], the above choice satisfies the desired properties. These \
properties imply that the controlled-unitary gate can be implemented as in \
the following quantum circuit"
}], "TechNoteText",
 CellID->1182303784,ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->118.8,
   PlotRangePadding->Scaled[0.025]], "=", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[ExponentialE]\\), \\(\
\[ImaginaryI]\\\\ \[CurlyPhi]\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->313511997,ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b"],

Cell[TextData[{
 "where the last gate on the first qubit is the relative phase shift by \
\[CurlyPhi], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"04c67e1e-6647-4538-bbb6-b9def3f5571a"],
 ". Indeed, when the control qubit is in |0\:27e9, the two CNOT gates in the \
middle do nothing, and the combined operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", " ", "B", " ", "C"}], TraditionalForm]],ExpressionUUID->
  "656b77d4-b90f-4de0-b5b0-b6c3dc41a145"],
 " on the target qubit ends up with the identity operator. With the control \
qubit in |1\:27e9, on the other hand, the two CNOT gates are operational and \
the overall operator on the target qubit becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "X", " ", "B", " ", "X", " ", "C"}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], "U"}]}], 
   TraditionalForm]],ExpressionUUID->"07005521-c279-4c9c-8d8c-bafd3d51d026"],
 ", where the phase factor is canceled by the opposite phase from the control \
qubit."
}], "TechNoteText",
 CellID->1418747488,ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd"],

Cell["\<\
For demonstration, consider a unitary matrix to be applied conditionally on \
the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1378098175,ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[263]:=",
 CellID->1028095504,ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"3", "/", "4"}]]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[264]//MatrixForm=",
 CellID->1504631305,ExpressionUUID->"38e50d82-cf69-4b2e-82d3-6c116693ae9a"]
}, Open  ]],

Cell["We want to implement the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->1646790355,ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[265]:=",
 CellID->1153761970,ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->118.8,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[266]=",
 CellID->1279366376,ExpressionUUID->"29269fdb-9ca7-4f90-ad2d-3d9a80ab5f57"]
}, Open  ]],

Cell["\<\
First, find the Euler angles of the unitary operator and the global phase \
factor.\
\>", "TechNoteMathCaption",
 CellID->1240176371,ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"det", "=", 
   RowBox[{"Det", "[", "mat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "det", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"mat", "/", 
    RowBox[{"Sqrt", "[", "det", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[267]:=",
 CellID->167989615,ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "4"]}], ",", 
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "4"]}], "}"}]], "Output",
 CellLabel->"Out[269]=",
 CellID->2072346988,ExpressionUUID->"d6668f09-b22d-4101-8dab-519a11fbfd12"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", \
"TechNoteMathCaption",
 CellID->833485781,ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[270]:=",
 CellID->359691886,ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c"],

Cell["Finally, construct the equivalent quantum circuit model.", \
"TechNoteMathCaption",
 CellID->175061697,ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellLabel->"In[274]:=",
 CellID->209345089,ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"C\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"B\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -2}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
        4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"A\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
     StyleBox["\<\"\[Phi]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {6, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->298.8,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[274]=",
 CellID->1268149688,ExpressionUUID->"682c0b12-e7e2-4c52-b337-d477fda8eac9"]
}, Open  ]],

Cell["Check the result.", "TechNoteMathCaption",
 CellID->2073812678,ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "//", "Chop"}]], "Input",
 CellLabel->"In[275]:=",
 CellID->1395051790,ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[275]=",
 CellID->260320349,ExpressionUUID->"af2551ad-217a-4e6d-9c10-df9019d64bda"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "TechNoteSection",
 CellTags->"Section19",
 CellID->1476129218,ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[276]:=",
 CellID->384188579,ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[277]:=",
 CellID->1721604371,ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408"],

Cell[TextData[{
 "Here we ",
 ButtonBox["decompose",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/TwoLevelDecomposition"],
 " an arbitrary two-qubit unitary gate into factors of controlled-unitary \
gates only. This is a remarkable advantage when one tries to build a quantum \
computer as you can just focus on how to implement the CNOT gate and \
single-qubit gates. Moreover, the same idea eventually leads to the proof of \
universal quantum computation on a larger system."
}], "TechNoteText",
 CellID->1572676782,ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c"],

Cell[CellGroupData[{

Cell["Two-Level Unitary Transforms", "Subsection",
 CellTags->"Section20",
 CellID->749947798,ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c"],

Cell[TextData[{
 "Consider an arbitrary two-qubit unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "74bbef41-b239-4256-b5d5-f4bb071f8944"],
 ". In the logical basis, it is represented by a unitary matrix"
}], "TechNoteText",
 CellID->791116743,ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "13"], 
        SubscriptBox["U", "14"]},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "23"], 
        SubscriptBox["U", "24"]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubscriptBox["U", "33"], 
        SubscriptBox["U", "34"]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubscriptBox["U", "43"], 
        SubscriptBox["U", "44"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "49d60377-f5d7-4dc8-bd55-98e85746207e"],
 " ."
}], "TechNoteText",
 CellID->1227841024,ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e"],

Cell[TextData[{
 "To break the unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b52a1ed7-0ba7-40e2-bf4c-cf1f5def16ab"],
 " down into more elementary quantum logic gates, we make use of ",
 StyleBox[ButtonBox["two-level unitary transformations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/TwoLevelU"],
  FontSlant->"Italic"],
 ". A two-level unitary transformation is a unitary operation with matrix \
representation that acts only on the two columns and rows of other matrices \
or column or row vectors. The descriptive word \
\[OpenCurlyDoubleQuote]two-level\[CloseCurlyDoubleQuote] should not be \
confused with \[OpenCurlyDoubleQuote]two-qubit\[CloseCurlyDoubleQuote]. A \
two-level transformation acts on multiple qubits, but it just transforms only \
two rows or columns at a time in the representation."
}], "TechNoteText",
 CellID->1153726345,ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704"],

Cell["\<\
\tLet us start with a two-level unitary transformation of the form\
\>", "TechNoteText",
 CellID->1048831652,ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "13", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         SubscriptBox["U", "14"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "14", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d87e6b00-b56f-4bd7-803c-399755863cf5"],
 " "
}], "TechNoteText",
 CellID->1167800588,ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalN]", "1"], ":=", 
    SqrtBox[
     RowBox[{"|", 
      SubscriptBox["U", "13"], 
      SuperscriptBox["|", "2"], 
      RowBox[{"+", 
       RowBox[{"|", 
        SubscriptBox["U", "14"], 
        SuperscriptBox["|", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "3d868cb0-ebb3-4c78-8ddc-f1586c530df3"],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "1"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "1", "\[Dagger]"], 
      SubscriptBox["T", "1"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"1f35209a-1fbf-48f3-884f-67e21e6eb28c"],
 ". When it multiplies ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0055e7ce-786a-4e76-a5cf-7513877c3e78"],
 " from the right, it does not change the first two columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "feffd3c2-fd2b-499c-902f-353dd544563e"],
 ". It only alters the last two columns, and hence the name \
\[OpenCurlyQuote]two-level transformation\[CloseCurlyQuote]. The elements in \
the lower-right sub-block of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "de482d28-90a1-4a5c-a353-187cebeb0110"],
 " have been chosen so that the first element of the last column is \
canceled:"
}], "TechNoteText",
 CellID->1371432583,ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubsuperscriptBox["U", "13", 
         RowBox[{" ", "\[Prime]"}]], "0"},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubsuperscriptBox["U", "23", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubsuperscriptBox["U", "33", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubsuperscriptBox["U", "43", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "229bae80-0c62-4782-80d7-bb21170e88c2"],
 " ."
}], "TechNoteText",
 CellID->725439230,ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06"],

Cell["\<\
Now take another two-level unitary transformation, this time, of the form\
\>", "TechNoteText",
 CellID->1192474591,ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "2"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "12", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", "\[Prime]"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", 
           RowBox[{"\[Prime]", "*"}]}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "933ff944-3d93-4984-8319-45b52f0f25c3"],
 " ,"
}], "TechNoteText",
 CellID->1603057133,ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "2"], TraditionalForm]],ExpressionUUID->
  "42f4f8eb-8a60-4f33-83b1-ef413e77ab43"],
 " is a normalization factor like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "1"], TraditionalForm]],ExpressionUUID->
  "b145126e-e49a-4ffe-87d5-cdb331e6d340"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "2"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "2", "\[Dagger]"], 
      SubscriptBox["T", "2"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"9779262d-c14b-4c29-b0c0-8b11b570a42d"],
 ". It removes ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "13", 
    RowBox[{" ", "\[Prime]"}]], TraditionalForm]],ExpressionUUID->
  "e0a76015-ec0e-46ac-b6cf-de3ff7920c4f"],
 " while keeping the first and last column as they are:"
}], "TechNoteText",
 CellID->251399069,ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubsuperscriptBox["U", "12", "\[DoublePrime]"], "0", "0"},
       {
        SubscriptBox["U", "21"], 
        SubsuperscriptBox["U", "22", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubsuperscriptBox["U", "32", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubsuperscriptBox["U", "42", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "979aec3f-ddc0-42d0-893c-fc1f3e50ff73"],
 " ."
}], "TechNoteText",
 CellID->1163819034,ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720"],

Cell["Similarly, we go further with the two-level unitary matrix", \
"TechNoteText",
 CellID->1025447562,ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "3"], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["U", "11", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         SubsuperscriptBox["U", "12", "\[DoublePrime]"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {
        RowBox[{
         SubsuperscriptBox["U", "12", 
          RowBox[{"\[DoublePrime]", "*"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "11"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dae78453-2ab9-4d05-ae48-8aae8af0a905"],
 " "
}], "TechNoteText",
 CellID->1140907359,ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb"],

Cell[TextData[{
 "to remove element ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "12", "\[DoublePrime]"], TraditionalForm]],
  ExpressionUUID->"58b02cc1-973b-4a66-bcf7-475a5111e0b7"],
 " and get"
}], "TechNoteText",
 CellID->348498650,ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "3"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["U", "11", "\[Prime]\[Prime]\[Prime]"], "0", "0", 
        "0"},
       {"0", 
        SubsuperscriptBox["U", "22", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "32", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "42", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "505f2971-b178-4f6c-846a-f26ff01a3e47"],
 " ."
}], "TechNoteText",
 CellID->1028905181,ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb"],

Cell[TextData[{
 "At this stage, all elements except for the first of the first column vanish \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "21", "\[Prime]\[Prime]\[Prime]"], "=", 
    RowBox[{
     SubsuperscriptBox["U", "31", "\[Prime]\[Prime]\[Prime]"], "=", 
     RowBox[{
      SubsuperscriptBox["U", "41", "\[Prime]\[Prime]\[Prime]"], "=", 
      "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "06ee66e5-d340-4277-8501-c84a3cdeb493"],
 ") the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", 
    SubscriptBox["T", "1"], 
    SubscriptBox["T", "2"], 
    SubscriptBox["T", "3"]}], TraditionalForm]],ExpressionUUID->
  "9fc42948-ccec-4b1f-9f6b-3150b50e591b"],
 " is a unitary matrix. "
}], "TechNoteText",
 CellID->1271051423,ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70"],

Cell["\<\
\tRepeating the procedure, we can remove all off-diagonal elements to get\
\>", "TechNoteText",
 CellID->1541429652,ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "L"]}], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "8ea5b480-8693-4958-ad10-aae38ff8a622"],
 " ."
}], "TechNoteText",
 CellID->1712927403,ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351"],

Cell[TextData[{
 "As Tj are all unitary, it enables us to rewrite ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "75eab368-2039-46a2-8453-a51d75dee9a1"],
 " in a combination of two-level unitary transformations, that is,"
}], "TechNoteText",
 CellID->5090539,ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "=", 
    RowBox[{
     SubsuperscriptBox["T", "L", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "2", "\[Dagger]"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}]}], TraditionalForm]],
  ExpressionUUID->"c92fea36-6858-4b54-9a85-a0bea3369da5"],
 " ."
}], "TechNoteText",
 CellID->1804826740,ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83"],

Cell["\<\
For demonstration, consider a Hermitian operator on a two-qubit system. \
Physically, it corresponds to a transverse-field Ising model.\
\>", "TechNoteMathCaption",
 CellID->516505305,ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "H", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[20]:=",
 CellID->775759961,ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"]}]], "Output",
 CellLabel->"Out[20]=",
 CellID->1281576332,ExpressionUUID->"b18bfdb8-5555-417b-aeeb-743f02c1c001"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellLabel->"Out[21]//MatrixForm=",
 CellID->192432514,ExpressionUUID->"7ba48906-a98c-4e8e-92f5-431fddd951a5"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "TechNoteMathCaption",
 CellID->595736468,ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[22]:=",
 CellID->974055362,ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], ")"}]}]]], "Output",
 CellLabel->"Out[22]=",
 CellID->271234817,ExpressionUUID->"bf153f84-f054-49b7-93f2-fdec82ecf04b"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "TechNoteMathCaption",
 CellID->1817782849,ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[23]:=",
 CellID->1373980921,ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[24]//MatrixForm=",
 CellID->699760199,ExpressionUUID->"2631fea2-b7ce-498b-9928-60b228f006ff"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["TwoLevelU", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->642635412,ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[25]:=",
 CellID->1078108721,ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            FractionBox["3", "2"], "+", 
            FractionBox[
             RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
           SqrtBox["7"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}], ",", 
         SqrtBox[
          FractionBox["14", "19"]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["14", "19"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[26]=",
 CellID->2056629583,ExpressionUUID->"9ea7b93c-eadb-4874-ac87-c145bfbd71ec"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["TwoLevelU", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "TechNoteMathCaption",
 CellID->1155771237,ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[27]:=",
 CellID->1057593144,ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[27]=",
 CellID->1519566621,ExpressionUUID->"81d300b1-b34f-42bf-8574-f3a50bbeff4a"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "TechNoteMathCaption",
 CellID->1969536942,ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "twl"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[28]:=",
 CellID->694449336,ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[29]//MatrixForm=",
 CellID->160171015,ExpressionUUID->"b8f42fae-c2ef-4f21-a510-c49af35cb17f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Two-Level Unitary Transformations with Controlled-Unitary Gates\
\>", "Subsection",
 CellTags->"Section22",
 CellID->1363502801,ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0"],

Cell["\<\
We are still to express the two-level unitary transformations in terms of \
controlled-unitary gates. The two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->593579270,ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e083befc-a7e0-4768-988b-1f27cc7af22e"],
 " "
}], "TechNoteText",
 CellID->1225250575,ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3"],

Cell["\<\
is already in the form of the matrix representation of a controlled-unitary \
gate, and just corresponds to a single controlled-unitary\
\>", "TechNoteText",
 CellID->565722942,ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "8f633567-5d40-438e-aba9-efed74c06e17"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "2d010309-ce55-49c2-83d0-d75b6330abac"],
 "."
}], "TechNoteText",
 CellID->1195380925,ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963"],

Cell["A two-level unitary matrix of the form", "TechNoteText",
 CellID->1057688790,ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "6c480a58-bff4-4f80-9c35-7dda6b9ea4c8"],
 " "
}], "TechNoteText",
 CellID->1853347311,ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec"],

Cell["\<\
also corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged. Here, the first qubit is the target qubit and the \
second the control qubit:\
\>", "TechNoteText",
 CellID->2105439889,ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e38a6c68-2602-4891-bc34-1311b80dde5d"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "4d558d0d-ffca-4755-8bde-b9812f09c2c1"],
 "."
}], "TechNoteText",
 CellID->2040162804,ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b"],

Cell["\<\
\tMore complicated is the two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->144855179,ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "37c16ac8-7e58-4468-b68c-6d10cb79975f"],
 " . "
}], "TechNoteText",
 CellID->1482021402,ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3"],

Cell["\<\
As it affects both qubits, it cannot be represented by a single \
controlled-unitary gate. However, it is possible to bring it to the second of \
the above two forms by simultaneously exchanging the last two columns and \
rows.\
\>", "TechNoteText",
 CellID->1818365508,ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], "0", 
        SubscriptBox["U", "12"]},
       {"0", "0", "1", "0"},
       {"0", 
        SubscriptBox["U", "21"], "0", 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7a86ab8c-235e-4dd8-8ed7-c6ce57b24b88"],
 " . "
}], "TechNoteText",
 CellID->429312499,ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f"],

Cell["\<\
The specified exchanges correspond to flipping the bit values of the second \
qubit only when the first qubit has a value of 1, and they can be implemented \
by applying the CNOT gate with the first qubit as the control qubit and the \
second qubit as the target qubit. These observations lead to the following \
equivalence,\
\>", "TechNoteText",
 CellID->2057600420,ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "fd0b029d-8d4b-4398-8da1-87506b4b2332"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "3cdee78c-a236-4778-a65c-f5b50fb80706"],
 ". "
}], "TechNoteText",
 CellID->1161091299,ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd"],

Cell["\<\
which allows us to implement the two-level unitary transformation with two \
CNOT gates and a controlled-unitary gate.\
\>", "TechNoteText",
 CellID->277562004,ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b"],

Cell["\<\
\tOf course, the way is not unique. For example, it is also possible to bring \
the same two-level unitary matrix to the first two-level unitary form, this \
time, by simultaneously exchanging the second and fourth columns and rows.\
\>", "TechNoteText",
 CellID->650119944,ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "21"]},
       {"0", "0", 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "11"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "10683ca9-7618-42dc-a15d-b71e59a3adf7"],
 " . "
}], "TechNoteText",
 CellID->169102872,ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4"],

Cell[TextData[{
 "These exchanges correspond to flipping the bit values of the first qubit \
only when the second qubit has a value of 1, that is, to applying the CNOT \
gate with the second qubit as the control qubit and the first qubit as the \
target qubit. Note that in this case, unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4084441d-9e5a-4132-baea-8f23cd937a23"],
 " itself is modified through the exchanges, and the rows and columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "32a80573-6a45-46d2-8c11-76524149bbfd"],
 " are exchanged. This is equivalent to the basis change by the Pauli X \
matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", "\[RightArrow]", " ", 
     SuperscriptBox[
      RowBox[{"U", " "}], "\[Prime]"]}], " ", "=", " ", 
    RowBox[{"X", " ", "U", " ", "X"}]}], TraditionalForm]],ExpressionUUID->
  "7c5991a1-4d8d-48e2-8f28-7d190e4d8098"],
 ". Putting all together, the two-level unitary matrix is implemented as"
}], "TechNoteText",
 CellID->991104723,ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "89f4fe62-4810-4870-b7fa-c07e8a70e33c"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U'\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b1853fbd-2d28-48c7-81bc-05f3cde24749"],
 ". "
}], "TechNoteText",
 CellID->1613913329,ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b"],

Cell["\<\
\tIn a similar manner, we can implement another form of two-level unitary \
matrix as\
\>", "TechNoteText",
 CellID->175375246,ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["U", "11"], "0", "0", 
       SubscriptBox["U", "12"]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       SubscriptBox["U", "21"], "0", "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "f5f73d4b-faa8-47cd-99b4-95b842181aa8"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->295.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "9af252a6-d7fe-4869-ae7f-3fceeb977059"],
 "= ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->367.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "88048059-bb49-4867-aa3c-b3d2e0a1135c"],
 "."
}], "TechNoteText",
 CellID->1184195838,ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad"],

Cell["\<\
\tFor a demonstration, consider a single-qubit rotation around the y-axis.\
\>", "TechNoteText",
 CellID->2048492517,ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[126]:=",
 CellID->555904515,ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[127]//MatrixForm=",
 CellID->1533319155,ExpressionUUID->"662f35ad-a354-4351-9f3b-4b2c107324ac"]
}, Open  ]],

Cell["\<\
This is the two-level unitary transformation to be implemented with \
elementary gates.\
\>", "TechNoteText",
 CellID->691274085,ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"Matrix", "[", "U", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[128]:=",
 CellID->357016325,ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], 1, 1, Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[129]//MatrixForm=",
 CellID->304064557,ExpressionUUID->"b226fca4-48a2-46dd-93a6-03781efd2e1a"]
}, Open  ]],

Cell["This quantum circuit shows one implementation.", "TechNoteText",
 CellID->1549413286,ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[135]:=",
 CellID->602394280,ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -2}}], 
    DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
        7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{3.6, 3.6}, {5, 5}},
  ImageSize->295.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[135]=",
 CellID->1202752002,ExpressionUUID->"7f9bc3b4-fa99-4833-9220-ab11c046a378"]
}, Open  ]],

Cell["This is another implementation.", "TechNoteText",
 CellID->389328403,ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[136]:=",
 CellID->59796812,ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], 
    DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
        8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {9, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{3.6, 3.6}, {5, 5}},
  ImageSize->367.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[136]=",
 CellID->2130156135,ExpressionUUID->"e970626b-bc5f-4595-a47b-b1f46828ace1"]
}, Open  ]],

Cell["\<\
Check the equivalence of the two-level unitary matrix and the implementations\
\
\>", "TechNoteText",
 CellID->834281808,ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc2", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[139]:=",
 CellID->853615793,ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[139]//MatrixForm=",
 CellID->1529870991,ExpressionUUID->"baa695c6-566d-4910-bb28-f0a002f38d37"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[140]//MatrixForm=",
 CellID->720040206,ExpressionUUID->"a9228a82-8548-458a-866f-5cf7f54f101e"]
}, Open  ]],

Cell[TextData[{
 "\tSo far, we have determined the implementations of 4 \[Times] 4 two-level \
unitary matrices of different forms just by inspection, that is, in an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " manner. For more than two qubits, the size of the two-level unitary \
matrices is much larger, and it is difficult to find proper implementations \
in such a way. Fortunately, there is a ",
 ButtonBox["systematic way based on the Gray code",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/GrayTwoLevelU"],
 "."
}], "TechNoteText",
 CellID->645391397,ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellTags->"Section23",
 CellID->153308382,ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9"],

Cell["\<\
In the above, we have shown that an arbitrary two-qubit unitary gate can be \
carried out by first decomposing its matrix representation into two-level \
unitary matrices and then implementing the two-level unitary matrices by \
means of the CNOT and controlled-unitary gates. Here we demonstrate the whole \
procedure.\
\>", "TechNoteText",
 CellID->1821083521,ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6"],

Cell["\<\
Consider a two-qubit model. Physically, it describes two qubits coupled with \
each other through an Ising-type couping and subject to an external magnetic \
field..\
\>", "TechNoteMathCaption",
 CellID->1013800403,ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->808117923,ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1422201642,ExpressionUUID->"6f9f5f4e-184e-4258-8e42-ddd59c3129bc"]
}, Open  ]],

Cell["\<\
We are interested in simulating the time-evolution operator governed by the \
above Hamiltonian.\
\>", "TechNoteMathCaption",
 CellID->322701359,ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", "*", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[5]:=",
 CellID->1245532038,ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], ")"}]}]]], "Output",
 CellLabel->"Out[5]=",
 CellID->841991803,ExpressionUUID->"6f3803af-87a4-40d1-8cad-3a178bd73865"]
}, Open  ]],

Cell["\<\
This is the 4\[Times]4 unitary matrix to implement in terms of elementary \
gates.\
\>", "TechNoteMathCaption",
 CellID->730080199,ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"U", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1883829282,ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1120532934,ExpressionUUID->"a9ff9460-ef83-4a95-94dc-f4b12655ea7e"]
}, Open  ]],

Cell["\<\
First, decompose the 4\[Times]4 unitary matrix into the two-level unitary \
matrices.\
\>", "TechNoteMathCaption",
 CellID->2133759026,ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "twl"}]}]}], "Input",
 CellLabel->"In[8]:=",
 CellID->1258528729,ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["5", "14"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "14"]}], 
          SqrtBox["2"]]}], 
        FractionBox[
         RowBox[{"3", " ", 
          SqrtBox["19"]}], "14"]},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SqrtBox["19"]}], "14"]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["5", "14"], "-", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "14"]}], 
          SqrtBox["2"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[-5, 14], Rational[-5, 14]] 2^Rational[-1, 2], 
         Rational[3, 14] 19^Rational[1, 2], 
         Complex[Rational[-5, 14], Rational[5, 14]] 2^Rational[-1, 2], 
         Rational[-3, 14] 19^Rational[1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
          SqrtBox["2"]]}], 
        FractionBox[
         SqrtBox["19"], "6"], "0", "0"},
       {
        RowBox[{"-", 
         FractionBox[
          SqrtBox["19"], "6"]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
          SqrtBox["2"]]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[Rational[-1, 2], Rational[-5, 6]] 2^Rational[-1, 2], 
         Rational[1, 6] 19^Rational[1, 2], 
         Complex[Rational[-1, 2], Rational[5, 6]] 2^Rational[-1, 2], 
         Rational[-1, 6] 19^Rational[1, 2], 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[-1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1476939964,ExpressionUUID->"7347690f-12cf-412c-9715-34677d5218a3"]
}, Open  ]],

Cell[TextData[{
 "Next, rewrite the two-level unitary matrices in terms of the CNOT and \
controlled-unitary gates. The first element of list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "TechNoteMathCaption",
 CellID->702850526,ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"GrayTwoLevelU", "[", 
     RowBox[{"#", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}], "/@", 
   RowBox[{"Rest", "[", "twl", "]"}]}]}]], "Input",
 CellLabel->"In[12]:=",
 CellID->1648731982,ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}]}], "]"}], ",", 
     RowBox[{"ControlledU", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["38"]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          FractionBox["14", "19"]], " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"]}], 
         SqrtBox["38"]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], "}"}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["5", 
         RowBox[{"14", " ", 
          SqrtBox["2"]}]]}], "+", 
       RowBox[{
        FractionBox["3", "14"], " ", "\[ImaginaryI]", " ", 
        SqrtBox["19"], " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}], "-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"14", " ", 
         SqrtBox["2"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"], "}"}], ",", 
     RowBox[{"ControlledU", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", "\[ImaginaryI]", " ", 
         SqrtBox["19"], " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], "-", 
        FractionBox[
         RowBox[{"5", " ", "\[ImaginaryI]", " ", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"]}], 
         RowBox[{"6", " ", 
          SqrtBox["2"]}]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"{", 
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}]}], "]"}], ",", 
     RowBox[{"ControlledU", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["38"]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          FractionBox["14", "19"]], " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"]}], 
         SqrtBox["38"]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], "}"}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["7"]}]]}], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[12]=",
 CellID->741954985,ExpressionUUID->"7a469504-7b5d-4b60-ac0b-eff89c5422f1"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "TechNoteMathCaption",
 CellID->328948492,ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"Flatten", "[", "gates", "]"}]}]}]}]], "Input",
 CellLabel->"In[13]:=",
 CellID->1014397666,ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->514.8000000000001,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[13]=",
 CellID->1954897260,ExpressionUUID->"c59c6de4-581d-4fe3-a52d-9fa155ff8616"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "TechNoteMathCaption",
 CellID->608232459,ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[14]:=",
 CellID->540778693,ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[15]//MatrixForm=",
 CellID->1069105726,ExpressionUUID->"a1e23ced-e2b0-4bfb-82dd-55bd18bfb20a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "mat"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[16]:=",
 CellID->326787606,ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[16]//MatrixForm=",
 CellID->306127092,ExpressionUUID->"a75fa0b1-962a-4414-8c32-ca0bd5dde293"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/guide/QuantumComputationAndQuantumInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "4a34ab7c-05b0-4f6c-b807-210184726b24"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"3e82acbb-dc25-4d40-86b7-\
29a112386fe5"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "70de6aa0-fc83-43c9-8388-a1bac326c320"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"]], 
         "RelatedTutorials",ExpressionUUID->
         "769e6e6d-dabe-4846-849f-cff5bf8c8365"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"58ebfef8-db7f-40aa-9d60-\
b0b07f1255ec"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. M. Greenberger, M. A. Horne, & A. Zeilinger, \
\[OpenCurlyDoubleQuote]Going beyond Bell\[CloseCurlyQuote]s theorem,\
\[CloseCurlyDoubleQuote]"}]]]], "http://arxiv.org/abs/0712.0921"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c5debcd0-7b5b-4f56-9739-6b6e27d3697a"]}]],ExpressionUUID->
         "6b6fa765-272b-41c9-9410-966c4873a074"],
        " in Bell\[CloseCurlyQuote]s Theorem, Quantum Theory, and Conceptions \
of the Universe, edited by Kafatos, M. (Kluwer Academic, Dordrecht, The \
Netherlands, 1989)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aca9bd33-36b1-4873-9af7-a58e67bfb358"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Bouwmeester, J.-W. Pan, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Phys. Rev. Lett. 82 (7), 1345 (1999)"}]]]], 
             "https://doi.org/10.1103/PhysRevLett.82.1345"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "18e1c150-199a-459f-91d8-966d4ddff509"]}]],ExpressionUUID->
         "7409302d-8f5b-442c-9d79-d3a269fff3b5"],
        ", \[OpenCurlyDoubleQuote]Observation of Three-Photon Greenberger- \
Horne-Zeilinger Entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aa4c1e7d-4bdc-4382-bc6c-aa7b8343b83d"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J.-W. Pan, D. Bouwmeester, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Nature 403, 515 (2000)"}]]]], "https://doi.org/10.1038/35000514"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "75a3ac0e-f81d-4eeb-a9ea-a9b405ce6522"]}]],ExpressionUUID->
         "5a1af0a4-2072-4774-b741-79a33c6d73c6"],
        ", \[OpenCurlyDoubleQuote]Experimental test of quantum nonlocality in \
three-photon Greenberger-Horne-Zeilinger entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "a821e7eb-6571-4a82-8b5d-fd47d4a054b1"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c4c21821-10fb-4325-a241-e3122bef929d"]}]],ExpressionUUID->
         "603c066a-93a3-4ae7-b2c4-d7274e8fa1ad"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "bea60db6-5aa3-4b2f-a998-954dfc342bfa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "d4200dc5-41b2-4919-96a5-0f72f361eded"]}]],ExpressionUUID->
         "055010d1-b10e-41e4-b24e-7f08564b113e"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "dd6b64d8-b32e-4457-a692-5aae5ec7c290"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"5dfe1c60-4824-469e-a8b3-\
2558ec56e88c"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"33b31505-cbf5-4be0-8dff-2d21eae26d5f"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Two-Qubit Gates",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 7, 7, 21, 20, 16.129949}", 
    "history" -> {"12", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tech Note", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 2.2 of the Quantum Workbook (Springer, 2022). This \
document introduces quantum logic gate operations acting on two qubits. Such \
operations are represented by 4*4 unitary matrices. We will see that any \
two-qubit gate operations can be decomposed into controlled-unitary gates. A \
controlled-unitary gate acts a unitary operator on one qubit depending on the \
logical state of the other qubit. A controlled-unitary gate on two qubits can \
be further decomposed into factors including only the CNOT gate and \
single-qubit rotation gates. In this sense, the CNOT gate alone is sufficient \
for any two-qubit gate. The controlled-unitary and CNOT gates have various \
interesting properties that make them useful in implementing quantum \
algorithms. In this document, we first examine the basic properties of the \
CNOT gate, and in particular, how it is used to generate an entanglement \
between two qubits. Then, we discuss the properties of the controlled-unitary \
gate and describe how to implement a controlled-unitary gate in terms of the \
CNOT gate and single-qubit rotations. Finally, we discuss how an arbitrary \
two-qubit unitary operation can be decomposed into controlled-unitary gates.",
     "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$305802, "title" -> 
    "Two-Qubit Gates", "titlemodifier" -> "", "windowtitle" -> 
    "Two-Qubit Gates", "type" -> "Tech Note", "uri" -> 
    "Q3/tutorial/TwoQubitGates"}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.1 for Mac OS X ARM (64-bit) (June 16, 2022)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"4663fe35-2c5f-4a09-900a-422490805531"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Section11"->{
  Cell[15812, 394, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
   CellTags->"Section11",
   CellID->1585062394]},
 "Section12"->{
  Cell[78730, 2270, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
   CellTags->"Section12",
   CellID->29167796]},
 "Section13"->{
  Cell[94768, 2759, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
   CellTags->"Section13",
   CellID->1218939314]},
 "Section14"->{
  Cell[121214, 3564, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
   CellTags->"Section14",
   CellID->1455445268]},
 "Section15"->{
  Cell[121810, 3583, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
   CellTags->"Section15",
   CellID->1829879946]},
 "Section16"->{
  Cell[141843, 4221, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
   CellTags->"Section16",
   CellID->715838931]},
 "Section17"->{
  Cell[153490, 4580, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
   CellTags->"Section17",
   CellID->1379525988]},
 "Section18"->{
  Cell[180106, 5313, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
   CellTags->"Section18",
   CellID->1847739219]},
 "Section19"->{
  Cell[199901, 5898, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
   CellTags->"Section19",
   CellID->1476129218]},
 "Section20"->{
  Cell[201081, 5930, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
   CellTags->"Section20",
   CellID->749947798]},
 "Section22"->{
  Cell[233207, 6948, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
   CellTags->"Section22",
   CellID->1363502801]},
 "Section23"->{
  Cell[264135, 7831, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
   CellTags->"Section23",
   CellID->153308382]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Section11", 313178, 9280},
 {"Section12", 313350, 9284},
 {"Section13", 313521, 9288},
 {"Section14", 313694, 9292},
 {"Section15", 313868, 9296},
 {"Section16", 314037, 9300},
 {"Section17", 314205, 9304},
 {"Section18", 314374, 9308},
 {"Section19", 314543, 9312},
 {"Section20", 314717, 9316},
 {"Section22", 314885, 9320},
 {"Section23", 315054, 9324}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 3447, 80, 57, "AnchorBarGrid",ExpressionUUID->"2cbae514-aedc-40e6-accb-132a73e029a8",
 CellID->1],
Cell[CellGroupData[{
Cell[4059, 105, 116, 1, 68, "TechNoteTitle",ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0",
 CellID->1379112571],
Cell[4178, 108, 5481, 119, 115, "TechNoteJumpBox",ExpressionUUID->"52c1917c-1084-4a21-bf78-c00ca5f28622"],
Cell[9662, 229, 418, 13, 38, "TechNoteText",ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383",
 CellID->1308734266],
Cell[10083, 244, 1099, 23, 132, "TechNoteText",ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c",
 CellID->1465929903],
Cell[11185, 269, 1320, 31, 132, "TechNoteText",ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74",
 CellID->1951481337],
Cell[12508, 302, 2104, 55, 227, "DefinitionBox",ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5",
 CellID->407539380],
Cell[14615, 359, 135, 1, 31, "TechNoteCaption",ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f",
 CellID->1189009377],
Cell[14753, 362, 288, 7, 36, "TechNoteMathCaption",ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11",
 CellID->1428640008],
Cell[15044, 371, 145, 3, 29, "Input",ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6",
 CellID->853967906],
Cell[15192, 376, 323, 6, 57, "TechNoteMathCaption",ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6",
 CellID->1937193009],
Cell[15518, 384, 269, 6, 70, "Input",ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736",
 CellID->403330096],
Cell[CellGroupData[{
Cell[15812, 394, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
 CellTags->"Section11",
 CellID->1585062394],
Cell[15968, 398, 494, 13, 70, "TechNoteText",ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443",
 CellID->609014923],
Cell[16465, 413, 554, 19, 70, "TechNoteText",ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41",
 CellID->806749259],
Cell[17022, 434, 537, 17, 70, "TechNoteText",ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f",
 CellID->1970532502],
Cell[CellGroupData[{
Cell[17584, 455, 264, 7, 70, "Input",ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf",
 CellID->246957080],
Cell[17851, 464, 441, 16, 37, "Output",ExpressionUUID->"3faf1ef6-9126-440d-873e-58ebbf045bea",
 CellID->1669237556]
}, Open  ]],
Cell[CellGroupData[{
Cell[18329, 485, 536, 16, 70, "Input",ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b",
 CellID->149239284],
Cell[18868, 503, 4167, 128, 120, "Output",ExpressionUUID->"d647c3d4-59d2-46b1-ba0f-55eb3a2cec1e",
 CellID->3746492]
}, Open  ]],
Cell[23050, 634, 170, 3, 70, "TechNoteText",ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae",
 CellID->690265281],
Cell[CellGroupData[{
Cell[23245, 641, 271, 6, 70, "Input",ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02",
 CellID->581916673],
Cell[23519, 649, 804, 23, 100, "Output",ExpressionUUID->"be102ff8-4cc9-4764-85bd-5eeeffbd4cd0",
 CellID->632994673]
}, Open  ]],
Cell[24338, 675, 192, 4, 70, "TechNoteText",ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844",
 CellID->107481873],
Cell[CellGroupData[{
Cell[24555, 683, 162, 3, 70, "Input",ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9",
 CellID->414092384],
Cell[24720, 688, 1063, 35, 55, "Output",ExpressionUUID->"876f3271-2a33-4c57-a6d8-cc2220447b96",
 CellID->1803681608]
}, Open  ]],
Cell[CellGroupData[{
Cell[25820, 728, 194, 4, 70, "Input",ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665",
 CellID->597624604],
Cell[26017, 734, 465, 11, 52, "Output",ExpressionUUID->"e0308e66-9bb8-48e1-943f-33f4ba49b60d",
 CellID->495702409]
}, Open  ]],
Cell[26497, 748, 184, 3, 70, "TechNoteText",ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13",
 CellID->1181321350],
Cell[CellGroupData[{
Cell[26706, 755, 191, 4, 70, "Input",ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361",
 CellID->981612935],
Cell[26900, 761, 649, 14, 80, "Output",ExpressionUUID->"1778e5fe-7b8d-4959-bf0a-22b2e7e728b5",
 CellID->999222291]
}, Open  ]],
Cell[27564, 778, 283, 5, 70, "TechNoteText",ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39",
 CellID->606925297],
Cell[27850, 785, 724, 15, 70, "TechNoteText",ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420",
 CellID->46143429],
Cell[CellGroupData[{
Cell[28599, 804, 675, 21, 70, "Input",ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73",
 CellID->291014636],
Cell[29277, 827, 2400, 83, 41, "Output",ExpressionUUID->"8db4692c-b671-4347-87c0-049c75c6becd",
 CellID->1262723033]
}, Open  ]],
Cell[31692, 913, 605, 14, 70, "TechNoteText",ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939",
 CellID->1152615977],
Cell[CellGroupData[{
Cell[32322, 931, 273, 7, 70, "Input",ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e",
 CellID->1714229499],
Cell[32598, 940, 984, 22, 91, "Output",ExpressionUUID->"4ba7f6c8-474b-4519-adf4-72a3d563ccd8",
 CellID->414581541]
}, Open  ]],
Cell[CellGroupData[{
Cell[33619, 967, 538, 16, 70, "Input",ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160",
 CellID->1435008719],
Cell[34160, 985, 6583, 200, 172, "Output",ExpressionUUID->"52b227c9-786d-42b6-b248-17a2b9c0aaab",
 CellID->1950184423]
}, Open  ]],
Cell[40758, 1188, 965, 21, 70, "TechNoteText",ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1",
 CellID->1854176847],
Cell[CellGroupData[{
Cell[41748, 1213, 915, 27, 70, "Input",ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075",
 CellID->1015065912],
Cell[42666, 1242, 1229, 23, 260, "Output",ExpressionUUID->"6924f948-da7e-4e96-89fe-724adbdece05",
 CellID->602691216]
}, Open  ]],
Cell[43910, 1268, 143, 1, 70, "TechNoteText",ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608",
 CellID->1898388060],
Cell[44056, 1271, 523, 19, 70, "TechNoteText",ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775",
 CellID->1043580941],
Cell[44582, 1292, 1369, 43, 70, "TechNoteText",ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de",
 CellID->965930338],
Cell[45954, 1337, 654, 20, 70, "TechNoteText",ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98",
 CellID->1562303093],
Cell[46611, 1359, 1170, 35, 70, "TechNoteText",ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08",
 CellID->345532182],
Cell[47784, 1396, 475, 17, 70, "TechNoteText",ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547",
 CellID->563601386],
Cell[48262, 1415, 1089, 31, 70, "TechNoteText",ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841",
 CellID->2045611232],
Cell[49354, 1448, 1119, 39, 70, "TechNoteText",ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe",
 CellID->1522271401],
Cell[50476, 1489, 1181, 38, 70, "TechNoteText",ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec",
 CellID->1842749896],
Cell[CellGroupData[{
Cell[51682, 1531, 273, 7, 70, "Input",ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d",
 CellID->88345038],
Cell[51958, 1540, 2208, 47, 271, "Output",ExpressionUUID->"d5f49643-6697-454d-926d-3c2955ebeb67",
 CellID->903853589]
}, Open  ]],
Cell[CellGroupData[{
Cell[54203, 1592, 418, 12, 70, "Input",ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3",
 CellID->1915435092],
Cell[54624, 1606, 2067, 67, 62, "Output",ExpressionUUID->"0ebf0129-501f-43bc-89c5-299a6f1c5bf2",
 CellID->1937722714]
}, Open  ]],
Cell[56706, 1676, 305, 5, 70, "TechNoteText",ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195",
 CellID->716147443],
Cell[57014, 1683, 1249, 45, 70, "TechNoteText",ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182",
 CellID->1791716713],
Cell[58266, 1730, 174, 3, 70, "TechNoteText",ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b",
 CellID->1367097157],
Cell[58443, 1735, 323, 5, 70, "TechNoteText",ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615",
 CellID->874378446],
Cell[CellGroupData[{
Cell[58791, 1744, 776, 23, 70, "Input",ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946",
 CellID->447945501],
Cell[59570, 1769, 1194, 22, 152, "Output",ExpressionUUID->"2a5e5c71-21cc-45c0-8246-777642277150",
 CellID->1676325949]
}, Open  ]],
Cell[60779, 1794, 115, 1, 70, "TechNoteText",ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328",
 CellID->880946029],
Cell[CellGroupData[{
Cell[60919, 1799, 707, 21, 70, "Input",ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5",
 CellID->1307646985],
Cell[61629, 1822, 1194, 22, 152, "Output",ExpressionUUID->"e49a0da4-14db-4c31-9a5d-833868845440",
 CellID->2026523596]
}, Open  ]],
Cell[62838, 1847, 235, 4, 70, "TechNoteText",ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43",
 CellID->169608441],
Cell[63076, 1853, 667, 21, 70, "TechNoteText",ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec",
 CellID->898268318],
Cell[63746, 1876, 381, 10, 70, "TechNoteText",ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb",
 CellID->385582216],
Cell[64130, 1888, 2511, 59, 70, "TechNoteText",ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc",
 CellID->1620101282],
Cell[66644, 1949, 131, 1, 70, "TechNoteText",ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167",
 CellID->712578174],
Cell[66778, 1952, 787, 27, 70, "TechNoteText",ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621",
 CellID->1522141313],
Cell[67568, 1981, 414, 7, 70, "TechNoteText",ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929",
 CellID->1803844527],
Cell[67985, 1990, 384, 8, 70, "TechNoteText",ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed",
 CellID->1188320590],
Cell[68372, 2000, 336, 6, 70, "TechNoteText",ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e",
 CellID->506239030],
Cell[68711, 2008, 3608, 92, 70, "TechNoteText",ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3",
 CellID->1226753413],
Cell[72322, 2102, 402, 6, 70, "TechNoteText",ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00",
 CellID->365203462],
Cell[72727, 2110, 5378, 142, 70, "TechNoteText",ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38",
 CellID->977674470],
Cell[78108, 2254, 585, 11, 70, "TechNoteText",ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840",
 CellID->833871357]
}, Open  ]],
Cell[CellGroupData[{
Cell[78730, 2270, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
 CellTags->"Section12",
 CellID->29167796],
Cell[78880, 2274, 147, 3, 70, "Input",ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603",
 CellID->754200946],
Cell[79030, 2279, 272, 6, 70, "Input",ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b",
 CellID->1406814828],
Cell[79305, 2287, 270, 5, 70, "TechNoteText",ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06",
 CellID->596875856],
Cell[79578, 2294, 628, 22, 70, "TechNoteText",ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45",
 CellID->796396655],
Cell[80209, 2318, 344, 11, 70, "TechNoteText",ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478",
 CellID->1920492481],
Cell[CellGroupData[{
Cell[80578, 2333, 264, 7, 70, "Input",ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1",
 CellID->1037913757],
Cell[80845, 2342, 439, 16, 37, "Output",ExpressionUUID->"fb06d0c7-a71e-42f2-a5d4-aff88a510124",
 CellID->206849318]
}, Open  ]],
Cell[CellGroupData[{
Cell[81321, 2363, 538, 16, 70, "Input",ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc",
 CellID->1887946780],
Cell[81862, 2381, 4207, 129, 120, "Output",ExpressionUUID->"4627d9ea-53f9-445c-8a2f-5b0163d3c37b",
 CellID->1650647035]
}, Open  ]],
Cell[86084, 2513, 181, 3, 70, "TechNoteText",ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb",
 CellID->1230965299],
Cell[CellGroupData[{
Cell[86290, 2520, 194, 4, 70, "Input",ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55",
 CellID->2123808742],
Cell[86487, 2526, 792, 24, 100, "Output",ExpressionUUID->"243d5e76-7714-4b3f-867e-8ec65d757f06",
 CellID->1527830007]
}, Open  ]],
Cell[87294, 2553, 315, 5, 70, "TechNoteText",ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c",
 CellID->776960470],
Cell[CellGroupData[{
Cell[87634, 2562, 169, 3, 70, "Input",ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01",
 CellID->1674045530],
Cell[87806, 2567, 495, 12, 73, "Output",ExpressionUUID->"dc9e97b8-0e58-43ae-bfd1-1223834c38ef",
 CellID->1499963363]
}, Open  ]],
Cell[88316, 2582, 252, 4, 70, "TechNoteText",ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f",
 CellID->573709808],
Cell[88571, 2588, 507, 11, 70, "TechNoteText",ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c",
 CellID->139168026],
Cell[CellGroupData[{
Cell[89103, 2603, 1148, 35, 70, "Input",ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec",
 CellID->387321399],
Cell[90254, 2640, 650, 14, 80, "Output",ExpressionUUID->"8548cc49-b767-40a9-ac25-70380f3941f2",
 CellID->687818936],
Cell[90907, 2656, 1112, 28, 85, "Output",ExpressionUUID->"e6bc177b-7b31-4ff4-b28b-80b321f00df4",
 CellID->268385551],
Cell[92022, 2686, 1909, 46, 96, "Output",ExpressionUUID->"b50dd44a-9ba0-4e72-8bd0-cb4af365a38c",
 CellID->1040296957]
}, Open  ]],
Cell[CellGroupData[{
Cell[93968, 2737, 201, 4, 70, "Input",ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612",
 CellID->1606586072],
Cell[94172, 2743, 132, 2, 37, "Output",ExpressionUUID->"f69d9295-0e1a-4abf-a1fd-4658a46acc76",
 CellID->1580218373]
}, Open  ]],
Cell[94319, 2748, 412, 6, 70, "TechNoteText",ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710",
 CellID->799932562]
}, Open  ]],
Cell[CellGroupData[{
Cell[94768, 2759, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
 CellTags->"Section13",
 CellID->1218939314],
Cell[94907, 2763, 148, 3, 70, "Input",ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7",
 CellID->1843914595],
Cell[95058, 2768, 271, 6, 70, "Input",ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5",
 CellID->336088308],
Cell[95332, 2776, 550, 13, 70, "TechNoteText",ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a",
 CellID->1866541665],
Cell[95885, 2791, 625, 22, 70, "TechNoteText",ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e",
 CellID->524648279],
Cell[96513, 2815, 505, 12, 70, "TechNoteText",ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269",
 CellID->195770571],
Cell[CellGroupData[{
Cell[97043, 2831, 725, 22, 70, "Input",ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70",
 CellID->371039593],
Cell[97771, 2855, 4171, 128, 120, "Output",ExpressionUUID->"27110225-b050-43b0-82c5-8bce29b33c15",
 CellID->1917412310]
}, Open  ]],
Cell[101957, 2986, 642, 21, 70, "TechNoteText",ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305",
 CellID->809087288],
Cell[CellGroupData[{
Cell[102624, 3011, 193, 4, 70, "Input",ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae",
 CellID->463596612],
Cell[102820, 3017, 805, 23, 100, "Output",ExpressionUUID->"69da66ea-3ba6-4c64-a72b-e896a948f202",
 CellID->597586568]
}, Open  ]],
Cell[103640, 3043, 143, 1, 70, "TechNoteText",ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580",
 CellID->2003915004],
Cell[CellGroupData[{
Cell[103808, 3048, 192, 4, 70, "Input",ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc",
 CellID->813436327],
Cell[104003, 3054, 607, 14, 73, "Output",ExpressionUUID->"7d914db4-cb42-49ec-876d-996856c93ac9",
 CellID->543451087]
}, Open  ]],
Cell[104625, 3071, 371, 8, 70, "TechNoteText",ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c",
 CellID->534468518],
Cell[CellGroupData[{
Cell[105021, 3083, 311, 9, 70, "Input",ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d",
 CellID->2035770272],
Cell[105335, 3094, 806, 23, 100, "Output",ExpressionUUID->"bb1cae5c-992a-4991-a5bb-fccff6e79a2d",
 CellID->1481497500]
}, Open  ]],
Cell[106156, 3120, 735, 15, 70, "TechNoteText",ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d",
 CellID->1603079182],
Cell[CellGroupData[{
Cell[106916, 3139, 811, 23, 70, "Input",ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454",
 CellID->621976612],
Cell[107730, 3164, 608, 14, 73, "Output",ExpressionUUID->"7f482271-369c-413d-8e52-f3dc7ecc2ef3",
 CellID->1758007935],
Cell[108341, 3180, 1155, 22, 86, "Output",ExpressionUUID->"b2cb5b57-493e-4c95-8532-4eb804d4ced7",
 CellID->1759348119]
}, Open  ]],
Cell[CellGroupData[{
Cell[109533, 3207, 188, 4, 70, "Input",ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22",
 CellID->661500490],
Cell[109724, 3213, 131, 2, 37, "Output",ExpressionUUID->"6548e31c-b3bc-4658-893f-23f52218d210",
 CellID->315894911]
}, Open  ]],
Cell[109870, 3218, 1203, 29, 70, "TechNoteText",ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7",
 CellID->666193793],
Cell[111076, 3249, 469, 13, 70, "TechNoteText",ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[111570, 3266, 525, 14, 70, "Input",ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150",
 CellID->1040933486],
Cell[112098, 3282, 1033, 31, 116, "Output",ExpressionUUID->"30fd9d21-2bf9-4fa6-a219-a5d3bf62bf92",
 CellID->1886827140]
}, Open  ]],
Cell[113146, 3316, 327, 8, 70, "TechNoteText",ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9",
 CellID->771058470],
Cell[CellGroupData[{
Cell[113498, 3328, 434, 12, 70, "Input",ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2",
 CellID->1895203240],
Cell[113935, 3342, 2334, 77, 52, "Output",ExpressionUUID->"4349c87f-1af1-4ba7-8cb6-3a3f7ff1e240",
 CellID->12726731]
}, Open  ]],
Cell[116284, 3422, 849, 23, 70, "TechNoteText",ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587",
 CellID->27233292],
Cell[CellGroupData[{
Cell[117158, 3449, 511, 14, 70, "Input",ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3",
 CellID->1505230369],
Cell[117672, 3465, 2205, 52, 96, "Output",ExpressionUUID->"1ef90033-2bd1-4a1b-b857-50ddd6b30237",
 CellID->1297286864]
}, Open  ]],
Cell[119892, 3520, 225, 4, 70, "TechNoteText",ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3",
 CellID->535686806],
Cell[CellGroupData[{
Cell[120142, 3528, 193, 4, 70, "Input",ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901",
 CellID->851721286],
Cell[120338, 3534, 827, 24, 100, "Output",ExpressionUUID->"1e1aae71-e28a-476a-b576-b7f2b8fd146d",
 CellID->98855257]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121214, 3564, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
 CellTags->"Section14",
 CellID->1455445268],
Cell[121368, 3568, 145, 3, 70, "Input",ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91",
 CellID->214055128],
Cell[121516, 3573, 269, 6, 70, "Input",ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87",
 CellID->167122186],
Cell[CellGroupData[{
Cell[121810, 3583, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
 CellTags->"Section15",
 CellID->1829879946],
Cell[121945, 3587, 572, 13, 70, "TechNoteText",ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644",
 CellID->678943735],
Cell[122520, 3602, 634, 23, 70, "TechNoteText",ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8",
 CellID->1426737634],
Cell[123157, 3627, 115, 1, 70, "TechNoteText",ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9",
 CellID->377012236],
Cell[123275, 3630, 584, 22, 70, "TechNoteText",ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165",
 CellID->1367891802],
Cell[123862, 3654, 400, 8, 70, "TechNoteText",ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b",
 CellID->1345075079],
Cell[124265, 3664, 214, 4, 70, "TechNoteText",ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e",
 CellID->819163313],
Cell[124482, 3670, 569, 19, 70, "TechNoteText",ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4",
 CellID->116500784],
Cell[125054, 3691, 446, 13, 70, "TechNoteText",ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48",
 CellID->1671074271],
Cell[125503, 3706, 176, 3, 70, "TechNoteText",ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd",
 CellID->1953344721],
Cell[125682, 3711, 811, 20, 70, "Picture",ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329",
 CellID->954137231],
Cell[126496, 3733, 287, 5, 70, "TechNoteText",ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1",
 CellID->924049268],
Cell[126786, 3740, 285, 5, 70, "TechNoteMathCaption",ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d",
 CellID->2041795819],
Cell[CellGroupData[{
Cell[127096, 3749, 570, 16, 70, "Input",ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668",
 CellID->1821134520],
Cell[127669, 3767, 1153, 33, 86, "Output",ExpressionUUID->"aad4f053-1c32-450a-a1c4-597e2fe743ae",
 CellID->2025053772]
}, Open  ]],
Cell[128837, 3803, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e",
 CellID->1443037598],
Cell[CellGroupData[{
Cell[129041, 3810, 285, 7, 70, "Input",ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767",
 CellID->1600084015],
Cell[129329, 3819, 847, 22, 95, "Output",ExpressionUUID->"06ed66f7-8e68-4751-876b-7d7fe1c70743",
 CellID->2030390600]
}, Open  ]],
Cell[130191, 3844, 206, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171",
 CellID->378680471],
Cell[CellGroupData[{
Cell[130422, 3852, 162, 3, 70, "Input",ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f",
 CellID->1488630036],
Cell[130587, 3857, 1417, 45, 52, "Output",ExpressionUUID->"0d225d53-f610-4243-ad57-8b7eb51f2cf7",
 CellID->463603589]
}, Open  ]],
Cell[132019, 3905, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4",
 CellID->641929970],
Cell[CellGroupData[{
Cell[132221, 3912, 536, 16, 70, "Input",ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170",
 CellID->2106646909],
Cell[132760, 3930, 5592, 168, 130, "Output",ExpressionUUID->"c4e32268-0795-468c-b7a9-e5b50038df00",
 CellID->1590542250]
}, Open  ]],
Cell[138367, 4101, 217, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b",
 CellID->1736236263],
Cell[CellGroupData[{
Cell[138609, 4109, 483, 15, 70, "Input",ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff",
 CellID->915076805],
Cell[139095, 4126, 869, 27, 41, "Output",ExpressionUUID->"4af6f8d7-84ea-4cd7-87aa-7ccec4f8af33",
 CellID->451820721]
}, Open  ]],
Cell[CellGroupData[{
Cell[140001, 4158, 363, 10, 70, "Input",ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8",
 CellID->1955961279],
Cell[140367, 4170, 1427, 45, 52, "Output",ExpressionUUID->"c88b8772-373c-4d69-b547-063d4f695c44",
 CellID->895924620]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[141843, 4221, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
 CellTags->"Section16",
 CellID->715838931],
Cell[141984, 4225, 709, 12, 70, "TechNoteText",ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b",
 CellID->901522823],
Cell[142696, 4239, 1048, 32, 70, "TechNoteText",ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8",
 CellID->1396956576],
Cell[143747, 4273, 1485, 54, 70, "TechNoteText",ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d",
 CellID->210460181],
Cell[145235, 4329, 420, 8, 70, "TechNoteText",ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4",
 CellID->298695458],
Cell[145658, 4339, 528, 13, 70, "TechNoteMathCaption",ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8",
 CellID->1505279567],
Cell[CellGroupData[{
Cell[146211, 4356, 335, 8, 70, "Input",ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c",
 CellID->1876320909],
Cell[146549, 4366, 288, 9, 37, "Output",ExpressionUUID->"617ee0c5-78d0-4fc7-9554-e0cba471f638",
 CellID->1171583325],
Cell[146840, 4377, 799, 23, 68, "Output",ExpressionUUID->"471394cf-0ea2-4265-85a8-ac25b3113299",
 CellID->523383932]
}, Open  ]],
Cell[147654, 4403, 167, 2, 70, "TechNoteMathCaption",ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738",
 CellID->774865820],
Cell[CellGroupData[{
Cell[147846, 4409, 337, 9, 70, "Input",ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64",
 CellID->2117896949],
Cell[148186, 4420, 853, 22, 95, "Output",ExpressionUUID->"541334a7-5d91-404c-a569-0ea0fe297db5",
 CellID->1890287755]
}, Open  ]],
Cell[149054, 4445, 323, 5, 70, "TechNoteMathCaption",ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50",
 CellID->193224567],
Cell[CellGroupData[{
Cell[149402, 4454, 538, 15, 70, "Input",ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1",
 CellID->1062235589],
Cell[149943, 4471, 1721, 45, 93, "Output",ExpressionUUID->"ca0e74e6-6bc9-495f-8ff6-5fa3bf723904",
 CellID->265239778]
}, Open  ]],
Cell[151679, 4519, 278, 5, 70, "TechNoteMathCaption",ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0",
 CellID->581406343],
Cell[CellGroupData[{
Cell[151982, 4528, 304, 7, 70, "Input",ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c",
 CellID->1127477995],
Cell[152289, 4537, 1152, 37, 62, "Output",ExpressionUUID->"5c405cdb-f62d-47a1-8abd-14ab11c8bcfc",
 CellID->406828334]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153490, 4580, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
 CellTags->"Section17",
 CellID->1379525988],
Cell[153649, 4584, 714, 15, 70, "TechNoteText",ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40",
 CellID->1459827304],
Cell[154366, 4601, 761, 26, 70, "TechNoteText",ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8",
 CellID->316831353],
Cell[155130, 4629, 1504, 37, 70, "TechNoteText",ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee",
 CellID->1372588958],
Cell[156637, 4668, 2053, 41, 70, "TechNoteText",ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a",
 CellID->833281032],
Cell[158693, 4711, 195, 4, 70, "TechNoteText",ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9",
 CellID->1213442737],
Cell[158891, 4717, 254, 4, 70, "TechNoteText",ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2",
 CellID->1827368847],
Cell[CellGroupData[{
Cell[159170, 4725, 1264, 38, 70, "Input",ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11",
 CellID->1424575782],
Cell[160437, 4765, 1831, 36, 157, "Output",ExpressionUUID->"0872f49a-1870-4ecd-853e-a700c27d7e99",
 CellID->549987671]
}, Open  ]],
Cell[162283, 4804, 197, 4, 70, "TechNoteText",ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787",
 CellID->873169809],
Cell[CellGroupData[{
Cell[162505, 4812, 460, 13, 70, "Input",ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117",
 CellID->1609219912],
Cell[162968, 4827, 17089, 480, 228, "Output",ExpressionUUID->"64f4def1-ea67-4e9b-8eba-3f8dd7946f0f",
 CellID->750010666]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180106, 5313, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
 CellTags->"Section18",
 CellID->1847739219],
Cell[180266, 5317, 645, 10, 70, "TechNoteText",ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081",
 CellID->192034466],
Cell[180914, 5329, 735, 19, 70, "TechNoteText",ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235",
 CellID->2002832268],
Cell[181652, 5350, 567, 17, 70, "TechNoteText",ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9",
 CellID->1943245198],
Cell[182222, 5369, 521, 15, 70, "TechNoteText",ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063",
 CellID->1190739210],
Cell[182746, 5386, 587, 18, 70, "TechNoteText",ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9",
 CellID->353796077],
Cell[183336, 5406, 176, 3, 70, "TechNoteText",ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da",
 CellID->2015931243],
Cell[183515, 5411, 429, 14, 70, "TechNoteText",ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6",
 CellID->906902382],
Cell[183947, 5427, 576, 20, 70, "TechNoteText",ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0",
 CellID->1616891515],
Cell[184526, 5449, 587, 19, 70, "TechNoteText",ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc",
 CellID->837623467],
Cell[185116, 5470, 669, 18, 70, "TechNoteText",ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628",
 CellID->1182303784],
Cell[185788, 5490, 2977, 68, 70, "TechNoteText",ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b",
 CellID->313511997],
Cell[188768, 5560, 1491, 40, 70, "TechNoteText",ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd",
 CellID->1418747488],
Cell[190262, 5602, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4",
 CellID->1378098175],
Cell[CellGroupData[{
Cell[190497, 5610, 464, 13, 70, "Input",ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825",
 CellID->1028095504],
Cell[190964, 5625, 1115, 36, 86, "Output",ExpressionUUID->"38e50d82-cf69-4b2e-82d3-6c116693ae9a",
 CellID->1504631305]
}, Open  ]],
Cell[192094, 5664, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510",
 CellID->1646790355],
Cell[CellGroupData[{
Cell[192287, 5670, 524, 14, 70, "Input",ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49",
 CellID->1153761970],
Cell[192814, 5686, 849, 22, 95, "Output",ExpressionUUID->"29269fdb-9ca7-4f90-ad2d-3d9a80ab5f57",
 CellID->1279366376]
}, Open  ]],
Cell[193678, 5711, 198, 4, 70, "TechNoteMathCaption",ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45",
 CellID->1240176371],
Cell[CellGroupData[{
Cell[193901, 5719, 544, 16, 70, "Input",ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5",
 CellID->167989615],
Cell[194448, 5737, 282, 8, 50, "Output",ExpressionUUID->"d6668f09-b22d-4101-8dab-519a11fbfd12",
 CellID->2072346988]
}, Open  ]],
Cell[194745, 5748, 162, 2, 70, "TechNoteMathCaption",ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d",
 CellID->833485781],
Cell[194910, 5752, 1453, 45, 70, "Input",ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c",
 CellID->359691886],
Cell[196366, 5799, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1",
 CellID->175061697],
Cell[CellGroupData[{
Cell[196555, 5805, 514, 14, 70, "Input",ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea",
 CellID->209345089],
Cell[197072, 5821, 2256, 53, 95, "Output",ExpressionUUID->"682c0b12-e7e2-4c52-b337-d477fda8eac9",
 CellID->1268149688]
}, Open  ]],
Cell[199343, 5877, 124, 1, 70, "TechNoteMathCaption",ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0",
 CellID->2073812678],
Cell[CellGroupData[{
Cell[199492, 5882, 217, 5, 70, "Input",ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65",
 CellID->1395051790],
Cell[199712, 5889, 128, 2, 37, "Output",ExpressionUUID->"af2551ad-217a-4e6d-9c10-df9019d64bda",
 CellID->260320349]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[199901, 5898, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
 CellTags->"Section19",
 CellID->1476129218],
Cell[200052, 5902, 147, 3, 70, "Input",ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f",
 CellID->384188579],
Cell[200202, 5907, 272, 6, 70, "Input",ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408",
 CellID->1721604371],
Cell[200477, 5915, 579, 11, 70, "TechNoteText",ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c",
 CellID->1572676782],
Cell[CellGroupData[{
Cell[201081, 5930, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
 CellTags->"Section20",
 CellID->749947798],
Cell[201233, 5934, 337, 7, 70, "TechNoteText",ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222",
 CellID->791116743],
Cell[201573, 5943, 875, 30, 70, "TechNoteText",ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e",
 CellID->1227841024],
Cell[202451, 5975, 953, 18, 70, "TechNoteText",ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704",
 CellID->1153726345],
Cell[203407, 5995, 174, 3, 70, "TechNoteText",ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff",
 CellID->1048831652],
Cell[203584, 6000, 896, 28, 70, "TechNoteText",ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559",
 CellID->1167800588],
Cell[204483, 6030, 1548, 45, 70, "TechNoteText",ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355",
 CellID->1371432583],
Cell[206034, 6077, 1189, 38, 70, "TechNoteText",ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06",
 CellID->725439230],
Cell[207226, 6117, 181, 3, 70, "TechNoteText",ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245",
 CellID->1192474591],
Cell[207410, 6122, 1000, 31, 70, "TechNoteText",ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533",
 CellID->1603057133],
Cell[208413, 6155, 1046, 31, 70, "TechNoteText",ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a",
 CellID->251399069],
Cell[209462, 6188, 1184, 34, 70, "TechNoteText",ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720",
 CellID->1163819034],
Cell[210649, 6224, 160, 2, 70, "TechNoteText",ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42",
 CellID->1025447562],
Cell[210812, 6228, 958, 29, 70, "TechNoteText",ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb",
 CellID->1140907359],
Cell[211773, 6259, 300, 8, 70, "TechNoteText",ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d",
 CellID->348498650],
Cell[212076, 6269, 1147, 32, 70, "TechNoteText",ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb",
 CellID->1028905181],
Cell[213226, 6303, 821, 23, 70, "TechNoteText",ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70",
 CellID->1271051423],
Cell[214050, 6328, 181, 3, 70, "TechNoteText",ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7",
 CellID->1541429652],
Cell[214234, 6333, 392, 12, 70, "TechNoteText",ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351",
 CellID->1712927403],
Cell[214629, 6347, 337, 7, 70, "TechNoteText",ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54",
 CellID->5090539],
Cell[214969, 6356, 441, 12, 70, "TechNoteText",ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83",
 CellID->1804826740],
Cell[215413, 6370, 249, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11",
 CellID->516505305],
Cell[CellGroupData[{
Cell[215687, 6378, 649, 19, 70, "Input",ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4",
 CellID->775759961],
Cell[216339, 6399, 1248, 40, 39, "Output",ExpressionUUID->"b18bfdb8-5555-417b-aeeb-743f02c1c001",
 CellID->1281576332],
Cell[217590, 6441, 1201, 31, 100, "Output",ExpressionUUID->"7ba48906-a98c-4e8e-92f5-431fddd951a5",
 CellID->192432514]
}, Open  ]],
Cell[218806, 6475, 185, 3, 70, "TechNoteMathCaption",ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3",
 CellID->595736468],
Cell[CellGroupData[{
Cell[219016, 6482, 267, 7, 70, "Input",ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e",
 CellID->974055362],
Cell[219286, 6491, 1523, 45, 45, "Output",ExpressionUUID->"bf153f84-f054-49b7-93f2-fdec82ecf04b",
 CellID->271234817]
}, Open  ]],
Cell[220824, 6539, 214, 5, 70, "TechNoteMathCaption",ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9",
 CellID->1817782849],
Cell[CellGroupData[{
Cell[221063, 6548, 303, 8, 70, "Input",ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd",
 CellID->1373980921],
Cell[221369, 6558, 3152, 110, 180, "Output",ExpressionUUID->"2631fea2-b7ce-498b-9928-60b228f006ff",
 CellID->699760199]
}, Open  ]],
Cell[224536, 6671, 349, 7, 70, "TechNoteMathCaption",ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239",
 CellID->642635412],
Cell[CellGroupData[{
Cell[224910, 6682, 358, 10, 70, "Input",ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643",
 CellID->1078108721],
Cell[225271, 6694, 2259, 74, 107, "Output",ExpressionUUID->"9ea7b93c-eadb-4874-ac87-c145bfbd71ec",
 CellID->2056629583]
}, Open  ]],
Cell[227545, 6771, 306, 7, 70, "TechNoteMathCaption",ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5",
 CellID->1155771237],
Cell[CellGroupData[{
Cell[227876, 6782, 266, 7, 70, "Input",ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97",
 CellID->1057593144],
Cell[228145, 6791, 3799, 112, 127, "Output",ExpressionUUID->"81d300b1-b34f-42bf-8574-f3a50bbeff4a",
 CellID->1519566621]
}, Open  ]],
Cell[231959, 6906, 152, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877",
 CellID->1969536942],
Cell[CellGroupData[{
Cell[232136, 6911, 352, 10, 70, "Input",ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc",
 CellID->694449336],
Cell[232491, 6923, 667, 19, 100, "Output",ExpressionUUID->"b8f42fae-c2ef-4f21-a510-c49af35cb17f",
 CellID->160171015]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233207, 6948, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
 CellTags->"Section22",
 CellID->1363502801],
Cell[233403, 6954, 249, 4, 70, "TechNoteText",ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384",
 CellID->593579270],
Cell[233655, 6960, 492, 17, 70, "TechNoteText",ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3",
 CellID->1225250575],
Cell[234150, 6979, 242, 4, 70, "TechNoteText",ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9",
 CellID->565722942],
Cell[234395, 6985, 1214, 37, 70, "TechNoteText",ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963",
 CellID->1195380925],
Cell[235612, 7024, 138, 1, 70, "TechNoteText",ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738",
 CellID->1057688790],
Cell[235753, 7027, 492, 17, 70, "TechNoteText",ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec",
 CellID->1853347311],
Cell[236248, 7046, 285, 5, 70, "TechNoteText",ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124",
 CellID->2105439889],
Cell[236536, 7053, 1214, 37, 70, "TechNoteText",ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b",
 CellID->2040162804],
Cell[237753, 7092, 169, 3, 70, "TechNoteText",ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506",
 CellID->144855179],
Cell[237925, 7097, 494, 17, 70, "TechNoteText",ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3",
 CellID->1482021402],
Cell[238422, 7116, 335, 6, 70, "TechNoteText",ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac",
 CellID->1818365508],
Cell[238760, 7124, 810, 28, 70, "TechNoteText",ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f",
 CellID->429312499],
Cell[239573, 7154, 433, 7, 70, "TechNoteText",ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169",
 CellID->2057600420],
Cell[240009, 7163, 1701, 45, 70, "TechNoteText",ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd",
 CellID->1161091299],
Cell[241713, 7210, 225, 4, 70, "TechNoteText",ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b",
 CellID->277562004],
Cell[241941, 7216, 339, 5, 70, "TechNoteText",ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a",
 CellID->650119944],
Cell[242283, 7223, 810, 28, 70, "TechNoteText",ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4",
 CellID->169102872],
Cell[243096, 7253, 1128, 24, 70, "TechNoteText",ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be",
 CellID->991104723],
Cell[244227, 7279, 1700, 45, 70, "TechNoteText",ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b",
 CellID->1613913329],
Cell[245930, 7326, 192, 4, 70, "TechNoteText",ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0",
 CellID->175375246],
Cell[246125, 7332, 4846, 121, 70, "TechNoteText",ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad",
 CellID->1184195838],
Cell[250974, 7455, 182, 3, 70, "TechNoteText",ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e",
 CellID->2048492517],
Cell[CellGroupData[{
Cell[251181, 7462, 446, 12, 70, "Input",ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49",
 CellID->555904515],
Cell[251630, 7476, 1155, 33, 86, "Output",ExpressionUUID->"662f35ad-a354-4351-9f3b-4b2c107324ac",
 CellID->1533319155]
}, Open  ]],
Cell[252800, 7512, 194, 4, 70, "TechNoteText",ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac",
 CellID->691274085],
Cell[CellGroupData[{
Cell[253019, 7520, 428, 12, 70, "Input",ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208",
 CellID->357016325],
Cell[253450, 7534, 1250, 35, 120, "Output",ExpressionUUID->"b226fca4-48a2-46dd-93a6-03781efd2e1a",
 CellID->304064557]
}, Open  ]],
Cell[254715, 7572, 146, 1, 70, "TechNoteText",ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e",
 CellID->1549413286],
Cell[CellGroupData[{
Cell[254886, 7577, 903, 23, 70, "Input",ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38",
 CellID->602394280],
Cell[255792, 7602, 1828, 43, 96, "Output",ExpressionUUID->"7f9bc3b4-fa99-4833-9220-ab11c046a378",
 CellID->1202752002]
}, Open  ]],
Cell[257635, 7648, 130, 1, 70, "TechNoteText",ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228",
 CellID->389328403],
Cell[CellGroupData[{
Cell[257790, 7653, 1034, 27, 70, "Input",ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2",
 CellID->59796812],
Cell[258827, 7682, 2512, 59, 91, "Output",ExpressionUUID->"e970626b-bc5f-4595-a47b-b1f46828ace1",
 CellID->2130156135]
}, Open  ]],
Cell[261354, 7744, 186, 4, 70, "TechNoteText",ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76",
 CellID->834281808],
Cell[CellGroupData[{
Cell[261565, 7752, 551, 16, 70, "Input",ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2",
 CellID->853615793],
Cell[262119, 7770, 669, 19, 100, "Output",ExpressionUUID->"baa695c6-566d-4910-bb28-f0a002f38d37",
 CellID->1529870991],
Cell[262791, 7791, 668, 19, 100, "Output",ExpressionUUID->"a9228a82-8548-458a-866f-5cf7f54f101e",
 CellID->720040206]
}, Open  ]],
Cell[263474, 7813, 624, 13, 70, "TechNoteText",ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9",
 CellID->645391397]
}, Open  ]],
Cell[CellGroupData[{
Cell[264135, 7831, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
 CellTags->"Section23",
 CellID->153308382],
Cell[264272, 7835, 427, 7, 70, "TechNoteText",ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6",
 CellID->1821083521],
Cell[264702, 7844, 280, 5, 70, "TechNoteMathCaption",ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98",
 CellID->1013800403],
Cell[CellGroupData[{
Cell[265007, 7853, 553, 17, 70, "Input",ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8",
 CellID->808117923],
Cell[265563, 7872, 1247, 40, 39, "Output",ExpressionUUID->"6f9f5f4e-184e-4258-8e42-ddd59c3129bc",
 CellID->1422201642]
}, Open  ]],
Cell[266825, 7915, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28",
 CellID->322701359],
Cell[CellGroupData[{
Cell[267060, 7923, 267, 7, 70, "Input",ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4",
 CellID->1245532038],
Cell[267330, 7932, 1522, 45, 45, "Output",ExpressionUUID->"6f3803af-87a4-40d1-8cad-3a178bd73865",
 CellID->841991803]
}, Open  ]],
Cell[268867, 7980, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3",
 CellID->730080199],
Cell[CellGroupData[{
Cell[269088, 7988, 375, 11, 70, "Input",ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459",
 CellID->1883829282],
Cell[269466, 8001, 3152, 110, 180, "Output",ExpressionUUID->"a9ff9460-ef83-4a95-94dc-f4b12655ea7e",
 CellID->1120532934]
}, Open  ]],
Cell[272633, 8114, 200, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833",
 CellID->2133759026],
Cell[CellGroupData[{
Cell[272858, 8122, 348, 9, 70, "Input",ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045",
 CellID->1258528729],
Cell[273209, 8133, 9794, 290, 239, "Output",ExpressionUUID->"7347690f-12cf-412c-9715-34677d5218a3",
 CellID->1476939964]
}, Open  ]],
Cell[283018, 8426, 371, 7, 70, "TechNoteMathCaption",ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030",
 CellID->702850526],
Cell[CellGroupData[{
Cell[283414, 8437, 382, 11, 70, "Input",ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468",
 CellID->1648731982],
Cell[283799, 8450, 9100, 285, 260, "Output",ExpressionUUID->"7a469504-7b5d-4b60-ac0b-eff89c5422f1",
 CellID->741954985]
}, Open  ]],
Cell[292914, 8738, 400, 6, 70, "TechNoteMathCaption",ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80",
 CellID->328948492],
Cell[CellGroupData[{
Cell[293339, 8748, 257, 6, 70, "Input",ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24",
 CellID->1014397666],
Cell[293599, 8756, 4385, 99, 95, "Output",ExpressionUUID->"c59c6de4-581d-4fe3-a52d-9fa155ff8616",
 CellID->1954897260]
}, Open  ]],
Cell[297999, 8858, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3",
 CellID->608232459],
Cell[CellGroupData[{
Cell[298220, 8866, 337, 9, 70, "Input",ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37",
 CellID->540778693],
Cell[298560, 8877, 3153, 110, 180, "Output",ExpressionUUID->"a1e23ced-e2b0-4bfb-82dd-55bd18bfb20a",
 CellID->1069105726]
}, Open  ]],
Cell[CellGroupData[{
Cell[301750, 8992, 220, 6, 70, "Input",ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb",
 CellID->326787606],
Cell[301973, 9000, 667, 19, 100, "Output",ExpressionUUID->"a75fa0b1-962a-4414-8c32-ca0bd5dde293",
 CellID->306127092]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[302679, 9024, 755, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"3e82acbb-dc25-4d40-86b7-29a112386fe5"],
Cell[303437, 9045, 1119, 29, 70, "RelatedTutorialsSection",ExpressionUUID->"58ebfef8-db7f-40aa-9d60-b0b07f1255ec"],
Cell[304559, 9076, 5256, 132, 70, "TutorialRelatedLinksSection",ExpressionUUID->"5dfe1c60-4824-469e-a8b3-2558ec56e88c"]
}, Open  ]],
Cell[309830, 9211, 78, 0, 70, "FooterCell",ExpressionUUID->"33b31505-cbf5-4be0-8dff-2d21eae26d5f"]
}
]
*)

(* End of internal cache information *)

