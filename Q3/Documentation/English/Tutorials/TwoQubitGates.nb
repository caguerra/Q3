(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    557046,      14472]
NotebookOptionsPosition[    497544,      13307]
NotebookOutlinePosition[    504111,      13457]
CellTagsIndexPosition[    503657,      13440]
WindowTitle->Two-Qubit Gates
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "42625437-8559-4c7c-b34a-c2f36fa3f85c"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "82903b3d-6fb7-4f25-9749-9ce18f7f3bbb"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[Cell[BoxData[
     TagBox[
      ActionMenuBox[
       FrameBox[Cell[TextData[{
         "URL",
         " ",
         Cell[BoxData[
          GraphicsBox[
           {GrayLevel[0.66667], Thickness[0.13], 
            LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
           AspectRatio->1,
           AxesStyle->Large,
           FrameStyle->Large,
           ImageSize->20,
           PlotRange->{{-3, 4}, {-1, 1}},
           PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
          "6577562e-50d7-462e-8ce7-e699b5335388"]
        }],ExpressionUUID->"8fd0ba4f-9bf7-4187-8a56-3e6d3f32e7d8"],
        StripOnInput->False],{
       "\"Q3/tutorial/TwoQubitGates\"" :> None, 
        "\"Copy Wolfram Documentation Center URL\"" :> 
        Module[{DocumentationSearch`Private`nb$}, 
          DocumentationSearch`Private`nb$ = 
           NotebookPut[
            Notebook[{Cell["Q3/tutorial/TwoQubitGates"]}, Visible -> False]]; 
          SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
          FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
          NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
        "\"Copy web URL\"" :> 
        Module[{DocumentationSearch`Private`nb$}, 
          DocumentationSearch`Private`nb$ = 
           NotebookPut[
            Notebook[{
              Cell[BoxData[
                MakeBoxes[
                 Hyperlink[
                  "http://reference.wolfram.com/language/Q3/tutorial/\
TwoQubitGates.html"], StandardForm]], "Input", TextClipboardType -> 
                "PlainText"]}, Visible -> False]]; 
          SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
          FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
          NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        "\"Go to web URL\"" :> 
        FrontEndExecute[{
          NotebookLocate[{
            URL[If[TrueQ[False], 
                "http://reference.wolfram.com/system-modeler/", 
                "http://reference.wolfram.com/language/"] <> 
              "Q3/tutorial/TwoQubitGates" <> ".html"], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"],
      MouseAppearanceTag["LinkHand"]]],
     LineSpacing->{1.4, 0},ExpressionUUID->
     "4791208f-54a9-445c-bc56-01e8d5c8cd9a"]], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "8b202b27-bb61-42c9-a35b-e986d7cefbff"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1,ExpressionUUID->"1260b555-49e0-471c-bc9e-6d0342dfd11b"],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "TechNoteTitle",
 CellID->1379112571,ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Controlled-NOT Gate (CNOT)"], 
      "paclet:Q3/tutorial/TwoQubitGates#1585062394", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Controlled-Unitary Gates"], 
      "paclet:Q3/tutorial/TwoQubitGates#1455445268", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Controlled-Z Gate (CZ)"], 
      "paclet:Q3/tutorial/TwoQubitGates#29167796", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["General Unitary Gates"], 
      "paclet:Q3/tutorial/TwoQubitGates#1476129218", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Swap Gate"], "paclet:Q3/tutorial/TwoQubitGates#1218939314", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"6be900c6-91d5-4904-b8d2-\
ce44e8029b45"],

Cell[TextData[{
 "See also Section 2.2 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "011d1bed-6ccc-4675-a186-9e146775ef49"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383"],

Cell[TextData[{
 "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4\[Times]4 unitary matrices. We \
will see that any two-qubit gate operations can be decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 ". A ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " acts a unitary operator on one qubit depending on the logical state of the \
other qubit. A controlled-unitary gate on two qubits can be further \
decomposed into factors including only the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " and single-qubit rotation gates. In this sense, the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " alone is sufficient for any two-qubit gate."
}], "TechNoteText",
 CellID->1465929903,ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c"],

Cell[TextData[{
 "The ",
 ButtonBox["controlled-unitary",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " and ",
 ButtonBox["CNOT gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " have various interesting properties that make them useful in implementing \
quantum algorithms. In this document, we first examine the basic properties \
of the CNOT gate, and in particular, how it is used to generate an \
entanglement between two qubits. Then, we discuss the properties of the ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 " and describe how to implement a controlled-unitary gate in terms of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1585062394"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates#1113797362"],
 ". Finally, we discuss how an arbitrary two-qubit unitary operation can be \
decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1455445268"],
 "."
}], "TechNoteText",
 CellID->1951481337,ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-NOT or CNOT gate", "TechNoteTableText",ExpressionUUID->
     "fd2154fb-d8e1-4837-800b-09a7ff1ebc5d"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:Q3/ref/CZ", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-Z or CZ gate", "TechNoteTableText",ExpressionUUID->
     "4bbf74e4-e4fb-4367-aa6f-1364552cd4cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["Swap"]], "paclet:Q3/ref/Swap", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The Swap gate exchanging the states between two qubits", 
     "TechNoteTableText",ExpressionUUID->
     "309b92d2-10a9-4ceb-a3cb-d80c05cc177f"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledGate"]], "paclet:Q3/ref/ControlledGate", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-unitary gates", "TechNoteTableText",ExpressionUUID->
     "51fb4670-e668-485b-a64e-5a3fd7e559cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["GivensRotation"]], "paclet:Q3/ref/GivensRotation", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents two-level unitary transformation", "TechNoteTableText",
     ExpressionUUID->"abd02730-9c1c-412f-aeed-26c5964b494e"]}
  }]], "DefinitionBox",
 CellID->407539380,ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5"],

Cell["Two-qubit gates available in Q3.", "TechNoteCaption",
 CellID->1189009377,ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[185]:=",
 CellID->853967906,ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6"],

Cell[TextData[{
 "Throughout this documentation, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[186]:=",
 CellID->403330096,ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736"],

Cell[CellGroupData[{

Cell["Controlled-NOT Gate (CNOT)", "TechNoteSection",
 CellTags->"Section11",
 CellID->1585062394,ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458"],

Cell[TextData[{
 "The  controlled-NOT or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e620a8c8-0da2-4add-9e60-e9b95269af8c"],
 " gate is a quantum logic gate on two qubits that maps the logical basis \
states as"
}], "TechNoteText",
 CellID->609014923,ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CNOT", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        RowBox[{"c", "\[CirclePlus]", "t"}]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d65b82c4-da31-4b40-8e51-3f9ddd06ee1b"]
}], "TechNoteText",
 CellID->806749259,ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "9029aa68-1d83-41e2-8780-ffac38998045"],
 ", where the first qubit is typically called the ",
 StyleBox["control qubit",
  FontSlant->"Italic"],
 " (c) and the second qubit the ",
 StyleBox["target qubit",
  FontSlant->"Italic"],
 " (t)."
}], "TechNoteText",
 CellID->1970532502,ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[156]:=",
 CellID->246957080,ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"2"},
       "RowDefault"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[156]=",
 CellID->558783466,ExpressionUUID->"78d241be-9db2-4032-8a34-d6212e8acae2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[157]:=",
 CellID->149239284,ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXlsDe8ax6utapTm2hshdWNL2oilYguVK4pbRKgldv1F/Yili3LTBA3X
kvgDN4pIQ6K2iB8JSRFpomIpf9BSS5AQa1xNkItar/c+t29M5vf2nDnvzJkz
8870+0lIz5w58zzn+Z4zy+ny+etvuVMWRUdFRa2Mp/+mZP/jbwUF2UVZf6Eb
01asXPL7ipyFf19RmPN7TsGQ32Jo4R/07z/07/9fMwAAAAAANejQoYPbLbhP
bm7ujh073O4iAEiHWUoHcyO2b9/et29ft7sIANJhltLB3IjHjx/T1TT973Yj
IkiHWUoHc+PQ3mDbtm1udyGCdDhm08HcOMXFxenp6W53IYJ0OGbTCTm32tra
1atX0zZTU1MXLFhw8ODB8BoMjfMViZqampiYmLq6OgdqyYN0OGbTMZ7bmTNn
WrVqFfVnsrOzv337ZkezSlTU6Nat2759+yJdxRRIR8NUOgZze/ToEb1BqO2J
EydWV1e/fPmypKQkNjaWlhQVFdnUrMsV9eTl5VHdSFcxBdLRMJWOwdyWLVtG
DY8YMUL/Tty/fz8tbNOmzcePH8NtVIGKeiorK+Pj4yNdxRRIR8NUOsHm9unT
p4SEBGr4xIkT+uXfv39PSkqi5aWlpTb06mpFgR8/frRv316o7i5IR8NUOsHm
dvfuXWq1ZcuWjU+Zli5dSnfl5uaG26jbFRtDp4hz5syxZVP379/ftGlTmBtB
Onrk0wk2t/Pnz1OrPXr0YA1vk7Vr186aNevOnTt0c+vWrXRXVlaWjQ27UrEx
p06dooMp7X/C3xQ/Yubn54ezEaSjRz6dYHPj50vDhw+nr8vLy/nV7qRJk+hm
WVkZfT1kyBDhIe/evaOLiLdv31rr2fmKjamvr6fjbEVFhS1bO3fuXIsWLQoK
CixvAenokU8n2Nz27NlDrY4aNYo1fJ7Dn8WECRPo5rFjx+jrfv36aSvT1XFG
Rob2UQ+9o2kdsz07XzEgU6ZMocsiWzbFGp4IvbALCwutPRzpCEimE2xutLen
fvr06cN+HXHmz5/Pjzg7d+6ku8aPH8/X/PLlS8+ePZs1azZ79uy9e/du2LCh
V69etEJVVZWphp2vGBDa83Tp0kVy5f9KcPr06ebNm69atcpCM0hHQDKdYHO7
ceMGdRLw3jVr1tBdixYt4jevXr2qf1Ks4Xr56NGjZht2vmJAnjx5EiX3szS3
bt2KMsPJkyfNNoN0BCTTCTa3uro6ervRFmpqaoS7Bg0aRMs3b97Mb/LjUfhH
becrBoTmn5SU9PPnz5Br0mXLQwlog9Qt7bhov222GaQjIJmOwef848aNa9ze
7du3aWF0dLT2fqHLgXbt2tFTzsvLe/bsWcBN0YXD4cOHZ8yYQadnBs3YVZF2
LMuXL09LS0tJSaGijYMwgNbXdjvhc/PmzbZt286cOZOO2hYejnQEJNMxmNvZ
s2ep4ZiYmEOHDvElr1696t27Ny2cPHmyfs0rV64kJyfzlbOysi5fvqy/d8uW
LfxtTuTk5Bg0Y0tFOpeLi4uj19L06dNpdLQOndbSqyvkKIivX78mJibS3kZm
5ZBUV1fzNqy9pBnS+TPy6RjMjfbz8+bNo7r0rKmBzMxM2ibd7Nq164MHDxpX
PHDgwMCBA/l86D1FS/hd165do50A/1TTeG62VFy3bl16err2gRKdzdK906ZN
CzkK1vBZXOvWrel6R2ZlY+ism3ZZU6dODefTb6SjRz4d458KoydCV7v0zuK9
xcbGjhw58sWLFwYPuXTpUv/+/fUnWpw3b96EnJtdFfX7Rjqb7dixY2pqqnFd
zuLFiyUnHBK6aMrOzg7zGzpIR498OjI/l07P5d69e1VVVXQxK7NNepr0LMaM
GaNfKDk3GytyaBeRkJBAOxaZop07d6YzTJmKzoB09EXl0wn/ty0qKysLCwvr
6+u1JfywMnfuXP1qpuZmS0VOSUkJ3UWncyE3e/36dTrHo0un8Du0C6SjYSqd
8OdGp0zUWPfu3VeuXLlr1y6aDG2Tjk106NGvZuPcJCuyht+hiI+PHzZsmMyn
akVFRaNHjw6/PRtBOhqm0gl/bnRo2L17N10LR0dH89Mt+rq8vFxYzca5SVas
ra2lcza6lnn69KnMZlNSUmjXEX57NoJ0NEylY+Pve3748KG6ujrYL5fZODeZ
irQfoKfWqVOnxpfnAXn48CG19/z5cxvbCx+kwzGbjmO/xRyJuQWjoqIiMTEx
OTlZcmis4ccp09LSItqVBZAOx2w6kZ4bvcv+1cD69etpbkOHDuU3L1y4EKGK
R44ciYuLo1r5+fkbN2785y8uXrxo8Cg6u6N1ItSSZZAOx2w6kZ7b8ePHowKx
cOHCCFUcPHhwwIrFxcXBHvL69Ws6CaQzvQi1ZBmkwyylg7+jQpSWltI1u9td
BADpMEvpYG6s4cMoyz/YH1GQDrOUDuamMkjHGpibyiAda2BuKoN0AAAAAAAA
AAAAAAAAAAAAAAAgcuB7sgwec7WBx9wa8JirDDzm1oDHXGXgMbcMPOYqA4+5
NeAxVxkfeMyJz58/l5WVLVmyxLGLOHjM5VE/HdVM2fv378/IyOB/QpYYMGBA
hAo1Bh7zkHglHaVM2URmZqY+IyfnBo95SLySjlKmbOL9+/f/boA7dJycGzzm
IfFKOuqYsgXomtfhucFjLo/i6ahjyhZwfm4MHnNpFE9HHVO2gCtzg8dcEsXT
UceULSAzN3jMGdIJhDqmbAHjubluypbENx5zAcXTUceULWAwNxVM2Zym4zEX
UDwddUzZAgZzU8GUzZqYx1xA8XTUMWULGMxNBVM2a2IecwHF01HKlK3HYG4q
mLIl8ZPHXI/i6ShlytZjfD3iuilbBp95zPUono5Spmy6wu34C+3ndrQlY8eO
lakIjznSUcqUzc8Jg6H/tMq4IjzmwWgi6ahpyjYLPOZIRw9M2RrwmPsmHZiy
NeAx9006MGVrwGPum3RgyubAY+6ndGDK5sBj7qd0YMrmwGPup3RgymbwmPsu
HfwdFQaPudrAY24NeMxVBh5zn4F0rIG5qQzSsQbmpjJIBwAAAAAAAAAAAAAA
AAAAAAAAIge+J8vgMVcbeMytAY+5ysBjbg14zFUGHnPLwGOuMvCYWwMec5Wx
3WPOHPdWu+Lm9qjHnLlhFfe6x9x5b7Xzbm4Nz3nMnU/HBx5z5ri32hU3t4a3
PObMDau4DzzmzHFvtStubg1vecyZG1Zxr3vMBRxwobru5vaQx1zAeVOtRz3m
Ag48C9fd3Mw7HnOBpvCqZnZ4zAUceBauu7mZdzzmAk3kVR2+x1zAAW+1625u
5h2PuYDzVnGPeswFHPBWu+7m5njCYy7gvFXcox5zAQe81a67uTme8JgLOG8V
96jHXMABb7Xrbm6OJzzmAs5bxT3qMRdwwFvtupub4wmPuYDzVnHvesz1hOOt
ZtKmbLvc3E3BY67HmXTsquiux1yPZW81M2PKtsXN3UQ85nqcSceWiq57zG3x
VjMzpmxb3NxNxGPufDr+8Jjb5a3mSFqibHFzNwWPufPp+MxjbpbwTdm2uLk5
vveYmwUecxmapinbGZCOBjzmGvCYN810YMrWgMfcN+nAlM2Bx9xP6cCUzYHH
3E/pwJTNgcfcT+nAlM3gMfddOvg7Kgwec7WBx9wa8JirDDzmPgPpWANzUxmk
Yw3MTWWQDgAAAAAAAAAAAAAAAAAAAAAARA58T5bBY6428JhbAx5zlYHH3Brw
mKsMPOaWgcdcZeAxtwY85irjA4+5KxXhMZfEE5Z5mLI14DEPiVcs8zBla8Bj
boyHLPMwZWvAY26MhyzzsK9qwGNugLcs8+rMzfWKDB7z4HjLMq/O3FyvyOAx
D463LPMwZeuBxzwY3rLMw5QtAI95QLxlmYcpWwAe84B4yzIPU7YAPOYB8ZZl
HqZsAXjMA+ItyzxM2QLwmAfDQ5Z5mLL1wGNuUMVDlnmYsvXAY27QjIcs8zBl
64HH3Lgfr1jmYcrWgMfcN5Z5mLI14DH3TTowZWvAY+6bdGDK1oDH3DfpwJTN
gcfcT+nAlM2Bx9xP6cCUzYHH3E/pwJTN4DH3XTr4OyoMHnO1gcfcGvCYqww8
5j4D6VgDc1MZpGMNzE1lkA4AAAAAgIL8DyKGbVw=
    "], {{0, 86.}, {121., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    RasterInterpolation->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{121., 86.},
  PlotRange->{{0, 121.}, {0, 86.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[159]//TableForm=",
 CellID->201904416,ExpressionUUID->"9ba3f8ba-f407-4eb1-9f0f-8cdb090acd32"]
}, Open  ]],

Cell["\<\
It has the following matrix representation in the logical basis\
\>", "TechNoteText",
 CellID->690265281,ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[160]:=",
 CellID->581916673,ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[161]//MatrixForm=",
 CellID->1605179591,ExpressionUUID->"3c1eea45-5fae-4dd3-bb12-726c0bfdef46"]
}, Open  ]],

Cell["\<\
and is expressed in terms of the Pauli operators on the control and target \
qubit as\
\>", "TechNoteText",
 CellID->107481873,ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "op", "]"}]], "Input",
 CellLabel->"In[162]:=",
 CellID->414092384,ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]], "2"]}]], "Output",
 CellLabel->"Out[162]=",
 CellID->1908217771,ExpressionUUID->"63aff9c0-f715-42e5-b050-eab99f429e37"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "op", "]"}], "//", "PauliForm"}]], "Input",
 CellLabel->"In[163]:=",
 CellID->597624604,ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"],
   Rational[1, 2]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}],
    $CellContext`S[2, 1]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 3]], "2"], "-", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]], "2"]}]], "Output",
 CellLabel->"Out[163]=",
 CellID->507831260,ExpressionUUID->"af082845-f690-419e-bb3f-d91916a4f93f"]
}, Open  ]],

Cell["\<\
In quantum circuit model, it is represented as the following circuit element\
\>", "TechNoteText",
 CellID->1181321350,ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[164]:=",
 CellID->981612935,ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[164]=",
 CellID->1480642977,ExpressionUUID->"d6bfec8b-8117-45e2-9e1b-a0b5f5a2b864"]
}, Open  ]],

Cell["\<\
where the smaller filled circle indicates the dependence on the state of the \
control qubit and the circled-plus sign denotes the conditional NOT action on \
the target qubit.\
\>", "TechNoteText",
 CellID->606925297,ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39"],

Cell[TextData[{
 "A simple yet important feature of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5880ef7f-73b8-4ab6-82cc-87dc0d31f1eb"],
 " is to copy the logical state of the control qubit to the target bit \
provided that the target bit is initially set to |0\:27e9; or the reversed \
state when the target qubit is in |1\:27e9. A vital implication is that CNOT \
generates an entangled state when the control qubit is in a superposition:"
}], "TechNoteText",
 CellID->46143429,ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], 
      RowBox[{"c", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "->", "1"}], "]"}], 
      RowBox[{"c", "[", "1", "]"}]}]}], "//", "KetRegulate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "->", "out"}], "//", "KetFactor"}]}], "Input",
 CellLabel->"In[168]:=",
 CellID->291014636,ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 0|>]]}],
    HoldForm],
   Q3`OTimes[$CellContext`c[0] 
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>]]], "\[Rule]", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
   "+", 
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1|>]]}]}]}]], "Output",
 CellLabel->"Out[170]=",
 CellID->538831450,ExpressionUUID->"0c57e250-12c6-43df-b616-5e8e722bc0ed"]
}, Open  ]],

Cell[TextData[{
 "Applying a single qubit rotation such the Hadamard gate on the control \
qubit prior to CNOT, one can thus generate entangled states from logical \
states. In this sense, such a circuit is called a ",
 StyleBox["quantum entangler circuit",
  FontSlant->"Italic"],
 ".  In general, the different product states in the logical basis are \
transformed to different ",
 StyleBox[ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/BellState"],
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->1152615977,ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "op"}], "]"}]}]], "Input",
 CellLabel->"In[171]:=",
 CellID->1714229499,ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[171]=",
 CellID->741907886,ExpressionUUID->"2c912e97-90cc-4489-affc-13cdd8cff7f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[172]:=",
 CellID->1435008719,ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[174]//TableForm=",
 CellID->1370067106,ExpressionUUID->"d90ed253-1a80-45c5-971a-af8d8bf6c275"]
}, Open  ]],

Cell[TextData[{
 "One can further generalize the above procedure to generate maximally \
entangled states between larger systems: Consider two quantum registers, each \
consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "af6575a1-43d0-4455-97df-db7ec963065c"],
 " qubits. We respectively call them the \[OpenCurlyQuote]control\
\[CloseCurlyQuote] and \[OpenCurlyQuote]target\[CloseCurlyQuote] register for \
the reason that will be clear below. Upon applying the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "901a47ec-7470-4146-b686-042c18f982bb"],
 " gate on each pair of the corresponding qubits in the two registers as in \
the quantum circuit,"
}], "TechNoteText",
 CellID->1854176847,ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"2", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{"CNOT", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[175]:=",
 CellID->1015065912,ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}, {{0, -6}, {4, -6}}, {{0, -7}, {4, -7}}}], {
     LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -7}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[178]=",
 CellID->53398403,ExpressionUUID->"83c8af77-3069-47c5-b836-a9d6e31090cb"]
}, Open  ]],

Cell["the logical basis states are transformed as", "TechNoteText",
 CellID->1898388060,ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       RowBox[{"c", "\[CirclePlus]", "t"}]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "d41dd958-8763-4d29-b6bc-67bf58980937"],
 " ."
}], "TechNoteText",
 CellID->1043580941,ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775"],

Cell[TextData[{
 "The above association rule is formally the same as the one in (2.29) for a \
single pair of qubits. Here, however, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"c"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["c", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "18193fb8-fe63-46e6-9adb-b49b66691c9d"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"t"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["t", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "383ed95f-2d83-49c9-ab80-3650c110e70c"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[CirclePlus]", " ", "t"}], TraditionalForm]],
  ExpressionUUID->"30dfbfdc-abc1-4a43-91e4-a024c634e3b0"],
 " denotes the bit-wise exclusive OR (or XOR),"
}], "TechNoteText",
 CellID->965930338,ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "\[CirclePlus]", "t"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["t", "1"]}], ",", 
      RowBox[{
       SubscriptBox["c", "2"], "\[CirclePlus]", 
       SubscriptBox["t", "2"]}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["c", "n"], "\[CirclePlus]", 
       SubscriptBox["t", "n"]}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "9e89c491-b7a9-4bcf-a5bc-3c8c03b067f7"],
 " ,"
}], "TechNoteText",
 CellID->1562303093,ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98"],

Cell[TextData[{
 "for the n-bit strings ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", 
      SubscriptBox["c", "2"], ",", "...", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "91a8d8cd-fe5c-488a-9717-c0bf12b93c97"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["t", "1"], ",", 
      SubscriptBox["t", "2"], ",", "...", ",", 
      SubscriptBox["t", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1fef8f88-4c88-4714-b329-9a1d4305b835"],
 ". When the target register is prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "391653d4-d933-4e3c-bfda-d4c2b5266109"],
 ", the logical basis state of the control register is copied to the target \
register,"
}], "TechNoteText",
 CellID->345532182,ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "4192506e-ca86-4264-86b6-2c76afde6035"]
}], "TechNoteText",
 CellID->563601386,ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547"],

Cell[TextData[{
 "under the set of CNOT gates on paired qubits. More interestingly, when the \
control register is prepared in a superposition, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "7621ce2f-1c13-42ff-8aaa-50dbcc2924dd"],
 ", and the target register x=0 is in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "709dc516-26c0-43cb-8ffe-0b30b3555103"],
 ", the CNOT gate makes a copy of each logical state of the control register \
to the target register, leading to a maximally entangled state,"
}], "TechNoteText",
 CellID->2045611232,ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"n", "/", "2"}]]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"x", "=", "0"}], 
          RowBox[{
           SuperscriptBox["2", "n"], "-", "1"}]], 
         TemplateBox[{"x"},
          "Ket"]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], "\[RightTeeArrow]", 
     TemplateBox[{"\[CapitalPhi]"},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3c877f12-3f98-4a5b-a91c-f841483a1dff"]
}], "TechNoteText",
 CellID->1522271401,ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe"],

Cell[TextData[{
 "between the two registers (rather than single qubits). Since the \
superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "1a3df944-a9d2-4c37-90ff-bc9e60e7f1ab"],
 " is obtained just by the ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/Hadamard"],
 ", the maximally entangled state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3a3d096e-4106-4349-bb5a-6c3a2214bc3f"],
 " can be generated from the logical state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "cb7d677d-5c29-463c-af58-230e5263bea6"],
 " through the following quantum circuit."
}], "TechNoteText",
 CellID->1842749896,ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qce", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[179]:=",
 CellID->88345038,ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -5}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
         2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -7}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[179]=",
 CellID->1392711197,ExpressionUUID->"c7409dab-5259-4dd5-bc5f-71a5186ce849"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qce", "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[180]:=",
 CellID->1915435092,ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[181]=",
 CellID->2015811498,ExpressionUUID->"dff32074-78d9-4fff-810a-f58b8be0335f"]
}, Open  ]],

Cell["\<\
It is also interesting to note that even though |\[CapitalPhi]\:27e9 is a \
maximally entangled state between the control and target registers, it is a \
product state of n maximally entangled pairs\
\>", "TechNoteText",
 CellID->716147443,ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "38a75842-a8e5-4adf-850b-3ff2f0bcef8e"],
 " ."
}], "TechNoteText",
 CellID->1791716713,ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182"],

Cell["\<\
The entanglement strongly depends on how you partition the system.\
\>", "TechNoteText",
 CellID->1367097157,ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b"],

Cell["\<\
Another generalization of copying logical basis states to a series of qubits \
by consecutively applying CNOT gates with a single control qubit on multiple \
target qubits is shown in the following quantum circuit,\
\>", "TechNoteText",
 CellID->874378446,ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "List"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[182]:=",
 CellID->447945501,ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -4}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[186]=",
 CellID->2003916806,ExpressionUUID->"d1cf96f5-c45f-432b-b69e-faea76873e4f"]
}, Open  ]],

Cell["or equivalently,", "TechNoteText",
 CellID->880946029,ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"CNOT", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[187]:=",
 CellID->1307646985,ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[190]=",
 CellID->1957181437,ExpressionUUID->"7383e199-5344-4218-a14b-f4f2a9ded1c5"]
}, Open  ]],

Cell["\<\
When the target qubits are all prepared in the logical basis state |0\:27e9, \
the series of CNOT gates makes the transformation\
\>", "TechNoteText",
 CellID->169608441,ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "e54c9567-fcf6-4bb6-aa51-ad46d78abac5"]
}], "TechNoteText",
 CellID->898268318,ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1"}], TraditionalForm]],ExpressionUUID->
  "180a4472-59f2-40f1-bee7-baf558860f8d"],
 ". Therefore, a simple application of the Hadamard gate in the control qubit \
before the CNOT gates, "
}], "TechNoteText",
 CellID->385582216,ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}}], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{3, -1}, {3, -3}}], 
      DiskBox[{3, -1}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
       LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
          3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
      LineBox[{{4, -1}, {4, -4}}], 
      DiskBox[{4, -1}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
       LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
          4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->226.79999999999998`,
    PlotRangePadding->Scaled[0.025]], ","}]}]], "TechNoteText",
 CellID->1620101282,ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc"],

Cell["can generate a state of the form", "TechNoteText",
 CellID->712578174,ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"GHZ"},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"]}]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "0ba762a6-c203-49b1-a60e-a6e8325930d1"],
 " ."
}], "TechNoteText",
 CellID->1522141313,ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621"],

Cell["\<\
The above state, which is known as the Greenberger-Horne-Zeilinger (GHZ) \
state (Greenberger et al., 1989), exhibits a quantum entanglement of more \
than two particles. It has stimulated tests of non-locality of quantum \
mechanics beyond Bell inequalities (Bouwmeester et al., 1999; Pan et al., \
2000).\
\>", "TechNoteText",
 CellID->1803844527,ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929"],

Cell[TextData[{
 "Quantum entanglement is a valuable resource in quantum information \
processing and in quantum communication. The most popular example of such is ",
 ButtonBox["quantum teleportation",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"],
 "."
}], "TechNoteText",
 CellID->1188320590,ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed"],

Cell["\<\
In the above consideration, CNOT gates with the same control qubit are \
applied on different target qubits. The opposite setting brings forth \
additional applications of CNOT as illustrated in the following quantum \
circuit.\
\>", "TechNoteText",
 CellID->506239030,ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, InsetBox[
     StyleBox[
      TemplateBox[{
        RowBox[{
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, Rational[1, 2]}]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->1226753413,ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3"],

Cell["\<\
 In this quantum circuit, the successive application of the CNOT gates on the \
same target qubit with different control qubits results in the accumulation \
of the logical bit values of all qubits. The same goal may be achieved by \
applying the CNOT gates on the consecutive pairs of qubits as\
\>", "TechNoteText",
 CellID->365203462,ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -3}, ImageScaled[{0, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->977674470,ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38"],

Cell[TextData[{
 "In this case, not only the last qubit but also the qubits in the middle are \
modified. However, this makes little difference since the quantum circuit \
block is mostly used to conditionally control the operation of an unitary \
gate on a different qubit and the whole block must be undone anyway (see, for \
example, the ",
 ButtonBox["quantum circuit of conditional unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1379525988"],
 ")."
}], "TechNoteText",
 CellID->833871357,ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Z Gate (CZ)", "TechNoteSection",
 CellTags->"Section12",
 CellID->29167796,ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[191]:=",
 CellID->754200946,ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[192]:=",
 CellID->1406814828,ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b"],

Cell["\<\
An interesting variant of CNOT gates is the so-called controlled-Z or CZ \
gate. This is a quantum logic gate on two qubits that maps the logical basis \
states as\
\>", "TechNoteText",
 CellID->596875856,ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CZ", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"t"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"c", " ", "t"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "1ea385c0-0dbd-4923-90b1-9729933fa242"]
}], "TechNoteText",
 CellID->796396655,ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "a224194f-7edc-4912-ab58-d4d4eb23fe22"],
 "."
}], "TechNoteText",
 CellID->1920492481,ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[194]:=",
 CellID->1037913757,ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`S[1, Q3`$]], "}"}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"2"},
       "RowDefault"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[194]=",
 CellID->1753856987,ExpressionUUID->"53359433-e49f-4fb1-a850-866a0cf3056c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[195]:=",
 CellID->1887946780,ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]], 
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]], 
               $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[197]//TableForm=",
 CellID->502609038,ExpressionUUID->"ecabfdf9-6435-40f6-990b-e41a26edda92"]
}, Open  ]],

Cell["\<\
The matrix representation of the CZ gate in the logical basis is given by\
\>", "TechNoteText",
 CellID->1230965299,ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[198]:=",
 CellID->2123808742,ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellLabel->"Out[198]//MatrixForm=",
 CellID->116817163,ExpressionUUID->"8c570763-590f-43df-8ed8-46ae035ccbca"]
}, Open  ]],

Cell["\<\
Since it is symmetric for the two qubits, a distinction of the control and \
target qubit is meaningless. Accordingly, in quantum circuit model, the gate \
is depicted by the following quantum circuit element\
\>", "TechNoteText",
 CellID->776960470,ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[199]:=",
 CellID->1674045530,ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CZ[{
     $CellContext`S[1, Q3`$]}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[199]=",
 CellID->1496734992,ExpressionUUID->"601547be-a31d-4f29-a2a8-41d43abf1a22"]
}, Open  ]],

Cell["\<\
The filled circles on both qubit lines (rather than a square box on either \
qubit) indicate that the bit values of both qubits remain unchanged.\
\>", "TechNoteText",
 CellID->573709808,ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f"],

Cell[TextData[{
 "Noting the identity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", " ", "Z", " ", "H"}], "=", "X"}], TraditionalForm]],
  ExpressionUUID->"7a83536f-3ac5-4c9f-bee5-cbbd8e9da49f"],
 ", one can regard that the CZ gate is equal to the CNOT gate up to the \
Hadamard gate on the target qubit. The relation between the CNOT and CZ gate \
is illustrated in the following quantum circuits"
}], "TechNoteText",
 CellID->139168026,ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}]}], "]"}]}]}], "Input",\

 CellLabel->"In[200]:=",
 CellID->387321399,ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[200]=",
 CellID->2072971140,ExpressionUUID->"997911e8-ec49-48d9-a4fe-d992bd8fff2f"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[2, 6], 
   Q3`CZ[{
     $CellContext`S[1, Q3`$]}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[2, 6]]]], "Output",
 CellLabel->"Out[201]=",
 CellID->1798744699,ExpressionUUID->"a9d1bb79-fdff-4ca1-9cc5-6805dd789c63"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
       2.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
       2.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}, 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}]]], "Output",
 CellLabel->"Out[202]=",
 CellID->1374857274,ExpressionUUID->"a4b2f715-a1df-4fd4-952b-f512913f7608"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnot", "==", "cz1", "==", "cz2"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[203]:=",
 CellID->1606586072,ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[203]=",
 CellID->1513988403,ExpressionUUID->"e6040c8f-b482-4697-9bcc-16329ec94cc2"]
}, Open  ]],

Cell["\<\
Depending on the Hamiltonian of a particular physical system, direct \
realization of the CNOT gate may be considerably difficult while the CZ gate \
is relatively easier to implement. In such a case, the above identity offers \
a straightforward workaround for a physical implementation of the CNOT gate.\
\>", "TechNoteText",
 CellID->799932562,ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swap Gate", "TechNoteSection",
 CellTags->"Section13",
 CellID->1218939314,ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[204]:=",
 CellID->1843914595,ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[205]:=",
 CellID->336088308,ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5"],

Cell[TextData[{
 "Another interesting two-qubit gate is the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Swap"]], "paclet:Q3/ref/Swap", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1a92bc4f-5431-495f-93a4-bf7492e7da3f"],
 " gate that \[OpenCurlyQuote]swaps\[CloseCurlyQuote] the states of the two \
qubits and maps the logical basis states as"
}], "TechNoteText",
 CellID->1866541665,ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Swap", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "70e7957f-f62a-492d-b2fd-298b150e232a"]
}], "TechNoteText",
 CellID->524648279,ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e"],

Cell[BoxData[
 RowBox[{"for", " ", 
  RowBox[{Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Element]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
    "ff8569d5-2c51-4925-acc6-cd64fc41399b"]],ExpressionUUID->
    "9a7b9477-6dc2-4a42-bce9-11aaf19a2ff3"], "."}]}]], "TechNoteText",
 CellID->195770571,ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"Swap", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[207]:=",
 CellID->371039593,ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXlsDe8ax6utapTm2hshdWNL2oilYguVK4pbRKgldv0FP2Lpotw0QcO1
JP7AjSLSkKgt4kdCUkQkiKX8QWsPEmKNqwlyUev13uf2jcn83p4zZ2bOzLzv
TL+fhPTMmTPPc57vnDkzp8vnr7/lTZgfGxMTsyyR/puQ+4+/FRbmFuf8hW5M
Wrps4e9L5839+9Kieb/PKxzwWxwt/IP+/Yf+/f9rBgAAAACgBm3atJHdgnzy
8vK2bt0qu4sQIB1mKx3MjdiyZUvPnj1ldxECpMNspYO5EY8fP6arafpfdiMi
SIfZSgdz49DRYPPmzbK7EEE6HKvpYG6ckpKSzMxM2V2IIB2O1XQizu327dsr
Vqygbaanp8+ZM2ffvn3RNRgZ7ysS1dXVcXFxNTU1HtQyD9LhWE3HeG4nT55s
1qxZzJ/Jzc399u2bE80qUVGjU6dOu3fvdruKJZCOhqV0DOb26NEjeoFQ22PH
jq2qqnr58mVpaWl8fDwtKS4udqhZyRX15OfnU123q1gC6WhYSsdgbosXL6aG
hwwZon8l7tmzhxa2aNHi48eP0TaqQEU958+fT0xMdLuKJZCOhqV0ws3t06dP
SUlJ1PDRo0f1y79//56SkkLLy8rKHOhVakWBHz9+tG7dWqguF6SjYSmdcHO7
e/cutdq0adP6p0yLFi2iu/Ly8qJtVHbF+tAp4owZMxzZ1P3799evXx/lRpCO
HvPphJvbmTNnqNUuXbqwupfJqlWrpk2bdufOHbq5adMmuisnJ8fBhqVUrM/x
48fpzZSOP9Fvir9jFhQURLMRpKPHfDrh5sbPlwYPHkxfV1RU8KvdcePG0c3y
8nL6esCAAcJD3r17RxcRb9++tdez9xXrU1tbS++zZ8+edWRrp0+fbtKkSWFh
oe0tIB095tMJN7edO3dSq8OGDWN1n+fwZzFmzBi6efjwYfq6V69e2sp0dZyV
laV91EOvaFrHas/eVwzJhAkT6LLIkU2xuidCO3ZRUZG9hyMdAZPphJsbHe2p
nx49erBf7zizZ8/m7zjbtm2ju0aPHs3X/PLlS9euXRs1ajR9+vRdu3atXbu2
W7dutEJlZaWlhr2vGBI68nTo0MHkyv81wYkTJxo3brx8+XIbzSAdAZPphJvb
9evXqZOQ965cuZLumj9/Pr955coV/ZNiddfLhw4dstqw9xVD8uTJkxhzP0tz
8+bNGCscO3bMajNIR8BkOuHmVlNTQy832kJ1dbVwV79+/Wj5hg0b+E3+fhT9
u7b3FUNC809JSfn582fENemy5aEJaIPULR246LhttRmkI2AyHYPP+UeNGlW/
vVu3btHC2NhY7fVClwOtWrWip5yfn//s2bOQm6ILhwMHDkyZMoVOzwyacaoi
HViWLFmSkZGRlpZGResHYQCtrx12oufGjRstW7acOnUqvWvbeDjSETCZjsHc
Tp06RQ3HxcXt37+fL3n16lX37t1p4fjx4/VrXr58OTU1la+ck5Nz6dIl/b0b
N27kL3Ni3rx5Bs04UpHO5RISEmhfmjx5Mo2O1qHTWtq7Io6C+Pr1a3JyMh1t
zKwckaqqKt6GvV2aIZ0/Yz4dg7nRcX7WrFlUl541NZCdnU3bpJsdO3Z88OBB
/Yp79+7t27cvnw+9pmgJv+vq1at0EOCfahrPzZGKq1evzszM1D5QorNZunfS
pEkRR8HqPotr3rw5Xe+YWdkYOuumQ9bEiROj+fQb6egxn47xT4XRE6GrXXpl
8d7i4+OHDh364sULg4dcvHixd+/e+hMtzps3byLOzamK+mMjnc22bds2PT3d
uC5nwYIFJiccEbpoys3NjfIbOkhHj/l0zPxcOj2Xe/fuVVZW0sWsmW3S06Rn
MWLECP1Ck3NzsCKHDhFJSUl0YDFTtH379nSGaaaiNyAdfVHz6UT/2xbnz58v
Kiqqra3VlvC3lZkzZ+pXszQ3RypySktL6S46nYu42WvXrtE5Hl06Rd+hUyAd
DUvpRD83OmWixjp37rxs2bLt27fTZGib9N5Ebz361Rycm8mKrO53KBITEwcN
GmTmU7Xi4uLhw4dH356DIB0NS+lEPzd6a9ixYwddC8fGxvLTLfq6oqJCWM3B
uZmsePv2bTpno2uZp0+fmtlsWloaHTqib89BkI6GpXQc/H3PDx8+VFVVhfvl
MgfnZqYiHQfoqbVr167+5XlIHj58SO09f/7cwfaiB+lwrKbj2W8xuzG3cJw9
ezY5OTk1NdXk0Fjdj1NmZGS42pUNkA7Hajpuz41eZf+qY82aNTS3gQMH8pvn
zp1zqeLBgwcTEhKoVkFBwbp16/75iwsXLhg8is7uaB2XWrIN0uFYTcftuR05
ciQmFHPnznWpYv/+/UNWLCkpCfeQ169f00kgnem51JJtkA6zlQ7+jgpRVlZG
1+yyuwgB0mG20sHcWN2HUbZ/sN9VkA6zlQ7mpjJIxx6Ym8ogHXtgbiqDdAAA
AAAAAAAAAAAAAAAAAAAAwD3wPVkGj7nawGNuD3jMVQYec3vAY64y8JjbBh5z
lYHH3B7wmKtMADzmxOfPn8vLyxcuXOjZRZxPPebM81nBY26DPXv2ZGVl8T8h
S/Tp08elQvXxncfc+1nBY26P7Oxs/cS83Kv95TFnns8KHnPbvH///t91cIeO
l3u1vzzmzPNZwWMePXTN6/Fe7SOPuYAHs5K+P/jUYy7g/V7N/OMxF/BgVtL3
B+ZPj7mAlL3aLx5zAQ9mJX1/YP70mAuYSarBeswFPJiV9P2B+dNjLmCclHRT
tklc8pgLeDAr6fsDx3cecwGDpFQwZXNkecwFPJiV9P2B4zuPuYBBUiqYsplU
j7mAB7OSvj9wfOcxFzBISgVTNpPqMRfwYFbS9weOHz3megySUsGUbRL3POZ6
opkVg8fcZVO2HuMrIOmmbDO46jHXY3tWDB5z903ZdIXb9hfaT9FoS0aOHGmm
YgPxmDsyKwaPufumbH6GFg79Z0fGFRuCx9ypWXHgMY9I9KZsqzRkj7lV4DE3
Q8M0ZXsD0tGAx1wDHvOGmQ5M2RrwmAcmHZiyOfCYBykdmLI58JgHKR2Ysjnw
mAcpHZiyGTzmgUsHf0eFwWOuNvCY2wMec5WBxzxgIB17YG4qg3TsgbmpDNIB
AAAAAAAAAAAAAAAAAAAAAAD3wPdkGTzmagOPuT3gMVcZeMztAY+5ysBjbht4
zFUGHnN7wGOuMo57zBlM2fKAZZ7jrMccpmy5wDKv4ZTHnMGULRtY5jWc8pgz
mLJlA8u8hiMecwGYsqUAy7yGIx5zAZiyreKqx1z6rBS3zKuzV/vLlB0RVz3m
0meluGUepmw9fvGYS5+V4pZ5mLIFfOExlz4rxS3zMGUL+MJjLn1WilvmYcoW
8IXHXPqsFLfMw5Qt4AuPufRZKW6ZhylbwC8ec1jmDYApW4+PPOawzBsAU7Ye
H3nMYZk3AKZsPT7ymDNY5sMDU7a+qB895rDM1wembA14zAOTDkzZGvCYByYd
mLI14DEPTDowZXPgMQ9SOjBlc+AxD1I6MGVz4DEPUjowZTN4zAOXDv6OCoPH
XG3gMbcHPOYqA495wEA69sDcVAbp2ANzUxmkAwAAAAAAAAAAAAAAAAAAAAAA
7oHvyTJ4zNUGHnN7wGOuMvCY2wMec5WBx9w28JirDDzm9oDHXGUC4DGXUtGn
HnOGdEKhmsfcL6Zsb0A6Gv71mEupqOEvjzlDOuFRymMupaKGvzzmDOmERx03
rvSKPvKYCyAdAcxNj1885gJIRwBz0+MXj7kA0hFQx2MuvSLzj8dcAOkIqOMx
l16R4wuPuQDSEVDHYy69IscXHnMBpCOgjsdcekWOLzzmAkhHQB2PufSKHF94
zAWQjoBSHnOnKjYEj7kepCOglMfckYoNxGOuB+kIKOUx95EpOyJue8yRjgFK
ecx9ZMqOiNsec6RjgJoec0cqcgLvMbdKQ0gHpmwNeMwDkw5M2RrwmAcmHZiy
NeAxD0w6MGVz4DEPUjowZXPgMQ9SOjBlc+AxD1I6MGUzeMwDlw7+jgqDx1xt
4DG3BzzmKgOPecBAOvbA3FQG6dgDc1MZpAMAAAAAoCD/A8/RbVw=
    "], {{0, 86.}, {121., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    RasterInterpolation->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{121., 86.},
  PlotRange->{{0, 121.}, {0, 86.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[210]//TableForm=",
 CellID->383357452,ExpressionUUID->"4695f294-01c5-48e3-bb3f-e66372907c6b"]
}, Open  ]],

Cell[TextData[{
 "Given that the states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e1a70f29-c7a7-4611-be34-d93daa35de1b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"1"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e28214a6-d024-4028-b68a-dabbdac76c95"],
 " are not altered by the operation, the\nmatrix representation is given by"
}], "TechNoteText",
 CellID->809087288,ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[211]:=",
 CellID->463596612,ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellLabel->"Out[211]//MatrixForm=",
 CellID->1534563869,ExpressionUUID->"b5d9f181-9d16-49f9-a417-52f31ec98a43"]
}, Open  ]],

Cell["In quantum circuit model, it is depicted as", "TechNoteText",
 CellID->2003915004,ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[212]:=",
 CellID->813436327,ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {
      1.09, -1.09}}}], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Swap[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellLabel->"Out[212]=",
 CellID->1585757247,ExpressionUUID->"269b3fbd-ce4b-4318-88ce-b2f55f4df93b"]
}, Open  ]],

Cell[TextData[{
 "The Swap gate can be implemented using the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/CNOT"],
 ". To see this, first note that a simultaneous exchange of the second and \
fourth columns and rows of the above matrix leads to"
}], "TechNoteText",
 CellID->534468518,ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[213]:=",
 CellID->2035770272,ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[213]//MatrixForm=",
 CellID->1329507574,ExpressionUUID->"88bfe24e-79d3-4a15-9faa-c509d8eff640"]
}, Open  ]],

Cell[TextData[{
 "which is nothing other than the matrix representation of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/CNOT"],
 ". On the other hand, the exchange of the second and fourth columns and rows \
is equivalent to flipping the bit values of the first qubit only when the \
second qubit is set to |1\:27e9. Hence, it corresponds to the CNOT gate with \
the second and first qubit as the control and target qubit, respectively. In \
short, the ",
 ButtonBox["Swap gate",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/Swap"],
 " can be achieved by a combination of the CNOT gates as follows"
}], "TechNoteText",
 CellID->1603079182,ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"swap", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Swap", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[214]:=",
 CellID->621976612,ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {
      1.09, -1.09}}}], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Swap[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellLabel->"Out[214]=",
 CellID->893629415,ExpressionUUID->"f04996b7-7fa3-487d-adfa-6df03bf564dd"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellLabel->"Out[215]=",
 CellID->1876434434,ExpressionUUID->"76949d3e-1e63-43c5-a7d1-0bfbb951855d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"swap", "==", "cnot"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[216]:=",
 CellID->661500490,ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[216]=",
 CellID->1261104137,ExpressionUUID->"b7b6f970-3ca9-4d82-a824-f7f59ad28e17"]
}, Open  ]],

Cell[TextData[{
 "Interestingly, the Swap gate itself is not universal, but the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "0f9dfc0b-39d9-453c-a675-eb518d512950"],
 " gate\[LongDash]the gate that equals Swap when squared\[LongDash]is \
universal. That is, any quantum gate on a multi-qubit system can be \
implemented by combining ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "0b05be5e-8692-4a5b-84d8-b5a054b0849e"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates"],
 ". Indeed, one can combine the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "f0151c4b-fa75-4924-af0f-5c265bda68bc"],
 " gate with single-qubit rotations to construct the CZ gate (see the \
demonstration below). As discussed above, the CZ gate requires just two more ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/SingleQubitGates#347838345"],
 " to implement the CNOT gate, and it is hence universal."
}], "TechNoteText",
 CellID->666193793,ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7"],

Cell[TextData[{
 "Let us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "b7315c05-edda-4aa9-bb66-bffa244fc647"],
 "gate. Here is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "454ba21f-a0fc-4433-a9bc-caa72aa86329"],
 "gate."
}], "TechNoteText",
 CellID->1938247085,ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"Swap", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[217]:=",
 CellID->1040933486,ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[218]//MatrixForm=",
 CellID->1395397422,ExpressionUUID->"b8f59ed8-8ac8-4e5a-b1d4-7753293f5148"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "e185c8f7-1091-455a-a7b5-decc7ef41d04"],
 "gate in terms of the Pauli operators."
}], "TechNoteText",
 CellID->771058470,ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSwap", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Elaborate", "@", 
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[219]:=",
 CellID->1895203240,ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 1]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 1]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 2]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellLabel->"Out[219]=",
 CellID->1581691677,ExpressionUUID->"520e3acc-959c-4a46-88ce-d2847f31da11"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "0c02f098-8315-4a01-9535-1f16c7d29832"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "4f9c9fdf-a314-48eb-8ca5-c122c290c0f3"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["Swap"], TraditionalForm]],ExpressionUUID->
  "41972265-9899-479d-9dd8-e197cf8f3815"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "104915d6-026f-4c72-8e03-32e76e59fedd"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "TechNoteText",
 CellID->27233292,ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSwap", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSwap", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[220]:=",
 CellID->1505230369,ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{3, Rational[-3, 2]}, {3, -1.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
      LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
       3.6, -1.4}}], InsetBox[
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
      LineBox[{{3.6, -2.4}, {4.4, -2.4}, {4.4, -1.6}, {3.6, -1.6}, {
       3.6, -2.4}}], InsetBox[
       StyleBox[
        TemplateBox[{"\"S\"", "\"\[Dagger]\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, 
   $CellContext`S[1, 3], {Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, {
    $CellContext`S[1, 7], 
    $CellContext`S[2, -7]}]]], "Output",
 CellLabel->"Out[220]=",
 CellID->1763841847,ExpressionUUID->"36b47d79-d6f7-498e-bac1-71f1d2bd143c"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "TechNoteText",
 CellID->535686806,ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[221]:=",
 CellID->851721286,ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 1,
       0, 1, 0, -1, 0}}]]]]], "Output",
 CellLabel->"Out[221]//MatrixForm=",
 CellID->1477577916,ExpressionUUID->"cc2706ad-0cc3-4eb0-b333-07cca9d3b629"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "TechNoteSection",
 CellTags->"Section14",
 CellID->1455445268,ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[222]:=",
 CellID->214055128,ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[223]:=",
 CellID->167122186,ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellTags->"Section15",
 CellID->1829879946,ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13"],

Cell[TextData[{
 "Consider two qubits that are once again called control and target qubits. \
Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "7df1b7ef-7bf9-4bb2-8e0a-c82a10de8dd1"],
 " be a unitary operator on the target qubit. The controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d6c81065-e5e8-45aa-8e8b-48a9d091c461"],
 " gate is a unitary operator on the two-qubit Hilbert space defined, \
analogously to CNOT, by"
}], "TechNoteText",
 CellID->678943735,ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["U", "c"], 
        TemplateBox[{"t"},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "b45eb968-4f6f-4d2e-aac4-e40cc028b521"],
 "."
}], "TechNoteText",
 CellID->1426737634,ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8"],

Cell["or equivalently,", "TechNoteText",
 CellID->377012236,ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"0"},
        "Bra"], "\[CircleTimes]", "I"}]}], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"1"},
        "Bra"], "\[CircleTimes]", "U"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"cd25fdd5-a143-4446-9955-56a71898c384"],
 "."
}], "TechNoteText",
 CellID->1367891802,ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165"],

Cell[TextData[{
 "If the control qubit is in |0\:27e9, then it does nothing. On the other \
hand, if the control qubit is in |1\:27e9, then it operates unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ee6fbbb7-d521-4262-b0a5-534ed0a3ddee"],
 " on the target qubit."
}], "TechNoteText",
 CellID->1345075079,ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b"],

Cell["\<\
Analogously to the CNOT gate, the matrix representation of the \
controlled-unitary gate is thus given by\
\>", "TechNoteText",
 CellID->819163313,ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"]},
       {"0", "0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55c085e5-4781-4627-a020-167c0d577b9c"],
 " ."
}], "TechNoteText",
 CellID->116500784,ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"i", " ", "j"}]], TraditionalForm]],ExpressionUUID->
  "67b2053c-b485-4ced-8776-ec6fe6dff079"],
 " are the elements of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "e6087d59-fe37-45d4-9881-210a8577b0c0"],
 "."
}], "TechNoteText",
 CellID->1671074271,ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48"],

Cell["\<\
In quantum circuit model, a controlled-unitary gate is depicted as\
\>", "TechNoteText",
 CellID->1953344721,ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
      LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->118.8,
    PlotRangePadding->Scaled[0.025]], "."}]}]], "Picture",
 CellID->954137231,ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329"],

Cell["\<\
The filled circle connected to the quantum circuit element on the target \
qubit indicates the conditional operation of the element conditioned on the \
state of the control qubit.\
\>", "TechNoteText",
 CellID->924049268,ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1"],

Cell[TextData[{
 "For demonstration, consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,$]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "TechNoteMathCaption",
 CellID->2041795819,ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", "ExpToTrig"}], "//",
   "MatrixForm"}]}], "Input",
 CellLabel->"In[225]:=",
 CellID->1821134520,ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[227]//MatrixForm=",
 CellID->211732316,ExpressionUUID->"2b4a8d8f-f26b-499a-92c2-eec5fd5ccb15"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "TechNoteMathCaption",
 CellID->1443037598,ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[228]:=",
 CellID->1600084015,ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[2, 2], "Label" -> "U"]]]]], "Output",
 CellLabel->"Out[228]=",
 CellID->532818073,ExpressionUUID->"9cc122b1-4eed-49b4-866b-b6d9f9ec20f6"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate  in terms of the \
Pauli operators.\
\>", "TechNoteMathCaption",
 CellID->378680471,ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "qc", "]"}]], "Input",
 CellLabel->"In[229]:=",
 CellID->1488630036,ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 2]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[229]=",
 CellID->2048032932,ExpressionUUID->"d5601312-1382-4457-9cf0-4847295fc56e"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "TechNoteMathCaption",
 CellID->641929970,ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[230]:=",
 CellID->2106646909,ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], "-", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[232]//TableForm=",
 CellID->364541601,ExpressionUUID->"841e8f18-a29d-4716-b15b-80e103d5cf74"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "TechNoteMathCaption",
 CellID->1736236263,ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "//", 
   RowBox[{
    RowBox[{"KetRegulate", "[", 
     RowBox[{"#", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 CellLabel->"In[234]:=",
 CellID->915076805,ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0|>]]}]], "Output",
 CellLabel->"Out[234]=",
 CellID->307055411,ExpressionUUID->"cb204ba4-14b7-4737-a76c-5f118cf464f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[237]:=",
 CellID->1955961279,ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[237]=",
 CellID->640059207,ExpressionUUID->"c14caf31-7486-4d6f-be9a-b47bb7903023"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Acquisition", "Subsection",
 CellTags->"Section16",
 CellID->715838931,ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7"],

Cell[TextData[{
 "An important aspect of a controlled-unitary operator is that it induces \
relative phase shifts on the control qubit when the target qubit has been \
prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d72c7574-e55f-417f-84bc-b2adcf4fe225"],
 ". At first glace, it may sound counterintuitive since the definition given \
above seems to indicate that it changes only the target qubit depending on \
the state of the control qubit and keeps the latter intact. This is another \
feature distinguishing quantum gates from their classical counterparts."
}], "TechNoteText",
 CellID->901522823,ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b"],

Cell[TextData[{
 "Let us take a closer look to see how this works. Prepare the control qubit \
in a superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Psi]"},
     "Ket"], "=", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     TemplateBox[{"1"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "04b33533-0562-4608-b725-a96fec102669"],
 " and the target qubit in an eigenstate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d991046d-2cc8-41b9-a6b5-85cf5e124ead"],
 " of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "6b111da1-5fab-4ed2-a869-76d903e38487"],
 " with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"2b44b691-1c48-49c9-baf3-c1f5dcd541b9"],
 ". The controlled-unitary gate transforms the state to"
}], "TechNoteText",
 CellID->1396956576,ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"\[Psi]"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Phi]"},
      "Ket"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"\[Phi]"},
         "Ket"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], ")"}], 
      "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d52d9159-830d-4d51-a642-e0b209cbb6bd"],
 " ."
}], "TechNoteText",
 CellID->210460181,ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d"],

Cell[TextData[{
 "This feature is extended to multi-control unitary gates and plays a crucial \
role in many quantum algorithms. In particular, the ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumPhaseEstimation"],
 " algorithm is a direct consequence of this feature."
}], "TechNoteText",
 CellID->298695458,ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4"],

Cell[TextData[{
 "For demonstration, consider the phase gate. Recall that state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"c8b87316-432d-4b48-a729-bbc90d23c883"],
 " is an eigenstate of it with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"840f2f8e-aaae-4feb-84ba-8e7fee414a46"],
 "."
}], "TechNoteMathCaption",
 CellID->1505279567,ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[238]:=",
 CellID->1876320909,ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        $CellContext`S[2, 3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  Q3`Phase[$CellContext`\[Phi], 
   $CellContext`S[2, 3]]]], "Output",
 CellLabel->"Out[238]=",
 CellID->1060027485,ExpressionUUID->"3c1c2461-d4fa-462c-8f14-ea355fefab7e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, 1] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[239]//MatrixForm=",
 CellID->357604883,ExpressionUUID->"7ac68bb0-1c5e-4c6f-b362-1ceabeed184b"]
}, Open  ]],

Cell["We are interested in the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->774865820,ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "op", "]"}]}], "Input",
 CellLabel->"In[240]:=",
 CellID->2117896949,ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[241]=",
 CellID->1570931992,ExpressionUUID->"59a080e0-3632-4310-bfa7-ba90caf547b9"]
}, Open  ]],

Cell["\<\
Prepare the target qubit in the eigenstate with a finite phase shift. In \
addition, prepare the control qubit in a linear superposition of the \
computational basis states in order to pick up the phase shift.\
\>", "TechNoteMathCaption",
 CellID->193224567,ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "->", "1"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "op"}], 
   "]"}]}]], "Input",
 CellLabel->"In[242]:=",
 CellID->1062235589,ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"1"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{
        2, -2.5}, {2, -0.5}}]]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
   $CellContext`S[1, 6], "Separator", 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[242]=",
 CellID->969090302,ExpressionUUID->"058f5233-9541-4dee-a008-ee54fbe48960"]
}, Open  ]],

Cell["\<\
Observe that the state does not change on the target qubit while the phase \
shift induced by the phase gate has been picked up by the state in the \
control qubit.\
\>", "TechNoteMathCaption",
 CellID->581406343,ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[245]:=",
 CellID->1127477995,ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[246]=",
 CellID->307558716,ExpressionUUID->"01f1a9b7-7e19-4193-948e-f05c65e40412"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Controlled Power", "Subsection",
 CellTags->"Section17",
 CellID->616090041,ExpressionUUID->"453a152c-b3e2-48d6-be74-e6f1581ade56"],

Cell["\<\
An interesting variation of the controlled-unitary gate is the controlled \
power of a unitary gate, typically depicted by the quantum circuit element in \
Figure 1.\
\>", "TechNoteText",
 CellID->1275497408,ExpressionUUID->"7a616ccc-9433-4998-8369-2df7d2da84f1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {{InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -1}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -2}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -3}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -4}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Psi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {-0.2, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{
          
          TemplateBox[{
           "\"\\!\\(\\*StyleBox[\\\"U\\\",FontSlant->\\\"Italic\\\"]\\)\"", 
            "\"\\!\\(\\*StyleBox[\\\"x\\\",FontSlant->\\\"Italic\\\"]\\)\""}, 
           "Superscript", SyntaxForm -> SuperscriptBox], 
          TemplateBox[{"\"\[Psi]\""}, "Ket"]},
         "RowDefault"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {2.2, -6}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], {InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -1}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -2}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -3}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -4}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{36, 46.800000000000004`}, {1, 1}},
    ImageSize->154.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`QuantumCircuitIn[
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>], 
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> 
      Ket[{"\[Psi]"}]]], 
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], 
    Q3`QuantumCircuitOut[
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> Row[{
         Superscript[
         "\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)", 
          "\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)"], 
         Ket[{"\[Psi]"}]}]], 
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}, "PortSize" -> {1, 1.3}]]],ExpressionUUID->
  "185bf967-796c-48fc-89fb-ac0b51f19410"]
}], "Picture",
 CellID->2084184000,ExpressionUUID->"1475fba9-177e-40e7-8eb1-94b50eeac311"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". A quantum circuit for the controlled power of unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3650efe4-c847-4b81-9b3a-b0b25a20ea6b"],
 "."
}], "TechNoteCaption",
 CellID->1283463500,ExpressionUUID->"b9896500-fb22-49b7-ac82-574240863cb5"],

Cell[TextData[{
 "Consider a system consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "73faa963-5dd4-44e2-a129-af3b031341a9"],
 " qubits and a target register. Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "016ecfb4-d82f-462b-b5d9-d20ff469f062"],
 " be a unitary operator acting on the target register. The controlled power \
(or controlled exponentiation) of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d47ced69-8b87-41c4-9afb-ea9f58601ad3"],
 " is defined by"
}], "TechNoteText",
 CellID->1036421782,ExpressionUUID->"57a86a30-7e8e-4f75-b2d0-62c14934bee7"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"y"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", "x"], 
       TemplateBox[{"y"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "602bff8b-4228-4708-9b00-8a9c9162b6f7"],
 " ,"
}], "TechNoteText",
 CellID->1390517433,ExpressionUUID->"bd33c5dd-996b-431e-877e-f6876cc9e766"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ":=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"7e59d41d-141b-4617-940a-f252b5e059ab"],
 ". Like the controlled-unitary gate, the controlled-power gate induces \
relative phase shifts on the control register leaving the target register \
intact when the target register is prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ea508afd-126b-4430-8da6-f04a6356d55e"],
 ". More explicitly, let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d1c5a5ab-526f-4d0b-b709-f001bbca670e"],
 " be an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f4f6d235-d128-4aef-833c-3e1407e6c66f"],
 " belonging to eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "\[Phi]"}]], 
   TraditionalForm]],ExpressionUUID->"a680a52f-e4ea-4dfc-9bec-9c52689284ca"],
 ". Then, the controlled-power gate makes a transformation such that"
}], "TechNoteText",
 CellID->357932788,ExpressionUUID->"20c21316-a861-4c55-9a22-3017d7cf3e7a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
       "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
        "\[Phi]"}]]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
         "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
          "\[Phi]"}]]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "633beea7-a511-4230-a850-005aab70d5d3"],
 " ."
}], "TechNoteText",
 CellID->232871499,ExpressionUUID->"c79df340-6df1-4264-a420-75bf8342298a"],

Cell[TextData[{
 "This is a straightforward generalization of the ",
 ButtonBox["phase-acquisition property",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#715838931"],
 " of the controlled-unitary gate discussed above."
}], "TechNoteText",
 CellID->531662691,ExpressionUUID->"83f238dc-7afc-4872-a985-c7f796b7cff2"],

Cell[TextData[{
 "Note that for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"61821f16-7d3e-4e46-877a-c475b2050444"],
 ","
}], "TechNoteText",
 CellID->1514408200,ExpressionUUID->"0bc08e04-978f-49bb-a8cf-34eb1ce33c50"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "x"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "1"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "2"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"\[Ellipsis]", "(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", "0"]], ")"}], 
      SubscriptBox["x", "n"]]}]}], TraditionalForm]],ExpressionUUID->
  "00ace3d2-b6b2-4581-a0fe-c1cccae885eb"],
 " ."
}], "TechNoteText",
 CellID->2034215257,ExpressionUUID->"1b15c47e-535b-4669-a118-3ded02f47ec2"],

Cell["\<\
This implies that the controlled-power gate is a combination of the usual \
controlled-unitary gates as in Figure 2.\
\>", "TechNoteText",
 CellID->1368761109,ExpressionUUID->"27f3aa74-7067-43e3-bf6e-6bcaf17ad5a4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->118.8,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "278339b7-71fd-40c6-9ddc-e7a41f26e68f"],
 "=",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}, {{0, -6}, {5, -6}}}], {LineBox[{{1, -1}, {1, -6}}], 
      DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "3"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -6}}], 
      DiskBox[{2, -2}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -6.4}, {2.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -6}}], 
      DiskBox[{3, -3}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -6.4}, {3.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {3, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -4}, {4, -6}}], 
      DiskBox[{4, -4}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -6.4}, {4.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {4, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->226.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 3]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 2]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 1]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
     Q3`ActOn[
      $CellContext`T[3], {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 0]], "LabelSize" -> 0.65], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "753e9b5d-0655-41ba-826d-8c849e7ff69a"]
}], "Picture",
 CellID->757238962,ExpressionUUID->"2c1f89bf-12ac-494a-80c0-70f147dc605b"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". A equivalent quantum circuit (right) of the controlled power of unitary \
operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3564bf0e-0bc6-4269-95a2-e17930c777e9"],
 " (left). "
}], "TechNoteCaption",
 CellID->927142212,ExpressionUUID->"ee8dd00a-30e4-4b38-abb1-9e025434b3de"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->305516076,ExpressionUUID->"e6222d2e-fdec-4a7f-9a0a-cac47d0ffb1b"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[88]:=",
 CellID->1535052485,ExpressionUUID->"70a85bb5-d5d2-4ca2-bff2-638e2e8405be"],

Cell[TextData[{
 "Consider a control register consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "d82fd905-1f78-45d7-baae-5ba5a63c2620"],
 " qubits."
}], "TechNoteMathCaption",
 CellID->1475887768,ExpressionUUID->"46ce6238-8cd3-488a-959f-b47a70f46c9f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[89]:=",
 CellID->1092408791,ExpressionUUID->"f8be5084-1a72-4198-85c6-55a53be164b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[91]=",
 CellID->1550207546,ExpressionUUID->"b741726f-e964-4106-aa8e-c879ab1145ba"]
}, Open  ]],

Cell["\<\
Consider a single-qubit unitary gate acting on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1519843333,ExpressionUUID->"2c4b63aa-9188-47ac-bc7f-2e580e3232cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"T", "[", "3", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[92]:=",
 CellID->21384525,ExpressionUUID->"73970fb6-d378-4c24-83f7-d7a3de8a5011"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"T", 
          
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
           "RowWithSeparators"]},
         "Superscript"],
        $CellContext`T[3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  Q3`Phase[$CellContext`\[Phi], 
   $CellContext`T[3]]]], "Output",
 CellLabel->"Out[93]=",
 CellID->374528822,ExpressionUUID->"a6df30b2-6dec-4389-8688-e9e08534db85"]
}, Open  ]],

Cell[TextData[{
 "Construct the controlled-power of ",
 StyleBox["opU", "Input"],
 " defined above."
}], "TechNoteMathCaption",
 CellID->978050365,ExpressionUUID->"64f01fe2-3329-4e1d-a62c-1d659773250c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cop", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{"SS", ",", "opU"}], "]"}]}]], "Input",
 CellLabel->"In[94]:=",
 CellID->2127797723,ExpressionUUID->"8a1fc341-884a-4ec1-aa43-b40f461924af"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", 
   InterpretationBox[
    TagBox[
     FormBox[
      TagBox[
       RowBox[{
        FormBox[
         InterpretationBox[
          TemplateBox[{"T", 
            
            TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
             "RowWithSeparators"]},
           "Superscript"],
          $CellContext`T[3]],
         TraditionalForm], "\[InvisibleApplication]", 
        RowBox[{"(", "\[Phi]", ")"}]}],
       HoldForm],
      TraditionalForm],
     TraditionalForm,
     Editable->True],
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]]}], "]"}]], "Output",
 CellLabel->"Out[94]=",
 CellID->434407040,ExpressionUUID->"457c55c3-d7a0-4d27-bdd5-82ad3366f3a9"]
}, Open  ]],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->1664622810,ExpressionUUID->"6bf995ee-9020-414a-b0f1-ed570fc55b14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{"T", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "cop", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[95]:=",
 CellID->2027335310,ExpressionUUID->"d5c62256-61e0-4309-8387-d64cb3287486"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.2, -5}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{72, 36}, {1, 1}},
   ImageSize->180,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>]], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[95]=",
 CellID->2023190340,ExpressionUUID->"ff27ac41-8a45-4bd5-808c-8c912b8f6aa7"]
}, Open  ]],

Cell["Take computational basis states as inputs.", "TechNoteMathCaption",
 CellID->1320057003,ExpressionUUID->"a3f46d63-fbc3-4f35-9a29-27ae41f9605b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Basis", "[", "SS", "]"}]}]], "Input",
 CellLabel->"In[96]:=",
 CellID->856233533,ExpressionUUID->"0684e151-c73f-4f8d-af8b-3f085687db78"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnX9MVeUfxy8/FAaKSiVmOjJUvumapa3MFPZ1/iTDibMbFiTmDygKUtd3
rMiVmc0/LBMjZrq6Zc4yFi2sObZ+mD/6g2BSrlAsM8uvNKlQFBHO9/PlGWen
w72H58L5xf28X5vu3nOe+7zPeV7P52Hn7t5zxywvyFgV7vF41kbTfxk5//n3
mjU5RYuH0pMlT67NW/3kyhXzn1y3cvXKNVOXR9DGf9G/OQM8nv8/VgAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAECQVFRVZWVlz5841bnbDDTfYczwg
EAUFBa+++qrNofDuOPDOE3jnCbzzBN55Au88gXeeSHovKSlJT09/+eWX//77
b/nOs7Ozo6Ojc3Nz9+zZY9wSM8FxXnnllUmTJtkcCu+OA+88gXeewDtP4J0n
8M4TeOeJpPe6ujq6nE9KSrrxxhvPnDkj0/OBAwfocr66ulqmMWaC45w6dcrj
8dD/dobCu+PAO0/gnSfwzhN45wm88wTeeRKU99bW1tTU1AcffFCm8caNG2fN
miV5GJgJbmDSpElbtmyxMxHe3QC88wTeeQLvPIF3nsA7T+CdJ0F537dvX2Ji
okzLZ555JjMzU7JbzAQ3sH79+pSUFDsT4d0NwDtP4J0n8M4TeOcJvPME3nkS
lPcvvvji+uuvl2lp7hV9XV3d008/Tcc5ceLEZcuWvfPOO5I99xFWubW1tRER
EY2NjTZkCeC9O5cvX/b5fHl5ebbd2ATetdg//grqvQtu3h3JdaF3hVPdOZUL
7yqs1hl4dzwX9a7CyrsjuUF5d+SKfv/+/YMGDfL8k5ycnKtXr0r23zu45RI3
33zzzp07rU5RgXctu3btmj17dlxcnEicPHmypXFa4F1xbvxR7wJu3lHvAm51
h3oXcPOOehdwW29R7wJu3vtFvdt/RX/ixImIiAgakPvvv7+mpubs2bMlJSWR
kZG0paioSLL/XsAtV1BYWEi5VqeowLuWtLQ07Zpv5woA74pD4496F3Dz7mCu
4ibvCrO6Q72rsPKuoN67YLXeot5VWHl3MFcJxrv9V/T5+fk0GjNmzNC+o7Vr
1y7aOGzYsIsXL0pGBAu3XAH5jY6OtjpFBd61/Pnnn//t5Nlnn7V5BYB3xaHx
R70LuHl3MFdxk3eFWd2h3lVYeVdQ712wWm9R7yqsvDuYqwTj3eYr+kuXLsXG
xtJofPjhh9rtbW1tI0aMoO07duyQjAgKbrkq165dI7+6dOuAd79s2bLF5hWA
uXcdto2/4+cL71rsrzuncl3iXUfI153j8xzeea4zzL07lev4fIN3nrny3m2+
ov/+++9pKGJiYrp/5eTxxx+nXQUFBZIRQcEtV0tOTs7DDz9sdYoA3v3iyMrD
2bsO28bfDecL7yp8/uIr7vCuI+Trzg3zHN55rjOcvTuV64b5Bu88cyW923xF
f+DAARqKsWPHKp1vOxQXFy9duvS7776jp5s3b6ZdixcvlowICm65WioqKoYN
G9bW1mZ1kALvAXBkBeDsXYdt4++G84V3FVZ/8d3gXUfI150b5jm881xnOHt3
KtcN8w3eeeZKepe/ol+xYsXy5csl0wPNBPF9k+nTp9PjyspKTycLFy6kpz6f
jx5PnTpV95KmpqaampoLFy5IRiNXR0tLS2xsbFVVlVkdGgDvfpFZAeBd0K/H
3w3nC+8qjtSdU7lu8K4j5OvODfMc3nmuM5y9O5XrhvkG7zxzJb0fPXo0KiqK
Ghs3a29vT0hIeOuttyTTA82E0tJSGoqZM2cqnb8BISpiwYIF9HTv3r30+Pbb
b1cbnzhxYvbs2Z4uxo4dS20kD4B5ro6MjIz8/HxTujIG3v1ivALAuyAExt8l
5wvvAqfqjm296wj5unPJPId3heU6w9a7U7kumW/wzjNXxntra2tMTMxHH31k
0Oarr77yer0k99y5c5LRgWZCRUUFneNtt92mdH1q5ZFHHhGfWtm2bRvtuu++
+0TLK1eujBs3Liws7KGHHiorK3vhhRfGjx9PDY4cOSJ5DJxzdfh8vlGjRvW9
nx6Bd78YrADwLlqGxvi75HzhXeBU3bGtdx0hX3cumefwrrBcZ9h6dyrXJfMN
3nnmSnrPy8tLTk6uqqq6fPly973nz5+n44mNjT19+rR8dKCZUF1dTb353St+
EWDVqlXi6eHDh7UFonTeZ3LPnj3yx8A5V8dPP/1EnZ86dcqU3gyAd78YrADw
Lp6Gxvi75HzhXeBU3bGtdx0hX3cumefw3n0Xh3WGrXencl0y3+CdZ66892XL
llHLDRs2dN/V1ta2bdu28ePH33rrrc3NzZLRgWZCY2NjWFgYZdXW1up23XXX
XbT9pZdeEk/FZ1rM+mwJt1wdNKNGjBjR0dFhReda4N0vBisAvIunoTH+Ljlf
eBc4VXds611HyNedS+Y5vPNcZ9h6dyrXJfMN3nnmSnrfunXrkCFDcnNzGxoa
ArVpbW2Ni4srLy+XjDaYCfPmzet+yseOHaON4eHh6vsPFy5cuO6666h8CgsL
f/nlF79dNTU17d692+v1lpaW9nhIZuVWV1c/8cQTU6ZMmTBhAkV3L22Lcr/9
9tu8vDxaN8aNGzd//vz333+/x1NWoeNU3zz0yw8//JCamkoH8MADD5Br+Z51
wLtfDFYAeBdbTPeupS/jj3o3AN5Nz+3v3rX0ZRyUfrLOo967w8G7FtS7wE7v
ZuWi3g2Ad9NzLfWudH4ZZPDgwTt37uyxt8zMTDoSyWiDmfDpp5/SaERERLz7
7rtiy2+//ZacnEwbFy1apG156NChxMRE0Xjx4sVff/21du+mTZvE22XEypUr
ezwkU3LLysoGDhwYHx9PlUKTgdoMGDCAHFmd+8Ybb9BGmiq0feHChTExMdRs
48aNPZ610vVuzP79+w3aZGVlebroy1004d0vxnfSgHeBud619Hr8Ue/GwLu5
uSHgXUuvx0HpP+s86r07HLybcr7wrtJf1nnUe3c4eDcl12rvSuc7FZGRkX/8
8UePHZrye/RER0dHdnY2nQh5pMFMS0uj46Sno0eP/vHHH3WN6SzefvvtO++8
Uxj3er3qO05Hjx4tLS0VvwIpMxNMyX3uuedSUlLUnyQoLy+nvUuWLLE6t76+
nga/sbFRNDt58mR4ePhNN93U41kTn3322eDBg69cuWLQZs2aNeoKQOco061f
4F0lIyNjeBeDBg0SHapb5s6dK5ML7732bsr4o96NgXdzc0PAuynjoPSfdR71
LuDmHfUucMo7/r4btIF349xQrXclmN+jN+uKXuksiuLi4vj4eHG+kZGRqamp
v/76q8FLDh48eMcdd3g0X1QRiBv3Sb63Y0rutWvX1L3t7e1kc+LEiTbk6qC9
NK+0BxOI3Nxc47lK/Pzzz4sWLRKH9+ijj/bYZyDgXUV8ryoQ2l85kTlfFXiX
9G7W+KPeDYB303N19Dvv5o6D+9d5s3J1wLvLvaPeBU55x993A+C9x9yQrHfF
oSt6AdXF8ePHjxw5cunSJZk+qWRoZObMmaPdGNTKb2KuoLW1NTY2Ni0tzebc
vXv30jLy2GOPyYSOHDly9+7dMonp6eke6Q+B+AXe+w68C8zyHiyod3ng3dLc
fu09WPr7Oo967x393XuwwLugv6/zqPfe0d+9m5hrhXcHr+iNoQNbt25dS0uL
ukV8NCIrK0vbzPSZIJkrKCkpoV1lZWX25FZWVtKsGzNmDE2DwsLCpqamHrv9
5ptvBgwYINPyr7/+ioqKosQvv/yyd6egwLs1ufCuAu/GwLu5uQJ41wHvVuTC
uwq8GwPv5uYK4F0HvFuRa6l3117Re71eGoekpKS1a9du376dXFOfNAIHDx7U
NjN9JkjmErW1tdHR0dOmTWtvb7cnl+bGvffeO3r0aGqZkpIic3vGoqKiWbNm
9disoaHh7rvvpm5nzpzZl7OAdyty4V0F3o2Bd3NzFXj3B7xbkQvvKvBuDLyb
m6vAuz/g3Ypc67wrLr6i7+joeP3115OTk8PDwz2d0OPKykpdM9NngmRuXV3d
8OHDScrp06ftzBUcPnyYouPj43///XfjbidMmFBSUmLc5tChQ+LmHtOnTw/0
AxOSwLtFuQJ4h3fjbuHd3Fx49wu8W5QrgHd4N+4W3s3NhXe/wLtFuQJzvQtc
e0Wv0tzcXFNTo94eUId1378wyK2traUTTEhI6H5zS0tztbz55pt04j6fz6BN
fX09tTlz5oxxVydPnhw6dOj27dtpNgZ9uP8E3q3I1QLv8B4IeDc3F94DAe9W
5GqBd3gPBLybmwvvgYB3K3K1mOhd4P4remNsuKOCjqqqqri4uMTERCumQSA+
/vjjuro67ZaioiI6cdpu8KrNmzdPmTJFpv+LFy/26fi6gHdzgXcd8G7wKng3
EXg3AN7NBd51wLvBq+DdRODdAHg3F6u9K8Fc0T///PMLFiyQ7NbqmVBfX7+1
EzoqGpB77rlHPP38888tzX3vvfcGDhxIiU899dSLL764oYu+3H2iR65evUoT
j3JXr17t8/k++eST/Pz88PDwpKSk5uZmgxdOmzaNjs26A+sOvJsIvKvAO7zD
eyDg3Szg3Rh4NxF4V4F3eIf3QATlnbodOXKkTMvy8vIhQ4ZIft3A6pnwwQcf
ePyxYsUKS3PF7Sa6s379ektzz58/n52dnZCQIOLCwsLS09MbGhoMXnLu3Dma
Lbp3hKwG3s0F3gXwDu/w7hd4NxF4NwbezQXeBfAO7/Dul2C9L126VPJn+Nra
2mbMmDFq1KjXXnutpqbGuLFtn9bgxtmzZ48dO2b8lo5gx44dSUlJNhySFni3
CHjnCbzzBN55Au88gXeewDtPTPdOF/779u2bN29eVFRUdXW15GG0tLRs2rRp
8uTJiYmJxi0xExzH6/WuW7fO5lB4dxx45wm88wTeeQLvPIF3nsA7TyS9FxcX
33LLLZmZmcePH7fiMDATeALvPIF3nsA7T+CdJ/DOE3jnCbwDAWYCT+CdJ/DO
E3jnCbzzBN55Au88gXcgwEzgCbzzBN55Au88gXeewDtP4J0n8A4AAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAgJDnf3pnnv8=
    "], {{0, 20.}, {675., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    RasterInterpolation->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{675., 20.},
  PlotRange->{{0, 675.}, {0, 20.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[96]=",
 CellID->637754764,ExpressionUUID->"53c077d6-f163-473c-846a-4c626db67c9f"]
}, Open  ]],

Cell["Calculate the output for each input state.", "TechNoteMathCaption",
 CellID->1095734201,ExpressionUUID->"0bfda6ba-1614-40db-bb2c-d9b4938763a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[97]:=",
 CellID->1234389837,ExpressionUUID->"4a7cc5e4-765d-497e-a5bc-a41ff5e948ed"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnQ1QVGXf/2F5kRFExW7xRhEMydLbkcSpBMXSfIEMU0f30RKzIqXgFpTH
J6bQysxGZzTvUFLJeaK0wbcRE7OG1DLR7omXR4oKwZcM5QYRC0FAXv6/P2fY
2fbl7Dm713nZs9/PjM5y9jrne11nv7/vubjYPTvihZXzXta5ubmt9qH/5i37
nydWrVqWMX8A/bDgn6uTlv8z8aXYf6YnLk9c9dgLHrTxNfq3ysvN7f8/7gYA
AAAAAAAAAAAAAAAAgAro7OxsaWlRuhcAAAAAAAAAAABwPo4dO+bm5lZfXy+w
fWFhYUlJiaRdAgAAAAAAAAAAgFPw+eefi1pV0Ov1Z86ckbRLAAAAAAAAAAAA
cAra29vr6uqEtw8PD29ubpauPwAAAAAA8pOfn79kyZKZM2fyN/vb3/4mT3+A
nKxcufL9999XsAPwlSZRxFfwkiZRPKN4qK+vv9ZLQ0ODkPZHjhwJCgoS0lgI
8LwmUbPnAQAAAIskJCT4+PisWLHis88+42+J2Ysm2bp167hx4xTsAHylSRTx
FbykSRTPKB5WrVoVGxvbp0+f6OhoesDT8tq1a3FxcePHj584ceKDDz4YHByc
mJh4+/ZtBzsAz2sSNXseAAAAMOerr77y8fEpLi4W0hizF01y6dIlNzc3+l+p
DsBXmkQRX8FLmkTxjLJJWFhYRUUFz6pCbW3t0KFDd+3aRY8zMzNzcnJaWlpm
zZqVlJTkoDQ8r0nU73kAAADAmA0bNjz55JMCG2P2olXGjRu3ZcsWpdThK60i
v6/gJa2ibEbZxOaqgl6vf/3117nHM2fOLC8vpwcHDx4MDQ11UBqe1yoq9zwA
AABgDM1zFi1aJLAxZi9aZd26dTExMUqpw1daRX5fwUtaRdmMsonNVYUBAwY0
NjbSg66uruHDh3d2dtLjmpqawYMHOygNz2sVlXseAAAAMIbtqkJ5efmaNWvo
OjhmzJjnn3/+k08+cbiDgoCugwcsKyvz8PAQ/rVobIGvVKJL3L17Nzc3Nykp
icmNwuT3FbxkDtvXVCAayyib8K8q1NbW+vv7d3V10ePKysrHH3+c237q1Kkn
nnjCQWl43hxFPM9cV+WeBwAAAIxhuKpw/PhxPz8/t7+ybNmy9vZ2Fj2FrrS6
oaGhH330EatOigK+UoPunj17pk+fTr/7cIrjx49ncliZfQUvGSPRa2oT7WWU
TfhXFTo6Ory9vb/99lt6TL9c0+/a3PYZM2Zs27bNQWl43hilPK+N/AQAAADs
htWqwsWLFz08POhi+vTTT5eWltbU1GRlZXl6etKWjIwMRp2FroS6qampdExW
/RQFfKW4LhEXF2c8/2c1K5bZV/CSMRK9pvxoMqNsYvMTEHSdnT17dkNDQ0pK
yqFDh5qbmxMTE6dNm8a9gcER4HljFPG8dLpq9jwAAABgDKtVheTkZLqSTp48
2fgvEXv27KGNAwcOvHPnjqMdha7EuqdPn/bx8ZGu5zzAV4rrErdv3/5PD2+8
8QbDWbHMvoKXjJHoNeVHkxlljaKiorE90C/RI0eO9PX15X5samoyaXnz5s3Z
s2f369evf//+kZGR999///r165n84R6eN0YRz0unq0LPAwAAABZhsqrQ3NxM
sym6kh46dMh4+71794YMGULbd+/e7WhHoSuxbkdHx3333WdyZHmAr5TVNWHL
li0MZ8Uy+wpesgjb15QHrWYUK65cuULnoaqqyvG3KBiA5y0im+cl1dWA5wEA
ALgITFYVfvrpJ7qM9u3b1/wvL6+++io9tXLlSod6aQXostVdtmzZc889Z8eO
1dXVhYWFduvCV8rqmsB8Nm63r+wAXrKIbL9haSyjrl279tprr8XGxj700EP0
Pz2+ceOGHeoGzp8/P2fOHEeOYA48bxFtrCp0y5ufAAAAgN0wWVX46quv6DI6
cuTI7p6l9czMzMWLF//444/046ZNm+ip+fPns+owdKXTzc/PHzhw4L1798Tu
uHPnzujoaLt14StldU1gPiu221d2AC9ZRLbfsLSUUTt27PDz89PpdNTtsLCw
FStW+Pewb98+seoGiouLCwoK7N7dIvC8RTSzqiBnfgIAAAB289JLL73wwgsC
G1ubvXCfl5w0aRI9pikTd7ci7i8yubm59Pixxx4z2aWxsbG0tPTWrVsO9B26
tnVF0dLS4uvra8df9CRaVXCi8+zUuiYwnxXb7Ss7gJcsIuQ1RUYZc/z4cXd3
9/T09OHDh1P/uT+7NzQ0pKWleXt7//DDD2I7IB3wvEVk87wduqKQMz8BAAAA
++js7AwMDPzf//1fge2tzV6ys7PpMjp16tTunskYN4uYPXs2/ZiXl0ePIyIi
DI0vXrw4ffp0t15GjhxJbezrP3Qt6h48eNDNOr/++iuPxLx585KTk8V2TKJV
BZWfZ83ommBtViy/r+wAXrII/286yCgTuCtjYmLi1q1bvby8TH7rjI2NjY+P
F9sB6YDnLSKb5wXqOkV+AgAAAHbw7bff6vV6mpDU1tYK3MXa7CU/P58ui2PH
ju3ufcfj0qVLuXc8fvDBB/TUU089xbVsbW0NDw93d3d/9tlnaZr39ttvP/DA
A9Tg3LlzdgwBuhZ1Kyoq3uuFJsC0PSEhwbCF/+8yubm5w4YNE9KZrq6uzl5o
GhkVFdVphKhxwVfK6ppgbVYsj68cBF6yCM9vWMgoc37++Wfq0qVLlxYuXEi/
e3b+lV27dg0ZMkTESZEYeN4isnleoK5T5CcAAAAglrq6Orqo+fr6Xr16Vfhe
1mYvxcXFdDSLz3LfsvTyyy9zPxYVFRlPKrp77hf92Wefiek7dG3rGuA+x/r1
118LlLh8+TI3nbbZ0vgPPeYIOYIB+EpZXROEvINXOl85CLxkEZ7XFBllTl5e
Xv/+/elBaGioxX19fHwE9lYG4HmLyOZ54boGVJufAAAAgFju3bv3wQcfPPDA
Aw899JD5N2tbw9rspb6+3t3dna56ZWVlJk898sgjtP3dd9/lfuTeD8nqvXzQ
taZrQOzshWZWQ4YMEfKtZ9evX6/s5c0334yIiKg0QtTbFeArZXVNkGJWLNxX
DgIvWYTnNUVGmfPll196eXm1trZOmDCBzky9GQ0NDQJ7KwPwvEVk87xwXQOq
zU8AAADAPtra2vz9/Q8fPiywvbXZCzFr1izzy/SFCxdoo06nM6yx37p1a9Cg
QTTlSE1N/e233yweqrGxce/evXq9Pjs722aXWOkWFxenpKRERkaOHj2apM2n
QxLplpSUJCUl0VwrPDw8NjZ2//79THQNiJ290NjN/5hoE4nuq9ANX9mrK9ZX
xkgxK7bpq19++WXKlCk0qIULF1IuCe+tCfCSRXheU2SUOTdv3qQu5eXl0Qkn
W4rVkhl43iJyel6grgHV5icAAABgN4sWLaKrp8DGPLOXL774gq6SHh4en376
Kbfl+vXro0aNoo1z5841bnn27NmQkBCu8fz587/77jvjZzdu3Mj9mYNITEy0
2SUmujTh9Pb2DggIoCsyTWCojZeXF80rpNb98MMPaSPNBGj7nDlz+vbtS802
bNjARJdD1OyFW2U6fvy4kMbGSLeqAF/J4ytjmM+KhfhqyZIlbr04crdzeMki
/K8pMsqcxYsXBwUFrV27lvp25MgRk2dV9V50eN4icnpeuC6HavMTAAAAsJvX
X3990aJFAhvzzF66uroSEhLoikZzD5oAxMXF0XWQfgwODja/uTFdJT/++OMJ
EyZwF0G9Xm9YXT9//nx2djZ3zRUye2GiS1PHmJgYw+2SDh8+TM8uWLBAat3K
yko6+fX19VyzqqoqnU43dOhQVrrdImcvJ06c6NevX2trq5DGxki3qgBfyeOr
efPmDe7Fz8+PO6Bhy8yZM03aM/fVqlWrDLNiOm9CDmsReMmAqNcUGWXC7du3
w8PDPT09uROSmppKopcuXcrJyYmIiKDfNP/880+xfZAIeN6AUp7XTH4CAAAA
dsNqVaG7ZyKRmZkZEBDAXdpoPjZlypTff/+dZ5czZ848/PDDbmYftuVuJilk
9sJKt6Ojw/BsZ2cnzQTGjBkjg64J9CzNSYw746CuqNnLihUr+Ods1iguLqbJ
th07csBXzHVNsOkr7vPO1jD+JjgO5r66cuXK3LlzObkXX3xRyGEtAi8ZEPua
8o/XgOtkVFNTU1pamuGMeXt70/+DBg1as2aNtY8JKAI8b0Apz2smPwEAAAC7
YbiqwEFziYqKinPnzjU3Nws5Jk0z6Do4Y8YM442iZi8MdTna2tp8fX3j4uJk
1s3Ly6Op1yuvvMJQV/jshQ4YFBS0d+9eIepsga8k1RXlK4FI5Kv4+Hg3MW82
NgdechxklDEtLS0lJSU08JMnT9bU1MgpLRB43nGQnwAAAICDMF9V4Of06dPp
6ek0TzNs4d7WuGTJEuNmdsxemOhyZGVl0VM7d+6UR7egoIBmSiNGjKCpS2pq
amNjo+O6BoTPXr7//nsvLy+26gKBr6TQdTpf/fHHH3369KHDfvPNN3Z3DF6S
QtfpvORSwPNS6Dqd55nkJwAAAGA3Mq8q6PV6uuqFhYWtXr16+/btND+hY9JV
+8yZM8bNmM9eBOoSZWVlPj4+UVFRor4b0RFdms9ER0cHBwdTy5iYGFG3ubaJ
8NlLRkbGk08+yVBaOPCVFLrO5avq6upHH32Ujjl16lRHOgYvSaHrXF5yNeB5
KXSdy/Os8hMAAACwG5lXFbq6unbs2DFq1CidTsd9BpAeFxQUmDRjPnsRqFte
Xj548GCaSFy9elVOXY6ioiKSDggIuHHjBhN1YvPmzSR66tQpmy1Hjx6dlZXF
SlcU8JVEuhzq99XZs2e5m7lNmjTJwU+sw0sS6XKo30suCDwvkS6H+j3PMD8B
AAAAu5F5VcFAU1NTaWmp4TbLJjCfvQjRLSsrowEGBgZavFG5dLrG5OTk0MBz
c3OZd4CfyspK0r127ZrMuhzwlRS6xqjcV1VVVQMGDNi+fTvN9h1UhJek0DVG
5V5yQeB5KXSNUbnnGeYnAAAAYDdKrSrwI93sxRqFhYX+/v4hISFSTF2scfTo
0fLycuMtGRkZNHDaLlsfODZt2hQZGSmzqAH4ii3O6Ks7d+4wUYSX2OKMXnI1
4Hm2OKPnWeUnAAAAYDdvvfXW7NmzBTaWevZSWVm5rQfqFV3EJ06cyP0o5I2C
jrBv3z7uW8PS0tLeeeed9b1Ietej9vZ2miyR7vLly3Nzc48dO5acnKzT6cLC
wpqamqTTtUhUVBSNV2ZRA/AVQ1zcV/ASQ1zcS84CPM8QeB4AAACwj8OHD/fv
31/gxxWlnr0cOHDAzRIvvfSSpLrcbY7MWbdunaS6dXV1CQkJgYGBnJy7u3t8
fHx1dbWkoubU1tbSrMnkrzNyAl+xxZV9BS+xxZW95CzA82yB5wEAAAA7uHfv
3uTJk4cNG/avf/2rtLSUv7Fs77R0NWpqai5cuCD/n0I4du/eHRYWpog0B3wl
ES7oK3hJIlzQS84CPC8R8DwAAAAgipaWlo0bN44fPz4kJIS/JWYvmkSv16en
pyvYAfhKkyjiK3hJkyieUWoGntck8DwAAAANg9kLkAL4CrACXgKuBjwPAAAA
AOcCsxcgBfAVYAW8BFwNeB4AAAAAzgVmL0AK4CvACngJuBrwPAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAATk1nZ2dLS4vSvQAAAC2DpAUAAKlB0gIAACuK
i4tTUlIiIyNHjx6t1+vLysr42x87dszNza2+vl7g8QsLC0tKShzuJgAAODEU
g0lJSY888kh4eHhsbOz+/fv52yNpAQDAbtrb2xMTE+fPn9/Q0MDTDEkLAABM
2Llzp7e3d0BAwMKFCyMjIylavby8+APz888/F5XAer3+zJkzLDoLAABOyYcf
fujh4TFo0CCa4s6ZM6dv376Uohs2bODZBUkLAAB2k5yc7NbDpUuXeJohaQEA
gAlr166NiYm5desW9+Phw4cpXRcsWMCzS3t7e11dnXCJ8PDw5uZmh3oJAADO
TGVl5aJFiwwT16qqKp1ON3ToUJ5dkLQAAGAfn376Kc1mKWPp/+rqap6WSFqg
YfA9Vppk5cqV77//vtK9sExHR4fhcWdn5+DBg8eMGWOxJU2Jr/XC/44yQ/sj
R44EBQUJaSwEVIcmUaQ64CVNouakNeHhhx/28/Mzjl8DSFogBUhawAqVJ+2F
Cxf69u07fvz49evX87xXAUkLpEBV1QGPaZKtW7eOGzdO6V7Ypq2tzdfXNy4u
zuKzq1atio2N7dOnT3R0ND3gOQ5FNB2EIn3ixIkPPvhgcHBwYmLi7du3Hewe
qkOTKFId8JImcZakzcvL8/T0fOWVVyw+i6QFUoCkBaxQc9JSAIaHhw8aNOjy
5cvvvPMOz6oCkhZIgaqqAx7TJJRpNj/bpQaysrKonzt37uRpExYWVlFRwZPA
tbW1Q4cO3bVrFz3OzMzMyclpaWmZNWtWUlKSg91DdWgSRaoDXtIkKk/agoIC
mpqOGDHC09MzNTW1sbGRpzGSFrAFSQtYodqk7erqeuaZZyhgT548ST/yrypw
IGkBW1RVHfCYVhk3btyWLVuU7gUfZWVlPj4+UVFRnZ2dPM1sJrBer3/99de5
xzNnziwvL6cHBw8eDA0NdbCHqA6tIn91wEtaRc1Je/jw4ejo6ODgYJpyxMTE
8H/hDpIWMAdJC1ihzqTduHEjpeu//vUv7kcmqwpIWiAW9VQHPKZV1q1bR9NI
pXthFcrJwYMH03T36tWr/C1tJvCAAQO4v8F1dXUNHz6cW6Ooqamh4zvYSVSH
VpG/OuAlraLypOUoKiqisA0ICLhx44a1NkhawBwkLWCFCpOWctXDw4OC8a1e
pk2b5ubmlpqaunnzZmt7IWkBc9RTHTY9Rr/9rVmzhno7ZsyY559//pNPPpGn
Y8Tdu3dzc3OTkpLkvA2FUuNlrltWVkZxJ/zLa+SE+kbGCwwM/PXXX2025k/g
2tpaf39/yt7untueP/7449z2U6dOPfHEEw72E9VhgmbGK391wEsq0XWppDUm
JyeHprt0wq01QNJaxKWqg7muCpO2WyvJ42q6KkzaAwcOjPgrvr6+FLPDhg2b
MGGCtb3UnLTdqA65cPaktQa/x44fP+7n5+f2V5YtW9be3i5pr/bs2TN9+nSq
LE5x/PjxksoZUGq8EumGhoZ+9NFHrDrJisLCQnplQ0JChCwpdNtK4I6ODm9v
72+//ZYeUyBQPnDbZ8yYsW3bNge7iuowRmPjlbk64CU16LpO0h49epR736yB
jIwMGixtt7YLktYEV6sOV0hajSWPq+mqMGlNcPwTEAomLarDqa8sKqkOHo9d
vHjRw8ODhvz000+XlpbW1NRkZWV5enrSFpqfSNqruLg441dZHm8rNV7pdFNT
U+mYrPrJhH379lFg0tDS0tIoftf38s0331jbxea7xRYtWjR79uyGhoaUlJRD
hw41NzcnJiZOmzaNW+x1BFSHAe2NV+bqgJcU13WdpKVJUUhICCXt8uXLc3Nz
jx07lpycrNPpKEubmpqs7YWkNcGlqkM6XfUkbbfmksfVdNWWtOYwua+CIknb
jepw8iuLSqqDx2M0D6HxTp482XjdZs+ePbRx4MCBd+7cka5Xt2/f/k8Pb7zx
hmzeVmq80umePn3ax8dH0ldKLI8++qibJdatW2fSsqioaGwPVPgjR4709fXl
fjSfFd+8eZMSuF+/fv3794+MjLz//vvXr1/PZLER1WFAe+OVuTrgJcV1XSpp
6+rqEhISAgMDuYB1d3ePj4+vrq42b4mktYZLVYd0uupJ2m7NJY+r6aowaU3g
bt5ocVVB5Unbjepw8iuLSqrDmseam5u5zwcdOnTIePu9e/eGDBlC23fv3i1D
97Zs2SKPt5Uar6S6HR0d9913n8mRtcqVK1fojFVVVTm+nGsA1cGhyfHKXB3w
krK6Lpu0NTU1Fy5c4HmLgliQtLKhDV2VJK0J2kgeV9NVc9IyR86kNQHV4YxX
FpVUhzWP/fTTTzTYvn37mq+Pvfrqq/TUypUrpe+dfN5WarxS6y5btuy5556z
Y8fq6urCwkKxe127du21116LjY196KGH6H96zHPLcbacP39+zpw5bI+J6uDQ
6njtrg47gJeU1UXSsgJJKxua0VVD0pqgmeRxNV0krSOgOpTVNcGpk9Ya1jz2
1Vdf0WBHjhzZ3bMAkpmZuXjx4h9//JF+3LRpEz01f/58Gbonm7eVGq/Uuvn5
+QMHDrx3757YHXfu3BkdHS1qlx07dvj5+el0Oup2WFjYihUr/HvYt2+fWHU7
KC4uLigoYHtMVAeHVsdrd3XYAbykrC6SlhVIWtnQjK4aktYEzSSPq+kiaR0B
1aGsrglOnbTWsOYx7tMlkyZNosdkbLceuHWz3NxcevzYY4+Z7NLY2FhaWnrr
1i2G3RNyzpnoKjVeO3RF0dLS4uvra8cKrdgEPn78uLu7e3p6+vDhw6n/3AJg
Q0NDWlqat7f3Dz/8ILYDagDVweFE4xWF3dVhB/CSsrpIWjWD6nA6XVGoIWlN
UHPyuJquKJC0joDqUFbXBKdOWmtY81h2djYNdurUqd09xcWd89mzZ9OPeXl5
9DgiIsLQ+OLFi9OnT3frZeTIkdSGSff4zzlDXaXGK1D34MGDbtbh/4rGefPm
JScni+2YqATu7OwMDAxMTEzcunWrl5eXSd3FxsbGx8eL7YAaQHVwqHy88leH
HcBLyuoiadUMqsMpdJ06aU1QW/K4mi6SVhFQHcrqmuDUSWsNax7Lz8+nzo8d
O7a79/0hS5cu5d4f8sEHH9BTTz31FNeytbU1PDzc3d392WefpbJ9++23H3jg
AWpw7tw5x7vH4222ukqNV6BuRUXFe71QoNH2hIQEwxb+1bPc3Nxhw4YJ6UxX
V1dnL1R0UVFRnUbw7Pjzzz+79dz2duHChVR9nX9l165dQ4YMEXFSVAOqg0Pl
45WnOhwEXlJWF0mrZlAdTqHr1ElrgtqSx9V0kbSKgOpQVtcEp05aa1jzWHFx
MQ3E4rPcd2G8/PLL3I9FRUXGL0F3z901P/vsMybd4/E2W12lxitc1wD3qZ+v
v/5aoMTly5fdbH1/Lofxcpw5PEfIy8vr378/PQgNDbW4r4+Pj8DeqgpUB4f6
x2tAuupwEHhJWV0krZpBdTiLrgGnS1oTVJg8rqZrAEkrG6gOZXVNcOqktYY1
j9XX17u7u1PfysrKTJ565JFHaPu7777L/ci9e0Sid1zwnHO2ukqNV7iuAbEe
I/8PGTJEyHfTXL9+vbKXN998MyIiotIInqXdL7/80svLq7W1dcKECXRm6s1o
aGgQ2FtVgergUP94DUhXHQ4CLymri6RVM6gOZ9E14HRJa4IKk8fVdA0gaWUD
1aGsrglOnbTW4PHYrFmzzE/mhQsXaKNOpzOshNy6dWvQoEH0AqWmpv72228W
D9XY2Lh37169Xp+dnS2qezzn3KZucXFxSkpKZGTk6NGjSdrcPCawGm9JSUlS
UhI5Mzw8PDY2dv/+/Ux0DYj1GI3dfHHYJqI+g3bz5k3qUl5eHp3wKVOmiNVS
LagOA0pVhzFSJLDN6vjll1/I0jSohQsXtrW1Ce+tCfASc10krVgt1YLqYK6L
pOXHkXPbLdJLrDzsLFdtJK1qQXUw13XZpLUGj8e++OILGouHh8enn37Kbbl+
/fqoUaNo49y5c41bnj17NiQkhGs8f/787777zvjZjRs3cotCRGJioqju8Z9z
Hl0KEG9v74CAADpvZDNq4+XlRa8+jxaT8X744Ye0kV4v2j5nzpy+fftSsw0b
NjDR5RDlMfKMv7//8ePHhTQ2Ruz9chcvXhwUFLR27Vrq25EjR0yeVfDdOI6A
6mA7XjuqQ/h4OZhXx5IlS9x6ceTOuvASW10kLZIW1YGkNYfJ/ejYeomJh53o
qo2kVS2oDra6rpy01uDxWFdXV0JCAumSQ+hliouLo97Sj8HBwea3oKSxfPzx
xxMmTOC6qtfrDWsg58+fz87O5s6MEI/NmzdvcC9+fn7cAQ1bZs6cKUSXoiAm
JsZwU4vDhw/TswsWLODRZTLeysrKRYsW1dfXc82qqqp0Ot3QoUNZ6XaL9NiJ
Eyf69evX2toqpLExYhP49u3b4eHhnp6e3AlJTU0lUQrenJyciIgIqrU///xT
bB8UB9XBdrx2VIeo8XZLUB2rVq0yJDCdNyGHtQi8xFYXSYukRXUgac3h8RKT
c9st3ktMPOxEV20krWpBdbDVdeWktQb/yhWd9szMzICAAK4DVF9Tpkz5/fff
eXY5c+bMww8/7Gb24am6ujqBHuM+1WIN4+/74Nft6OgwPNvZ2Umv15gxY/il
GY7XAD1LzjHujIO6ojy2YsUK/sqyRnFxMYWnqF2amprS0tIMr5S3tzf9P2jQ
oDVr1lh7o5TKQXVINF4DNqtD7HiZV8eVK1fmzp3Lyb344otCDmsReIm5rglI
WiStAVSHCUjabtbnVriXuhl52Fmu2mJ1kbSygepgrmuC6yStNYS8H4bOfEVF
xblz55qbm4Uck14U6u2MGTOMN4rymH1Y1OVoa2vz9fWNi4sTchwm4+XIy8sj
o77yyisMdYV7jA4YFBS0d+9eIeqsaGlpKSkpoYGfPHmypqZGTmnmoDrMUao6
BCJRdcTHx7uJeWObOfCSpLpIWjmlmYPqkFQXSesgrLzE8OrpFFdtJK3aQHVI
qutSSWsNxz12+vTp9PR0qjvDFu7NJ0uWLDFuxvxqLlCXIysri57auXOnPLoF
BQXk5xEjRpDBUlNTGxsbHdc1INxj33//vZeXF1t1lwLVIYWu01XHH3/80adP
HzrsN998Y3fH4CUpdJ3OS8AiqA4pdJ2uOpC08BI/SFoHQXVIoet01cEkaa3h
uMf0ej31LSwsbPXq1du3bycX0THp3J45c8a4GXOPCdQlysrKfHx8oqKieL5H
hq0uuS46Ojo4OJhaxsTEiLrts02EeywjI+PJJ59kKO1qoDqk0HWu6qiurn70
0UfpmFOnTnWkY/CSFLrO5SVgDVSHFLrOVR1IWnjJZkskrYOgOqTQda7qYJW0
1nDcY11dXTt27Bg1apROp+M+qUGPCwoKTJox95hA3fLy8sGDB9PLffXqVTl1
OYqKikg6ICDgxo0bTNSJzZs3k+ipU6dsthw9enRWVhYrXRcE1SGRLof6q+Ps
2bPcDXwmTZrk4Oco4SWJdDnU7yXAA6pDIl0O9VcHkla4LrzEStcFQXVIpMuh
/upgmLTWYPgpm6amptLSUsPNME2Q7vOMPLplZWU0wMDAQIs3npVO15icnBwa
eG5uLvMO8FNZWUm6165dk1lXS6A6pNA1RuXVUVVVNWDAgO3bt9OVxUFFeEkK
XWNU7iXAA6pDCl1jVF4dSFqBuvASktYRUB1S6Bqj8upgmLTWkOLeHRaR4S5J
JhQWFvr7+4eEhEhhMGscPXq0vLzceEtGRgYNnLbL1geOTZs2RUZGyiyqMVAd
bHHG6rhz5w4TRXiJLc7oJWANVAdbnLE6kLQ2gZeQtA6C6mCLM1YHq6S1htQe
q6ys3NbDW2+9Rad64sSJ3I9C3s7hCPv27eO+BSYtLe2dd95Z34sU96Yw0N7e
TpYm3eXLl+fm5h47diw5OVmn04WFhTU1NUmna5GoqCgar8yiGgPVwRAXrw54
iSEu7iXtgepgiItXB7zEEBf3kvZAdTAE1WERqT124MABN0u89NJLkupyN6Mw
Z926dZLq1tXVJSQkBAYGcnLu7u7x8fHV1dWSippTW1tL3jZZQwNiQXWwxZWr
A15iiyt7SXugOtjiytUBL7HFlb2kPVAdbEF1mCPb+2FcjZqamgsXLsi/YMWx
e/fusLAwRaS1BKpDIlywOuAliXBBL2kPVIdEuGB1wEsS4YJe0h6oDolAdRiA
xzSJXq9PT09XuhdOD6pDkyhSHfCSJkHSMgHVoUmQtIAVSFomoDo0iaqqAx4D
wBqoDsAKeAkAa6A6ACvgJQCsgeoAUgOPAWANVAdgBbwEgDVQHYAV8BIA1kB1
AKmBxwCwBqoDsAJeAsAaqA7ACngJAGugOgAAAAAAAAAAAAAAAAAAAAAAAAAA
AABANjo7O1taWpTuBQAAaBkkLQAASA2SFgAAWJGenj7vryQmJvK0P3bsmJub
W319vcDjFxYWlpSUsOgpAAA4MRSbK1eufOyxx0aNGrVw4cL8/HyexkhaAAAQ
RUpKyjxLbNq0ydouSFoAAGBFWFiYn5/fWCMmT57M0/7zzz8XlcB6vf7MmTMs
egoAAM7K//3f/wUFBel0umnTpj377LMhISEUpAcOHLDWHkkLAACiiI+PH/tX
/va3v1GQpqSkWNsFSQsAAKwICAiYO3eu8Pbt7e11dXXC24eHhzc3N4vvFwAA
aIcZM2Z4e3sfOXKE+/Hu3bvZ2dmdnZ3W2iNpAQDAEShFIyIiQkND//jjD542
SFqgVfA9I5pk5cqV77//vtK9sEBXV5dOp1uxYoWQxvX19dd6aWhoENKeptBB
QUFCGgsB1aFJFKkOeEmTqDZp//3vf7u5uSUlJQlpjKQFUoCkBaxQbdKa8MYb
b3h4eJw9e9bis0haIAUCqyMrKys+Pv699977888/pesMPKZJtm7dOm7cOKV7
YYHGxkaa6/73f//36dOnDx48eP78+bt371prvGrVqtjY2D59+kRHR9MDnsNS
RMfFxY0fP37ixIkPPvhgcHBwYmLi7du3HewtqkOTKFId8JImUW3Sbtu2jZL2
woUL9Li1tfXOnTs8jZG0QAqQtIAVqk1aY6qrqz09PXn+aoakBVIgsDrKy8vf
e++9sLCwv//972QwiToDj2mSS5cu0ZSS/le6I6ZwHTMmKCjo6NGjPLtQCVRU
VPAkcG1t7dChQ3ft2kWPMzMzc3JyWlpaZs2aJfDvdDygOjSJItUBL2kS1SZt
SkqKu7v7yZMnJ0+eTJNY6mR4eDjPTRW6kbSANUhawArVJq0xL7zwgre392+/
/cbfDEkL2CKqOtra2qZMmfJf//VfEnUGHtMq48aN27Jli9K9MOXu3btr167d
v39/U1PT1atXt23b5ufn5+vrS4+t7WIzgfV6/euvv849njlzZnl5OT04ePBg
aGiog71FdWgV+asDXtIq6kza+Ph4mmZ4eXmlpKTk5+dv2LCBglSn0507d87a
LkhawBwkLWCFOpPWwH/+8x9PT8+lS5fabImkBcwRVR3kpZCQEIl6Ao9plXXr
1sXExCjdC9skJSXR7Pfjjz+21sBmAg8YMKCxsbG756YNw4cP525HVlNTM3jw
YAf7hurQKvJXB7ykVdSZtC+88ALlakFBgWHLiRMnaMs///lPa7sgaQFzkLSA
FepMWgOffPIJBey+fftstkTSAuaIqo7Tp0/fd999EvVEiMfu3r2bm5tLv/3J
ebOU8vLyNWvW0FkaM2bM888/TwUrm7Q2xltWVubh4SH8y2uUIj8/n6J48+bN
1hrwJ3Btba2/vz9lLz2urKx8/PHHue2nTp164oknHOwbqsMcRcbLXFf+6lCt
l5TSVcrDLpK07777LuWq8YfLOjo6vLy8nnnmGWu7IGnVo6uZhEfSuqyuiySt
gYSEBIrcGzdu2GyJpIUuc11R1aHgqsKePXumT59ODuc+Aj9+/HiJumHC8ePH
/fz8TD6Av2zZsvb2dkl1NTbe0NDQjz76iFUnmfDll1+apO7SpUtpsCdPnrS2
C38C01TZ29v722+/7e5ZK6arGLd9xowZ27Ztc7C3qA5jlBqvRLoyV4c6veRq
HnadpC0pKXF3d583b55hyw8//ECDNbyx1hwkrUp0NZbwSFoX1HWdpDUQGRkZ
EBAgpCWSFrrKJq2CqwpxcXHGmSDPOb948aKHhwfJPf3006WlpTU1NVlZWZ6e
nrQlIyNDUmmNjTc1NZWOyaqfjtPa2kp+o+Bdu3btiRMnDh8+PH/+fBrm1KlT
KUit7WXz3WKLFi2aPXt2Q0NDSkrKoUOHmpubExMTp02bxi32OgKqwxhFxiud
rszVoUIvKaWrlIddJ2k5lixZ4u7uTqlIU4h9+/aFhIT079//8uXL1tojadWg
q72ER9K6mq6rJS3H3//+91GjRglpiaSFrrJJq+Cqwu3bt//TwxtvvCHbOU9O
TiatyZMnG69q7tmzhzYOHDiQ/xuyHERj4yXn+Pj4SHrGxPLzzz8/88wz3t7e
XDVx38Jz69Yt85ZFRUVje6DL08iRI319fbkfm5qaTFrevHmTErhfv340Z46M
jLz//vvXr1/P5M86qA5jFBmvdLoyV4cKvaSUrlIedqmkJWiYq1evpo5xYfuP
f/zD4q0akbSq0tVewiNpXU3X1ZK2u+cGCF5eXpMmTeJpg6SFrqS6wqtD8fsq
EFu2bJHnnDc3N1OtkdahQ4eMt9+7d2/IkCG0fffu3VL3oVsr4+3o6CDnmBxZ
DZDty8vLf/zxx7a2NlbHvHLlCp2xqqoqx5dzDaA6LCLbeCXVlbk61OYlpXSV
8rBrJm13zwApaWtqalgd0BWSVildTSY8ktaldF02aZmDpIWuKIRXh0utKvz0
008k1LdvX/N1uVdffZWeWrlypdR96NbQeJctW/bcc8/ZsWN1dXVhYaHYva5d
u/baa6/FxsY+9NBD9D89FnLvGiacP39+zpw5bI+J6rCINhK424HqsAO1eUkp
XaU8jKRlhSskrVK6Wk14JK3r6CJpWYGkha5YBFaHS60qfPXVVyQ0cuTI7p6F
l8zMzMWLF//444/046ZNm+ip+fPnS92Hbg2NNz8/f+DAgffu3RO7486dO6Oj
o0XtsmPHDj8/P51OR90OCwtbsWKFfw9CvmrHcYqLi42/Ro0JqA6LaCaB7a4O
O1Cbl5TSVcrDSFpWuELSKqWr1YRH0rqOLpKWFUha6IpFYHU4y6pCY2NjaWmp
xc/IC4f77BX36SQqKO4Dodx6XW5uLj1+7LHHpNA1Qc3jFUVLS4uvr68dK7Ri
E/j48ePu7u7p6enDhw+n/nPL1A0NDWlpad7e3j/88IPYDqgBVIdFZBuvHbqi
sLs67EBtXlJKVykPI2nVDKqDw4kSXhRIWtfRRdKqGVSH0+mKQmB1nD9/vk+f
PtSYla4xTDx28eLF6dOnu/UycuTIvLw8+/qTnZ3t1vOlAN09Rc0dcPbs2fQj
HZMeR0RESKFrgtrGe/DgQTfr/PrrrzwS8+bNS05OFtsxUQnc2dkZGBiYmJi4
detWLy8vk7qLjY2Nj48X2wE1gOqwiGzjFagrf3XYgdq8pJSuUh5G0qoZVAeH
yhMeSes4mtdF0qoZVIdT6EpdHW1tbX379j1y5IijA7CE4x5rbW0NDw93d3d/
9tlnqWzffvvtBx54gBpbvN20TfLz82nfsWPHdve+e2rp0qXcu6c++OADeuqp
p56SQtcEtY23oqLivV4o0Gh7QkKCYQv/6llubu6wYcOEdKarq6uzF7o0REVF
dRrBs+PPP/9MXbp06dLChQup+jr/yq5du4YMGSLipKgGVIdFZBuvQF15qsNB
1OYlpXSV8jCSVs2gOjhUnvBIWse7p3ldJK2aQXU4ha4M1ZGUlDRq1KjCwsK7
d+86NAYzHPdYUVGR8cWuu+cesJ999pl9/SkuLqajWewV9x0cL7/8shS6Jqhw
vAa4z6Z9/fXXAiUuX77MxaPNlsbLcebwHCEvL69///70IDQ01OK+Pj4+Anur
KlAdFpFtvMJ1DUhXHQ6iNi8ppauUh5G0agbVwaH+hDeApLUPzesiadUMqsNZ
dA1IVx3PP/88tVy/fr3AIwvEcY9x73Fi9d62+vp6d3d3OmBZWZnJU4888ght
f/fdd6XQNUGF4zUg1mPk/yFDhgj5bprr169X9vLmm29GRERUGsGztPvll196
eXm1trZOmDCBzky9GQ0NDQJ7qypQHRaRbbzCdQ1IVx0OojYvKaWrlIeRtGoG
1cGh/oQ3gKS1D83rImnVDKrDWXQNSFQd27Zt69+//4oVK6qrq4V2VxiOe+zW
rVuDBg2iGElNTf3tt98s7t7Y2Lh37169Xp+dnW1Ta9asWeYv4oULF2ijTqcz
rMDY1C0uLk5JSYmMjBw9ejRJm0ccD46Mt6SkJCkpifIzPDw8NjZ2//79/FoC
x2tArMdo7OaLwzYR9Rm0mzdvUpfy8vLohE+ZMkWslmpBdVhEzuoQqGuAeXX8
8ssvZGka1MKFC9va2oT31gQVeomVrlgvsfIwklaslmpBdRhQqjqMQdJqw0us
dJG0YrVUC6qDua7TJW13z0eT+vXr99FHHwntqBiY3Lvj7NmzISEh1MDDw2P+
/Pnfffed8bMbN27kli6JxMREm1pffPEFd6hPP/2U23L9+vVRo0bRxrlz5wrU
pQDx9vYOCAigKxTZjNp4eXnRqy9ksI6M98MPP6SNZELaPmfOnL59+1KzDRs2
MBkvhyiP0dXZ39//+PHjQhobI/Z+uYsXLw4KClq7di31zfweIDK871EKUB1s
x2tHdQjX5WBeHUuWLHHrxZF7mKvQS0x07fASEw8jaZG0JqA6DE8haW3iCl5i
ooukRdKagOowPOWMSdvdswLj6el58+ZNgf0UBY/H5s2bN7gXPz8/ziSGLTNn
zjRuTGP5+OOPJ0yYwDXT6/WG1ebz589nZ2dzZ0aIx7q6uhISEqgxOZPsERcX
R2eJfgwODja/9aU1XYqCmJgYw00tDh8+TM8uWLCAR5fJeCsrKxctWlRfX881
q6qq0ul0Q4cOZTXebpEeO3HiRL9+/VpbW4U0NkZsAt++fTs8PJyMyp2Q1NRU
EqXgzcnJiYiIoFr7888/xfZBcVAdbMdrR3WI0u2WoDpWrVplmOvSeRNyWIuo
0EtMdO3wEhMPI2mRtKgOJK058BJbXSQtkhbVoaWkJU6fPn3fffcJOaAd8HiM
+wyUNYy/4ciYM2fOPPzww25mH56qq6sT6LHunlDKzMwMCAjgtKiup0yZ8vvv
v/PsYq7b0dFheLazs5NerzFjxvAcge14DdCz5Bzjzjg4XlEeW7FiBX9lWaO4
uJjCU9QuTU1NaWlphjPm7e1N/w8aNGjNmjXW3iilclAdEo3XgM3qEKvLvDqu
XLkyd+5cTu7FF18UcliLqNBLrHTFeqmbkYdNQNIiaQ2gOkxA0na7npcwpzUG
SduN6pBsvAbUn7Tdyq0q2A1FB52EGTNmGG8U9XsTB+VSRUXFuXPnmpub7dbl
aGtr8/X1jYuLE64uHB7dvLw8itNXXnlFyHEEjle4x+iAQUFBe/fuFaLOipaW
lpKSEhr4yZMna2pq5JRmDqrDcVhVh0Akqo74+Hg3MW9sM0fNXmKiyyHKSww9
jKSVU5o5qA5zlKoOgSBpnchLDHWRtHJKMwfVIamusyStylcVqHvp6elUd4Yt
3JtPlixZYtyMuccE6nJkZWXRUzt37pRHt6CggPw8YsQIMlhqampjY6PjugaE
e+z777/38vJiq+5SoDqk0HW66vjjjz/69OlDh/3mm2/s7hi8JIWu03kJWATV
IYWu01UHkhZe4gdJ6yCoDil0na46VL6qoNfrachhYWGrV6/evn07uYiOSef2
zJkzxs2Ye0ygLlFWVubj4xMVFcXzPTJsdcl10dHRwcHB1DImJkbUzUhtItxj
GRkZTz75JENpVwPVIYWuc1VHdXX1o48+SsecOnWqIx2Dl6TQdS4vAWugOqTQ
da7qQNLCSzZbImkdBNUhha7TVYfKVxW6urp27NgxatQonU7HfTCEHhcUFJg0
Y+4xgbrl5eWDBw+ml/vq1aty6nIUFRWRdEBAwI0bN5ioE5s3bybRU6dO2Ww5
evTorKwsVrouCKpDIl0O9VfH2bNnudtMTZo0ycHPUcJLEulyqN9LgAdUh0S6
HOqvDiStcF14iZWuC4LqkEiXw1mqQ+WrCgaamppKS0sNN8M0QbpP2fDolpWV
0QADAwMt3nhWOl1jcnJyaOC5ubnMO8BPZWUl6V67dk1mXS2B6pBC1xiVV0dV
VdWAAQO2b99OVxYHFeElKXSNUbmXAA+oDil0jVF5dSBpBerCS0haR0B1SKFr
jFNUh7OsKvAjw707TCgsLPT39w8JCZHCYNY4evRoeXm58ZaMjAwaOG2XrQ8c
mzZtioyMlFlUY6A62OKM1XHnzh0mivASW5zRS8AaqA62OGN1IGltAi8haR0E
1cEWJ60Op15VqKys3NbDW2+9Rad64sSJ3I9C3s7hCPv27eO+BSYtLe2dd95Z
34sjdwGySXt7O1madJcvX56bm3vs2LHk5GSdThcWFtbU1CSdrkWioqJovDKL
agxUB0NcvDrgJYa4uJe0B6qDIS5eHfASQ1zcS9oD1cEQ560O6mpQUJBEPZHa
YwcOHHCzxEsvvSSpLnfbH3PWrVsnqW5dXV1CQkJgYCAn5+7uHh8fX11dLamo
ObW1teRtkzU0IBZUB1tcuTrgJba4spe0B6qDLa5cHfASW1zZS9oD1cEWJ62O
xYsXS/S1m90yvh/G1aipqblw4YL8C1Ycu3fvDgsLU0RaS6A6JMIFqwNekggX
9JL2QHVIhAtWB7wkES7oJe2B6pAIp6iO2tragwcPzpo1q0+fPsXFxRJ1Bh7T
JHq9Pj09XeleOD2oDk2iSHXAS5oEScsEVIcmQdICViBpmYDq0CQCqyMzM/P+
++9ftGhRRUWFdJ2BxwCwBqoDsAJeAsAaqA7ACngJAGugOoDUwGMAWAPVAVgB
LwFgDVQHYAW8BIA1UB1AauAxAKyB6gCsgJcAsAaqA7ACXgLAGqgOAAAAAAAA
AAAAAMCc/wdusX4z
    "], {{0, 60.}, {697., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    RasterInterpolation->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{697., 60.},
  PlotRange->{{0, 697.}, {0, 60.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[97]=",
 CellID->653436371,ExpressionUUID->"ae1a8d8a-ed6e-4fb2-9498-001de2b68f0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", 
    RowBox[{"KetFactor", "[", "out", "]"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellLabel->"In[98]:=",
 CellID->273770455,ExpressionUUID->"8f110ddf-5d41-47ec-bfb6-507f5470bc27"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["1", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 1|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 1] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 2] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 3] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 4] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 5] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 6] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 7] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[98]//TableForm=",
 CellID->1175648410,ExpressionUUID->"bd236272-ffcd-44b5-bdab-b298978ebdd0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1362282140,ExpressionUUID->"a584828a-5f63-46d6-acca-17da31bc510a"],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->523520144,ExpressionUUID->"5ace6b38-a9e2-4b77-80eb-3e959b2980e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"SS", "->", "0"}], ",", 
      RowBox[{"T", "->", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "cop", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[99]:=",
 CellID->770533652,ExpressionUUID->"b04ddcb3-b0e8-4c48-9266-0f030ebb00bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.2, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.2, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.2, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"1"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.2, -5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{72, 36}, {1, 1}},
   ImageSize->252,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, "Separator", 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[99]=",
 CellID->1980199431,ExpressionUUID->"17f5be26-ddae-49e9-8f9a-25450700212f"]
}, Open  ]],

Cell["Calculate the output state.", "TechNoteMathCaption",
 CellID->363088131,ExpressionUUID->"ea3b27aa-d6ea-4867-bf0b-11d5de562f12"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[100]:=",
 CellID->1079016412,ExpressionUUID->"ba343557-1c6b-4226-8f63-2f6d05302796"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox["T", 
            $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[100]=",
 CellID->682909481,ExpressionUUID->"5d7f233c-b5cc-4b89-98b3-7e847cc3119a"]
}, Open  ]],

Cell["Check that the target qubit is factorized.", "TechNoteMathCaption",
 CellID->942690207,ExpressionUUID->"f1511856-759c-4555-b7cf-9bf84246565c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[101]:=",
 CellID->473086067,ExpressionUUID->"b10a87b9-d775-453e-8b72-e0af68d42a5c"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[3, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                 $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[3, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`T[Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + 
    E^(Complex[0, 4] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>] + 
    E^(Complex[0, 2] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[2, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[3, Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[3, Q3`$] -> 1|>], 
    Ket[<|$CellContext`T[Q3`$] -> 1|>]]], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellLabel->"Out[101]=",
 CellID->2050946078,ExpressionUUID->"0382186e-c425-47a3-b5f9-0155c5c8997f"]
}, Open  ]],

Cell["\<\
To focus on the state of the control register, ignore the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1762048567,ExpressionUUID->"a24652a6-33f8-44f8-bb4e-aafa4b4f1be2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetDrop", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[102]:=",
 CellID->1674087129,ExpressionUUID->"888467fd-bd2d-4b83-ac6e-fe71ec9bb26f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[102]=",
 CellID->751825541,ExpressionUUID->"0ede7a93-d7d5-42a6-a34e-e2fbab8256c8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1016485255,ExpressionUUID->"307b8d33-34ac-49cc-a168-2603dc4e54e1"],

Cell["\<\
Consider again  the quantum circuit for controlled-power gate.\
\>", "TechNoteMathCaption",
 CellID->1235189013,ExpressionUUID->"720d3348-ec2a-4bcf-8cab-e9cdbeafcc6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"cop", ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[103]:=",
 CellID->1297582908,ExpressionUUID->"9571ff5f-2c4a-44b3-9a39-ed0954bf2436"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[103]=",
 CellID->1918092582,ExpressionUUID->"e847dbb9-7350-41da-b20e-f1b82405f983"]
}, Open  ]],

Cell["\<\
Expand the controlled-power gate in terms of elementary gates (in this case, \
the controlled-unitary gates).\
\>", "TechNoteMathCaption",
 CellID->331049159,ExpressionUUID->"5b00c955-c9e2-4038-a7cd-9fb34b7ba309"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Expand", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[104]:=",
 CellID->1888208538,ExpressionUUID->"f28e6c6e-68c8-4519-8c90-aebec921c699"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {LineBox[{{1, -1}, {1, -5}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -5}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`ActOn[
     Q3`Multiply[
      Q3`Phase[$CellContext`\[Phi], 
       $CellContext`T[3]], 
      Q3`Phase[$CellContext`\[Phi], 
       $CellContext`T[3]], 
      Q3`Phase[$CellContext`\[Phi], 
       $CellContext`T[3]], 
      Q3`Phase[$CellContext`\[Phi], 
       $CellContext`T[3]]], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 2]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`ActOn[
     Q3`Multiply[
      Q3`Phase[$CellContext`\[Phi], 
       $CellContext`T[3]], 
      Q3`Phase[$CellContext`\[Phi], 
       $CellContext`T[3]]], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 1]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`ActOn[
     Q3`Phase[$CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 0]], "LabelSize" -> 0.65], 
   "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[104]=",
 CellID->31973050,ExpressionUUID->"1e577cd7-a27e-4ca4-a9c5-233dc17d237c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qc", "]"}], "-", 
   RowBox[{"Matrix", "[", "new", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[105]:=",
 CellID->1871953819,ExpressionUUID->"fba6c2a0-bc2a-4e9c-91fd-6323afbaf0c7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[105]//MatrixForm=",
 CellID->1116994629,ExpressionUUID->"224a35fa-9359-4598-bf41-0e9998181228"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Conditional Operation", "Subsection",
 CellTags->"Section17",
 CellID->1379525988,ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff"],

Cell[TextData[{
 "The CNOT gate and the controlled-unitary gate can be combined to achieve a \
variety of conditional gate operations. For example, consider a system \
consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2b922721-8f59-4475-9ecf-8081bcea1f50"],
 " qubits and a target register of a single qubit. Suppose that you want to \
operate a unitary gate ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4a95e72d-7750-4e2d-a2c8-9969571d6e6b"],
 " on the target qubit only when an odd number of the control qubits is set \
to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"1"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "4700c5e3-300d-40b7-b81b-bfa275a62410"],
 ","
}], "TechNoteText",
 CellID->1459827304,ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", 
        RowBox[{
         SubscriptBox["c", "1"], "\[CirclePlus]", 
         SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
         "\[CirclePlus]", 
         SubscriptBox["c", "n"]}]], 
       TemplateBox[{"t"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "c961d966-d0ec-45a8-b10c-fe492251e4c2"],
 " ."
}], "TechNoteText",
 CellID->316831353,ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8"],

Cell[TextData[{
 "First, operate the CNOT gates consecutively with the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "\[Minus]", " ", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"384b0335-b827-4145-becb-ab9f85d6d828"],
 " qubits in the control register as the control qubit and the last qubit in \
the control register as the target qubit. This transforms the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "1c7bb7e1-187a-4b4d-8a6d-64bba07245c8"],
 " qubit to",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
       "\[CirclePlus]", 
       SubscriptBox["c", "n"]}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "bb8c910c-1b1c-453e-bde2-bbf806d46593"],
 ". Then, the desired operation is implemented by applying the controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "798627e2-491f-450f-a1ad-8c50cb24997d"],
 " gate controlled by the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "c34cdc58-10ba-4e1a-a673-f9d4b09fb9e4"],
 " qubit. To get the control qubits back to the original state, operate the \
CNOT gates in the reverse order. Overall, the two equivalent quantum circuits \
in Figure 3 below implement the conditional operation."
}], "TechNoteText",
 CellID->1372588958,ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -5}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -5}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -5}, {7.266666666666667, -5}}, {{
         7, -5.266666666666667}, {7, -4.733333333333333}}}]}}, {
     LineBox[{{9, -1}, {9, -5}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -5}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -5}, {9.266666666666667, -5}}, {{
         9, -5.266666666666667}, {9, -4.733333333333333}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]], 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -4}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -4}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -4}, {7.266666666666667, -4}}, {{
         7, -4.266666666666667}, {7, -3.7333333333333334`}}}]}}, {
     LineBox[{{9, -1}, {9, -3}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -3}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -3}, {9.266666666666667, -3}}, {{
         9, -3.2666666666666666`}, {9, -2.7333333333333334`}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]]}]], "Picture",
 CellID->833281032,ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a"],

Cell[TextData[{
 StyleBox["Figure 3",
  FontWeight->"Bold"],
 ". Two equivalent quantum circuits for a conditional unitary gate based on \
sequences of CNOT gates. In principle, the two quantum circuits give the same \
result, but one quantum circuit may be more useful than the other depending \
on the physical connectivity of qubits in a particular quantum computer."
}], "TechNoteCaption",
 CellID->571282978,ExpressionUUID->"5c8a6fcd-8f70-4355-bb88-fb33d14ff756"],

Cell["\<\
This method is used to implement a multi-control unitary gate based on the \
Gray code.\
\>", "TechNoteText",
 CellID->1213442737,ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->780471724,ExpressionUUID->"b8e144c2-025b-4ed9-8be3-8c9d2b5eae31"],

Cell["\<\
As a demonstration, consider a three-qubit control register. Suppose that we \
want to operate a rotation around the y-axis on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1827368847,ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
       RowBox[{
        RowBox[{"Most", "[", "ss", "]"}], ",", 
        RowBox[{"Last", "@", "ss"}]}], "]"}], ",", "List"}], "]"}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", "cnot"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "$n", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Reverse", "[", "cnot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[247]:=",
 CellID->1424575782,ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[4, 2]]], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[251]=",
 CellID->1496947974,ExpressionUUID->"5a9349b8-30c0-4392-b401-4bf00d14059f"]
}, Open  ]],

Cell["\<\
Note the way the logical basis states are transformed through the above \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->873169809,ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[258]:=",
 CellID->1609219912,ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"4"}, "RowDefault"]], 
                $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[260]//TableForm=",
 CellID->572582296,ExpressionUUID->"89c1d5fd-1986-44c0-bb90-b4594fbc36dc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Elementary Gates", "Subsection",
 CellTags->"Section18",
 CellID->1847739219,ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15"],

Cell["\<\
How can you implement a controlled-unitary gate? The operation involves only \
two qubits, and in principle, it should be possible to implement any specific \
controlled-unitary gate. However, the requirements for a physical \
implementation of two-qubit gates is far more difficult to fulfill on \
realistic systems than for single-qubit gates. Fortunately, any \
controlled-unitary gate can be implemented using only the CNOT gate and \
single-qubit gates. This is one of the basic steps in establishing universal \
quantum computation.\
\>", "TechNoteText",
 CellID->192034466,ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "72ee3eec-70a2-4218-a514-c4b738fe7643"],
 " be a unitary gate on the second (target) qubit controlled by the first \
(control) qubit. Suppose that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "482d7c8e-0411-496b-8c03-b7622118e9d2"],
 " has Euler angles \[Alpha], \[Beta], and \[Gamma] and an additional phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], TraditionalForm]],
  ExpressionUUID->"f01f05ed-7b40-4560-9389-996b1c3a264d"],
 ", "
}], "TechNoteText",
 CellID->2002832268,ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"1ceb2f79-208c-43ea-b423-55cfb3cd22d4"],
 " ."
}], "TechNoteText",
 CellID->1943245198,ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9"],

Cell[TextData[{
 "Then one can always find three unitary operators ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "13fc0fd8-64b4-4a1b-91cf-e35261027499"],
 ", ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "d25d1512-d841-4f79-8ecf-3aa53afe092a"],
 ", and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "ed6c3a87-b67c-4830-b6bc-ee86b25be7b7"],
 " such that"
}], "TechNoteText",
 CellID->1190739210,ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "A", " ", "X", " ", "B",
      " ", "X", " ", "C"}]}], TraditionalForm]],ExpressionUUID->
  "74ab9d9c-f73d-409c-b8b4-06573b856aa5"],
 " ,\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "B", " ", "C"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"91f71196-5736-41cc-b04f-8c1e7c12218c"],
 " ,"
}], "TechNoteText",
 CellID->353796077,ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9"],

Cell["\<\
where X is the Pauli X operator. More explicitly, a common choice is\
\>", "TechNoteText",
 CellID->2015931243,ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{"\[Beta]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"faa23ecb-b643-490f-9a46-588cf6441d7f"],
 " ,"
}], "TechNoteText",
 CellID->906902382,ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}], "/", "2"}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "4654d436-6508-4610-abb5-0be68d6d88fc"],
 " ,"
}], "TechNoteText",
 CellID->1616891515,ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "=", 
    RowBox[{
     SubscriptBox["U", "z"], "(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Gamma]"}], ")"}]}], "/", "2"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"d0e584d1-6b09-480b-bdbc-36ca96bc9da7"],
 " ."
}], "TechNoteText",
 CellID->837623467,ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"y", "/", "z"}]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{"X", " ", 
     RowBox[{
      SubscriptBox["U", 
       RowBox[{"y", "/", "z"}]], "(", 
      RowBox[{"-", "\[Phi]"}], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"2b861489-f486-4764-a02d-ad68575af15c"],
 " for any \[Phi], the above choice satisfies the desired properties. These \
properties imply that the controlled-unitary gate can be implemented as in \
the following quantum circuit"
}], "TechNoteText",
 CellID->1182303784,ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->118.8,
   PlotRangePadding->Scaled[0.025]], "=", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[ExponentialE]\\), \\(\
\[ImaginaryI]\\\\ \[CurlyPhi]\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->313511997,ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b"],

Cell[TextData[{
 "where the last gate on the first qubit is the relative phase shift by \
\[CurlyPhi], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"04c67e1e-6647-4538-bbb6-b9def3f5571a"],
 ". Indeed, when the control qubit is in |0\:27e9, the two CNOT gates in the \
middle do nothing, and the combined operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", " ", "B", " ", "C"}], TraditionalForm]],ExpressionUUID->
  "656b77d4-b90f-4de0-b5b0-b6c3dc41a145"],
 " on the target qubit ends up with the identity operator. With the control \
qubit in |1\:27e9, on the other hand, the two CNOT gates are operational and \
the overall operator on the target qubit becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "X", " ", "B", " ", "X", " ", "C"}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], "U"}]}], 
   TraditionalForm]],ExpressionUUID->"07005521-c279-4c9c-8d8c-bafd3d51d026"],
 ", where the phase factor is canceled by the opposite phase from the control \
qubit."
}], "TechNoteText",
 CellID->1418747488,ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd"],

Cell["\<\
For demonstration, consider a unitary matrix to be applied conditionally on \
the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1378098175,ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[261]:=",
 CellID->1028095504,ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"3", "/", "4"}]]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[262]//MatrixForm=",
 CellID->66651344,ExpressionUUID->"7ebad514-2384-40fd-9626-6e0e825a4a06"]
}, Open  ]],

Cell["We want to implement the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->1646790355,ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[263]:=",
 CellID->1153761970,ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, Complex[0, 
       Rational[1, 2]] 
     3^Rational[1, 2] + (Rational[-1, 2] (-1)^Rational[3, 4]) $CellContext`S[
      2, 4] + (Rational[1, 2] (-1)^Rational[1, 4]) $CellContext`S[2, 5], 
    "Label" -> "U"]]]], "Output",
 CellLabel->"Out[264]=",
 CellID->909200866,ExpressionUUID->"abfb7109-7099-4ec7-bb30-6db0313004da"]
}, Open  ]],

Cell["\<\
First, find the Euler angles of the unitary operator and the global phase \
factor.\
\>", "TechNoteMathCaption",
 CellID->1240176371,ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"det", "=", 
   RowBox[{"Det", "[", "mat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "det", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"mat", "/", 
    RowBox[{"Sqrt", "[", "det", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[265]:=",
 CellID->167989615,ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "4"]}], ",", 
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "4"]}], "}"}]], "Output",
 CellLabel->"Out[267]=",
 CellID->982119958,ExpressionUUID->"ff423f9c-263a-4e7b-95ee-5f9a4b01c82e"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", \
"TechNoteMathCaption",
 CellID->833485781,ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[268]:=",
 CellID->359691886,ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c"],

Cell["Finally, construct the equivalent quantum circuit model.", \
"TechNoteMathCaption",
 CellID->175061697,ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellLabel->"In[272]:=",
 CellID->209345089,ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
     LineBox[{{5.6, -1.4}, {6.4, -1.4}, {6.4, -0.6}, {5.6, -0.6}, {
      5.6, -1.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", 
         FractionBox["\[Pi]", "2"]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->298.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`EulerRotation[{0, 0, Rational[1, 4] Pi}, 
    $CellContext`S[2, Q3`$], "Label" -> "C"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{0, Rational[-1, 6] Pi, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "B"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{Rational[-1, 4] Pi, Rational[1, 6] Pi, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "A"], 
   Q3`Phase[Rational[1, 2] Pi, 
    $CellContext`S[1, 3]]]]], "Output",
 CellLabel->"Out[272]=",
 CellID->1936315278,ExpressionUUID->"19f8331d-ec5e-4f13-8574-50ba82f707c7"]
}, Open  ]],

Cell["Check the result.", "TechNoteMathCaption",
 CellID->2073812678,ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "//", "Chop"}]], "Input",
 CellLabel->"In[273]:=",
 CellID->1395051790,ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[273]=",
 CellID->1958334418,ExpressionUUID->"809743dc-ef98-42ef-9f5e-c82f2d2f18c9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "TechNoteSection",
 CellTags->"Section19",
 CellID->1476129218,ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[74]:=",
 CellID->384188579,ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[75]:=",
 CellID->1721604371,ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408"],

Cell[TextData[{
 "Here, we ",
 ButtonBox["decompose",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/GivensFactor"],
 " an arbitrary two-qubit unitary gate into factors of controlled-unitary \
gates only. This is a remarkable advantage when one tries to build a quantum \
computer as you can just focus on how to implement the CNOT gate and \
single-qubit gates. Moreover, the same idea eventually leads to the proof of \
universal quantum computation on a larger system."
}], "TechNoteText",
 CellID->1572676782,ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c"],

Cell[CellGroupData[{

Cell["Two-Level Unitary Transforms", "Subsection",
 CellTags->"Section20",
 CellID->749947798,ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c"],

Cell[TextData[{
 "Consider an arbitrary two-qubit unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "74bbef41-b239-4256-b5d5-f4bb071f8944"],
 ". In the logical basis, it is represented by a unitary matrix"
}], "TechNoteText",
 CellID->791116743,ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "13"], 
        SubscriptBox["U", "14"]},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "23"], 
        SubscriptBox["U", "24"]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubscriptBox["U", "33"], 
        SubscriptBox["U", "34"]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubscriptBox["U", "43"], 
        SubscriptBox["U", "44"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "49d60377-f5d7-4dc8-bd55-98e85746207e"],
 " ."
}], "TechNoteText",
 CellID->1227841024,ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e"],

Cell[TextData[{
 "To break the unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b52a1ed7-0ba7-40e2-bf4c-cf1f5def16ab"],
 " down into more elementary quantum logic gates, we make use of ",
 StyleBox[ButtonBox["two-level unitary transformations",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/GivensRotation"],
  FontSlant->"Italic"],
 ". A two-level unitary transformation is a unitary operation with matrix \
representation that acts only on the two columns and rows of other matrices \
or column or row vectors. The descriptive word \
\[OpenCurlyDoubleQuote]two-level\[CloseCurlyDoubleQuote] should not be \
confused with \[OpenCurlyDoubleQuote]two-qubit\[CloseCurlyDoubleQuote]. A \
two-level transformation acts on multiple qubits, but it just transforms only \
two rows or columns at a time in the representation."
}], "TechNoteText",
 CellID->1153726345,ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704"],

Cell["\<\
Let us start with a two-level unitary transformation of the form\
\>", "TechNoteText",
 CellID->1048831652,ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "13", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         SubscriptBox["U", "14"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "14", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d87e6b00-b56f-4bd7-803c-399755863cf5"],
 " "
}], "TechNoteText",
 CellID->1167800588,ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalN]", "1"], ":=", 
    SqrtBox[
     RowBox[{"|", 
      SubscriptBox["U", "13"], 
      SuperscriptBox["|", "2"], 
      RowBox[{"+", 
       RowBox[{"|", 
        SubscriptBox["U", "14"], 
        SuperscriptBox["|", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "3d868cb0-ebb3-4c78-8ddc-f1586c530df3"],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "1"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "1", "\[Dagger]"], 
      SubscriptBox["T", "1"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"1f35209a-1fbf-48f3-884f-67e21e6eb28c"],
 ". When it multiplies ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0055e7ce-786a-4e76-a5cf-7513877c3e78"],
 " from the right, it does not change the first two columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "feffd3c2-fd2b-499c-902f-353dd544563e"],
 ". It only alters the last two columns, and hence the name \
\[OpenCurlyQuote]two-level transformation\[CloseCurlyQuote]. The elements in \
the lower-right sub-block of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "de482d28-90a1-4a5c-a353-187cebeb0110"],
 " have been chosen so that the first element of the last column is \
canceled:"
}], "TechNoteText",
 CellID->1371432583,ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubsuperscriptBox["U", "13", 
         RowBox[{" ", "\[Prime]"}]], "0"},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubsuperscriptBox["U", "23", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubsuperscriptBox["U", "33", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubsuperscriptBox["U", "43", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "229bae80-0c62-4782-80d7-bb21170e88c2"],
 " ."
}], "TechNoteText",
 CellID->725439230,ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06"],

Cell["\<\
Now take another two-level unitary transformation, this time, of the form\
\>", "TechNoteText",
 CellID->1192474591,ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "2"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "12", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", "\[Prime]"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", 
           RowBox[{"\[Prime]", "*"}]}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "933ff944-3d93-4984-8319-45b52f0f25c3"],
 " ,"
}], "TechNoteText",
 CellID->1603057133,ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "2"], TraditionalForm]],ExpressionUUID->
  "42f4f8eb-8a60-4f33-83b1-ef413e77ab43"],
 " is a normalization factor like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "1"], TraditionalForm]],ExpressionUUID->
  "b145126e-e49a-4ffe-87d5-cdb331e6d340"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "2"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "2", "\[Dagger]"], 
      SubscriptBox["T", "2"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"9779262d-c14b-4c29-b0c0-8b11b570a42d"],
 ". It removes ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "13", 
    RowBox[{" ", "\[Prime]"}]], TraditionalForm]],ExpressionUUID->
  "e0a76015-ec0e-46ac-b6cf-de3ff7920c4f"],
 " while keeping the first and last column as they are:"
}], "TechNoteText",
 CellID->251399069,ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubsuperscriptBox["U", "12", "\[DoublePrime]"], "0", "0"},
       {
        SubscriptBox["U", "21"], 
        SubsuperscriptBox["U", "22", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubsuperscriptBox["U", "32", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubsuperscriptBox["U", "42", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "979aec3f-ddc0-42d0-893c-fc1f3e50ff73"],
 " ."
}], "TechNoteText",
 CellID->1163819034,ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720"],

Cell["Similarly, we go further with the two-level unitary matrix", \
"TechNoteText",
 CellID->1025447562,ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "3"], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["U", "11", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         SubsuperscriptBox["U", "12", "\[DoublePrime]"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {
        RowBox[{
         SubsuperscriptBox["U", "12", 
          RowBox[{"\[DoublePrime]", "*"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "11"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dae78453-2ab9-4d05-ae48-8aae8af0a905"],
 " "
}], "TechNoteText",
 CellID->1140907359,ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb"],

Cell[TextData[{
 "to remove element ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "12", "\[DoublePrime]"], TraditionalForm]],
  ExpressionUUID->"58b02cc1-973b-4a66-bcf7-475a5111e0b7"],
 " and get"
}], "TechNoteText",
 CellID->348498650,ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "3"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["U", "11", "\[Prime]\[Prime]\[Prime]"], "0", "0", 
        "0"},
       {"0", 
        SubsuperscriptBox["U", "22", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "32", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "42", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "505f2971-b178-4f6c-846a-f26ff01a3e47"],
 " ."
}], "TechNoteText",
 CellID->1028905181,ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb"],

Cell[TextData[{
 "At this stage, all elements except for the first of the first column vanish \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "21", "\[Prime]\[Prime]\[Prime]"], "=", 
    RowBox[{
     SubsuperscriptBox["U", "31", "\[Prime]\[Prime]\[Prime]"], "=", 
     RowBox[{
      SubsuperscriptBox["U", "41", "\[Prime]\[Prime]\[Prime]"], "=", 
      "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "06ee66e5-d340-4277-8501-c84a3cdeb493"],
 ") the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", 
    SubscriptBox["T", "1"], 
    SubscriptBox["T", "2"], 
    SubscriptBox["T", "3"]}], TraditionalForm]],ExpressionUUID->
  "9fc42948-ccec-4b1f-9f6b-3150b50e591b"],
 " is a unitary matrix. "
}], "TechNoteText",
 CellID->1271051423,ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70"],

Cell["\<\
Repeating the procedure, we can remove all off-diagonal elements to get\
\>", "TechNoteText",
 CellID->1541429652,ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "L"]}], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "8ea5b480-8693-4958-ad10-aae38ff8a622"],
 " ."
}], "TechNoteText",
 CellID->1712927403,ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351"],

Cell[TextData[{
 "As Tj are all unitary, it enables us to rewrite ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "75eab368-2039-46a2-8453-a51d75dee9a1"],
 " in a combination of two-level unitary transformations, that is,"
}], "TechNoteText",
 CellID->5090539,ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "=", 
    RowBox[{
     SubsuperscriptBox["T", "L", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "2", "\[Dagger]"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}]}], TraditionalForm]],
  ExpressionUUID->"c92fea36-6858-4b54-9a85-a0bea3369da5"],
 " ."
}], "TechNoteText",
 CellID->1804826740,ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83"],

Cell["\<\
For demonstration, consider a Hermitian operator on a two-qubit system. \
Physically, it corresponds to a transverse-field Ising model.\
\>", "TechNoteMathCaption",
 CellID->516505305,ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "H", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[77]:=",
 CellID->775759961,ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[77]=",
 CellID->1591075994,ExpressionUUID->"7fd1fd7f-c0f8-4e90-8a28-6c1c68fd4f53"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellLabel->"Out[78]//MatrixForm=",
 CellID->747858714,ExpressionUUID->"cdd8078b-9bec-4fa3-bc59-b6b1d69cf5cd"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "TechNoteMathCaption",
 CellID->595736468,ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[79]:=",
 CellID->974055362,ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[(Complex[0, 
      Rational[-1, 4]] Pi) (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[79]=",
 CellID->1060407830,ExpressionUUID->"53c2deaa-176a-4de8-96cd-cd5c2d30d9cd"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "TechNoteMathCaption",
 CellID->1817782849,ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[80]:=",
 CellID->1373980921,ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[81]//MatrixForm=",
 CellID->1374392221,ExpressionUUID->"8def29fa-6f19-4957-a57c-e149db55e9ee"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["GivensRotation", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->642635412,ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "4"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[90]:=",
 CellID->1078108721,ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"-", "0.566946709513841`"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.566946709513841`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Q3`GivensRotation[{{
       Complex[0.18898223650461365`, -0.5669467095138409], 
       Complex[-0.566946709513841, -0.566946709513841]}, {
       Complex[0.566946709513841, -0.566946709513841], 
       Complex[0.18898223650461365`, 0.5669467095138409]}}, {3, 4}, {
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "+", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.8583950752789522`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.8583950752789522`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "-", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Q3`GivensRotation[{{
       Complex[-0.1622214211307625, 0.4866642633922876], 
       0.8583950752789522}, {-0.8583950752789522, 
       Complex[-0.1622214211307625, -0.4866642633922876]}}, {2, 3}, {
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "-", 
                    RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.9340497736158587`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.9340497736158587`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "+", 
                    
                    RowBox[{"0.25253813613805276`", " ", 
                    "\[ImaginaryI]"}]}]}], "}"}]}], "}"}], "SummaryItem"]}]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Q3`GivensRotation[{{
       Complex[-0.2525381361380527, -0.25253813613805276`], 
       0.9340497736158587}, {-0.9340497736158587, 
       Complex[-0.2525381361380527, 0.25253813613805276`]}}, {3, 4}, {
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], "}"}]], "Output",
 CellLabel->"Out[91]=",
 CellID->13529710,ExpressionUUID->"0a3864a7-df97-4afb-9080-bb43e4f4954a"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["GivensRotation", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "TechNoteMathCaption",
 CellID->1155771237,ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[92]:=",
 CellID->1057593144,ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0.`"},
       {"0.`", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {2, 2}, 0., {1, {{0, 1, 2}, {{1}, {2}}}, {1., 1.}}]]]], ",", 
   
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.`", "0.`", "0.`"},
       {"0.`", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.`", "0.`"},
       {"0.`", "0.`", 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0.`", "0.`", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0., {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        Complex[1., 0.], Complex[1., 0.], Complex[
         0.18898223650461365`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461365`, 0.5669467095138409]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.`", "0.`", "0.`"},
       {"0.`", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.8583950752789522`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.`"},
       {"0.`", 
        RowBox[{
         RowBox[{"-", "0.8583950752789522`"}], "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0.`"},
       {"0.`", "0.`", "0.`", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0., {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        Complex[1., 0.], Complex[-0.16222142113076243`, 0.4866642633922876], 
         Complex[0.8583950752789522, 0.], Complex[-0.8583950752789522, 0.], 
         Complex[-0.16222142113076243`, -0.4866642633922876], Complex[
         1., 0.]}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[92]=",
 CellID->1917505456,ExpressionUUID->"7b782820-34e6-4455-81c1-9b62fff30ae0"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "TechNoteMathCaption",
 CellID->1969536942,ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "[", "twl", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[99]:=",
 CellID->694449336,ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[100]//MatrixForm=",
 CellID->442189350,ExpressionUUID->"f04cc5ca-1138-4a0a-affa-7a3a568e1321"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Two-Level Unitary Transformations with Controlled-Unitary Gates\
\>", "Subsection",
 CellTags->"Section22",
 CellID->1363502801,ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0"],

Cell["\<\
We are still to express the two-level unitary transformations in terms of \
controlled-unitary gates. The two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->593579270,ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e083befc-a7e0-4768-988b-1f27cc7af22e"],
 " "
}], "TechNoteText",
 CellID->1225250575,ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3"],

Cell["\<\
is already in the form of the matrix representation of a controlled-unitary \
gate, and just corresponds to a single controlled-unitary\
\>", "TechNoteText",
 CellID->565722942,ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "8f633567-5d40-438e-aba9-efed74c06e17"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "2d010309-ce55-49c2-83d0-d75b6330abac"],
 "."
}], "TechNoteText",
 CellID->1195380925,ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963"],

Cell["A two-level unitary matrix of the form", "TechNoteText",
 CellID->1057688790,ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "6c480a58-bff4-4f80-9c35-7dda6b9ea4c8"],
 " "
}], "TechNoteText",
 CellID->1853347311,ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec"],

Cell["\<\
also corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged. Here, the first qubit is the target qubit and the \
second the control qubit:\
\>", "TechNoteText",
 CellID->2105439889,ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e38a6c68-2602-4891-bc34-1311b80dde5d"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "4d558d0d-ffca-4755-8bde-b9812f09c2c1"],
 "."
}], "TechNoteText",
 CellID->2040162804,ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b"],

Cell["\<\
\tMore complicated is the two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->144855179,ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "37c16ac8-7e58-4468-b68c-6d10cb79975f"],
 " . "
}], "TechNoteText",
 CellID->1482021402,ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3"],

Cell["\<\
As it affects both qubits, it cannot be represented by a single \
controlled-unitary gate. However, it is possible to bring it to the second of \
the above two forms by simultaneously exchanging the last two columns and \
rows.\
\>", "TechNoteText",
 CellID->1818365508,ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], "0", 
        SubscriptBox["U", "12"]},
       {"0", "0", "1", "0"},
       {"0", 
        SubscriptBox["U", "21"], "0", 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7a86ab8c-235e-4dd8-8ed7-c6ce57b24b88"],
 " . "
}], "TechNoteText",
 CellID->429312499,ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f"],

Cell["\<\
The specified exchanges correspond to flipping the bit values of the second \
qubit only when the first qubit has a value of 1, and they can be implemented \
by applying the CNOT gate with the first qubit as the control qubit and the \
second qubit as the target qubit. These observations lead to the following \
equivalence,\
\>", "TechNoteText",
 CellID->2057600420,ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "fd0b029d-8d4b-4398-8da1-87506b4b2332"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "3cdee78c-a236-4778-a65c-f5b50fb80706"],
 ". "
}], "TechNoteText",
 CellID->1161091299,ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd"],

Cell["\<\
which allows us to implement the two-level unitary transformation with two \
CNOT gates and a controlled-unitary gate.\
\>", "TechNoteText",
 CellID->277562004,ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b"],

Cell["\<\
Of course, the way is not unique. For example, it is also possible to bring \
the same two-level unitary matrix to the first two-level unitary form, this \
time, by simultaneously exchanging the second and fourth columns and rows.\
\>", "TechNoteText",
 CellID->650119944,ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "21"]},
       {"0", "0", 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "11"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "10683ca9-7618-42dc-a15d-b71e59a3adf7"],
 " . "
}], "TechNoteText",
 CellID->169102872,ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4"],

Cell[TextData[{
 "These exchanges correspond to flipping the bit values of the first qubit \
only when the second qubit has a value of 1, that is, to applying the CNOT \
gate with the second qubit as the control qubit and the first qubit as the \
target qubit. Note that in this case, unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4084441d-9e5a-4132-baea-8f23cd937a23"],
 " itself is modified through the exchanges, and the rows and columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "32a80573-6a45-46d2-8c11-76524149bbfd"],
 " are exchanged. This is equivalent to the basis change by the Pauli X \
matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", "\[RightArrow]", " ", 
     SuperscriptBox[
      RowBox[{"U", " "}], "\[Prime]"]}], " ", "=", " ", 
    RowBox[{"X", " ", "U", " ", "X"}]}], TraditionalForm]],ExpressionUUID->
  "7c5991a1-4d8d-48e2-8f28-7d190e4d8098"],
 ". Putting all together, the two-level unitary matrix is implemented as"
}], "TechNoteText",
 CellID->991104723,ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "89f4fe62-4810-4870-b7fa-c07e8a70e33c"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U'\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b1853fbd-2d28-48c7-81bc-05f3cde24749"],
 ". "
}], "TechNoteText",
 CellID->1613913329,ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b"],

Cell["\<\
\tIn a similar manner, we can implement another form of two-level unitary \
matrix as\
\>", "TechNoteText",
 CellID->175375246,ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["U", "11"], "0", "0", 
       SubscriptBox["U", "12"]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       SubscriptBox["U", "21"], "0", "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "f5f73d4b-faa8-47cd-99b4-95b842181aa8"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->295.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "9af252a6-d7fe-4869-ae7f-3fceeb977059"],
 "= ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->367.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "88048059-bb49-4867-aa3c-b3d2e0a1135c"],
 "."
}], "TechNoteText",
 CellID->1184195838,ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad"],

Cell["\<\
For a demonstration, consider a single-qubit rotation around the y-axis.\
\>", "TechNoteText",
 CellID->2048492517,ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "U", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[101]:=",
 CellID->555904515,ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[102]//MatrixForm=",
 CellID->792186502,ExpressionUUID->"f358e0c2-3b2b-4c4a-b0e5-d0ab13756081"]
}, Open  ]],

Cell["\<\
This is the two-level unitary transformation to be implemented with \
elementary gates.\
\>", "TechNoteMathCaption",
 CellID->691274085,ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"GivensRotation", "[", 
    RowBox[{
     RowBox[{"Matrix", "[", "U", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "op", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[103]:=",
 CellID->357016325,ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], 1, 1, Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[104]//MatrixForm=",
 CellID->1204476725,ExpressionUUID->"b3f3af28-0d86-43e6-93c9-d4d7c69d513f"]
}, Open  ]],

Cell["This quantum circuit shows one implementation.", "TechNoteMathCaption",
 CellID->1549413286,ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[105]:=",
 CellID->602394280,ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
      3.6, -1.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {1, 1}},
   ImageSize->295.2,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], "Spacer", 
   $CellContext`S[2, 1], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, Q3`$], "Label" -> "U"]], 
   $CellContext`S[2, 1], "Spacer", 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[105]=",
 CellID->443140805,ExpressionUUID->"481641f9-8953-4fdc-a514-dd4023177c2d"]
}, Open  ]],

Cell["This is another implementation.", "TechNoteMathCaption",
 CellID->389328403,ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[106]:=",
 CellID->59796812,ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -1}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
     LineBox[{{4.6, -1.4}, {5.4, -1.4}, {5.4, -0.6}, {4.6, -0.6}, {
      4.6, -1.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
     LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
      6.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, 
     LineBox[{{8.6, -1.4}, {9.4, -1.4}, {9.4, -0.6}, {8.6, -0.6}, {
      8.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {1, 1}},
   ImageSize->367.2,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 1], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 1], "Spacer", 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, Q3`$], "Label" -> "U"]], "Spacer", 
   $CellContext`S[1, 1], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 1], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[106]=",
 CellID->249200483,ExpressionUUID->"bede954a-b038-4a4c-9713-a8fb015d8484"]
}, Open  ]],

Cell["\<\
Check the equivalence of the two-level unitary matrix and the implementations\
\
\>", "TechNoteMathCaption",
 CellID->834281808,ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc2", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[107]:=",
 CellID->853615793,ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[107]//MatrixForm=",
 CellID->933398985,ExpressionUUID->"ed4d0063-a8ff-4db7-8176-b343ed6e6178"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[108]//MatrixForm=",
 CellID->268699560,ExpressionUUID->"ff4329d6-b0c9-4e01-92ac-a941ec0777e2"]
}, Open  ]],

Cell[TextData[{
 "So far, we have determined the implementations of 4 \[Times] 4 two-level \
unitary matrices of different forms just by inspection, that is, in an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " manner. For more than two qubits, the size of the two-level unitary \
matrices is much larger, and it is difficult to find proper implementations \
in such a way. Fortunately, there is a ",
 ButtonBox["systematic way based on the Gray code",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/GivensFactor"],
 "."
}], "TechNoteText",
 CellID->645391397,ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellTags->"Section23",
 CellID->153308382,ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9"],

Cell["\<\
In the above, we have shown that an arbitrary two-qubit unitary gate can be \
carried out by first decomposing its matrix representation into two-level \
unitary matrices and then implementing the two-level unitary matrices by \
means of the CNOT and controlled-unitary gates. Here we demonstrate the whole \
procedure.\
\>", "TechNoteText",
 CellID->1821083521,ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6"],

Cell["\<\
Consider a two-qubit model. Physically, it describes two qubits coupled with \
each other through an Ising-type couping and subject to an external magnetic \
field..\
\>", "TechNoteMathCaption",
 CellID->1013800403,ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellLabel->"In[189]:=",
 CellID->808117923,ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[189]=",
 CellID->2071916108,ExpressionUUID->"93cef377-a46a-408c-803e-0ac53d6a4b2e"]
}, Open  ]],

Cell["\<\
We are interested in simulating the time-evolution operator governed by the \
above Hamiltonian.\
\>", "TechNoteMathCaption",
 CellID->322701359,ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", "*", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[190]:=",
 CellID->1245532038,ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[(Complex[0, 
      Rational[-1, 4]] Pi) (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[190]=",
 CellID->1723793763,ExpressionUUID->"91b498f5-751b-4775-a234-f44e47189007"]
}, Open  ]],

Cell["\<\
This is the 4\[Times]4 unitary matrix to implement in terms of elementary \
gates.\
\>", "TechNoteMathCaption",
 CellID->730080199,ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"U", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[191]:=",
 CellID->1883829282,ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[192]//MatrixForm=",
 CellID->1308824420,ExpressionUUID->"36b19693-9b35-49b4-b5c0-67a3e5638386"]
}, Open  ]],

Cell["\<\
First, decompose the 4\[Times]4 unitary matrix into the two-level unitary \
matrices.\
\>", "TechNoteMathCaption",
 CellID->2133759026,ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", "SS"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"Matrix", "[", "twl", "]"}]}]}]}], "Input",
 CellLabel->"In[205]:=",
 CellID->1258528729,ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1., 1., 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        1., 1., Complex[0.18898223650461365`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461365`, 0.5669467095138409]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789522, -0.8583950752789522, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "-", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
        "0.9340497736158587`"},
       {"0", "0", 
        RowBox[{"-", "0.9340497736158587`"}], 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "+", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        1., 1., Complex[-0.25253813613805276`, -0.25253813613805276`], 
         0.9340497736158587, -0.9340497736158587, 
         Complex[-0.25253813613805276`, 0.25253813613805276`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "-", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
        "0.7264831572567789`", "0", "0"},
       {
        RowBox[{"-", "0.7264831572567789`"}], 
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "+", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {1}, {2}, {3}, {4}}}, {
        Complex[-0.35355339059327384`, -0.5892556509887896], 
         0.7264831572567789, -0.7264831572567789, 
         Complex[-0.35355339059327384`, 0.5892556509887896], 1., 1.}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789521`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789521`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789521, -0.8583950752789521, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.1889822365046136`"}], "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5669467095138409`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.5669467095138409`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.1889822365046136`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        1., 1., Complex[-0.1889822365046136, 0.5669467095138409], Complex[
         0.5669467095138409, -0.5669467095138409], 
         Complex[-0.5669467095138409, -0.5669467095138409], 
         Complex[-0.1889822365046136, -0.5669467095138409]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[206]=",
 CellID->1991751095,ExpressionUUID->"1ff5a613-94f6-4852-86ff-be53ee8e7966"]
}, Open  ]],

Cell[TextData[{
 "Next, rewrite the two-level unitary matrices in terms of the CNOT and \
controlled-unitary gates. The first element of list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "TechNoteMathCaption",
 CellID->702850526,ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Expand", "/@", 
   RowBox[{"Rest", "[", "twl", "]"}]}]}]], "Input",
 CellLabel->"In[207]:=",
 CellID->1648731982,ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]},
        LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
        0.6, -2.4}}], InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1, -2}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
     ImageSize->118.8,
     PlotRange->NCache[{Full, {
         Rational[-5, 2], 
         Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[0.18898223650461365`, 0.] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]},
        LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
        1.6, -2.4}}], InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2, -2}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
     ImageSize->190.79999999999998`,
     PlotRange->NCache[{Full, {
         Rational[-5, 2], 
         Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}], 
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]},
        LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
        0.6, -2.4}}], InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1, -2}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
     ImageSize->118.8,
     PlotRange->NCache[{Full, {
         Rational[-5, 2], 
         Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.2525381361380527, 0.] + 
      Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
      Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
      Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], 
       {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{1, -1}, 0.09]}, 
       {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]},
        LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
        0.6, -2.4}}], InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1, -2}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
     ImageSize->118.8,
     PlotRange->NCache[{Full, {
         Rational[-5, 2], 
         Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0}, 
      Complex[-0.35355339059327373`, 0.] + 
      Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
      Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]},
        LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
        1.6, -2.4}}], InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2, -2}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
     ImageSize->190.79999999999998`,
     PlotRange->NCache[{Full, {
         Rational[-5, 2], 
         Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}], 
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
      Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]},
        LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
        0.6, -2.4}}], InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1, -2}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
     ImageSize->118.8,
     PlotRange->NCache[{Full, {
         Rational[-5, 2], 
         Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.18898223650461357`, 0.] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]]}], "}"}]], "Output",
 CellLabel->"Out[207]=",
 CellID->68577246,ExpressionUUID->"14414b83-5536-4abc-b988-2c2031462080"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "TechNoteMathCaption",
 CellID->328948492,ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", "gates"}]}]}]], "Input",
 CellLabel->"In[208]:=",
 CellID->1014397666,ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
         4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
     LineBox[{{5, -1}, {5, -2}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
     LineBox[{{5.6, -2.4}, {6.4, -2.4}, {6.4, -1.6}, {5.6, -1.6}, {
      5.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -2}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -1}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -1}, {7.266666666666667, -1}}, {{
         7, -1.2666666666666666`}, {7, -0.7333333333333334}}}]}}, {
     LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, 
     LineBox[{{7.6, -2.4}, {8.4, -2.4}, {8.4, -1.6}, {7.6, -1.6}, {
      7.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -2}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
         9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
     LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, 
     LineBox[{{9.6, -2.4}, {10.4, -2.4}, {10.4, -1.6}, {9.6, -1.6}, {
      9.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->442.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.18898223650461357`, 0.] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
    Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0}, 
    Complex[-0.35355339059327373`, 0.] + 
    Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
    Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.2525381361380527, 0.] + 
    Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
    Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
    Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> "U"], 
   
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[0.18898223650461365`, 0.] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[208]=",
 CellID->2018914546,ExpressionUUID->"c7269dec-a371-413b-886f-0cc0877c86c9"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "TechNoteMathCaption",
 CellID->608232459,ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[209]:=",
 CellID->540778693,ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "-", 
       RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11785113019775785`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11785113019775792`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775785`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3535533905932738`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11785113019775793`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887898`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775796`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887897`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3535533905932736`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1178511301977579`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932738`"}], "-", 
       RowBox[{"0.3535533905932739`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3535533905932739`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932739`"}], "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[210]//MatrixForm=",
 CellID->1694484040,ExpressionUUID->"9fde22d8-72de-4e45-9e67-908cdc531c8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "mat"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellLabel->"In[212]:=",
 CellID->326787606,ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[212]//MatrixForm=",
 CellID->1912083700,ExpressionUUID->"af2d620b-8e93-41cb-b183-3a82763067d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "4a34ab7c-05b0-4f6c-b807-210184726b24"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"ac0acf37-45f4-44e8-b2ac-\
6fd418473a1a"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "70de6aa0-fc83-43c9-8388-a1bac326c320"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "769e6e6d-dabe-4846-849f-cff5bf8c8365"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"266b521d-27a7-483f-aab0-\
0a25aba4e7e1"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. M. Greenberger, M. A. Horne, & A. Zeilinger, \
\[OpenCurlyDoubleQuote]Going beyond Bell\[CloseCurlyQuote]s theorem,\
\[CloseCurlyDoubleQuote]"}]]]], "http://arxiv.org/abs/0712.0921"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "6b14bf12-a008-4356-94b1-d2bb83d7530f"]}]],ExpressionUUID->
         "95351471-2ddc-447d-9479-a7064b21d98a"],
        " in Bell\[CloseCurlyQuote]s Theorem, Quantum Theory, and Conceptions \
of the Universe, edited by Kafatos, M. (Kluwer Academic, Dordrecht, The \
Netherlands, 1989)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aca9bd33-36b1-4873-9af7-a58e67bfb358"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Bouwmeester, J.-W. Pan, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Phys. Rev. Lett. 82 (7), 1345 (1999)"}]]]], 
             "https://doi.org/10.1103/PhysRevLett.82.1345"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "ef898dc8-5e98-45c5-b76a-ae0658b2a580"]}]],ExpressionUUID->
         "59ff12cc-ca70-4f64-8bd6-b7dd165874e6"],
        ", \[OpenCurlyDoubleQuote]Observation of Three-Photon Greenberger- \
Horne-Zeilinger Entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aa4c1e7d-4bdc-4382-bc6c-aa7b8343b83d"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J.-W. Pan, D. Bouwmeester, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Nature 403, 515 (2000)"}]]]], "https://doi.org/10.1038/35000514"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c2199e10-9640-4445-a62c-7572faa3dce3"]}]],ExpressionUUID->
         "eb688c74-f267-43ac-a63e-0d6df7715091"],
        ", \[OpenCurlyDoubleQuote]Experimental test of quantum nonlocality in \
three-photon Greenberger-Horne-Zeilinger entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "a821e7eb-6571-4a82-8b5d-fd47d4a054b1"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "9cdd5d86-8fa2-4cb7-8803-e7e040e9af09"]}]],ExpressionUUID->
         "534c3072-427b-469b-a469-67cbf3a8909c"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "bea60db6-5aa3-4b2f-a998-954dfc342bfa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "eb28e3ee-ba36-453b-bf16-e6d7d0088022"]}]],ExpressionUUID->
         "b5d1edf5-9dd3-4128-998a-559508ab2eb4"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "dd6b64d8-b32e-4457-a692-5aae5ec7c290"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"a4c668cb-94f2-4180-889f-\
f797a26a476b"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"18885233-07c3-459f-8def-7ea58a88e6a2"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Two-Qubit Gates",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2024, 2, 4, 16, 13, 0.601435}", 
    "history" -> {"12", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tech Note", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 2.2 of the Quantum Workbook (2022). This document \
introduces quantum logic gate operations acting on two qubits. Such \
operations are represented by 4*4 unitary matrices. We will see that any \
two-qubit gate operations can be decomposed into controlled-unitary gates. A \
controlled-unitary gate acts a unitary operator on one qubit depending on the \
logical state of the other qubit. A controlled-unitary gate on two qubits can \
be further decomposed into factors including only the CNOT gate and \
single-qubit rotation gates. In this sense, the CNOT gate alone is sufficient \
for any two-qubit gate. The controlled-unitary and CNOT gates have various \
interesting properties that make them useful in implementing quantum \
algorithms. In this document, we first examine the basic properties of the \
CNOT gate, and in particular, how it is used to generate an entanglement \
between two qubits. Then, we discuss the properties of the controlled-unitary \
gate and describe how to implement a controlled-unitary gate in terms of the \
CNOT gate and single-qubit rotations. Finally, we discuss how an arbitrary \
two-qubit unitary operation can be decomposed into controlled-unitary gates.",
     "synonyms" -> {}, "tabletags" -> {}, "title" -> "Two-Qubit Gates", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "Two-Qubit Gates", "type" -> "Tech Note", "uri" -> 
    "Q3/tutorial/TwoQubitGates"}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.0 for Mac OS X ARM (64-bit) (December 12, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"356169fe-9cdb-4fb8-bdd0-d75d43f8af48"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Section11"->{
  Cell[15413, 385, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
   CellTags->"Section11",
   CellID->1585062394]},
 "RasterizedOutput"->{
  Cell[18613, 498, 4768, 84, 120, "Output",ExpressionUUID->"9ba3f8ba-f407-4eb1-9f0f-8cdb090acd32",
   CellTags->"RasterizedOutput",
   CellID->201904416],
  Cell[111361, 3128, 4719, 83, 120, "Output",ExpressionUUID->"4695f294-01c5-48e3-bb3f-e66372907c6b",
   CellTags->"RasterizedOutput",
   CellID->383357452],
  Cell[206164, 5888, 5732, 100, 41, "Output",ExpressionUUID->"53c077d6-f163-473c-846a-4c626db67c9f",
   CellTags->"RasterizedOutput",
   CellID->637754764],
  Cell[212265, 6002, 19616, 328, 81, "Output",ExpressionUUID->"ae1a8d8a-ed6e-4fb2-9498-001de2b68f0b",
   CellTags->"RasterizedOutput",
   CellID->653436371]},
 "Section12"->{
  Cell[88618, 2455, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
   CellTags->"Section12",
   CellID->29167796]},
 "Section13"->{
  Cell[108397, 3034, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
   CellTags->"Section13",
   CellID->1218939314]},
 "Section14"->{
  Cell[138988, 3883, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
   CellTags->"Section14",
   CellID->1455445268]},
 "Section15"->{
  Cell[139588, 3902, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
   CellTags->"Section15",
   CellID->1829879946]},
 "Section16"->{
  Cell[163555, 4632, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
   CellTags->"Section16",
   CellID->715838931]},
 "Section17"->{
  Cell[177289, 5047, 150, 2, 70, "Subsection",ExpressionUUID->"453a152c-b3e2-48d6-be74-e6f1581ade56",
   CellTags->"Section17",
   CellID->616090041],
  Cell[305170, 8157, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
   CellTags->"Section17",
   CellID->1379525988]},
 "Section18"->{
  Cell[343435, 9139, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
   CellTags->"Section18",
   CellID->1847739219]},
 "Section19"->{
  Cell[364735, 9755, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
   CellTags->"Section19",
   CellID->1476129218]},
 "Section20"->{
  Cell[365905, 9787, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
   CellTags->"Section20",
   CellID->749947798]},
 "Section22"->{
  Cell[416892, 11153, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
   CellTags->"Section22",
   CellID->1363502801]},
 "Section23"->{
  Cell[450063, 12083, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
   CellTags->"Section23",
   CellID->153308382]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Section11", 500801, 13373},
 {"RasterizedOutput", 500980, 13377},
 {"Section12", 501624, 13390},
 {"Section13", 501795, 13394},
 {"Section14", 501969, 13398},
 {"Section15", 502143, 13402},
 {"Section16", 502312, 13406},
 {"Section17", 502480, 13410},
 {"Section18", 502800, 13417},
 {"Section19", 502969, 13421},
 {"Section20", 503143, 13425},
 {"Section22", 503311, 13429},
 {"Section23", 503481, 13433}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 3430, 81, 57, "AnchorBarGrid",ExpressionUUID->"1260b555-49e0-471c-bc9e-6d0342dfd11b",
 CellID->1],
Cell[CellGroupData[{
Cell[4042, 106, 116, 1, 68, "TechNoteTitle",ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0",
 CellID->1379112571],
Cell[4161, 109, 5481, 119, 115, "TechNoteJumpBox",ExpressionUUID->"6be900c6-91d5-4904-b8d2-ce44e8029b45"],
Cell[9645, 230, 408, 13, 38, "TechNoteText",ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383",
 CellID->1308734266],
Cell[10056, 245, 1099, 23, 132, "TechNoteText",ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c",
 CellID->1465929903],
Cell[11158, 270, 1318, 31, 132, "TechNoteText",ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74",
 CellID->1951481337],
Cell[12479, 303, 1730, 45, 181, "DefinitionBox",ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5",
 CellID->407539380],
Cell[14212, 350, 135, 1, 31, "TechNoteCaption",ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f",
 CellID->1189009377],
Cell[14350, 353, 288, 7, 36, "TechNoteMathCaption",ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11",
 CellID->1428640008],
Cell[14641, 362, 147, 3, 29, "Input",ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6",
 CellID->853967906],
Cell[14791, 367, 323, 6, 57, "TechNoteMathCaption",ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6",
 CellID->1937193009],
Cell[15117, 375, 271, 6, 70, "Input",ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736",
 CellID->403330096],
Cell[CellGroupData[{
Cell[15413, 385, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
 CellTags->"Section11",
 CellID->1585062394],
Cell[15569, 389, 494, 13, 70, "TechNoteText",ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443",
 CellID->609014923],
Cell[16066, 404, 554, 19, 70, "TechNoteText",ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41",
 CellID->806749259],
Cell[16623, 425, 537, 17, 70, "TechNoteText",ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f",
 CellID->1970532502],
Cell[CellGroupData[{
Cell[17185, 446, 265, 7, 70, "Input",ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf",
 CellID->246957080],
Cell[17453, 455, 622, 22, 37, "Output",ExpressionUUID->"78d241be-9db2-4032-8a34-d6212e8acae2",
 CellID->558783466]
}, Open  ]],
Cell[CellGroupData[{
Cell[18112, 482, 498, 14, 70, "Input",ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b",
 CellID->149239284],
Cell[18613, 498, 4768, 84, 120, "Output",ExpressionUUID->"9ba3f8ba-f407-4eb1-9f0f-8cdb090acd32",
 CellTags->"RasterizedOutput",
 CellID->201904416]
}, Open  ]],
Cell[23396, 585, 170, 3, 70, "TechNoteText",ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae",
 CellID->690265281],
Cell[CellGroupData[{
Cell[23591, 592, 272, 6, 70, "Input",ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02",
 CellID->581916673],
Cell[23866, 600, 806, 23, 100, "Output",ExpressionUUID->"3c1eea45-5fae-4dd3-bb12-726c0bfdef46",
 CellID->1605179591]
}, Open  ]],
Cell[24687, 626, 192, 4, 70, "TechNoteText",ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844",
 CellID->107481873],
Cell[CellGroupData[{
Cell[24904, 634, 163, 3, 70, "Input",ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9",
 CellID->414092384],
Cell[25070, 639, 1451, 43, 55, "Output",ExpressionUUID->"63aff9c0-f715-42e5-b050-eab99f429e37",
 CellID->1908217771]
}, Open  ]],
Cell[CellGroupData[{
Cell[26558, 687, 195, 4, 70, "Input",ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665",
 CellID->597624604],
Cell[26756, 693, 706, 21, 52, "Output",ExpressionUUID->"af082845-f690-419e-bb3f-d91916a4f93f",
 CellID->507831260]
}, Open  ]],
Cell[27477, 717, 184, 3, 70, "TechNoteText",ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13",
 CellID->1181321350],
Cell[CellGroupData[{
Cell[27686, 724, 192, 4, 70, "Input",ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361",
 CellID->981612935],
Cell[27881, 730, 896, 22, 95, "Output",ExpressionUUID->"d6bfec8b-8117-45e2-9e1b-a0b5f5a2b864",
 CellID->1480642977]
}, Open  ]],
Cell[28792, 755, 283, 5, 70, "TechNoteText",ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39",
 CellID->606925297],
Cell[29078, 762, 722, 15, 70, "TechNoteText",ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420",
 CellID->46143429],
Cell[CellGroupData[{
Cell[29825, 781, 648, 20, 70, "Input",ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73",
 CellID->291014636],
Cell[30476, 803, 3658, 116, 41, "Output",ExpressionUUID->"0c57e250-12c6-43df-b616-5e8e722bc0ed",
 CellID->538831450]
}, Open  ]],
Cell[34149, 922, 605, 14, 70, "TechNoteText",ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939",
 CellID->1152615977],
Cell[CellGroupData[{
Cell[34779, 940, 273, 7, 70, "Input",ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e",
 CellID->1714229499],
Cell[35055, 949, 1372, 32, 95, "Output",ExpressionUUID->"2c912e97-90cc-4489-affc-13cdd8cff7f3",
 CellID->741907886]
}, Open  ]],
Cell[CellGroupData[{
Cell[36464, 986, 499, 14, 70, "Input",ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160",
 CellID->1435008719],
Cell[36966, 1002, 9463, 268, 176, "Output",ExpressionUUID->"d90ed253-1a80-45c5-971a-af8d8bf6c275",
 CellID->1370067106]
}, Open  ]],
Cell[46444, 1273, 963, 21, 70, "TechNoteText",ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1",
 CellID->1854176847],
Cell[CellGroupData[{
Cell[47432, 1298, 944, 28, 70, "Input",ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075",
 CellID->1015065912],
Cell[48379, 1328, 1710, 38, 275, "Output",ExpressionUUID->"83c8af77-3069-47c5-b836-a9d6e31090cb",
 CellID->53398403]
}, Open  ]],
Cell[50104, 1369, 143, 1, 70, "TechNoteText",ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608",
 CellID->1898388060],
Cell[50250, 1372, 523, 19, 70, "TechNoteText",ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775",
 CellID->1043580941],
Cell[50776, 1393, 1369, 43, 70, "TechNoteText",ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de",
 CellID->965930338],
Cell[52148, 1438, 654, 20, 70, "TechNoteText",ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98",
 CellID->1562303093],
Cell[52805, 1460, 1170, 35, 70, "TechNoteText",ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08",
 CellID->345532182],
Cell[53978, 1497, 475, 17, 70, "TechNoteText",ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547",
 CellID->563601386],
Cell[54456, 1516, 1089, 31, 70, "TechNoteText",ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841",
 CellID->2045611232],
Cell[55548, 1549, 1119, 39, 70, "TechNoteText",ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe",
 CellID->1522271401],
Cell[56670, 1590, 1181, 38, 70, "TechNoteText",ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec",
 CellID->1842749896],
Cell[CellGroupData[{
Cell[57876, 1632, 273, 7, 70, "Input",ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d",
 CellID->88345038],
Cell[58152, 1641, 3143, 70, 275, "Output",ExpressionUUID->"c7409dab-5259-4dd5-bc5f-71a5186ce849",
 CellID->1392711197]
}, Open  ]],
Cell[CellGroupData[{
Cell[61332, 1716, 418, 12, 70, "Input",ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3",
 CellID->1915435092],
Cell[61753, 1730, 3947, 99, 62, "Output",ExpressionUUID->"dff32074-78d9-4fff-810a-f58b8be0335f",
 CellID->2015811498]
}, Open  ]],
Cell[65715, 1832, 305, 5, 70, "TechNoteText",ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195",
 CellID->716147443],
Cell[66023, 1839, 1249, 45, 70, "TechNoteText",ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182",
 CellID->1791716713],
Cell[67275, 1886, 174, 3, 70, "TechNoteText",ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b",
 CellID->1367097157],
Cell[67452, 1891, 321, 5, 70, "TechNoteText",ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615",
 CellID->874378446],
Cell[CellGroupData[{
Cell[67798, 1900, 777, 23, 70, "Input",ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946",
 CellID->447945501],
Cell[68578, 1925, 1622, 36, 167, "Output",ExpressionUUID->"d1cf96f5-c45f-432b-b69e-faea76873e4f",
 CellID->2003916806]
}, Open  ]],
Cell[70215, 1964, 115, 1, 70, "TechNoteText",ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328",
 CellID->880946029],
Cell[CellGroupData[{
Cell[70355, 1969, 735, 22, 70, "Input",ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5",
 CellID->1307646985],
Cell[71093, 1993, 1622, 36, 167, "Output",ExpressionUUID->"7383e199-5344-4218-a14b-f4f2a9ded1c5",
 CellID->1957181437]
}, Open  ]],
Cell[72730, 2032, 235, 4, 70, "TechNoteText",ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43",
 CellID->169608441],
Cell[72968, 2038, 667, 21, 70, "TechNoteText",ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec",
 CellID->898268318],
Cell[73638, 2061, 381, 10, 70, "TechNoteText",ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb",
 CellID->385582216],
Cell[74022, 2073, 2511, 59, 70, "TechNoteText",ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc",
 CellID->1620101282],
Cell[76536, 2134, 131, 1, 70, "TechNoteText",ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167",
 CellID->712578174],
Cell[76670, 2137, 787, 27, 70, "TechNoteText",ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621",
 CellID->1522141313],
Cell[77460, 2166, 414, 7, 70, "TechNoteText",ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929",
 CellID->1803844527],
Cell[77877, 2175, 382, 8, 70, "TechNoteText",ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed",
 CellID->1188320590],
Cell[78262, 2185, 334, 6, 70, "TechNoteText",ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e",
 CellID->506239030],
Cell[78599, 2193, 3608, 92, 70, "TechNoteText",ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3",
 CellID->1226753413],
Cell[82210, 2287, 402, 6, 70, "TechNoteText",ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00",
 CellID->365203462],
Cell[82615, 2295, 5378, 142, 70, "TechNoteText",ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38",
 CellID->977674470],
Cell[87996, 2439, 585, 11, 70, "TechNoteText",ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840",
 CellID->833871357]
}, Open  ]],
Cell[CellGroupData[{
Cell[88618, 2455, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
 CellTags->"Section12",
 CellID->29167796],
Cell[88768, 2459, 147, 3, 70, "Input",ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603",
 CellID->754200946],
Cell[88918, 2464, 272, 6, 70, "Input",ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b",
 CellID->1406814828],
Cell[89193, 2472, 270, 5, 70, "TechNoteText",ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06",
 CellID->596875856],
Cell[89466, 2479, 628, 22, 70, "TechNoteText",ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45",
 CellID->796396655],
Cell[90097, 2503, 344, 11, 70, "TechNoteText",ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478",
 CellID->1920492481],
Cell[CellGroupData[{
Cell[90466, 2518, 264, 7, 70, "Input",ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1",
 CellID->1037913757],
Cell[90733, 2527, 558, 20, 37, "Output",ExpressionUUID->"53359433-e49f-4fb1-a850-866a0cf3056c",
 CellID->1753856987]
}, Open  ]],
Cell[CellGroupData[{
Cell[91328, 2552, 499, 14, 70, "Input",ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc",
 CellID->1887946780],
Cell[91830, 2568, 6015, 169, 120, "Output",ExpressionUUID->"ecabfdf9-6435-40f6-990b-e41a26edda92",
 CellID->502609038]
}, Open  ]],
Cell[97860, 2740, 181, 3, 70, "TechNoteText",ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb",
 CellID->1230965299],
Cell[CellGroupData[{
Cell[98066, 2747, 194, 4, 70, "Input",ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55",
 CellID->2123808742],
Cell[98263, 2753, 791, 24, 100, "Output",ExpressionUUID->"8c570763-590f-43df-8ed8-46ae035ccbca",
 CellID->116817163]
}, Open  ]],
Cell[99069, 2780, 315, 5, 70, "TechNoteText",ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c",
 CellID->776960470],
Cell[CellGroupData[{
Cell[99409, 2789, 169, 3, 70, "Input",ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01",
 CellID->1674045530],
Cell[99581, 2794, 728, 20, 95, "Output",ExpressionUUID->"601547be-a31d-4f29-a2a8-41d43abf1a22",
 CellID->1496734992]
}, Open  ]],
Cell[100324, 2817, 252, 4, 70, "TechNoteText",ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f",
 CellID->573709808],
Cell[100579, 2823, 505, 11, 70, "TechNoteText",ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c",
 CellID->139168026],
Cell[CellGroupData[{
Cell[101109, 2838, 1148, 35, 70, "Input",ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec",
 CellID->387321399],
Cell[102260, 2875, 896, 22, 95, "Output",ExpressionUUID->"997911e8-ec49-48d9-a4fe-d992bd8fff2f",
 CellID->2072971140],
Cell[103159, 2899, 1638, 41, 95, "Output",ExpressionUUID->"a9d1bb79-fdff-4ca1-9cc5-6805dd789c63",
 CellID->1798744699],
Cell[104800, 2942, 2760, 65, 95, "Output",ExpressionUUID->"a4b2f715-a1df-4fd4-952b-f512913f7608",
 CellID->1374857274]
}, Open  ]],
Cell[CellGroupData[{
Cell[107597, 3012, 201, 4, 70, "Input",ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612",
 CellID->1606586072],
Cell[107801, 3018, 132, 2, 37, "Output",ExpressionUUID->"e6040c8f-b482-4697-9bcc-16329ec94cc2",
 CellID->1513988403]
}, Open  ]],
Cell[107948, 3023, 412, 6, 70, "TechNoteText",ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710",
 CellID->799932562]
}, Open  ]],
Cell[CellGroupData[{
Cell[108397, 3034, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
 CellTags->"Section13",
 CellID->1218939314],
Cell[108536, 3038, 148, 3, 70, "Input",ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7",
 CellID->1843914595],
Cell[108687, 3043, 271, 6, 70, "Input",ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5",
 CellID->336088308],
Cell[108961, 3051, 550, 13, 70, "TechNoteText",ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a",
 CellID->1866541665],
Cell[109514, 3066, 625, 22, 70, "TechNoteText",ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e",
 CellID->524648279],
Cell[110142, 3090, 505, 12, 70, "TechNoteText",ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269",
 CellID->195770571],
Cell[CellGroupData[{
Cell[110672, 3106, 686, 20, 70, "Input",ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70",
 CellID->371039593],
Cell[111361, 3128, 4719, 83, 120, "Output",ExpressionUUID->"4695f294-01c5-48e3-bb3f-e66372907c6b",
 CellTags->"RasterizedOutput",
 CellID->383357452]
}, Open  ]],
Cell[116095, 3214, 642, 21, 70, "TechNoteText",ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305",
 CellID->809087288],
Cell[CellGroupData[{
Cell[116762, 3239, 193, 4, 70, "Input",ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae",
 CellID->463596612],
Cell[116958, 3245, 806, 23, 100, "Output",ExpressionUUID->"b5d9f181-9d16-49f9-a417-52f31ec98a43",
 CellID->1534563869]
}, Open  ]],
Cell[117779, 3271, 143, 1, 70, "TechNoteText",ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580",
 CellID->2003915004],
Cell[CellGroupData[{
Cell[117947, 3276, 192, 4, 70, "Input",ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc",
 CellID->813436327],
Cell[118142, 3282, 846, 23, 95, "Output",ExpressionUUID->"269b3fbd-ce4b-4318-88ce-b2f55f4df93b",
 CellID->1585757247]
}, Open  ]],
Cell[119003, 3308, 371, 8, 70, "TechNoteText",ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c",
 CellID->534468518],
Cell[CellGroupData[{
Cell[119399, 3320, 311, 9, 70, "Input",ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d",
 CellID->2035770272],
Cell[119713, 3331, 806, 23, 100, "Output",ExpressionUUID->"88bfe24e-79d3-4a15-9faa-c509d8eff640",
 CellID->1329507574]
}, Open  ]],
Cell[120534, 3357, 735, 15, 70, "TechNoteText",ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d",
 CellID->1603079182],
Cell[CellGroupData[{
Cell[121294, 3376, 811, 23, 70, "Input",ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454",
 CellID->621976612],
Cell[122108, 3401, 845, 23, 95, "Output",ExpressionUUID->"f04996b7-7fa3-487d-adfa-6df03bf564dd",
 CellID->893629415],
Cell[122956, 3426, 1582, 36, 95, "Output",ExpressionUUID->"76949d3e-1e63-43c5-a7d1-0bfbb951855d",
 CellID->1876434434]
}, Open  ]],
Cell[CellGroupData[{
Cell[124575, 3467, 188, 4, 70, "Input",ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22",
 CellID->661500490],
Cell[124766, 3473, 132, 2, 37, "Output",ExpressionUUID->"b7b6f970-3ca9-4d82-a824-f7f59ad28e17",
 CellID->1261104137]
}, Open  ]],
Cell[124913, 3478, 1201, 29, 70, "TechNoteText",ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7",
 CellID->666193793],
Cell[126117, 3509, 467, 13, 70, "TechNoteText",ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[126609, 3526, 525, 14, 70, "Input",ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150",
 CellID->1040933486],
Cell[127137, 3542, 1033, 31, 116, "Output",ExpressionUUID->"b8f59ed8-8ac8-4e5a-b1d4-7753293f5148",
 CellID->1395397422]
}, Open  ]],
Cell[128185, 3576, 327, 8, 70, "TechNoteText",ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9",
 CellID->771058470],
Cell[CellGroupData[{
Cell[128537, 3588, 472, 13, 70, "Input",ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2",
 CellID->1895203240],
Cell[129012, 3603, 3197, 89, 52, "Output",ExpressionUUID->"520e3acc-959c-4a46-88ce-d2847f31da11",
 CellID->1581691677]
}, Open  ]],
Cell[132224, 3695, 849, 23, 70, "TechNoteText",ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587",
 CellID->27233292],
Cell[CellGroupData[{
Cell[133098, 3722, 511, 14, 70, "Input",ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3",
 CellID->1505230369],
Cell[133612, 3738, 4037, 98, 95, "Output",ExpressionUUID->"36b47d79-d6f7-498e-bac1-71f1d2bd143c",
 CellID->1763841847]
}, Open  ]],
Cell[137664, 3839, 225, 4, 70, "TechNoteText",ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3",
 CellID->535686806],
Cell[CellGroupData[{
Cell[137914, 3847, 193, 4, 70, "Input",ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901",
 CellID->851721286],
Cell[138110, 3853, 829, 24, 100, "Output",ExpressionUUID->"cc2706ad-0cc3-4eb0-b333-07cca9d3b629",
 CellID->1477577916]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138988, 3883, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
 CellTags->"Section14",
 CellID->1455445268],
Cell[139142, 3887, 147, 3, 70, "Input",ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91",
 CellID->214055128],
Cell[139292, 3892, 271, 6, 70, "Input",ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87",
 CellID->167122186],
Cell[CellGroupData[{
Cell[139588, 3902, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
 CellTags->"Section15",
 CellID->1829879946],
Cell[139723, 3906, 572, 13, 70, "TechNoteText",ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644",
 CellID->678943735],
Cell[140298, 3921, 634, 23, 70, "TechNoteText",ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8",
 CellID->1426737634],
Cell[140935, 3946, 115, 1, 70, "TechNoteText",ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9",
 CellID->377012236],
Cell[141053, 3949, 584, 22, 70, "TechNoteText",ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165",
 CellID->1367891802],
Cell[141640, 3973, 400, 8, 70, "TechNoteText",ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b",
 CellID->1345075079],
Cell[142043, 3983, 212, 4, 70, "TechNoteText",ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e",
 CellID->819163313],
Cell[142258, 3989, 569, 19, 70, "TechNoteText",ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4",
 CellID->116500784],
Cell[142830, 4010, 446, 13, 70, "TechNoteText",ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48",
 CellID->1671074271],
Cell[143279, 4025, 174, 3, 70, "TechNoteText",ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd",
 CellID->1953344721],
Cell[143456, 4030, 811, 20, 70, "Picture",ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329",
 CellID->954137231],
Cell[144270, 4052, 287, 5, 70, "TechNoteText",ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1",
 CellID->924049268],
Cell[144560, 4059, 282, 5, 70, "TechNoteMathCaption",ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d",
 CellID->2041795819],
Cell[CellGroupData[{
Cell[144867, 4068, 606, 17, 70, "Input",ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668",
 CellID->1821134520],
Cell[145476, 4087, 1154, 33, 86, "Output",ExpressionUUID->"2b4a8d8f-f26b-499a-92c2-eec5fd5ccb15",
 CellID->211732316]
}, Open  ]],
Cell[146645, 4123, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e",
 CellID->1443037598],
Cell[CellGroupData[{
Cell[146849, 4130, 290, 7, 70, "Input",ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767",
 CellID->1600084015],
Cell[147142, 4139, 1190, 30, 95, "Output",ExpressionUUID->"9cc122b1-4eed-49b4-866b-b6d9f9ec20f6",
 CellID->532818073]
}, Open  ]],
Cell[148347, 4172, 206, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171",
 CellID->378680471],
Cell[CellGroupData[{
Cell[148578, 4180, 164, 3, 70, "Input",ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f",
 CellID->1488630036],
Cell[148745, 4185, 1807, 53, 52, "Output",ExpressionUUID->"d5601312-1382-4457-9cf0-4847295fc56e",
 CellID->2048032932]
}, Open  ]],
Cell[150567, 4241, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4",
 CellID->641929970],
Cell[CellGroupData[{
Cell[150769, 4248, 499, 14, 70, "Input",ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170",
 CellID->2106646909],
Cell[151271, 4264, 7934, 222, 130, "Output",ExpressionUUID->"841e8f18-a29d-4716-b15b-80e103d5cf74",
 CellID->364541601]
}, Open  ]],
Cell[159220, 4489, 217, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b",
 CellID->1736236263],
Cell[CellGroupData[{
Cell[159462, 4497, 490, 15, 70, "Input",ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff",
 CellID->915076805],
Cell[159955, 4514, 1283, 39, 41, "Output",ExpressionUUID->"cb204ba4-14b7-4737-a76c-5f118cf464f5",
 CellID->307055411]
}, Open  ]],
Cell[CellGroupData[{
Cell[161275, 4558, 178, 4, 70, "Input",ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8",
 CellID->1955961279],
Cell[161456, 4564, 2050, 62, 52, "Output",ExpressionUUID->"c14caf31-7486-4d6f-be9a-b47bb7903023",
 CellID->640059207]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163555, 4632, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
 CellTags->"Section16",
 CellID->715838931],
Cell[163696, 4636, 709, 12, 70, "TechNoteText",ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b",
 CellID->901522823],
Cell[164408, 4650, 1046, 32, 70, "TechNoteText",ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8",
 CellID->1396956576],
Cell[165457, 4684, 1485, 54, 70, "TechNoteText",ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d",
 CellID->210460181],
Cell[166945, 4740, 420, 8, 70, "TechNoteText",ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4",
 CellID->298695458],
Cell[167368, 4750, 528, 13, 70, "TechNoteMathCaption",ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8",
 CellID->1505279567],
Cell[CellGroupData[{
Cell[167921, 4767, 362, 9, 70, "Input",ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c",
 CellID->1876320909],
Cell[168286, 4778, 683, 23, 39, "Output",ExpressionUUID->"3c1c2461-d4fa-462c-8f14-ea355fefab7e",
 CellID->1060027485],
Cell[168972, 4803, 800, 23, 68, "Output",ExpressionUUID->"7ac68bb0-1c5e-4c6f-b362-1ceabeed184b",
 CellID->357604883]
}, Open  ]],
Cell[169787, 4829, 167, 2, 70, "TechNoteMathCaption",ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738",
 CellID->774865820],
Cell[CellGroupData[{
Cell[169979, 4835, 341, 9, 70, "Input",ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64",
 CellID->2117896949],
Cell[170323, 4846, 1224, 32, 95, "Output",ExpressionUUID->"59a080e0-3632-4310-bfa7-ba90caf547b9",
 CellID->1570931992]
}, Open  ]],
Cell[171562, 4881, 323, 5, 70, "TechNoteMathCaption",ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50",
 CellID->193224567],
Cell[CellGroupData[{
Cell[171910, 4890, 539, 15, 70, "Input",ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1",
 CellID->1062235589],
Cell[172452, 4907, 2444, 62, 93, "Output",ExpressionUUID->"058f5233-9541-4dee-a008-ee54fbe48960",
 CellID->969090302]
}, Open  ]],
Cell[174911, 4972, 278, 5, 70, "TechNoteMathCaption",ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0",
 CellID->581406343],
Cell[CellGroupData[{
Cell[175214, 4981, 271, 6, 70, "Input",ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c",
 CellID->1127477995],
Cell[175488, 4989, 1752, 52, 62, "Output",ExpressionUUID->"01f1a9b7-7e19-4193-948e-f05c65e40412",
 CellID->307558716]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177289, 5047, 150, 2, 70, "Subsection",ExpressionUUID->"453a152c-b3e2-48d6-be74-e6f1581ade56",
 CellTags->"Section17",
 CellID->616090041],
Cell[177442, 5051, 273, 5, 70, "TechNoteText",ExpressionUUID->"7a616ccc-9433-4998-8369-2df7d2da84f1",
 CellID->1275497408],
Cell[177718, 5058, 7318, 182, 70, "Picture",ExpressionUUID->"1475fba9-177e-40e7-8eb1-94b50eeac311",
 CellID->2084184000],
Cell[185039, 5242, 342, 9, 70, "TechNoteCaption",ExpressionUUID->"b9896500-fb22-49b7-ac82-574240863cb5",
 CellID->1283463500],
Cell[185384, 5253, 668, 16, 70, "TechNoteText",ExpressionUUID->"57a86a30-7e8e-4f75-b2d0-62c14934bee7",
 CellID->1036421782],
Cell[186055, 5271, 864, 29, 70, "TechNoteText",ExpressionUUID->"bd33c5dd-996b-431e-877e-f6876cc9e766",
 CellID->1390517433],
Cell[186922, 5302, 1382, 36, 70, "TechNoteText",ExpressionUUID->"20c21316-a861-4c55-9a22-3017d7cf3e7a",
 CellID->357932788],
Cell[188307, 5340, 1870, 62, 70, "TechNoteText",ExpressionUUID->"c79df340-6df1-4264-a420-75bf8342298a",
 CellID->232871499],
Cell[190180, 5404, 338, 7, 70, "TechNoteText",ExpressionUUID->"83f238dc-7afc-4872-a985-c7f796b7cff2",
 CellID->531662691],
Cell[190521, 5413, 460, 14, 70, "TechNoteText",ExpressionUUID->"0bc08e04-978f-49bb-a8cf-34eb1ce33c50",
 CellID->1514408200],
Cell[190984, 5429, 799, 27, 70, "TechNoteText",ExpressionUUID->"1b15c47e-535b-4669-a118-3ded02f47ec2",
 CellID->2034215257],
Cell[191786, 5458, 224, 4, 70, "TechNoteText",ExpressionUUID->"27f3aa74-7067-43e3-bf6e-6bcaf17ad5a4",
 CellID->1368761109],
Cell[192013, 5464, 5599, 145, 70, "Picture",ExpressionUUID->"2c1f89bf-12ac-494a-80c0-70f147dc605b",
 CellID->757238962],
Cell[197615, 5611, 369, 10, 70, "TechNoteCaption",ExpressionUUID->"ee8dd00a-30e4-4b38-abb1-9e025434b3de",
 CellID->927142212],
Cell[CellGroupData[{
Cell[198009, 5625, 357, 7, 70, "TechNoteText",ExpressionUUID->"e6222d2e-fdec-4a7f-9a0a-cac47d0ffb1b",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->305516076],
Cell[198369, 5634, 193, 4, 70, "Input",ExpressionUUID->"70a85bb5-d5d2-4ca2-bff2-638e2e8405be",
 CellID->1535052485],
Cell[198565, 5640, 285, 7, 70, "TechNoteMathCaption",ExpressionUUID->"46ce6238-8cd3-488a-959f-b47a70f46c9f",
 CellID->1475887768],
Cell[CellGroupData[{
Cell[198875, 5651, 377, 10, 70, "Input",ExpressionUUID->"f8be5084-1a72-4198-85c6-55a53be164b3",
 CellID->1092408791],
Cell[199255, 5663, 597, 19, 37, "Output",ExpressionUUID->"b741726f-e964-4106-aa8e-c879ab1145ba",
 CellID->1550207546]
}, Open  ]],
Cell[199867, 5685, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"2c4b63aa-9188-47ac-bc7f-2e580e3232cc",
 CellID->1519843333],
Cell[CellGroupData[{
Cell[200071, 5692, 330, 8, 70, "Input",ExpressionUUID->"73970fb6-d378-4c24-83f7-d7a3de8a5011",
 CellID->21384525],
Cell[200404, 5702, 653, 23, 38, "Output",ExpressionUUID->"a6df30b2-6dec-4389-8688-e9e08534db85",
 CellID->374528822]
}, Open  ]],
Cell[201072, 5728, 202, 5, 70, "TechNoteMathCaption",ExpressionUUID->"64f01fe2-3329-4e1d-a62c-1d659773250c",
 CellID->978050365],
Cell[CellGroupData[{
Cell[201299, 5737, 220, 5, 70, "Input",ExpressionUUID->"8a1fc341-884a-4ec1-aa43-b40f461924af",
 CellID->2127797723],
Cell[201522, 5744, 1262, 42, 40, "Output",ExpressionUUID->"457c55c3-d7a0-4d27-bdd5-82ad3366f3a9",
 CellID->434407040]
}, Open  ]],
Cell[202799, 5789, 203, 4, 70, "TechNoteMathCaption",ExpressionUUID->"6bf995ee-9020-414a-b0f1-ed570fc55b14",
 CellID->1664622810],
Cell[CellGroupData[{
Cell[203027, 5797, 707, 18, 70, "Input",ExpressionUUID->"d5c62256-61e0-4309-8387-d64cb3287486",
 CellID->2027335310],
Cell[203737, 5817, 2053, 57, 187, "Output",ExpressionUUID->"ff27ac41-8a45-4bd5-808c-8c912b8f6aa7",
 CellID->2023190340]
}, Open  ]],
Cell[205805, 5877, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"a3f46d63-fbc3-4f35-9a29-27ae41f9605b",
 CellID->1320057003],
Cell[CellGroupData[{
Cell[205979, 5882, 182, 4, 70, "Input",ExpressionUUID->"0684e151-c73f-4f8d-af8b-3f085687db78",
 CellID->856233533],
Cell[206164, 5888, 5732, 100, 41, "Output",ExpressionUUID->"53c077d6-f163-473c-846a-4c626db67c9f",
 CellTags->"RasterizedOutput",
 CellID->637754764]
}, Open  ]],
Cell[211911, 5991, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0bfda6ba-1614-40db-bb2c-d9b4938763a3",
 CellID->1095734201],
Cell[CellGroupData[{
Cell[212085, 5996, 177, 4, 70, "Input",ExpressionUUID->"4a7cc5e4-765d-497e-a5bc-a41ff5e948ed",
 CellID->1234389837],
Cell[212265, 6002, 19616, 328, 81, "Output",ExpressionUUID->"ae1a8d8a-ed6e-4fb2-9498-001de2b68f0b",
 CellTags->"RasterizedOutput",
 CellID->653436371]
}, Open  ]],
Cell[CellGroupData[{
Cell[231918, 6335, 259, 7, 70, "Input",ExpressionUUID->"8f110ddf-5d41-47ec-bfb6-507f5470bc27",
 CellID->273770455],
Cell[232180, 6344, 31203, 716, 208, "Output",ExpressionUUID->"bd236272-ffcd-44b5-bdab-b298978ebdd0",
 CellID->1175648410]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[263432, 7066, 358, 7, 70, "TechNoteText",ExpressionUUID->"a584828a-5f63-46d6-acca-17da31bc510a",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1362282140],
Cell[263793, 7075, 202, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5ace6b38-a9e2-4b77-80eb-3e959b2980e5",
 CellID->523520144],
Cell[CellGroupData[{
Cell[264020, 7083, 791, 20, 70, "Input",ExpressionUUID->"b04ddcb3-b0e8-4c48-9266-0f030ebb00bc",
 CellID->770533652],
Cell[264814, 7105, 4145, 109, 194, "Output",ExpressionUUID->"17f5be26-ddae-49e9-8f9a-25450700212f",
 CellID->1980199431]
}, Open  ]],
Cell[268974, 7217, 133, 1, 70, "TechNoteMathCaption",ExpressionUUID->"ea3b27aa-d6ea-4867-bf0b-11d5de562f12",
 CellID->363088131],
Cell[CellGroupData[{
Cell[269132, 7222, 189, 4, 70, "Input",ExpressionUUID->"ba343557-1c6b-4226-8f63-2f6d05302796",
 CellID->1079016412],
Cell[269324, 7228, 11414, 280, 105, "Output",ExpressionUUID->"5d7f233c-b5cc-4b89-98b3-7e847cc3119a",
 CellID->682909481]
}, Open  ]],
Cell[280753, 7511, 148, 1, 70, "TechNoteMathCaption",ExpressionUUID->"f1511856-759c-4555-b7cf-9bf84246565c",
 CellID->942690207],
Cell[CellGroupData[{
Cell[280926, 7516, 187, 4, 70, "Input",ExpressionUUID->"b10a87b9-d775-453e-8b72-e0af68d42a5c",
 CellID->473086067],
Cell[281116, 7522, 4688, 120, 62, "Output",ExpressionUUID->"0382186e-c425-47a3-b5f9-0155c5c8997f",
 CellID->2050946078]
}, Open  ]],
Cell[285819, 7645, 186, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a24652a6-33f8-44f8-bb4e-aafa4b4f1be2",
 CellID->1762048567],
Cell[CellGroupData[{
Cell[286030, 7652, 186, 4, 70, "Input",ExpressionUUID->"888467fd-bd2d-4b83-ac6e-fe71ec9bb26f",
 CellID->1674087129],
Cell[286219, 7658, 9898, 248, 105, "Output",ExpressionUUID->"0ede7a93-d7d5-42a6-a34e-e2fbab8256c8",
 CellID->751825541]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[296166, 7912, 358, 7, 70, "TechNoteText",ExpressionUUID->"307b8d33-34ac-49cc-a168-2603dc4e54e1",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1016485255],
Cell[296527, 7921, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"720d3348-ec2a-4bcf-8cab-e9cdbeafcc6f",
 CellID->1235189013],
Cell[CellGroupData[{
Cell[296729, 7928, 347, 9, 70, "Input",ExpressionUUID->"9571ff5f-2c4a-44b3-9a39-ed0954bf2436",
 CellID->1297582908],
Cell[297079, 7939, 1662, 44, 203, "Output",ExpressionUUID->"e847dbb9-7350-41da-b20e-f1b82405f983",
 CellID->1918092582]
}, Open  ]],
Cell[298756, 7986, 223, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b00c955-c9e2-4038-a7cd-9fb34b7ba309",
 CellID->331049159],
Cell[CellGroupData[{
Cell[299004, 7994, 186, 4, 70, "Input",ExpressionUUID->"f28e6c6e-68c8-4519-8c90-aebec921c699",
 CellID->1888208538],
Cell[299193, 8000, 3288, 84, 203, "Output",ExpressionUUID->"1e577cd7-a27e-4ca4-a9c5-233dc17d237c",
 CellID->31973050]
}, Open  ]],
Cell[CellGroupData[{
Cell[302518, 8089, 254, 6, 70, "Input",ExpressionUUID->"fba6c2a0-bc2a-4e9c-91fd-6323afbaf0c7",
 CellID->1871953819],
Cell[302775, 8097, 2334, 53, 304, "Output",ExpressionUUID->"224a35fa-9359-4598-bf41-0e9998181228",
 CellID->1116994629]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[305170, 8157, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
 CellTags->"Section17",
 CellID->1379525988],
Cell[305329, 8161, 849, 21, 70, "TechNoteText",ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40",
 CellID->1459827304],
Cell[306181, 8184, 761, 26, 70, "TechNoteText",ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8",
 CellID->316831353],
Cell[306945, 8212, 1528, 37, 70, "TechNoteText",ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee",
 CellID->1372588958],
Cell[308476, 8251, 5917, 116, 70, "Picture",ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a",
 CellID->833281032],
Cell[314396, 8369, 468, 8, 70, "TechNoteCaption",ExpressionUUID->"5c8a6fcd-8f70-4355-bb88-fb33d14ff756",
 CellID->571282978],
Cell[314867, 8379, 195, 4, 70, "TechNoteText",ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9",
 CellID->1213442737],
Cell[CellGroupData[{
Cell[315087, 8387, 357, 7, 70, "TechNoteText",ExpressionUUID->"b8e144c2-025b-4ed9-8be3-8c9d2b5eae31",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->780471724],
Cell[315447, 8396, 259, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2",
 CellID->1827368847],
Cell[CellGroupData[{
Cell[315731, 8404, 1344, 40, 70, "Input",ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11",
 CellID->1424575782],
Cell[317078, 8446, 2601, 58, 167, "Output",ExpressionUUID->"5a9349b8-30c0-4392-b401-4bf00d14059f",
 CellID->1496947974]
}, Open  ]],
Cell[319694, 8507, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787",
 CellID->873169809],
Cell[CellGroupData[{
Cell[319923, 8515, 422, 11, 70, "Input",ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117",
 CellID->1609219912],
Cell[320348, 8528, 23026, 604, 228, "Output",ExpressionUUID->"89c1d5fd-1986-44c0-bb90-b4594fbc36dc",
 CellID->572582296]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[343435, 9139, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
 CellTags->"Section18",
 CellID->1847739219],
Cell[343595, 9143, 645, 10, 70, "TechNoteText",ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081",
 CellID->192034466],
Cell[344243, 9155, 733, 19, 70, "TechNoteText",ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235",
 CellID->2002832268],
Cell[344979, 9176, 567, 17, 70, "TechNoteText",ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9",
 CellID->1943245198],
Cell[345549, 9195, 521, 15, 70, "TechNoteText",ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063",
 CellID->1190739210],
Cell[346073, 9212, 587, 18, 70, "TechNoteText",ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9",
 CellID->353796077],
Cell[346663, 9232, 176, 3, 70, "TechNoteText",ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da",
 CellID->2015931243],
Cell[346842, 9237, 429, 14, 70, "TechNoteText",ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6",
 CellID->906902382],
Cell[347274, 9253, 576, 20, 70, "TechNoteText",ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0",
 CellID->1616891515],
Cell[347853, 9275, 430, 14, 70, "TechNoteText",ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc",
 CellID->837623467],
Cell[348286, 9291, 669, 18, 70, "TechNoteText",ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628",
 CellID->1182303784],
Cell[348958, 9311, 2977, 68, 70, "TechNoteText",ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b",
 CellID->313511997],
Cell[351938, 9381, 1491, 40, 70, "TechNoteText",ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd",
 CellID->1418747488],
Cell[353432, 9423, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4",
 CellID->1378098175],
Cell[CellGroupData[{
Cell[353667, 9431, 464, 13, 70, "Input",ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825",
 CellID->1028095504],
Cell[354134, 9446, 1113, 36, 86, "Output",ExpressionUUID->"7ebad514-2384-40fd-9626-6e0e825a4a06",
 CellID->66651344]
}, Open  ]],
Cell[355262, 9485, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510",
 CellID->1646790355],
Cell[CellGroupData[{
Cell[355455, 9491, 527, 14, 70, "Input",ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49",
 CellID->1153761970],
Cell[355985, 9507, 1315, 32, 95, "Output",ExpressionUUID->"abfb7109-7099-4ec7-bb30-6db0313004da",
 CellID->909200866]
}, Open  ]],
Cell[357315, 9542, 198, 4, 70, "TechNoteMathCaption",ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45",
 CellID->1240176371],
Cell[CellGroupData[{
Cell[357538, 9550, 544, 16, 70, "Input",ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5",
 CellID->167989615],
Cell[358085, 9568, 281, 8, 49, "Output",ExpressionUUID->"ff423f9c-263a-4e7b-95ee-5f9a4b01c82e",
 CellID->982119958]
}, Open  ]],
Cell[358381, 9579, 162, 2, 70, "TechNoteMathCaption",ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d",
 CellID->833485781],
Cell[358546, 9583, 1480, 46, 70, "Input",ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c",
 CellID->359691886],
Cell[360029, 9631, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1",
 CellID->175061697],
Cell[CellGroupData[{
Cell[360218, 9637, 514, 14, 70, "Input",ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea",
 CellID->209345089],
Cell[360735, 9653, 3426, 78, 95, "Output",ExpressionUUID->"19f8331d-ec5e-4f13-8574-50ba82f707c7",
 CellID->1936315278]
}, Open  ]],
Cell[364176, 9734, 124, 1, 70, "TechNoteMathCaption",ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0",
 CellID->2073812678],
Cell[CellGroupData[{
Cell[364325, 9739, 217, 5, 70, "Input",ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65",
 CellID->1395051790],
Cell[364545, 9746, 129, 2, 37, "Output",ExpressionUUID->"809743dc-ef98-42ef-9f5e-c82f2d2f18c9",
 CellID->1958334418]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[364735, 9755, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
 CellTags->"Section19",
 CellID->1476129218],
Cell[364886, 9759, 146, 3, 70, "Input",ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f",
 CellID->384188579],
Cell[365035, 9764, 271, 6, 70, "Input",ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408",
 CellID->1721604371],
Cell[365309, 9772, 571, 11, 70, "TechNoteText",ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c",
 CellID->1572676782],
Cell[CellGroupData[{
Cell[365905, 9787, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
 CellTags->"Section20",
 CellID->749947798],
Cell[366057, 9791, 337, 7, 70, "TechNoteText",ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222",
 CellID->791116743],
Cell[366397, 9800, 875, 30, 70, "TechNoteText",ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e",
 CellID->1227841024],
Cell[367275, 9832, 958, 18, 70, "TechNoteText",ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704",
 CellID->1153726345],
Cell[368236, 9852, 172, 3, 70, "TechNoteText",ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff",
 CellID->1048831652],
Cell[368411, 9857, 896, 28, 70, "TechNoteText",ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559",
 CellID->1167800588],
Cell[369310, 9887, 1548, 45, 70, "TechNoteText",ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355",
 CellID->1371432583],
Cell[370861, 9934, 1189, 38, 70, "TechNoteText",ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06",
 CellID->725439230],
Cell[372053, 9974, 181, 3, 70, "TechNoteText",ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245",
 CellID->1192474591],
Cell[372237, 9979, 1000, 31, 70, "TechNoteText",ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533",
 CellID->1603057133],
Cell[373240, 10012, 1046, 31, 70, "TechNoteText",ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a",
 CellID->251399069],
Cell[374289, 10045, 1184, 34, 70, "TechNoteText",ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720",
 CellID->1163819034],
Cell[375476, 10081, 160, 2, 70, "TechNoteText",ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42",
 CellID->1025447562],
Cell[375639, 10085, 958, 29, 70, "TechNoteText",ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb",
 CellID->1140907359],
Cell[376600, 10116, 300, 8, 70, "TechNoteText",ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d",
 CellID->348498650],
Cell[376903, 10126, 1147, 32, 70, "TechNoteText",ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb",
 CellID->1028905181],
Cell[378053, 10160, 821, 23, 70, "TechNoteText",ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70",
 CellID->1271051423],
Cell[378877, 10185, 179, 3, 70, "TechNoteText",ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7",
 CellID->1541429652],
Cell[379059, 10190, 392, 12, 70, "TechNoteText",ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351",
 CellID->1712927403],
Cell[379454, 10204, 337, 7, 70, "TechNoteText",ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54",
 CellID->5090539],
Cell[379794, 10213, 441, 12, 70, "TechNoteText",ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83",
 CellID->1804826740],
Cell[380238, 10227, 249, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11",
 CellID->516505305],
Cell[CellGroupData[{
Cell[380512, 10235, 649, 19, 70, "Input",ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4",
 CellID->775759961],
Cell[381164, 10256, 1814, 46, 39, "Output",ExpressionUUID->"7fd1fd7f-c0f8-4e90-8a28-6c1c68fd4f53",
 CellID->1591075994],
Cell[382981, 10304, 1201, 31, 100, "Output",ExpressionUUID->"cdd8078b-9bec-4fa3-bc59-b6b1d69cf5cd",
 CellID->747858714]
}, Open  ]],
Cell[384197, 10338, 185, 3, 70, "TechNoteMathCaption",ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3",
 CellID->595736468],
Cell[CellGroupData[{
Cell[384407, 10345, 267, 7, 70, "Input",ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e",
 CellID->974055362],
Cell[384677, 10354, 2407, 57, 45, "Output",ExpressionUUID->"53c2deaa-176a-4de8-96cd-cd5c2d30d9cd",
 CellID->1060407830]
}, Open  ]],
Cell[387099, 10414, 214, 5, 70, "TechNoteMathCaption",ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9",
 CellID->1817782849],
Cell[CellGroupData[{
Cell[387338, 10423, 303, 8, 70, "Input",ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd",
 CellID->1373980921],
Cell[387644, 10433, 3153, 110, 180, "Output",ExpressionUUID->"8def29fa-6f19-4957-a57c-e149db55e9ee",
 CellID->1374392221]
}, Open  ]],
Cell[390812, 10546, 354, 7, 70, "TechNoteMathCaption",ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239",
 CellID->642635412],
Cell[CellGroupData[{
Cell[391191, 10557, 482, 15, 70, "Input",ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643",
 CellID->1078108721],
Cell[391676, 10574, 19294, 412, 70, "Output",ExpressionUUID->"0a3864a7-df97-4afb-9080-bb43e4f4954a",
 CellID->13529710]
}, Open  ]],
Cell[410985, 10989, 311, 7, 70, "TechNoteMathCaption",ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5",
 CellID->1155771237],
Cell[CellGroupData[{
Cell[411321, 11000, 266, 7, 70, "Input",ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97",
 CellID->1057593144],
Cell[411590, 11009, 4038, 99, 156, "Output",ExpressionUUID->"7b782820-34e6-4455-81c1-9b62fff30ae0",
 CellID->1917505456]
}, Open  ]],
Cell[415643, 11111, 152, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877",
 CellID->1969536942],
Cell[CellGroupData[{
Cell[415820, 11116, 352, 10, 70, "Input",ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc",
 CellID->694449336],
Cell[416175, 11128, 668, 19, 100, "Output",ExpressionUUID->"f04cc5ca-1138-4a0a-affa-7a3a568e1321",
 CellID->442189350]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[416892, 11153, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
 CellTags->"Section22",
 CellID->1363502801],
Cell[417088, 11159, 249, 4, 70, "TechNoteText",ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384",
 CellID->593579270],
Cell[417340, 11165, 492, 17, 70, "TechNoteText",ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3",
 CellID->1225250575],
Cell[417835, 11184, 242, 4, 70, "TechNoteText",ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9",
 CellID->565722942],
Cell[418080, 11190, 1214, 37, 70, "TechNoteText",ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963",
 CellID->1195380925],
Cell[419297, 11229, 138, 1, 70, "TechNoteText",ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738",
 CellID->1057688790],
Cell[419438, 11232, 492, 17, 70, "TechNoteText",ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec",
 CellID->1853347311],
Cell[419933, 11251, 285, 5, 70, "TechNoteText",ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124",
 CellID->2105439889],
Cell[420221, 11258, 1214, 37, 70, "TechNoteText",ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b",
 CellID->2040162804],
Cell[421438, 11297, 169, 3, 70, "TechNoteText",ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506",
 CellID->144855179],
Cell[421610, 11302, 494, 17, 70, "TechNoteText",ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3",
 CellID->1482021402],
Cell[422107, 11321, 335, 6, 70, "TechNoteText",ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac",
 CellID->1818365508],
Cell[422445, 11329, 810, 28, 70, "TechNoteText",ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f",
 CellID->429312499],
Cell[423258, 11359, 433, 7, 70, "TechNoteText",ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169",
 CellID->2057600420],
Cell[423694, 11368, 1701, 45, 70, "TechNoteText",ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd",
 CellID->1161091299],
Cell[425398, 11415, 225, 4, 70, "TechNoteText",ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b",
 CellID->277562004],
Cell[425626, 11421, 337, 5, 70, "TechNoteText",ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a",
 CellID->650119944],
Cell[425966, 11428, 810, 28, 70, "TechNoteText",ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4",
 CellID->169102872],
Cell[426779, 11458, 1128, 24, 70, "TechNoteText",ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be",
 CellID->991104723],
Cell[427910, 11484, 1700, 45, 70, "TechNoteText",ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b",
 CellID->1613913329],
Cell[429613, 11531, 192, 4, 70, "TechNoteText",ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0",
 CellID->175375246],
Cell[429808, 11537, 4846, 121, 70, "TechNoteText",ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad",
 CellID->1184195838],
Cell[434657, 11660, 180, 3, 70, "TechNoteText",ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e",
 CellID->2048492517],
Cell[CellGroupData[{
Cell[434862, 11667, 482, 14, 70, "Input",ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49",
 CellID->555904515],
Cell[435347, 11683, 1154, 33, 86, "Output",ExpressionUUID->"f358e0c2-3b2b-4c4a-b0e5-d0ab13756081",
 CellID->792186502]
}, Open  ]],
Cell[436516, 11719, 201, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac",
 CellID->691274085],
Cell[CellGroupData[{
Cell[436742, 11727, 469, 14, 70, "Input",ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208",
 CellID->357016325],
Cell[437214, 11743, 1251, 35, 120, "Output",ExpressionUUID->"b3f3af28-0d86-43e6-93c9-d4d7c69d513f",
 CellID->1204476725]
}, Open  ]],
Cell[438480, 11781, 153, 1, 70, "TechNoteMathCaption",ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e",
 CellID->1549413286],
Cell[CellGroupData[{
Cell[438658, 11786, 906, 23, 70, "Input",ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38",
 CellID->602394280],
Cell[439567, 11811, 2752, 62, 95, "Output",ExpressionUUID->"481641f9-8953-4fdc-a514-dd4023177c2d",
 CellID->443140805]
}, Open  ]],
Cell[442334, 11876, 137, 1, 70, "TechNoteMathCaption",ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228",
 CellID->389328403],
Cell[CellGroupData[{
Cell[442496, 11881, 1037, 27, 70, "Input",ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2",
 CellID->59796812],
Cell[443536, 11910, 3728, 83, 95, "Output",ExpressionUUID->"bede954a-b038-4a4c-9713-a8fb015d8484",
 CellID->249200483]
}, Open  ]],
Cell[447279, 11996, 193, 4, 70, "TechNoteMathCaption",ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76",
 CellID->834281808],
Cell[CellGroupData[{
Cell[447497, 12004, 551, 16, 70, "Input",ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2",
 CellID->853615793],
Cell[448051, 12022, 668, 19, 100, "Output",ExpressionUUID->"ed4d0063-a8ff-4db7-8176-b343ed6e6178",
 CellID->933398985],
Cell[448722, 12043, 668, 19, 100, "Output",ExpressionUUID->"ff4329d6-b0c9-4e01-92ac-a941ec0777e2",
 CellID->268699560]
}, Open  ]],
Cell[449405, 12065, 621, 13, 70, "TechNoteText",ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9",
 CellID->645391397]
}, Open  ]],
Cell[CellGroupData[{
Cell[450063, 12083, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
 CellTags->"Section23",
 CellID->153308382],
Cell[450200, 12087, 427, 7, 70, "TechNoteText",ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6",
 CellID->1821083521],
Cell[450630, 12096, 280, 5, 70, "TechNoteMathCaption",ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98",
 CellID->1013800403],
Cell[CellGroupData[{
Cell[450935, 12105, 555, 17, 70, "Input",ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8",
 CellID->808117923],
Cell[451493, 12124, 1815, 46, 39, "Output",ExpressionUUID->"93cef377-a46a-408c-803e-0ac53d6a4b2e",
 CellID->2071916108]
}, Open  ]],
Cell[453323, 12173, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28",
 CellID->322701359],
Cell[CellGroupData[{
Cell[453558, 12181, 269, 7, 70, "Input",ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4",
 CellID->1245532038],
Cell[453830, 12190, 2408, 57, 45, "Output",ExpressionUUID->"91b498f5-751b-4775-a234-f44e47189007",
 CellID->1723793763]
}, Open  ]],
Cell[456253, 12250, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3",
 CellID->730080199],
Cell[CellGroupData[{
Cell[456474, 12258, 377, 11, 70, "Input",ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459",
 CellID->1883829282],
Cell[456854, 12271, 3154, 110, 180, "Output",ExpressionUUID->"36b19693-9b35-49b4-b5c0-67a3e5638386",
 CellID->1308824420]
}, Open  ]],
Cell[460023, 12384, 200, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833",
 CellID->2133759026],
Cell[CellGroupData[{
Cell[460248, 12392, 426, 12, 70, "Input",ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045",
 CellID->1258528729],
Cell[460677, 12406, 8525, 218, 432, "Output",ExpressionUUID->"1ff5a613-94f6-4852-86ff-be53ee8e7966",
 CellID->1991751095]
}, Open  ]],
Cell[469217, 12627, 371, 7, 70, "TechNoteMathCaption",ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030",
 CellID->702850526],
Cell[CellGroupData[{
Cell[469613, 12638, 217, 5, 70, "Input",ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468",
 CellID->1648731982],
Cell[469833, 12645, 9143, 205, 177, "Output",ExpressionUUID->"14414b83-5536-4abc-b988-2c2031462080",
 CellID->68577246]
}, Open  ]],
Cell[478991, 12853, 400, 6, 70, "TechNoteMathCaption",ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80",
 CellID->328948492],
Cell[CellGroupData[{
Cell[479416, 12863, 222, 5, 70, "Input",ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24",
 CellID->1014397666],
Cell[479641, 12870, 6541, 132, 95, "Output",ExpressionUUID->"c7269dec-a371-413b-886f-0cc0877c86c9",
 CellID->2018914546]
}, Open  ]],
Cell[486197, 13005, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3",
 CellID->608232459],
Cell[CellGroupData[{
Cell[486418, 13013, 338, 9, 70, "Input",ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37",
 CellID->540778693],
Cell[486759, 13024, 2682, 59, 100, "Output",ExpressionUUID->"9fde22d8-72de-4e45-9e67-908cdc531c8e",
 CellID->1694484040]
}, Open  ]],
Cell[CellGroupData[{
Cell[489478, 13088, 216, 6, 70, "Input",ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb",
 CellID->326787606],
Cell[489697, 13096, 669, 19, 100, "Output",ExpressionUUID->"af2d620b-8e93-41cb-b183-3a82763067d7",
 CellID->1912083700]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[490405, 13120, 714, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"ac0acf37-45f4-44e8-b2ac-6fd418473a1a"],
Cell[491122, 13140, 1078, 28, 70, "RelatedTutorialsSection",ExpressionUUID->"266b521d-27a7-483f-aab0-0a25aba4e7e1"],
Cell[492203, 13170, 5244, 132, 70, "TutorialRelatedLinksSection",ExpressionUUID->"a4c668cb-94f2-4180-889f-f797a26a476b"]
}, Open  ]],
Cell[497462, 13305, 78, 0, 70, "FooterCell",ExpressionUUID->"18885233-07c3-459f-8def-7ea58a88e6a2"]
}
]
*)

(* End of internal cache information *)

