(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    309500,       7876]
NotebookOptionsPosition[    287761,       7442]
NotebookOutlinePosition[    291892,       7532]
CellTagsIndexPosition[    291811,       7527]
WindowTitle->Quantum Teleportation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TUTORIAL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "62bc8a6f-ec21-45ce-935c-df593076615a"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "8cd8c407-b9e3-4d96-aa96-048f09ef5bb5"],
        Background->RGBColor[
         0.7450980392156863, 0.3254901960784314, 0.1411764705882353],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "06273b57-616b-4e39-a83b-aedd808f4683"]
         }],ExpressionUUID->"c15475a2-9ffe-4835-9190-b272afba20c3"],
         StripOnInput->False], {"\<\"Quantum Algorithms\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumAlgorithms"], "\<\"QuantumCircuit Usage \
Examples\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumCircuitUsage"], "\<\"Quantum Information \
Systems with Q3\"\>":>Documentation`HelpLookup[
        "paclet:Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "8621d484-e515-428d-96bc-5784ab46a25a"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "650e655d-d5ce-4afd-b78a-f1cfcaedebbd"]
         }],ExpressionUUID->"f895ff35-3afc-47ef-a685-1d7c7b982b86"],
         StripOnInput->False], {"\<\"Quantum Information Systems\"\>":>
        Documentation`HelpLookup["paclet:Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "fc3411df-b5f8-4d81-8d7f-3fd0682f96f6"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f4026107-5f10-4e26-8fda-66257afe8f50"]
         }],ExpressionUUID->"7209a4ce-1a67-42fc-9f22-36ba24859701"],
         StripOnInput->False], {"\<\"BellState\"\>":>Documentation`HelpLookup[
        "paclet:Q3/ref/BellState"], "\<\"CNOT\"\>":>Documentation`HelpLookup[
        "paclet:Q3/ref/CNOT"], "\<\"ExpressionFor\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/ExpressionFor"], "\<\"Hadamard\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/Hadamard"], "\<\"Matrix\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/Matrix"], "\<\"QuantumCircuit\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/QuantumCircuit"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "731fbdbb-70ff-4856-b222-c30cbf87d3a2"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "980ae2e4-e9ce-4138-af5e-9ba867cd58de"]
         }],ExpressionUUID->"4b2e57c1-81cd-42c5-8077-839ec51b1cb1"],
         StripOnInput->False], {"\<\"Q3/tutorial/QuantumTeleportation\"\>":>
        None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell["Q3/tutorial/QuantumTeleportation"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        Delimiter, "\<\"Copy web URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell[
               BoxData[
                MakeBoxes[
                 Hyperlink[
                 "http://reference.wolfram.com/language/Q3/tutorial/\
QuantumTeleportation.html"], StandardForm]], "Input", TextClipboardType -> 
               "PlainText"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; 
         Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
          NotebookLocate[{
            URL[If[
               TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$23970], 
               "http://reference.wolfram.com/system-modeler/", 
               "http://reference.wolfram.com/language/"] <> 
             "Q3/tutorial/QuantumTeleportation" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "da06d1bf-7404-4951-8c0d-f9330a375af5"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "f4177d3e-8ea1-470d-b02f-b42e19815053"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"16d8f8b3-5f0d-417f-a472-229c26f97c44"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Quantum Teleportation", "Title",ExpressionUUID->
      "41653590-4166-40b9-9619-90fbf6821855"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"7ab4dfdc-a7bc-47ba-8fc9-3d8ac2d3c3a9"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "bcd09f49-095c-48b9-a70e-303b154264f5"]
    }],ExpressionUUID->"b98ede86-1229-4117-90dc-641fb53564c2"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 13\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
        Right, Center}],
       AxesStyle->Large,
       FrameStyle->Large,
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "c92435e0-0c75-4f75-95d4-7ac8c166e812"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"f2e49850-3451-42e6-a73a-7c9c06073bef"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Synopsis"], "paclet:Q3/tutorial/QuantumTeleportation#255888865", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Implementation"], 
      "paclet:Q3/tutorial/QuantumTeleportation#1867183189", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Simple Theory"], 
      "paclet:Q3/tutorial/QuantumTeleportation#610843909", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Applications"], 
      "paclet:Q3/tutorial/QuantumTeleportation#534588153", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Preliminaries"], 
      "paclet:Q3/tutorial/QuantumTeleportation#775468120", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TutorialJumpBox",ExpressionUUID->"bcdd1ecd-aae8-4198-b7b9-\
750eb8542d3d"],

Cell[TextData[{
 "See also Section 4.1 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "da968af4-4f1b-4233-b008-f7e3d0f20981"],
 "."
}], "Text",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"a1c45584-4cbb-4b95-bb86-8312b187a022"],

Cell[TextData[{
 "Quantum teleportation is a communication protocol that sends quantum \
information to a distant party by utilizing a pre-shared pair of entangled \
particles (Bennett ",
 StyleBox["et al",
  FontSlant->"Italic"],
 ".",
 ", 1993). The protocol has attracted public interest since it resembles \
(fictional) teleportation. In science fiction, (hypothetical) teleportation \
instantly transports matter or energy across space. Quantum teleportation \
does not transfer physical objects but only quantum information. Quantum \
teleportation is also conceptually distinguished from telefax. Telefax makes \
a copy of the document and sends the duplicated copy while the original \
document remains at its origin. In quantum teleportation, a quantum state is \
transferred and disappears from the original system."
}], "Text",
 CellID->646075679,ExpressionUUID->"b2c763b6-b692-40b3-affc-55068600cd74"],

Cell["\<\
\tQuantum teleportation is one of the first quantum information protocols \
that vividly illustrates the significance of quantum entanglement as a \
valuable resource. In this section, we discuss the physical principle behind \
quantum teleportation and demonstrate the protocol. Another closely related \
quantum communication protocol is the so-called superdense coding (Bennett \
and Wiesenr, 1992).\
\>", "Text",
 CellID->916617721,ExpressionUUID->"3186cab3-dda4-4a98-b27c-92f4f2fe6cbd"],

Cell["\<\
\tQuantum teleportation is not only interesting in its own right but also \
used as part of various quantum algorithms. Interestingly, even a \
computational model based solely on quantum teleportation has been proposed \
as well (Gottesman and Chuang, 1999; Nielsen, 2003; Leung, 2004).\
\>", "Text",
 CellID->1693836916,ExpressionUUID->"e1797c10-cbbf-42ff-9675-e1ef393e44ea"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Circuit representation of elementary gates.", "TableText",ExpressionUUID->
     "3eb065b6-cbff-4b67-9a6c-f0a07338aee9"]},
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Two-qubit controlled-NOT gate.", "TableText",ExpressionUUID->
     "3e07d98b-1b28-412b-87b9-1264c55aa378"]},
   {
    TemplateBox[{
      Cell[
       TextData["Hadamard"]], "paclet:Q3/ref/Hadamard", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The Hadamard gate.", "TableText",ExpressionUUID->
     "3950e5ce-43f0-4ff3-9b23-a2446d5c37e7"]},
   {
    TemplateBox[{
      Cell[
       TextData["BellState"]], "paclet:Q3/ref/BellState", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Returns a list of the four Bell states.", "TableText",ExpressionUUID->
     "1523e672-2c8a-401b-976c-230ec33e7a4f"]},
   {
    TemplateBox[{
      Cell[
       TextData["Matrix"]], "paclet:Q3/ref/Matrix", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[TextData[{
     "Converts ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
        "Q3 Package Symbol"},
       "PackageLink",
       BaseStyle->{"DefinitionBox", CellFrame -> 0}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "f31385f9-4294-4c92-a9a5-78f33267bfa6"],
     " and operator (or Ket) expressions to the matrix representation in the \
standard basis."
    }], "TableText",ExpressionUUID->"c95750c0-41f4-40f4-9087-8d15730d8a6f"]},
   {
    TemplateBox[{
      Cell[
       TextData["ExpressionFor"]], "paclet:Q3/ref/ExpressionFor", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Converts the matrix representation to the corresponding operator or \
state-vector expression.\
\>", "TableText",ExpressionUUID->"381b35f9-a42f-4ae7-a59a-de686280ddb1"]}
  }]], "DefinitionBox",
 CellID->2096742444,ExpressionUUID->"000b48ff-c85b-4b50-93ba-e3ad3631040a"],

Cell["Functions related to the quantum teleportation protocol.", "Caption",
 CellID->1891092685,ExpressionUUID->"6f3aedc2-a9f9-45fe-bd19-93199b02a969"],

Cell["\<\
Make sure that the Q3 package is loaded to use the demonstrations in this \
document.\
\>", "MathCaption",
 CellID->1428640008,ExpressionUUID->"ed76b3b5-a806-4c91-ac58-8b35d055b8cb"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[441]:=",
 CellID->853967906,ExpressionUUID->"7bbe438d-9dea-4110-b236-08980f631554"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "MathCaption",
 CellID->1937193009,ExpressionUUID->"460f0004-a488-42f9-b996-1a5fc83725e9"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[442]:=",
 CellID->403330096,ExpressionUUID->"5d7bb87d-142a-4b91-99eb-975bf99c5af0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Synopsis", "Section",
 CellID->255888865,ExpressionUUID->"98276746-b394-4c77-9691-298645f43018"],

Cell[TextData[{
 "Suppose that Bob wants to send one bit of quantum information, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "Ket"], "C"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "C"], 
      SubscriptBox["c", "0"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "C"], 
      SubscriptBox["c", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "0cb6224c-d5f7-4932-9df4-246d36a40f41"],
 " stored in Charlie\[CloseCurlyQuote]s qubit, to Alice residing in a place \
far away from Bob (and Charlie). There is no quantum communication channel \
operating between Alice and Bob to directly send the quantum state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "b0ff44ab-248c-4cc2-8c59-771a01ea8ce4"],
 " through. \tFortunately, however, there is a classical commutation \
channel."
}], "Text",
 CellID->1461892761,ExpressionUUID->"65ef87c4-46ff-4c2d-b5bc-b60db4f316e1"],

Cell[TextData[{
 "\tIt is important to note that the quantum state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d2b875c8-36de-493b-b78b-0811b62e573b"],
 " is unknown. The ",
 ButtonBox["no-cloning theorem",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/NoCloningTheorem"],
 " prevents a naive approach such as copying and transmitting the quantum \
state."
}], "Text",
 CellID->671228800,ExpressionUUID->"1764bc83-568e-4e1a-98ee-07ff994a90d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simple Theory", "Section",
 CellID->610843909,ExpressionUUID->"1aff1c39-5ba2-4404-97af-3b4cf6b34834"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[444]:=",
 CellID->1866199296,ExpressionUUID->"3efcd23e-941b-48d0-9608-3a163a26d9c5"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[445]:=",
 CellID->1151055825,ExpressionUUID->"53594233-bf93-44ba-978e-a412bcea26e7"],

Cell[TextData[{
 "To teleport a quantum state, Alice and Bob need to share an entangled pair \
of qubits in advance. Suppose that the shared pair of qubits is in the state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    TemplateBox[{
      SubscriptBox["\[Beta]", "0"]},
     "Ket"], 
    RowBox[{"A", " ", "B"}]], TraditionalForm]],ExpressionUUID->
  "cb373a37-e592-4afe-a156-fd496b3a8b8e"],
 ", which is one of the four ",
 ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/BellState"],
 ","
}], "Text",
 CellID->1481745903,ExpressionUUID->"2a5f717f-821b-46c7-a8e4-5fc48c3cad9c"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Beta]", "0"]},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      TemplateBox[{"00"},
       "Ket"], "+", 
      TemplateBox[{"11"},
       "Ket"]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "69e4f7dc-da88-45bd-a702-52f3a5c878b3"],
 ",    ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Beta]", "1"]},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      TemplateBox[{"01"},
       "Ket"], "+", 
      TemplateBox[{"10"},
       "Ket"]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "6bacffcc-d5e3-4e15-a3f4-e7aefd23a46f"],
 ",    ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Beta]", "3"]},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      TemplateBox[{"01"},
       "Ket"], "-", 
      TemplateBox[{"10"},
       "Ket"]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "8e57b981-b86e-4db0-b395-b77931e54776"],
 ",    ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Beta]", "3"]},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      TemplateBox[{"00"},
       "Ket"], "-", 
      TemplateBox[{"11"},
       "Ket"]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "defb4f30-7d18-48eb-8645-7eb6df74cdf9"],
 "."
}], "DisplayMath",
 CellID->1483021109,ExpressionUUID->"f61cc824-c5f9-4b1e-86ea-09fe9305a292"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bs", "=", 
  RowBox[{"BellState", "[", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[447]:=",
 CellID->1440571881,ExpressionUUID->"97697232-9e18-45db-8e65-7323cd1c19b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
     "+", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]]}], 
    
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
     "+", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
    
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
     "-", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
    
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
     "-", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]]}], 
    
    SqrtBox["2"]]}], "}"}]], "Output",
 CellLabel->"Out[447]=",
 CellID->551051522,ExpressionUUID->"bfc40ae4-9ac6-40aa-a810-7d1fb6dd28a8"]
}, Open  ]],

Cell[TextData[{
 "Then, with the quantum state stored in qubit ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "7fa72c46-6615-400c-b302-e8bf733e8007"],
 ", that is,"
}], "Text",
 CellID->1906923583,ExpressionUUID->"11c4f4fb-7fb0-49f9-90b5-7653c26e3a81"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "Ket"], "C"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "C"], 
      SubscriptBox["c", "0"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "C"], 
      SubscriptBox["c", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d0854bd6-cfdb-4282-a0ef-40829710eea6"],
 " ,"
}], "DisplayMath",
 CellID->618711653,ExpressionUUID->"427e08b3-3ca9-415e-b7ea-b632c42a53aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"msg", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], "*", 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "->", "1"}], "]"}], "*", 
     RowBox[{"c", "[", "1", "]"}]}]}], "//", "KetRegulate"}]}]], "Input",
 CellLabel->"In[449]:=",
 CellID->570933197,ExpressionUUID->"3d414470-4334-4d10-b25b-72f95d641fbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[449]=",
 CellID->1581637035,ExpressionUUID->"86d1fcd6-67f8-459f-84a0-b2e13110243d"]
}, Open  ]],

Cell[TextData[{
 "the initial state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPsi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "2cab81ea-74ae-4703-b89a-e07ef4625956"],
 " of the overall three qubits at the beginning of the procedure is given by"
}], "Text",
 CellID->1956114070,ExpressionUUID->"06d811e3-bb1e-4b73-bcef-aa78939459ba"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[CapitalPsi]"},
     "Ket"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "0"]},
        "Ket"], 
       RowBox[{"A", " ", "B"}]], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{"\[Psi]"},
        "Ket"], "C"]}], "=", 
     FractionBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"000"},
         "Ket"], 
        SubscriptBox["c", "0"]}], "+", 
       RowBox[{
        TemplateBox[{"110"},
         "Ket"], 
        SubscriptBox["c", "0"]}], "+", 
       RowBox[{
        TemplateBox[{"001"},
         "Ket"], 
        SubscriptBox["c", "1"]}], "+", 
       RowBox[{
        TemplateBox[{"111"},
         "Ket"], 
        SubscriptBox["c", "1"]}]}], 
      SqrtBox["2"]]}]}], TraditionalForm]],ExpressionUUID->
  "b46839f8-63e5-470a-95b3-019176f9b6ee"],
 "."
}], "DisplayMath",
 CellID->582022567,ExpressionUUID->"b1ced1e1-bd96-433c-bd19-258cca559d81"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"bs", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "**", "msg"}]}]], "Input",
 CellLabel->"In[450]:=",
 CellID->265271484,ExpressionUUID->"4d9986aa-f015-4871-bf59-de51b684b26c"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[450]=",
 CellID->304695646,ExpressionUUID->"eb1cfee7-4b07-4503-bef2-81bcbbe3c289"]
}, Open  ]],

Cell[TextData[{
 "Recall that Bob has qubits ",
 StyleBox["B",
  FontSlant->"Italic"],
 " and ",
 StyleBox["C",
  FontSlant->"Italic"],
 " at his hands."
}], "MathCaption",
 CellID->337551720,ExpressionUUID->"84c98925-0cce-41a4-a4cb-2e0be13e007e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ProductForm", "[", 
  RowBox[{"in", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "1"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[451]:=",
 CellID->1685891102,ExpressionUUID->"ac1d9b3e-b68f-4ae0-b973-a98086cee91e"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]}, "Ket"], "\"\[CircleTimes]\"", 
       TemplateBox[{
         TemplateBox[{"0", "0"}, "RowDefault"]}, "Ket"]},
      "RowDefault"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]}, "Ket"], "\"\[CircleTimes]\"", 
       TemplateBox[{
         TemplateBox[{"0", "1"}, "RowDefault"]}, "Ket"]},
      "RowDefault"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]}, "Ket"], "\"\[CircleTimes]\"", 
       TemplateBox[{
         TemplateBox[{"1", "0"}, "RowDefault"]}, "Ket"]},
      "RowDefault"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]}, "Ket"], "\"\[CircleTimes]\"", 
       TemplateBox[{
         TemplateBox[{"1", "1"}, "RowDefault"]}, "Ket"]},
      "RowDefault"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[451]=",
 CellID->433501179,ExpressionUUID->"394e9450-d3a3-40b5-900c-869c1930ae31"]
}, Open  ]],

Cell[TextData[{
 "\tRewriting the parts consisting of qubits B and C in the Bell basis, the \
basis consisting of the four ",
 ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/BellState"],
 ", leads to"
}], "Text",
 CellID->564391588,ExpressionUUID->"a2a8ea89-b29a-4102-8131-a3607cbb9dc4"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   TemplateBox[{"\[CapitalPsi]"},
    "Ket"], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TemplateBox[{"0"},
           "Ket"], 
          SubscriptBox["c", "0"]}], "+", 
         RowBox[{
          TemplateBox[{"1"},
           "Ket"], 
          SubscriptBox["c", "1"]}]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "0"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TemplateBox[{"0"},
           "Ket"], 
          SubscriptBox["c", "1"]}], "+", 
         RowBox[{
          TemplateBox[{"1"},
           "Ket"], 
          SubscriptBox["c", "0"]}]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "1"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TemplateBox[{"0"},
           "Ket"], 
          SubscriptBox["c", "1"]}], "-", 
         RowBox[{
          TemplateBox[{"1"},
           "Ket"], 
          SubscriptBox["c", "0"]}]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "2"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TemplateBox[{"0"},
           "Ket"], 
          SubscriptBox["c", "0"]}], "-", 
         RowBox[{
          TemplateBox[{"1"},
           "Ket"], 
          SubscriptBox["c", "1"]}]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "3"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}]}]}]}], TraditionalForm]],
 InitializationCell->
  True,ExpressionUUID->"3991e08f-0c8f-49b5-ad2f-bef0c8dfdd94"]], "DisplayMath",\

 CellID->294150717,ExpressionUUID->"53bdb13b-933a-4986-8edb-cc4ea7fcf48a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prj", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dyad", "[", 
      RowBox[{"#", ",", "#", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"BellState", "[", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmp", "=", 
   RowBox[{"prj", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmp", "//", "KetFactor"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[452]:=",
 CellID->283745225,ExpressionUUID->"4d3eaba2-5a2a-4012-9bd4-a3d1272510ac"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
               0|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               1|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
         Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>] + 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            1|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
               1|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               0|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[1] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
         Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 1|>] + 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            0|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        InterpretationBox[
         TagBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"c"},
                 "RowDefault"], 
                TemplateBox[{"1"},
                 "RowDefault"]],
               $CellContext`c[1]], " ", 
              InterpretationBox[
               TemplateBox[{
                 TemplateBox[{
                   SubscriptBox["0", 
                    InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
                "Ket"],
               Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "-", 
             RowBox[{
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"c"},
                 "RowDefault"], 
                TemplateBox[{"0"},
                 "RowDefault"]],
               $CellContext`c[0]], " ", 
              InterpretationBox[
               TemplateBox[{
                 TemplateBox[{
                   SubscriptBox["1", 
                    InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
                "Ket"],
               Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
           "\[CircleTimes]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              InterpretationBox[
               TemplateBox[{
                 TemplateBox[{
                   SubscriptBox["0", 
                    InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                    $CellContext`S[2, Q3`$]]], 
                   SubscriptBox["1", 
                    InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                    $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
                "Ket"],
               
               Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
                 1|>]]}], "+", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                    $CellContext`S[2, Q3`$]]], 
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                    $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              
              Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
                0|>]]}], ")"}]}],
          HoldForm],
         Q3`OTimes[$CellContext`c[1] 
           Ket[<|$CellContext`S[1, Q3`$] -> 0|>] - $CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], -
           Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
              1|>] + Ket[<|$CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 0|>]]], 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "-", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
               0|>]], "-", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               1|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] - $CellContext`c[1] 
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
         Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>] - 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
           1|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[454]//TableForm=",
 CellID->606896830,ExpressionUUID->"c778b219-e170-4ac7-a3c6-edded7a59e2a"]
}, Open  ]],

Cell[TextData[{
 "The crucial point here is that the state of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "4b55d648-b9a7-4272-8d85-86e35f9a6a38"],
 " in the first term is identical to the original quantum state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "786f5c70-c67b-46ac-8492-3bdf11bb226c"],
 ", and those in the rest are also closely related to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "4d2ebb35-2927-462d-bd36-4a9ea82a6828"],
 " by the Pauli operators. More explicitly, one can rewrite the total state \
vector as"
}], "Text",
 CellID->628536332,ExpressionUUID->"7f055d76-85e1-4ebd-afbb-10bc9bd42e9d"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[CapitalPsi]"},
     "Ket"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"\[Psi]"},
        "Ket"], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "0"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{"X", 
         TemplateBox[{"\[Psi]"},
          "Ket"]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "1"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", "Y", 
         TemplateBox[{"\[Psi]"},
          "Ket"]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "2"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{"Z", 
         TemplateBox[{"\[Psi]"},
          "Ket"]}], ")"}], "A"], "\[CircleTimes]", 
      SubscriptBox[
       TemplateBox[{
         SubscriptBox["\[Beta]", "3"]},
        "Ket"], 
       RowBox[{"B", " ", "C"}]]}]}]}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "aae01840-007f-474b-b916-2c8af2dc3e62"],
 "."
}], "DisplayMath",
 CellID->338072331,ExpressionUUID->"8cce4004-c464-440e-a97b-c93110fd1bf3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "1"}], "]"}], ",", 
      RowBox[{"I", "*", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "}"}], "**", "cmp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KetFactor", "[", "out", "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[455]:=",
 CellID->1887420802,ExpressionUUID->"10247fd3-2085-4359-95bd-2d936717a734"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
               0|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               1|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
         Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>] + 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            1|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
               1|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               0|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
         Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 1|>] + 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            0|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                    $CellContext`S[2, Q3`$]]], 
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                    $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              
              Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
                1|>]]}], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               0|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], -
          Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 1|>] + 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            0|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       InterpretationBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"0"},
                "RowDefault"]],
              $CellContext`c[0]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"c"},
                "RowDefault"], 
               TemplateBox[{"1"},
                "RowDefault"]],
              $CellContext`c[1]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"1"}, "RowDefault"]], 
                    $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], 
          "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["0", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
               0|>]], "-", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"2"}, "RowDefault"]], 
                   $CellContext`S[2, Q3`$]]], 
                 SubscriptBox["1", 
                  InterpretationBox[
                   SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"3"}, "RowDefault"]], 
                   $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
              "Ket"],
             
             Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
               1|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[$CellContext`c[0] 
          Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
         Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>] - 
         Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
           1|>]]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[456]//TableForm=",
 CellID->714324845,ExpressionUUID->"aaccfd6c-b9d1-4f70-9c18-184da3cc1e96"]
}, Open  ]],

Cell[TextData[{
 "\tNow Bob performs a measurement on the two qubits ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "3f6f314c-57b3-45ce-ab8b-c50684b02721"],
 " and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "aa42bd67-ca16-451e-9a22-1b9dd8a7aa41"],
 ", owned by Bob, in the Bell basis. The measurement will yield outcomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Mu]", "=", "0"}], ",", "1", ",", "2", ",", "3"}], 
   TraditionalForm]],ExpressionUUID->"848d20fd-44a0-470a-b36d-df27d41beafe"],
 " and will collapse the total state vector into the corresponding term, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S", "\[Mu]"], 
       TemplateBox[{"\[Psi]"},
        "Ket"]}], ")"}], "A"], "\[CircleTimes]", 
    SubscriptBox[
     TemplateBox[{
       SubscriptBox["\[Beta]", "\[Mu]"]},
      "Ket"], 
     RowBox[{"B", " ", "C"}]]}], TraditionalForm]],ExpressionUUID->
  "1b91ce7a-c80f-478e-979c-b9dd159a9d3b"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["S", "0"], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "88d9ba02-013b-4427-b75c-88e95a8a3a60"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["S", "1"], "=", "X"}], TraditionalForm]],ExpressionUUID->
  "59b6d484-30cd-4410-8aa9-e865a10d8279"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["S", "2"], "=", 
    RowBox[{"\[ImaginaryI]", " ", "Y"}]}], TraditionalForm]],ExpressionUUID->
  "493233d6-1431-4384-88a2-3b67285bf289"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["S", "3"], "=", "Z"}], TraditionalForm]],ExpressionUUID->
  "c2846e09-9868-4002-82f1-3cacd0ca3c74"],
 ". The remaining task is for Bob to inform Alice of the outcome ",
 Cell[BoxData[
  FormBox["\[Mu]", TraditionalForm]],ExpressionUUID->
  "56fa6ae3-fdc4-49e9-899e-5b60fb0a35d7"],
 " so that Alice recover the desired state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "68d3af71-3c4f-4daa-8944-dff4347dc70a"],
 " by operating the inverse operator ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "1d85144b-fd54-4c59-adb9-5adb01c4584b"],
 " on her qubit. The information regarding the measurement outcome amounts to \
two bits, and it requires only a classical channel for transmission."
}], "Text",
 CellID->1268048119,ExpressionUUID->"ce04a70a-1a3f-4f43-807f-b151a88df3bc"],

Cell["\<\
\tIn short, the quantum teleportation protocol consists of the following \
steps:\
\>", "Text",
 CellID->457023205,ExpressionUUID->"ff3b27d3-7d37-405b-8200-5fdb10c4233d"],

Cell[TextData[{
 "Alice and Bob generate an entangled pair of qubits, ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "57a5bfb3-062f-4718-8c5b-8f8c14205ead"],
 " and ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "900dae4f-8426-4d94-abbe-5a6446264c37"],
 ", and share the pair between them. This can be done anytime before the \
procedure actually starts. Bob prepares a quantum state to send in a separate \
qubit ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "2d774b83-1aa2-4e92-a4e9-8871bc60be25"],
 "."
}], "ItemNumbered",
 CellID->1787484763,ExpressionUUID->"e9a3a6c4-2ec5-431a-8f55-b3fb5c112882"],

Cell[TextData[{
 "Bob makes a Bell measurement, i.e., the measurement in the Bell basis, on \
his two qubits ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "43fa27a3-e1e7-4cd5-8c0a-1854e2a43638"],
 " and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "b10d16eb-7e6c-42c8-8af4-35a031005f33"],
 "."
}], "ItemNumbered",
 CellID->1107673858,ExpressionUUID->"da660e5d-194d-40c9-acff-c36f8b507719"],

Cell["\<\
Bob sends the two-bit information regarding the measurement outcome to Alice \
through a classical communication channel.\
\>", "ItemNumbered",
 CellID->138795563,ExpressionUUID->"5f38619c-f64f-4fdd-89d6-809c5a93d0a9"],

Cell["\<\
Alice operates a proper inverse operator to recover the desired quantum state.\
\>", "ItemNumbered",
 CellID->569786699,ExpressionUUID->"19d548b6-0bf1-4118-81b5-1966f5e4b961"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellID->775468120,ExpressionUUID->"ce71ca63-a02c-4aac-a616-8a2b3e50c444"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[457]:=",
 CellID->408379708,ExpressionUUID->"d9298cce-36f8-4a5b-9c20-3e748605c026"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[458]:=",
 CellID->280016544,ExpressionUUID->"9539b2ab-05d4-4410-8129-e5cf2d4ccb67"],

Cell["\<\
In the quantum teleportation protocol, two essential parts are sharing \
entanglement and performing the Bell measurement. Before we demonstrate an \
implementation of the quantum teleportation protocol, here we summarize \
quantum circuit models of the two tasks.\
\>", "Text",
 CellID->214439197,ExpressionUUID->"cd9be0d1-370a-4ad8-a5f3-6f45a6d0bb8c"],

Cell[CellGroupData[{

Cell["Entangler Quantum Circuit", "Subsection",
 CellID->602024313,ExpressionUUID->"a046bcfd-ea13-48ad-9b51-e8703516840c"],

Cell[TextData[{
 "To establish an entanglement between two qubits initially in a product \
state, one needs to interact them. In the quantum circuit model, the \
interaction is achieve by the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "712666bb-3676-47aa-972f-76ea5cdde38e"],
 " gate. Specifically, one can use the feature of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7869e474-df5a-4c50-b88d-ebd60d2340c6"],
 " gate that copies the computational basis states of the control qubit to \
the target qubit,"
}], "Text",
 CellID->1427167574,ExpressionUUID->"e1fc78c0-6820-4590-9d3c-b540b8271749"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], 
        SubscriptBox["c", "0"]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], 
        SubscriptBox["c", "1"]}]}], ")"}], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"00"},
        "Ket"], 
       SubscriptBox["c", "0"]}], "+", 
      RowBox[{
       TemplateBox[{"10"},
        "Ket"], 
       SubscriptBox["c", "1"]}]}], "\[RightTeeArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"00"},
        "Ket"], 
       SubscriptBox["c", "0"]}], "+", 
      RowBox[{
       TemplateBox[{"11"},
        "Ket"], 
       SubscriptBox["c", "1"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "5951c8ad-ba43-492e-8b26-29189d814758"],
 "."
}], "DisplayMath",
 CellID->1160562875,ExpressionUUID->"6c7077bf-f55e-4c68-913b-1d6bc59d7713"],

Cell[TextData[{
 "The linear superposition of the control qubit may be built by the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Hadamard"]], "paclet:Q3/ref/Hadamard", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8b909b59-5a52-45dd-9cb4-ffb46a75f1a7"],
 " gate (a general form of linear superposition can be built with ",
 ButtonBox["rotation gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/Rotation"],
 ")."
}], "Text",
 CellID->2133758071,ExpressionUUID->"c1161204-bc27-4793-9de8-4f9e037ab426"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[460]:=",
 CellID->1242478044,ExpressionUUID->"d9886e7e-1b83-4451-9435-7fb766cd6705"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[460]=",
 CellID->451008042,ExpressionUUID->"b8ac1056-f8b7-4196-bbe0-bf72dac1f248"]
}, Open  ]],

Cell["\<\
Get the four Bell states applying the above quantum circuit to the product \
basis.\
\>", "Text",
 CellID->1555223945,ExpressionUUID->"f2f5ff0c-f7c8-46a1-b32a-2cb2ad51ac4e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[461]:=",
 CellID->1625375978,ExpressionUUID->"a4b9019e-7c65-4161-a57c-6d91684c126c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[463]//TableForm=",
 CellID->737767785,ExpressionUUID->"bf9e572a-68d8-4167-9c4e-73e6053eb61b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bell-Measurement Circuit", "Subsection",
 CellID->101265955,ExpressionUUID->"adac3158-8cc1-47a2-b45e-8f805e1cc3c4"],

Cell[TextData[{
 "In quantum computers, a ",
 ButtonBox["measurement",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/measurement"],
 " usually means to measure the Pauli Z operator on different qubits. In \
other words, measurement is assumed to be performed independently on \
individual qubits in the computational basis, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], " ", ":", " ", "x"}], " ", "=", " ", "0"}], ",", " ", "1", 
     ",", " ", 
     RowBox[{".", " ", ".", " ", "."}], " ", ",", " ", 
     RowBox[{
      RowBox[{"2", "n"}], " ", "\[Minus]", " ", "1"}]}], "}"}], 
   TraditionalForm]],ExpressionUUID->"9d526de6-2c53-41f9-91e2-ceea17918a70"],
 ". (In Q3, measurement of arbitrary Pauli operators is supported; see the \
document of ",
 ButtonBox["Measurement",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/measurement"],
 ".)"
}], "Text",
 CellID->1169857261,ExpressionUUID->"3ed3f8ab-5862-4b14-8522-76f8d3f41c0e"],

Cell[TextData[{
 "\tTo measure an arbitrary observable ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "77b64693-8b21-4614-9375-22d30d5d8b7c"],
 ", one needs to change the basis so that the eigenstates of ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "6f3b2d26-0916-4422-beba-f30667558be1"],
 " are mapped to the computational basis. Specifically, for the Bell \
measurement (a measurement in the basis of Bell states), the required basis \
change is equivalent to the inverse procedure of building an entanglement as \
discussed above. Therefore, the quantum circuit for the Bell measurement may \
be achieved simply by reversing the order of gates in the entangler circuit."
}], "Text",
 CellID->1578197342,ExpressionUUID->"52b37ffd-1403-43e4-bf2b-85b365b69cf3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[464]:=",
 CellID->1192202897,ExpressionUUID->"e68a9e05-d272-45d6-840b-36e3634897b9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[464]=",
 CellID->1746072306,ExpressionUUID->"b2d0261a-47ae-42ae-9141-3bf08edf1ccb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"BellState", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[465]:=",
 CellID->191673749,ExpressionUUID->"c929f6cc-5594-4d90-aa54-ac5f201b7df6"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], "+", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], "+", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], "-", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], "-", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[467]//TableForm=",
 CellID->198655586,ExpressionUUID->"f683e1f8-2950-49e1-8a5c-ce68653a371a"]
}, Open  ]],

Cell[TextData[{
 "We note that measurement outcomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0", ",", "0"}], ")"}], ",", " ", 
    RowBox[{"(", 
     RowBox[{"0", ",", "1"}], ")"}], ",", " ", 
    RowBox[{"(", 
     RowBox[{"1", ",", "1"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d959c647-e096-4c7e-b447-aad229bff774"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", ",", "0"}], ")"}], TraditionalForm]],ExpressionUUID->
  "e7f1fdef-65e4-466b-9ba6-923a7ca016c0"],
 " corresponds to the Bell states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Beta]", "0"]},
     "Ket"], ",", 
    TemplateBox[{
      SubscriptBox["\[Beta]", "1"]},
     "Ket"], ",", 
    TemplateBox[{
      SubscriptBox["\[Beta]", "2"]},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "792c873a-d1bf-49eb-81e1-8391da8342c7"],
 ", and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Beta]", "3"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "263d53d4-fc22-41e8-bbce-582eccdd5c56"],
 ", respectively."
}], "Text",
 CellID->2122934521,ExpressionUUID->"7f254402-d6a5-45f5-9e93-36d57c3ea54b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 CellID->1867183189,ExpressionUUID->"665dd56a-09c2-4747-8cb4-65af7e5eec7c"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[522]:=",
 CellID->605069054,ExpressionUUID->"48bb5b71-f751-4566-9354-0b624daacafc"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[523]:=",
 CellID->1060522033,ExpressionUUID->"5922d56c-4d8a-4e2c-9deb-6f0d2c9a973d"],

Cell[TextData[{
 StyleBox["Step 1",
  FontWeight->"Bold"],
 ". Alice and Bob generate and share an entangled pair using the quantum \
entangler circuit discussed above."
}], "Text",
 CellID->569323912,ExpressionUUID->"2ad63dc5-33b6-47fd-8769-1e3fd06cd4d0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc1a", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
      RowBox[{"S", "[", "1.5", "]"}]}], ",", 
     RowBox[{"\"\<Visible\>\"", "->", 
      RowBox[{"S", "[", "3", "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Panel", "[", "qc1a", "]"}]}], "Input",
 CellLabel->"In[525]:=",
 CellID->1587341599,ExpressionUUID->"26045eb9-7475-4d9b-8b42-9f3d17864d0a"],

Cell[BoxData[
 PanelBox[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {3, -1}}, {{0, -3}, {3, -3}}, {{0, -4}, {3, -4}}}], {
      InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.10666666666666667`],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.10666666666666667`],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.13333333333333333`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -3}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
          2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->154.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-9, 2], 
        Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`QuantumCircuitIn[
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
    $CellContext`S[1, 6], 
    Q3`CNOT[{
       $CellContext`S[1, Q3`$]} -> {1}, {
      $CellContext`S[2, Q3`$]}], "Invisible" -> $CellContext`S[1.5], 
    "Visible" -> $CellContext`S[3]]]]], "Output",
 CellLabel->"Out[526]=",
 CellID->419919473,ExpressionUUID->"6f4c638c-8bdf-404c-bea5-113c3c8ce564"]
}, Open  ]],

Cell[TextData[{
 "Bob also prepares the quantum state to send to Allice and stores it  in \
Charlie\[CloseCurlyQuote]s qubit ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "a46224e3-0c37-4433-9161-879fecbdec8e"],
 "."
}], "Text",
 CellID->89151289,ExpressionUUID->"ba2dd9ff-e955-4c80-b3e5-a77a6ad43b0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"msg", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}], "//", "KetRegulate"}]}]], "Input",
 CellLabel->"In[527]:=",
 CellID->2061792057,ExpressionUUID->"3c689df2-4e16-4503-8b19-e1950fd71108"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[527]=",
 CellID->814355289,ExpressionUUID->"4a8f02ad-482f-4395-9dd1-b2bd7a43b0bd"]
}, Open  ]],

Cell["This is the quantum circuit that fulfills the tasks so far.", "Text",
 CellID->1694211991,ExpressionUUID->"da65f36b-186d-4b5e-8d08-ceed376191a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"msg", ",", 
      RowBox[{"\"\<Label\>\"", "->", 
       RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "}"}], ",", "qc1a", ",", 
    "\"\<Separator\>\""}], "]"}]}]], "Input",
 CellLabel->"In[528]:=",
 CellID->1135257164,ExpressionUUID->"9a564a23-db9e-4a94-9701-df421bb34f6c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -3}, {4, -3}}, {{0, -4}, {4, -4}}}], {
     InsetBox[
      StyleBox[
       TemplateBox[{"\[Psi]"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{
        3, -4.5}, {3, -0.5}}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[{$CellContext`c[0] 
      Ket[<|$CellContext`S[3, Q3`$] -> 0|>] + $CellContext`c[1] 
      Ket[<|$CellContext`S[3, Q3`$] -> 1|>], "Label" -> 
     Ket[$CellContext`\[Psi]]}, 
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], "Separator", 
   "Invisible" -> $CellContext`S[1.5], 
   "Visible" -> $CellContext`S[3]]]], "Output",
 CellLabel->"Out[528]=",
 CellID->859293260,ExpressionUUID->"655ef570-463c-49e9-a1a1-ac378be1ce41"]
}, Open  ]],

Cell["The overall state at this stage is as follows.", "Text",
 CellID->700603084,ExpressionUUID->"94149fb7-f708-429d-9f48-e6ab176b5418"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out1", "=", 
  RowBox[{"Elaborate", "[", "qc1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"out1", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[529]:=",
 CellID->383196287,ExpressionUUID->"dfea8ec5-e292-4da1-8f8c-ae9154a02355"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"0"},
       "RowDefault"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"c"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[529]=",
 CellID->1399804005,ExpressionUUID->"37d823a8-c814-4da5-b22e-3bfea2dcd2fb"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1|>]]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]], 
               $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[3, Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]], 
               $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[3, Q3`$] -> 1|>]]}]}], ")"}]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>] + 
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1|>], $CellContext`c[0] 
     Ket[<|$CellContext`S[3, Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[3, Q3`$] -> 1|>]]], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[530]=",
 CellID->822559150,ExpressionUUID->"e17eb069-5829-4f7e-a659-a31a93c6c80a"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 2",
  FontWeight->"Bold"],
 ". Bob performs a Bell measurement on his qubits. This can be done by \
reversing the entangler circuit as explained in the above."
}], "Text",
 CellID->1938265960,ExpressionUUID->"fc657542-35f4-4f96-ab86-801b1c092b47"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc2a", "=", 
   RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], ",", "3"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Visible\>\"", "->", 
      RowBox[{"S", "[", "1", "]"}]}], ",", 
     RowBox[{"\"\<Invisible\>\"", "->", 
      RowBox[{"S", "[", "1.5", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Panel", "[", "qc2a", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", "=", 
   RowBox[{"qc2a", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "@", 
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "ls"}], "]"}]}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[531]:=",
 CellID->1256548377,ExpressionUUID->"7072a82b-73b9-429d-89df-83e16814d85d"],

Cell[BoxData[
 PanelBox[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], 
      LineBox[{{{3, -3}, {4, -3}}, {{3, -4}, {4, -4}}}]}, 
     LineBox[{{{0, -1}, {4, -1}}, {{0, -3}, {3, -3}}, {{0, -4}, {3, -4}}}], {
      LineBox[{{1, -3}, {1, -4}}], 
      DiskBox[{1, -3}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
          1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, 
      LineBox[{{1.6, -3.4}, {2.4, -3.4}, {2.4, -2.6}, {1.6, -2.6}, {
       1.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {2, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {{{
        {GrayLevel[1], EdgeForm[None], 
         RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
        LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
         2.6, -3.4}}]}, 
       CircleBox[{3, -3.2}, 0.4, 
        NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
         2.6179938779914944`}]], LineBox[{{3, -3.2}, {3.24, -2.76}}]}, {{
        {GrayLevel[1], EdgeForm[None], 
         RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
        LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
         2.6, -4.4}}]}, 
       CircleBox[{3, -4.2}, 0.4, 
        NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
         2.6179938779914944`}]], LineBox[{{3, -4.2}, {3.24, -3.76}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->190.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-9, 2], 
        Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`CNOT[{
       $CellContext`S[2, Q3`$]} -> {1}, {
      $CellContext`S[3, Q3`$]}], 
    $CellContext`S[2, 6], 
    Q3`Measurement[{
      $CellContext`S[2, 3], 
      $CellContext`S[3, 3]}], "Visible" -> $CellContext`S[1], 
    "Invisible" -> $CellContext`S[1.5]]]]], "Output",
 CellLabel->"Out[532]=",
 CellID->1669976044,ExpressionUUID->"c1f52362-e6bf-4ae0-b4c1-1b8178efe8a8"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
            0|>]], "+", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            1|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
            1|>]], "+", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            0|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
            1|>]], "-", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            0|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
            0|>]], "-", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"3"}, "RowDefault"]], 
                $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
            1|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[535]//TableForm=",
 CellID->1823588865,ExpressionUUID->"cf5bb7ce-585e-4f55-beb5-b5af9306b5df"]
}, Open  ]],

Cell["The overall quantum circuit so far is as follows.", "Text",
 CellID->551325794,ExpressionUUID->"243986b2-66a5-436a-ac80-ca76d53462e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc1", ",", "qc2a", ",", "\"\<Separator\>\""}], "]"}]}]], "Input",
 CellLabel->"In[536]:=",
 CellID->1888166600,ExpressionUUID->"f8883b90-2daa-4894-b29d-9644530f585e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{6, -3}, {8, -3}}, {{6, -4}, {8, -4}}}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -3}, {6, -3}}, {{0, -4}, {6, -4}}}], {
     InsetBox[
      StyleBox[
       TemplateBox[{"\[Psi]"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{
        3, -4.5}, {3, -0.5}}]]}, {LineBox[{{4, -3}, {4, -4}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
         4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]},
        LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
        5.6, -3.4}}]}, 
      CircleBox[{6, -3.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{6, -3.2}, {6.24, -2.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]},
        LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
        5.6, -4.4}}]}, 
      CircleBox[{6, -4.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{6, -4.2}, {6.24, -3.76}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{7, Rational[-9, 2]}, {7, Rational[-1, 2]}}, {{
        7, -4.5}, {7, -0.5}}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->334.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[{$CellContext`c[0] 
      Ket[<|$CellContext`S[3, Q3`$] -> 0|>] + $CellContext`c[1] 
      Ket[<|$CellContext`S[3, Q3`$] -> 1|>], "Label" -> 
     Ket[$CellContext`\[Psi]]}, 
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], "Separator", 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   $CellContext`S[2, 6], 
   Q3`Measurement[{
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]}], "Separator", "Invisible" -> $CellContext`S[1.5], 
   "Visible" -> $CellContext`S[3], "Visible" -> $CellContext`S[1], 
   "Invisible" -> $CellContext`S[1.5]]]], "Output",
 CellLabel->"Out[536]=",
 CellID->797534236,ExpressionUUID->"326b4a0f-a537-4880-be6d-f9327ab26f75"]
}, Open  ]],

Cell["\<\
This is the state of the total system expected at this stage.\
\>", "Text",
 CellID->450547474,ExpressionUUID->"d593f302-91de-4abc-8bd6-3321fc8d21e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"normalizationRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"c", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"c", "[", "1", "]"}], "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"c", "[", "1", "]"}], "]"}]}]}], "->", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out2", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", "qc2", "]"}], "/.", 
    "normalizationRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out2", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[497]:=",
 CellID->324056196,ExpressionUUID->"29f0b595-b158-443e-b72c-29f7f12e5542"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[$CellContext`c[1] 
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[0] 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
      1|>]]]}]], "Output",
 CellLabel->"Out[499]=",
 CellID->736776562,ExpressionUUID->"2d86d0b0-00a7-4e93-bfc1-9582ee2caaa2"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 3",
  FontWeight->"Bold"],
 ". Bob sends the measurement outcome to Alice through a classical channel.\n",
 StyleBox["Step 4",
  FontWeight->"Bold"],
 ". Alice applies a proper unitary gate on her qubit in accordance with Bob\
\[CloseCurlyQuote]s message. These two steps are simulated by a feedback \
control."
}], "Text",
 CellID->549601959,ExpressionUUID->"0261fa4f-d3da-4266-bbf6-e59571eeea7d"],

Cell["\<\
Combining all the steps, one can transmit a quantum state to a remote party \
without a quantum channel.\
\>", "Text",
 CellID->158133487,ExpressionUUID->"0fcc0174-8b06-4499-bfe5-42fa39f92f2c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc2", ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1.5", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[500]:=",
 CellID->1612209499,ExpressionUUID->"1055f01f-5a2e-4abc-be29-55c202e6e7ae"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{6, -3}, {10, -3}}, {{6, -4}, {10, -4}}}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {6, -3}}, {{0, -4}, {6, -4}}}], {
     InsetBox[
      StyleBox[
       TemplateBox[{"\[Psi]"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.03200000000000001],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{
        3, -4.5}, {3, -0.5}}]]}, {LineBox[{{4, -3}, {4, -4}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
         4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]},
        LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
        5.6, -3.4}}]}, 
      CircleBox[{6, -3.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{6, -3.2}, {6.24, -2.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]},
        LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
        5.6, -4.4}}]}, 
      CircleBox[{6, -4.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{6, -4.2}, {6.24, -3.76}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{7, Rational[-9, 2]}, {7, Rational[-1, 2]}}, {{
        7, -4.5}, {7, -0.5}}]]}, {LineBox[{{8, -3}, {8, -1}}], 
     DiskBox[{8, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, 
     LineBox[{{7.6, -1.4}, {8.4, -1.4}, {8.4, -0.6}, {7.6, -0.6}, {
      7.6, -1.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -4}, {9, -1}}], 
     DiskBox[{9, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, 
     LineBox[{{8.6, -1.4}, {9.4, -1.4}, {9.4, -0.6}, {8.6, -0.6}, {
      8.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[{$CellContext`c[0] 
      Ket[<|$CellContext`S[3, Q3`$] -> 0|>] + $CellContext`c[1] 
      Ket[<|$CellContext`S[3, Q3`$] -> 1|>], "Label" -> 
     Ket[$CellContext`\[Psi]]}, 
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], "Separator", 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   $CellContext`S[2, 6], 
   Q3`Measurement[{
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]}], "Separator", 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[1, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    $CellContext`S[1, 1]], "Invisible" -> $CellContext`S[1.5], 
   "Visible" -> $CellContext`S[3], "Visible" -> $CellContext`S[1], 
   "Invisible" -> $CellContext`S[1.5], 
   "Invisible" -> $CellContext`S[1.5]]]], "Output",
 CellLabel->"Out[500]=",
 CellID->1694038429,ExpressionUUID->"ad47c0ca-dec0-4710-b11d-64afda13e692"]
}, Open  ]],

Cell["This is the final state of the total system.", "Text",
 CellID->98808169,ExpressionUUID->"99494841-5ccc-491c-bbf8-a615c2383fc6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", "qc", "]"}], "/.", "normalizationRules"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[501]:=",
 CellID->629111375,ExpressionUUID->"ddb8b835-971e-499e-a2ae-31ccf573cf56"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[$CellContext`c[0] 
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
      1|>]]]}]], "Output",
 CellLabel->"Out[502]=",
 CellID->79002155,ExpressionUUID->"b563fb95-6a76-4416-88bd-3b76bf7dd86c"]
}, Open  ]],

Cell[TextData[{
 "Note that the Bell measurement outcomes are uniformed distributed, and the \
state resulting in Alice\[CloseCurlyQuote]s qubit is always the same as the \
original quantum state (",
 StyleBox["msg", "Input"],
 ") regardless of the measurement outcome."
}], "Text",
 CellID->1580905,ExpressionUUID->"177e7dd9-ef1c-4137-9da1-ed20a081f1ec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ExpressionFor", "[", "qc", "]"}], "/.", 
        "normalizationRules"}], ";", 
       RowBox[{"Readout", "[", 
        RowBox[{"S", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], ",", "3"}], "]"}], "]"}]}], ",", 
      "300"}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram3D", "[", 
  RowBox[{"data", ",", 
   RowBox[{"Ticks", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(Z\), \(2\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Z\), \(3\)]\)\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[503]:=",
 CellID->800466571,ExpressionUUID->"ff33ff11-83c8-469f-88b8-267be03d196e"],

Cell[BoxData["7.974717`"], "EchoTiming",
 CellID->1221222170,ExpressionUUID->"2e99954e-92a4-42a2-8da1-794e520611bd"],

Cell[BoxData[
 Graphics3DBox[
  {RGBColor[0.9045776, 0.6888327999999999, 0.31364080000000005`], EdgeForm[
   RGBColor[0.880722, 0.611041, 0.142051]], 
   StyleBox[{{}, 
     {RGBColor[0.9045776, 0.6888327999999999, 0.31364080000000005`], EdgeForm[
      RGBColor[0.880722, 0.611041, 0.142051]], 
      StyleBox[{
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{-0.5, -0.5, 0.}, {0.5, 0.5, 85.}]},
              
              ImageSizeCache->{{46.60178333544468, 
               146.65176681030385`}, {-50.3149364166789, 48.0657679492386}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 85]& ,
           TagBoxNote->"85"],
          StyleBox["85", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[85, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{-0.5, 0.5, 0.}, {0.5, 1.5, 76.}]},
              
              ImageSizeCache->{{87.64667410298425, 
               176.21010625394155`}, {-73.92468506139934, 8.501421429987985}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 76]& ,
           TagBoxNote->"76"],
          StyleBox["76", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[76, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{0.5, -0.5, 0.}, {1.5, 0.5, 72.}]},
              
              ImageSizeCache->{{108.43812734547276`, 
               210.18182276516507`}, {-26.581187503110215`, 
               73.28059775807465}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 72]& ,
           TagBoxNote->"72"],
          StyleBox["72", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[72, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{0.5, 0.5, 0.}, {1.5, 1.5, 67.}]},
              
              ImageSizeCache->{{144.65176681030385`, 
               234.69434106587408`}, {-55.32588583822106, 
               28.922706531616946`}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 67]& ,
           TagBoxNote->"67"],
          StyleBox["67", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[67, {"Graphics3DLabel"}], "Tooltip"]& ]},
       FontColor->GrayLevel[0.4]]}, {}, {}},
    FontColor->GrayLevel[0.4]]},
  Axes->{True, True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\\!\\(\\*SubscriptBox[\\(Z\\), \\(2\\)]\\)\"", HoldForm], 
     TraditionalForm], 
    FormBox[
     TagBox["\"\\!\\(\\*SubscriptBox[\\(Z\\), \\(3\\)]\\)\"", HoldForm], 
     TraditionalForm], 
    FormBox[
     TagBox["\"Counts\"", HoldForm], TraditionalForm]},
  AxesStyle->{},
  BoxRatios->{1, 1, 0.4},
  FaceGridsStyle->Automatic,
  ImageSize->Automatic,
  Lighting->"Neutral",
  Method->{"RotationControl" -> "Globe"},
  PlotRange->{{-0.5, 1.5}, {-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.1]}},
  Ticks->{{{0, 
      FormBox["0", TraditionalForm]}, {1, 
      FormBox["1", TraditionalForm]}}, {{0, 
      FormBox["0", TraditionalForm]}, {1, 
      FormBox["1", TraditionalForm]}}, Automatic}]], "Output",
 CellLabel->"Out[504]=",
 CellID->1579796811,ExpressionUUID->"5697eece-b7de-461e-a5c2-3aef85f21415"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Applications", "Section",
 CellID->534588153,ExpressionUUID->"33ec6e84-e8de-4c3c-8ce9-799dce3a3c85"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[505]:=",
 CellID->1368600113,ExpressionUUID->"1994c13a-8406-47fe-8154-2a335d7d434c"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[506]:=",
 CellID->364756174,ExpressionUUID->"8e4dea32-2063-4c94-9a1b-d9943df3a134"],

Cell["\<\
As mentioned at the beginning, quantum teleportation is not only interesting \
in its own right but also used as part of various quantum algorithms. In \
fact, universal quantum computation based solely on quantum teleportation is \
possible (Gottesman and Chuang, 1999; Nielsen, 2003; Leung, 2004). For \
photonic quantum computers, this is vital because photons do not interact \
with each other and hence the CNOT gate is impossible with usual linear \
optics (Knill, Laflamme, and Milburn, 2001).\
\>", "Text",
 CellID->92429197,ExpressionUUID->"376f49a1-c60c-4847-b12c-e640b81c702f"],

Cell["\<\
\tThe CNOT gate can be achieved using the quantum teleportation (Gottesman \
and Chuang, 1999). The quantum circuit in Figure 1 summarizes the procedure. \
Below, we analyse the quantum circuit in detail.\
\>", "Text",
 CellID->1611475377,ExpressionUUID->"26bef74c-1864-4102-a00a-9d8e2ffc6499"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {12, -1}}, {{4, -2}, {12, -2}}, {{4, -5}, {12, -5}}, {{
     4, -6}, {12, -6}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {12, -3}}, {{
    0, -4}, {12, -4}}, {{0, -5}, {4, -5}}, {{0, -6}, {4, -6}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"\"x\""},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"\"y\""},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light"], {-0.1, -6}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {{
      BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.46875}, {-0.1625, \
-3.4375}, {-0.1625, -2.0625}, {-0.1625, -2.03125}, {-0.1, -2.}}], 
      BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.53125}, {-0.1625, \
-3.5625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"\[Chi]\""},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light"], {-0.325, -3.5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{1, Rational[-13, 2]}, {1, Rational[-1, 2]}}, {{
       1, -6.5}, {1, -0.5}}]]}, {{LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -5}, {2, -6}}], 
     DiskBox[{2, -5}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, 
     LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
      2.6, -5.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {{{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
      LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
       3.6, -1.4}}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
      LineBox[{{3.6, -2.4}, {4.4, -2.4}, {4.4, -1.6}, {3.6, -1.6}, {
       3.6, -2.4}}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -5.4}, {4.4, -4.6}]}, 
      LineBox[{{3.6, -5.4}, {4.4, -5.4}, {4.4, -4.6}, {3.6, -4.6}, {
       3.6, -5.4}}]}, 
     CircleBox[{4, -5.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -5.2}, {4.24, -4.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -6.4}, {4.4, -5.6}]}, 
      LineBox[{{3.6, -6.4}, {4.4, -6.4}, {4.4, -5.6}, {3.6, -5.6}, {
       3.6, -6.4}}]}, 
     CircleBox[{4, -6.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -6.2}, {4.24, -5.76}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{5, Rational[-13, 2]}, {5, Rational[-1, 2]}}, {{
       5, -6.5}, {5, -0.5}}]]}, {LineBox[{{6, -2}, {6, -4}}], 
    DiskBox[{6, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
    LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
     5.6, -4.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03333333333333333],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -2}, {7, -3}}], 
    DiskBox[{7, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
    LineBox[{{6.6, -3.4}, {7.4, -3.4}, {7.4, -2.6}, {6.6, -2.6}, {
     6.6, -3.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03333333333333333],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -1}, {8, -3}}], 
    DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, 
    LineBox[{{7.6, -3.4}, {8.4, -3.4}, {8.4, -2.6}, {7.6, -2.6}, {
     7.6, -3.4}}], InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03333333333333333],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -6}, {9, -4}}], 
    DiskBox[{9, -6}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, 
    LineBox[{{8.6, -4.4}, {9.4, -4.4}, {9.4, -3.6}, {8.6, -3.6}, {
     8.6, -4.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03333333333333333],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{10, -5}, {10, -4}}], 
    DiskBox[{10, -5}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, 
    LineBox[{{9.6, -4.4}, {10.4, -4.4}, {10.4, -3.6}, {9.6, -3.6}, {
     9.6, -4.4}}], InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03333333333333333],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{11, -5}, {11, -3}}], 
    DiskBox[{11, -5}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{10.6, -3.4}, {11.4, -2.6}]}, 
    LineBox[{{10.6, -3.4}, {11.4, -3.4}, {11.4, -2.6}, {10.6, -2.6}, {
     10.6, -3.4}}], InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03333333333333333],
      FontWeight->"Light",
      FontSlant->Italic], {11, -3}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {InsetBox[
     StyleBox[
      TemplateBox[{"\"x\""},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light"], {12.1, -3}, NCache[
     ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"\"x\[CirclePlus]y\""},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light"], {12.1, -4}, NCache[
     ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->478.8,
  PlotRange->NCache[{Full, {
      Rational[-13, 2], 
      Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Text",
 TextAlignment->Center,
 CellID->1813710902,ExpressionUUID->"a831faa7-5619-418d-abdc-2f909ac5234a"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ": A quantum circuit to realize the CNOT gate using quantum teleportation. \
The first and last qubits are the control and target qubits, respectively, \
and the result is stored in the third and forth qubits, respectively. Here, \
the two Bell measurements (between the vertical dashed lines) are implemented \
through the usual gate operations and measurements in the computational \
basis. In realistic situations, however, they are achieved \
(non-deterministically in many cases) using special measurement devices (such \
as parity measurement)."
}], "Caption",
 CellID->2117616808,ExpressionUUID->"946ff3f0-eeea-4746-a930-e435a4167620"],

Cell["\<\
First, generate the entanglement in the ancillary quantum register.\
\>", "MathCaption",
 CellID->1018270130,ExpressionUUID->"dc33b546-b975-4efe-b7df-02bec4228032"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"entangler", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "4", "]"}], ",", 
        RowBox[{"S", "[", "5", "]"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[508]:=",
 CellID->1376831930,ExpressionUUID->"ba1f1d48-dcd1-4923-8652-b838eccd8555"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -4}, {5, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {{LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{2, -3}, {2, -4}}], 
      DiskBox[{2, -3}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
          2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{
        3, -4.5}, {3, -0.5}}]]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
      0, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 0|>]], {
    $CellContext`S[2, 6], 
    $CellContext`S[4, 6]}, {
    Q3`CNOT[{
       $CellContext`S[2, Q3`$]} -> {1}, {
      $CellContext`S[3, Q3`$]}], 
    Q3`CNOT[{
       $CellContext`S[4, Q3`$]} -> {1}, {
      $CellContext`S[5, Q3`$]}]}, "Separator", 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[508]=",
 CellID->138188345,ExpressionUUID->"2619e3a0-1f42-49e8-af72-d2ec07e6acbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chi", "=", 
   RowBox[{"Elaborate", "[", "entangler", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"KetFactor", "[", 
  RowBox[{"chi", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[509]:=",
 CellID->1149330186,ExpressionUUID->"777c8158-acbf-464b-a8f9-d39204ed8b69"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   RowBox[{
    TagBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>]],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]], 
               $CellContext`S[4, Q3`$]]], 
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"5"}, "RowDefault"]], 
               $CellContext`S[5, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 
           0|>]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]], 
               $CellContext`S[4, Q3`$]]], 
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"5"}, "RowDefault"]], 
               $CellContext`S[5, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 
           1|>]]}]}],
      HoldForm], ")"}]}],
   Q3`OSlash[
    Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>], 
    Rational[1, 2] 
     Ket[<|$CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 0|>] + 
    Rational[1, 2] 
     Ket[<|$CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>]]], 
  "+", 
  InterpretationBox[
   RowBox[{
    TagBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 1|>]],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]], 
               $CellContext`S[4, Q3`$]]], 
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"5"}, "RowDefault"]], 
               $CellContext`S[5, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 
           1|>]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]], 
               $CellContext`S[4, Q3`$]]], 
             SubscriptBox["0", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"5"}, "RowDefault"]], 
               $CellContext`S[5, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 
           0|>]]}]}],
      HoldForm], ")"}]}],
   Q3`OSlash[
    Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 1|>], 
    Rational[1, 2] 
     Ket[<|$CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 1|>] + 
    Rational[1, 2] 
     Ket[<|$CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 
        0|>]]]}]], "Output",
 CellLabel->"Out[510]=",
 CellID->842641301,ExpressionUUID->"5e82665c-b180-49ce-a38e-908a2ce6e7ae"]
}, Open  ]],

Cell["\<\
Here is the core part of the quantum circuit to implement the CNOT gate using \
quantum teleportation.\
\>", "MathCaption",
 CellID->1088805765,ExpressionUUID->"d5559424-0fdb-4f67-9f93-9ac89a8fca08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"core", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "5", "]"}], ",", 
        RowBox[{"S", "[", "6", "]"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}], ",", "3"}], "]"}],
      "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "1"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "6", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "5", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "5", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[511]:=",
 CellID->69120072,ExpressionUUID->"98ec1ece-d7a4-4550-bcb5-f5edc6af809a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{3, -1}, {10, -1}}, {{3, -2}, {10, -2}}, {{3, -5}, {
      10, -5}}, {{3, -6}, {10, -6}}}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {10, -3}}, {{
     0, -4}, {10, -4}}, {{0, -5}, {3, -5}}, {{0, -6}, {
     3, -6}}}], {{LineBox[{{1, -1}, {1, -2}}], 
      DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
          1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
      LineBox[{{1, -5}, {1, -6}}], 
      DiskBox[{1, -5}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
          1, -6.266666666666667}, {1, -5.733333333333333}}}]}}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
      LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
       1.6, -5.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]},
        LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
        2.6, -1.4}}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]},
        LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
        2.6, -2.4}}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]},
        LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
        2.6, -5.4}}]}, 
      CircleBox[{3, -5.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -5.2}, {3.24, -4.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -6.4}, {3.4, -5.6}]},
        LineBox[{{2.6, -6.4}, {3.4, -6.4}, {3.4, -5.6}, {2.6, -5.6}, {
        2.6, -6.4}}]}, 
      CircleBox[{3, -6.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -6.2}, {3.24, -5.76}}]}}, {
     LineBox[{{4, -2}, {4, -4}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -3}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, 
     LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
      5.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -6}, {7, -4}}], 
     DiskBox[{7, -6}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -5}, {8, -4}}], 
     DiskBox[{8, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, 
     LineBox[{{7.6, -4.4}, {8.4, -4.4}, {8.4, -3.6}, {7.6, -3.6}, {
      7.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -5}, {9, -3}}], 
     DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     LineBox[{{8.6, -3.4}, {9.4, -3.4}, {9.4, -2.6}, {8.6, -2.6}, {
      8.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-13, 2], 
       Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    Q3`CNOT[{
       $CellContext`S[1, Q3`$]} -> {1}, {
      $CellContext`S[2, Q3`$]}], 
    Q3`CNOT[{
       $CellContext`S[5, Q3`$]} -> {1}, {
      $CellContext`S[6, Q3`$]}]}, {
    $CellContext`S[1, 6], 
    $CellContext`S[5, 6]}, 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[5, 3], 
     $CellContext`S[6, 3]}], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[3, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[6, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[4, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]]]]], "Output",
 CellLabel->"Out[511]=",
 CellID->1100065657,ExpressionUUID->"f9ca494b-7042-43a0-8aa4-bfdedf1e6bc5"]
}, Open  ]],

Cell["\<\
Let us construct a small subroutine to facilitate the test of the above \
quantum circuit.\
\>", "MathCaption",
 CellID->627577103,ExpressionUUID->"f0b23c22-93dc-4e66-a991-60873c712c46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"qtCNOT", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", "=", 
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], "->", "x"}], ",", 
        RowBox[{
         RowBox[{"S", "[", "6", "]"}], "->", "y"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qc", "=", 
      RowBox[{"QuantumCircuit", "[", 
       RowBox[{"in", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"chi", ",", 
          RowBox[{"\"\<Label\>\"", "->", 
           RowBox[{"Ket", "[", "\"\<\[Chi]\>\"", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", "core"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "qc", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"KetRegulate", "[", 
        RowBox[{
         RowBox[{"KetDrop", "[", 
          RowBox[{
           RowBox[{"Elaborate", "[", "qc", "]"}], ",", 
           RowBox[{"S", "@", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}]}]}], "]"}], 
         ",", 
         RowBox[{"S", "@", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4"}], "}"}]}]}], "]"}], ",", "20"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[537]:=",
 CellID->1746593056,ExpressionUUID->"57b47f85-53e7-4d2f-9108-1c3d45189d6c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qtCNOT", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0"}], "}"}], "]"}]], "Input",
 CellLabel->"In[538]:=",
 CellID->150274438,ExpressionUUID->"9e6472e6-80c4-4493-afbd-ed44842edf14"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{3, -1}, {10, -1}}, {{3, -2}, {10, -2}}, {{3, -5}, {
      10, -5}}, {{3, -6}, {10, -6}}}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {10, -3}}, {{
     0, -4}, {10, -4}}, {{0, -5}, {3, -5}}, {{0, -6}, {3, -6}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.46875}, {-0.1625, \
-3.4375}, {-0.1625, -2.0625}, {-0.1625, -2.03125}, {-0.1, -2.}}], 
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.53125}, {-0.1625, \
-3.5625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Chi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.325, -3.5}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      LineBox[{{1, -1}, {1, -2}}], 
      DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
          1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
      LineBox[{{1, -5}, {1, -6}}], 
      DiskBox[{1, -5}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
          1, -6.266666666666667}, {1, -5.733333333333333}}}]}}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
      LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
       1.6, -5.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]},
        LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
        2.6, -1.4}}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]},
        LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
        2.6, -2.4}}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]},
        LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
        2.6, -5.4}}]}, 
      CircleBox[{3, -5.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -5.2}, {3.24, -4.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -6.4}, {3.4, -5.6}]},
        LineBox[{{2.6, -6.4}, {3.4, -6.4}, {3.4, -5.6}, {2.6, -5.6}, {
        2.6, -6.4}}]}, 
      CircleBox[{3, -6.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -6.2}, {3.24, -5.76}}]}}, {
     LineBox[{{4, -2}, {4, -4}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -3}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, 
     LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
      5.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -6}, {7, -4}}], 
     DiskBox[{7, -6}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -5}, {8, -4}}], 
     DiskBox[{8, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, 
     LineBox[{{7.6, -4.4}, {8.4, -4.4}, {8.4, -3.6}, {7.6, -3.6}, {
      7.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -5}, {9, -3}}], 
     DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     LineBox[{{8.6, -3.4}, {9.4, -3.4}, {9.4, -2.6}, {8.6, -2.6}, {
      8.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-13, 2], 
       Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>], {
    Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 0|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 0|>], 
     "Label" -> Ket["\[Chi]"]}], {
    Q3`CNOT[{
       $CellContext`S[1, Q3`$]} -> {1}, {
      $CellContext`S[2, Q3`$]}], 
    Q3`CNOT[{
       $CellContext`S[5, Q3`$]} -> {1}, {
      $CellContext`S[6, Q3`$]}]}, {
    $CellContext`S[1, 6], 
    $CellContext`S[5, 6]}, 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[5, 3], 
     $CellContext`S[6, 3]}], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[3, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[6, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[4, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]]]]], "Echo",
 CellID->1910444916,ExpressionUUID->"c63e01ca-ad51-443f-8d6c-1fd2c8cf4944"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJzt3XtsFOXewPHtbhHSgnLxBA6WVCy1UWNQIEoUaF5EhYrl0uAK2krVctHG
NtD4pjlWoxU9wcQLFC9BzLFqCF7IqbFoCDEoAvoHlrRKtNxUBAlV0FPogRY7
7/N2wpNxdjs7052ZZ7f7/STH0N1hf7PfH9OTXdcy9v6K+UuCgUBg5SDxj/ml
//s/K1aUVhcNFV8seGTl8qWPlD0465GqsqVlKybfHxI3zhX/u2JAIPD/v9YA
AAAAAAAAAAAAAAAAAAAAACmmoaGhuLj49ttvtz7sb3/7mz/nk8gqKipefPFF
1WcRA5vSFG2K8hrl1eG7U7LgGlGFayRZcI2oQnlVKK+Kp+VLSkoGDRq0bNmy
jRs3Wh/JLoQXXnhh/Pjxqs8iBjalKdoU5TXKq8N3p2TBNaIK10iy4BpRhfKq
UF4V78pv3bpVvMTes2ePnYPZhXDo0KFAICD+qfpErLApTdGmKK9RXh2+OyUL
rhFVuEaSBdeIKpRXhfKqeFd+1apVM2bMsHkwu9CNHz/++eefV30WVtiUzv9N
UV5HeVX47pQsuEZU4RpJFlwjqlBeFcqr4lH5f/zjHwsXLrR5MLvQPfHEE9Om
TVN9FlbYlM7/TVFeR3lV+O6ULLhGVOEaSRZcI6pQXhXKq+JReXdfZbe0tDz6
6KPiPK+55prFixe/9dZbcZ9gDP5PFPbu3RsKhdra2nyY1TdsSuf/piivo7yS
iRrfnfokRTZFeR3XSB+kyKYor6O8koka5RVN1Dwr7+Kr7C1btgwePDjwV6Wl
pZ2dnW6caUJMlC6//PINGzZ4PaXP2JTk86YoL1E+Rco7xaYkrpEUKe8Um5K4
RiivUd5LlJe8KO/Wq+z9+/eHQiGR4s4772xqajp69GhdXV16erq4pbq62qWT
VTzRqLKyUsz1ekqfsSnJ501RXqJ8ipR3ik1JXCMpUt4pNiVxjVCe8p6ivORF
ebdeZZeXl4sIU6dONb7b8MYbb4gbhw0bdvr06XhPNAEmGm3fvn3QoEFeT+kz
NiX5vCnKS5RPkfJOsSmJayRFyjvFpiSuEcpT3lOUl7wo78qr7DNnzmRmZooI
H3zwgfH2rq6uUaNGidvXr18f74mqnmhy/vz5Sy+91DQ9cbApyedNUV6ifIqU
d4pNSVwjKVLeKTYlcY1QnvKeorzkRXlXXmV/++234ulnZGREfmz+4YcfFndV
VFTEdZYJMDFSaWnpvffe6/WUvmFTRn5uivJGlPdnYiS+O9mRapuivBHXiB2p
tinKG1Hen4mRKO/PxEiul3flVfbWrVvF0x83bpzW81ZATU3NokWLvvnmG/Hl
6tWrxV1FRUVunbCqiZEaGhqGDRvW1dXl9aA+YFNGfm6K8kaUT4XyTrEpI66R
VCjvFJsy4hqhPOW9Q3kj18s/+OCD999/v82De9uF/pn5KVOmiF83NjYGesyZ
M0d8WV9fL349efJk0285depUU1PTyZMn+3ba/k+M1NHRkZmZuW3bNrce0EVs
ysjPTVHeiPKpUN4pNmXENZIK5Z1iU0ZcI5SnvHcob+Ru+T///HPkyJH/+te/
bB7f2y5eeeUV8fSnT5+u9fwMdr3M7NmzxZebNm0Sv77uuuvkwfv377/11lsD
F4wbN04c4/TM/Z8Y1fz588vLy115KHexKRPfNkV5E8r3+/JOsSkTrpF+X94p
NmXCNUJ5jfLeoLyJW+U///zzcDgs8h4/ftzmb+ltFw0NDeI5XnvttdqFf8t/
33336f+Wf+3ateKuO+64Qz/y7Nmzubm5aWlp99xzz2uvvfbUU09deeWV4oDd
u3c7Onn/J0ZVX1+flZUV/+NE6u7u/rN3MX87mzLxblMmlDehfP8rz3enZNmU
CeVNuEZi6vebMqG8CeUpr1HeuRMnTojzyczM/PHHH+3/rt52sWfPHvFoUe99
7LHHxF1LlizRv9y1a5cxlNbzM+U2btzo5NzVTIzq8OHD4sEPHTrkyqMZGd+i
iRRzIpsy8W5TJpQ3obwPE6Piu1NM/X5TJpQ34RqJqd9vyoTyJpT3YWJUlPdh
YlSulO/q6lq7dq147X/VVVe1t7fb/F297aKtrS0tLU2c1d69e0133XDDDeL2
Z555Rv9S/wxA/P8u3v+JUYmdjho1qru72/VHPnbsWGvvYr4ZzqZMvNuUCeVN
KO/DxKj47hRTv9+UCeVNuEZi6vebMqG8CeV9mBgV5X2YGJWL5c+dO3fxxRdv
3rzZ5vEWf3f5zJkzI59yc3OzuDEYDMr3BE6ePDlixAiRsbKy8qeffop8nK+/
/nr58uWiZ25u7qxZs959912vJ0qdnZ1lZWVFRUW//fabxWFG4XBYvrUS1Xff
fZefny9O4K677hK1bT5s/NiUiW+borwJ5eOZKCVyeafYlAnXSDwTpUQu7xSb
MuEaiWeiRHnKR6K8ibvlFy5cKJ67zdEWu/j4449FhFAo9Pbbb+u3HDt2LC8v
T9w4b94845E7d+7Mzs7WDxZP/IsvvpB3vfrqq+JGcebi9jlz5mRkZIjDVq1a
5d1EI7HWQA+bnxPQ36PYsmWLxTHFxcWBC/z8WaZsysjPTVHeiPKpUN4pNmXE
NZIK5Z1iU0ZcI5SnfCTKJ0V5V/6+bK3nZ32UlJSIiWlpaRMnTiwoKBDnKb4c
M2bM999/H/ks3nzzzUmTJuknGQ6H9XcDWltbxcm0tbXphx04cCAYDF522WXe
TZTEQsXtYpb458GDB+3U+OSTT4YMGXL27FmLY1asWCF38fjjj9t5WFewKSM/
N0V5I8qnQnmn2JQR10gqlHeKTRlxjVCe8pEonxTl3XqVrfXEqampGT58uD46
PT09Pz//559/tvgtO3bsuP766wOGD9ubiHsHDx58/vx5Tyc2NzdnZGRMmDCh
trY2YPsdj2XLli1YsMD6mB9++GHevHn66T3wwAN2HtYVbMrIz01R3ojyqVDe
KTZlxDWSCuWdYlNGXCOUp3wkyltPTJDyLr7K1ok++/bt271795kzZ+w8pkgn
zvO2226LvGvTpk0i70MPPeTpxN9//z03N3fEiBGHDx9++umnbe5CDB09evQ7
77xjZ2JhYWGg9w9IeIFNGYf6uSnKG4dSPhXKO8WmjEO5RlKhvFNsyjiUa4Ty
8pQob0L5qBMTp7zrr7Ktbd++vaqqqqOjQ96yefNmcZ7FxcXylsbGxoKCgrFj
x4pFVFZWnjp1yruJIuncuXPFoE8//VR8aX8XX3311YABA+yc2x9//DFw4EDx
sJ999lkcz8MZNiX5vCnKS5SPc2KylHeKTUlcI3FOTJbyTrEpiWskzomUp7w1
yktelPf5VXY4HBZnlZOTs3LlynXr1pWVlYnHFCl27NghjxGtbr755jFjxogj
p02bFvkT3V2c+Oyzz4p716xZox9sfxfV1dUzZsyIedjBgwdvvPFG8ZjTp0+P
51k4xaYknzdFeYnycU5MlvJOsSmJayTOiclS3ik2JXGNxDmR8pS3RnnJi/I+
v8ru7u5++eWX8/LygsFgoIf4dWNjY9SDd+3aJTYyfPjwX375xYuJ4vFDodDQ
oUOfvOCWW24RB1RWVj733HPWD3v11VfX1dVZH7Nz5079P9ufMmWK9Y+adx2b
knzeFOUlysczMYnKO8WmJK6ReCYmUXmn2JTENRLPRMpTPibKS16U9/lVttTe
3t7U1CR/6FxvXn/9dfFc6uvrvZj43nvvjf2rzMxMMS4rK2vSpEkWD9Xa2ioO
O3LkiPXEAwcOiEWvW7fOh79W3oRN6fzfFOV1lI9zYhKVd4pN6bhG4pyYROWd
YlM6rpE4J1LeAuV1lNd5VF7Vq+yoPvzww5aWFuMt1dXV4lmL2z2dK9n8XMHq
1asnTpxo5wFPnz7txnk5xqZ0/m+K8jrKuy5hyzvFpnRcI65L2PJOsSkd14jr
KC9RXkd5nUfln3zyydmzZ9s82NNddHZ2ZmdnX3TRRUuXLq2vr//oo4/Ky8uD
wWBOTk57e7t3c41s7uKmm26qra3155T6hk3p/N8U5XWUd13ClneKTem4RlyX
sOWdYlM6rhHXUZ7yJpTXeVR+8+bNl1xyyY8//mjnYK/f8Thx4kRJScnIkSP1
j9mnpaUVFhba/JvEXaH/J/PWuzh+/Lj4E2J6ZybRsClN0aYor1HeGwlb3ik2
pXGNeCNhyzvFpjSuEW9QnvImlNe8LN/V1TV16tSsrKw1a9Y0NTVZH+z1LqSj
R482Nzf79kaHI+vXr8/JyVF9FjGwKU3RpiivUV4dvjsZsSkTymtcI3/Fpkwo
r1FeHcqr4mn5jo4O8Up/woQJ2dnZ1kf6totEFg6Hq6qqVJ9FDGxKU7QpymuU
V4fvTsmCa0QVrpFkwTWiCuVVobwqCfL/C+wiWbApVSivCuWTBZtShfLJgk2p
QnlVKK8K5RMHu0gWbEoVyqtC+WTBplShfLJgU6pQXhXKq0L5xMEukgWbUoXy
qlA+WbApVSifLNiUKpRXhfKqUB4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAA4sFPfRcqKipefPFF1WcRA5vS2FTyULIpymuUV4fyqlBeFcqr
QnlVKK+KzfJ1dXWFhYX//Oc///Of//hwVjGxO+GFF14YP3686rOIgU1pbCp5
KNkU5TXKq0N5VSivCuVVobwqlFfFZvmWlhbxEjsnJ+fvf//7kSNHfDgxa+xO
OHToUCAQEP9UfSJW2JTGppKHkk1RXqO8OpRXhfKqUF4VyqtCeVUclT937lx+
fv7dd9/t9VnFxO5048ePf/7551WfhRU2pWNTycL/TVFeR3lVKK8K5VWhvCqU
V4Xyqjgq//7772dnZ3t5OrawO90TTzwxbdo01WdhhU3p2FSy8H9TlNdRXhXK
q0J5VSivCuVVobwqjspv37790ksv9fR87Ii5u5aWlkcffVQ8r2uuuWbx4sVv
vfWW16fk/0Rh7969oVCora3Nh1l9w6Z0bKoPUmRTlNdRXslEjfKKJmqUVzRR
o7yiiRrlFU3UKK9oouawfFK8yt6yZcvgwYMDf1VaWtrZ2enR+fg/Ubr88ss3
bNjg9ZQ+Y1MSm3IkdTZFeYnylNco7yXKS5SnvEZ5L1Fesl8+8V9l79+/PxQK
iXR33nlnU1PT0aNH6+rq0tPTxS3V1dVenIz/E40qKyvFXK+n9BmbktiUfSm1
KcpLlKc85T1FeYnylKe8pygv2S+f+K+yy8vLRbSpU6ca35144403xI3Dhg07
ffq06yfj/0QjsZFBgwZ5PaXP2JTEpuxLqU1RXqI85SnvKcpLlKc85T1Fecl+
+QR/lX3mzJnMzEwR7YMPPjDe3tXVNWrUKHH7+vXr3T0T/yeanD9/XmzEND1x
sCmJTdmUapuivER5ylPeU5SXKE95ynuK8pL98gn+Kvvbb78VuTIyMiI/Zv/w
ww+LuyoqKtw9E/8nRiotLb333nu9ntI3bMqITdmRapuivBHl/ZkYifL+TIxE
eX8mRqK8PxMjUd6fiZEo78/ESDbLJ/ir7K1bt4pc48aN03reOqipqVm0aNE3
33wjvly9erW4q6ioyN0z8X9ipIaGhmHDhnV1dXk9qA/YlBGbsiPVNkV5I8pT
nvLeobwR5SlPee9Q3shm+QR/la1/xn7KlCni142NjYEec+bMEV/W19eLX0+e
PNn0W06dOtXU1HTy5Mm+nYn/EyN1dHRkZmZu27bNrQd0EZsyYlN2pNqmKG9E
ecpT3juUN6I85SnvHcob2Sz/5ZdfDhw4UBzs1ty+6W13r7zyisg1ffp0redn
tuslZ8+eLb7ctGmT+PV1110nD96/f/+tt94auGDcuHHiGKdn4v/EqObPn19e
Xu7KQ7mLTZmwqZhSbVOUN6E85TXKe4PyJpSnvEZ5b1DexE75c+fOZWRk/Pvf
/3ZlYp/1truGhgbR5Nprr9UufCrgvvvu0z8VsHbtWnHXHXfcoR959uzZ3Nzc
tLS0e+6557XXXnvqqaeuvPJKccDu3bsdnYn/E6Oqr6/PysqK/3EidXd3/9m7
mL+dTZmwqZj6/aZMKG9CecprlPcG5U0oT3mN8t6gvInN8suXL8/Ly9u2bdt/
//vf+If2TW+727Nnj6gR9d7HHntM3LVkyRL9y127dhnDaj0/g27jxo1Oz8T/
iVEdPnxYPPihQ4dceTQj41s6kWJOZFMmbCqmfr8pE8qbUN6HiVFR3oeJUVHe
h4lRUd6HiVFR3oeJUVHeh4lR2S+/ePFicWRtba0rc/ugt921tbWlpaWJc9u7
d6/prhtuuEHc/swzz+hf6p8ZiP9TE/5PjEr8GRg1alR3d7frj3zs2LHW3sX8
l6RsyoRNxdTvN2VCeRPK+zAxKsr7MDEqyvswMSrK+zAxKsr7MDEqyvswMSqb
5V966aVLLrlk2bJlBw8e9OI07LD4u85nzpwZmai5uVncGAwG5XsIJ0+eHDFi
hMheWVn5008/RT7O119/vXz5ctE/Nzd31qxZ7777rtcTpc7OzrKysqKiot9+
+83iMKNwOCzfionqu+++y8/PFydw1113nTt3zubDxo9NmbApNmVCeRPKxzNR
ojzlI1HehPLxTJQoT/lIlDeJWV7r+UD7kCFDNmzYYPMxPWKxu48//lhEC4VC
b7/9tn7LsWPH8vLyxI3z5s0zHrlz587s7Gz9YBHqiy++kHe9+uqr4kaRWtw+
Z86cjIwMcdiqVau8m2gk/hgEetj8RIe4Ci6++OItW7ZYHFNcXBy4wM+fcc2m
jNgUm4pEeSPKU57ykShPeY3yfUJ5I8oncnmt58Pt6enpv/76q53H9I7F7rq7
u0tKSsQTT0tLmzhxYkFBgXhe4ssxY8Z8//33poPFs37zzTcnTZqktwqHw/r7
Nq2trQsXLmxra9MPO3DgQDAYvOyyy7ybKIk/AOJ2MUv80+anBT755JMhQ4ac
PXvW4pgVK1bIq+bxxx+387CuYFNGbIpNRaK8EeUpT/lIlKe8jvJOUd6I8olc
Xkv4vy9bJ2LW1NQMHz5c75Oenp6fn//zzz9b/JYdO3Zcf/31AcOH803EvYMH
Dz5//rynE5ubmzMyMiZMmFBbWxuw/Q7JsmXLFixYYH3MDz/8MG/ePP30Hnjg
ATsP6wo2ZcSmjNiUjvJGlKc85SNR3noi5SNRXkd5I8oncnktSV5l60TPffv2
7d69+8yZM3YeU6QWuW677bbIuzZt2iTW8dBDD3k68ffff8/NzR0xYsThw4ef
fvppm7sTQ0ePHv3OO+/YmVhYWBjo/QMVXmBTxqFsSmJTEuWNQylPeXlKlDeh
fNSJlI+8i/IS5Y1DKZ/g5ZPoVbY18USqqqo6OjrkLZs3bxa5iouL5S2NjY0F
BQVjx44Vi6usrDx16pR3E8UK5s6dKwZ9+umn4kv7u/vqq68GDBhg59z++OOP
gQMHiof97LPP4ngezrApiU1pbCoaykuUj3Mi5SlvjfIS5eOcSHnKW6O8ZL98
v3mVHQ6HRZycnJyVK1euW7eurKxMPKZIt2PHDnmMaHvzzTePGTNGHDlt2rTI
nwDv4sRnn31W3LtmzRr9YPu7q66unjFjRszDDh48eOONN4rHnD59ejzPwik2
JbEpjU1FQ3mJ8nFOpDzlrVFeonycEylPeWuUl2yW1/rRq+zu7u6XX345Ly8v
GAwGeohfNzY2Rj14165dYoPDhw//5ZdfvJgoHj8UCg0dOvTJC2655RZxQGVl
5XPPPWf9sFdffXVdXZ31MTt37tT/M/8pU6ZY/2h617EpiU0ZsSmJ8hLl45lI
ecrHRHmJ8vFMpDzlY6K8ZKe8rt+8ypba29ubmprkD6nrzeuvvy5i1tfXezHx
vffeG/tXmZmZYlxWVtakSZMsHqq1tVUcduTIEeuJBw4cEH8w1q1b58NfQ2/C
pnRsKhKb0lFeR/k4J1LeAuV1lNdRPs6JlLdAeR3ldTbL6/rfq+yoPvzww5aW
FuMt1dXVopK43dO5ks3PIaxevXrixIl2HvD06dNunJdjbErHpthUbyivo7zr
KC9RXkd5HeVdR3mJ8jrK6+yX11LjVXZnZ2d2dvZFF120dOnS+vr6jz76qLy8
PBgM5uTktLe3ezfXyObubrrpptraWn9OqW/YlI5NsaneUF5HeddRnvImlNdR
3nWUp7wJ5XWOyosnMnr06LhPLV5ev0Ny4sSJkpKSkSNH6h/LT0tLKywstPk3
j7tC/0/srXd3/Phx8SfK9E5OomFTGpvqwaZ6Q3mN8t6gPOVNKK9R3huUp7wJ
5TXn5RctWlRQUODG2cXF691JR48ebW5u9u2NEUfWr1+fk5Oj+ixiYFMam/or
NmVCeY3y6lBeFcqrQnlVKK8K5VWxWV68GH///fdnzpw5cODAPXv2+HBi1nzb
XSILh8NVVVWqzyIGNqWxqeShZFOU1yivDuVVobwqlFeF8qpQXhWb5Wtqaq64
4oqFCxfu27fPh7OKid0lCzaVLNiUKpRXhfKqUF4VyqtCeVUorwrlkxe7SxZs
KlmwKVUorwrlVaG8KpRXhfKqUF4Vyicvdpcs2FSyYFOqUF4VyqtCeVUorwrl
VaG8KpQHAAAAAAAAAAAAAAAAAAAAAMBF/weREAcO
    "], {{0, 40.}, {657., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{657., 40.},
  PlotRange->{{0, 657.}, {0, 40.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[538]=",
 CellID->1962058963,ExpressionUUID->"bf2acbae-2bab-486c-9083-4599e3cc6cd2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qtCNOT", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}], "]"}]], "Input",
 CellLabel->"In[514]:=",
 CellID->1433668926,ExpressionUUID->"93655636-6d70-4db4-8a8c-e045f38e6f9d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{3, -1}, {10, -1}}, {{3, -2}, {10, -2}}, {{3, -5}, {
      10, -5}}, {{3, -6}, {10, -6}}}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {10, -3}}, {{
     0, -4}, {10, -4}}, {{0, -5}, {3, -5}}, {{0, -6}, {3, -6}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"1"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.46875}, {-0.1625, \
-3.4375}, {-0.1625, -2.0625}, {-0.1625, -2.03125}, {-0.1, -2.}}], 
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.53125}, {-0.1625, \
-3.5625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Chi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.325, -3.5}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      LineBox[{{1, -1}, {1, -2}}], 
      DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
          1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
      LineBox[{{1, -5}, {1, -6}}], 
      DiskBox[{1, -5}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
          1, -6.266666666666667}, {1, -5.733333333333333}}}]}}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
      LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
       1.6, -5.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]},
        LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
        2.6, -1.4}}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]},
        LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
        2.6, -2.4}}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]},
        LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
        2.6, -5.4}}]}, 
      CircleBox[{3, -5.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -5.2}, {3.24, -4.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -6.4}, {3.4, -5.6}]},
        LineBox[{{2.6, -6.4}, {3.4, -6.4}, {3.4, -5.6}, {2.6, -5.6}, {
        2.6, -6.4}}]}, 
      CircleBox[{3, -6.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -6.2}, {3.24, -5.76}}]}}, {
     LineBox[{{4, -2}, {4, -4}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -3}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, 
     LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
      5.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -6}, {7, -4}}], 
     DiskBox[{7, -6}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -5}, {8, -4}}], 
     DiskBox[{8, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, 
     LineBox[{{7.6, -4.4}, {8.4, -4.4}, {8.4, -3.6}, {7.6, -3.6}, {
      7.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -5}, {9, -3}}], 
     DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     LineBox[{{8.6, -3.4}, {9.4, -3.4}, {9.4, -2.6}, {8.6, -2.6}, {
      8.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-13, 2], 
       Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>], {
    Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 0|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 0|>], 
     "Label" -> Ket["\[Chi]"]}], {
    Q3`CNOT[{
       $CellContext`S[1, Q3`$]} -> {1}, {
      $CellContext`S[2, Q3`$]}], 
    Q3`CNOT[{
       $CellContext`S[5, Q3`$]} -> {1}, {
      $CellContext`S[6, Q3`$]}]}, {
    $CellContext`S[1, 6], 
    $CellContext`S[5, 6]}, 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[5, 3], 
     $CellContext`S[6, 3]}], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[3, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[6, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[4, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]]]]], "Echo",
 CellID->1614405197,ExpressionUUID->"0e670722-72c6-4dac-aa0f-3185a54707a8"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
SUlJeeutt+QtJ06cyM7OFjcuWLDAuOXu3bszMjLkxuLhf/bZZ/pdr776qrhR
HL+4fd68eampqWKzVatWRT0w699At1jRSPx1svmOCEm+8rBt2zaLbYqKivQ3
WsTyOW+UN6K8RnnKh6F8vJd3ikkZcY5olKd8GMrHe3mnmJSRR5Ny5d931rp/
t724uFism5SUNHHixLy8PHG04tuxY8d+8803po3FY3njjTcmTZokDzUYDMor
/ZaWFnEwra2tcrNDhw4lJydfd911EVcsKCj47RWDBg2Su9JvmTVrlp0VdeIv
krhdrCX+PHz4sJ0aH3/88eDBgy9evGixzYoVK/SJPPnkk3Z2GxHljShPecqH
o3y8l3eKSRlxjlCe8uEoH+/lnWJSRh5Nyq1rZ617KDU1NcOHD5cH0K9fv9zc
3B9++MHiR3bt2nXrrbcGDG+zNxH3itqXL18Ov0u+P78nxs9aj7piU1NTampq
Tk5ObW1twParGcuXL1+4cKH1Nt9+++2CBQvkIT388MN2dhsR5Y0oT3nKh6O8
9Yp9v7xTTMqIc4TylA9HeesV+355p5iUkUeTcvHaWRJzOXDgwN69e8+fP29n
n2Jk4mjvvvvu8Lu2bNkixvroo4/aPDybTCuePXs2KytrxIgRR48effbZZ21O
RDzMMWPGvP3223ZWzM/PD9h7S0NPKK+jfC9QXqK8HZTX+VzeKSal4xzpBcpL
lLeD8jqeF4yuzkm5fu1sbefOnVVVVe3t7fotW7duFUdbVFSk39LQ0JCXlzdu
3DgxjsrKyjNnzni3ogg7f/58sdAnn3wivrU/kc8//7x///52ju3nn38eMGCA
2O2nn37a60dBeR3lY1yR8pS3Rnmdz+WdYlI6zpEYV6Q85a1RXsfzgnbVT8rn
a+dgMCiOLTMzc+XKlevXry8tLRX7FEF27dqlbyOK3XnnnWPHjhVbTps2LfzT
1F1c8fnnnxf3rl27Vm5sfyLV1dUzZsyIutnhw4dvv/12sc/p06fH8igor6N8
jCtSnvLWKK/zubxTTErHORLjipSnvDXK63he0K76Sfl87dzV1fXyyy9nZ2cn
JycHuomvGxoaIm68Z88eMZfhw4f/+OOPXqwo9p+SkjJ06NCnr7jrrrvEBpWV
lS+88IL1bm+88ca6ujrrbXbv3i1/DX/KlCnWH7oeFeV1lI9lRcpTPirK63wu
7xST0nGOxLIi5SkfFeV1PC8YXZ2T8vnaWdfW1tbY2Kh/UFtPXn/9dfGIQqGQ
Fyu+++67434tLS1NLJeenj5p0iSLXbW0tIjNjh07Zr3ioUOHxLjXr18f+z/J
TXmJ8jGuSHkLlJcoL/lf3ikmJXGOxLgi5S1QXqK8xPNCuKtwUqqunSP64IMP
mpubjbdUV1eLxy5u93Rdnc13AqxevXrixIl2dnju3Dk3jovy/4fyrqO8jvIS
5SX/yzvFpCTOEddRXkd5ifISzwtMSnj66afnzp1rc2NPJ9LR0ZGRkXHNNdcs
W7YsFAp9+OGH5eXlycnJmZmZbW1t3q1rZHMid9xxR21trT+HJFFeorzrKE95
E8pL/pd3iklJnCOuozzlTSgv8bzApLTuX/e+9tprv/vuOzsbe/1qxqlTp4qL
i0eNGiXf7p6UlJSfn2/z3792hfyFdOuJnDx5Uvw9Mb3q4jXKa5T3BuUpb0J5
TVF5p5iUxjniDcpT3oTyGs8L3ZiU0NnZOXXq1PT09LVr1zY2Nlpv7PVEdMeP
H29qavLtRQxHNmzYkJmZ6fOilNcorw7lVaG8KkrKO8WkNM4RdSivCuVV4XnB
6CqfVHt7u7iKz8nJycjIsN7St4n0ZcFgsKqqyudFKa9RXh3Kq0J5VZSUd4pJ
aZwj6lBeFcqrwvNCvOhTk2IiqlBeFcqrQnlVKB8vmJQqlFeF8qpQPl4wqb6G
iahCeVUorwrlVaF8vGBSqlBeFcqrQvl4waT6GiaiCuVVobwqlFeF8vGCSalC
eVUorwrl4wWTAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAW
Pv9cqKioeOmll1QfRRRMSlM0KcprnCPxg3NEFcqrQnlVKK8K5VWhvCo2y9fV
1eXn5//lL3/5z3/+493BMBHhxRdfnDBhguqjiIJJaYomRXmNcyR+cI6oQnlV
KK8K5VWhvCqUV8Vm+ebmZnHhnJmZ+bvf/e7YsWMeHQwTEY4cORIIBMSfqg/E
CpPSFE2K8hrnSPzgHFGF8qpQXhXKq0J5VSiviqPyly5dys3N/eMf/+jRwTAR
acKECWvWrFF9FFaYlOT/pCgvcY7EC84RVSivCuVVobwqlFeF8qo4Kv/ee+9l
ZGR4dCRMRHrqqaemTZum+iisMCnJ/0lRXuIciRecI6pQXhXKq0J5VSivCuVV
cVR+586dI0eO9OhIok6kubn58ccfF0d70003LVmy5M033/ToSIwuXLgQCoXK
ysp8+5X8/fv3p6SktLa2+rNcLzApyf9JUV7iHOmdq2FSlJcoL1Feo7xnKC9R
XqK8RvlIFF47b9u2bdCgQYFfKykp6ejo8Oh4Nm3aNHPmzCFDhsi1cnJyPFoo
3PXXX79x40bflnOKSel8nhTldZwjjlw9k6K8jvKU1yjvJcrrKE95jfI9UHXt
fPDgQXGBL7Lce++9jY2Nx48fr6ur69evn7ilurrao+PJy8szTt/PiVRWVopH
6ttyTjEpnc+ToryOc8SRq2dSlNdRnvKU9xTldZSnPOV7ourauby8XDSZOnWq
8bWLTZs2iRuHDRt27tw5L47n7Nmz/+r2xBNP+DwR0XngwIEePa7YMSmdz5Oi
vI5zxJGrZ1KU11Ge8pT3FOV1lKc85S229P/a+fz582lpaaLJ+++/b7y9s7Nz
9OjR4vYNGzZ4dEjSmjVrfJ7I5cuXRWfT4+07mJTO50lRXsc50jsJPynK6ygv
UZ7yHqG8jvIS5SkfTsm181dffSWCpKamhr9h/rHHHhN3VVRUeHRIkv8TEUpK
Sh544AE/V7SPSRn5OSnKG3GO9ELCT4ryRpTXKE95z1DeiPIa5SkfiZJr5+3b
t4sg48eP17ov82tqahYvXvzll1+Kb1evXi3uKiws9OiQJCUTqa+vHzZsWGdn
p5+L2sSkjPycFOWNOEd6IeEnRXkjymuUp7xnKG9EeY3ylI9EybWzfLf8lClT
xNcNDQ3y98HnzZsnvg2FQuLryZMnm37kzJkzjY2Np0+fduXA7EzE3RWF9vb2
tLS0HTt2uLVDFzEpIz8nRXkjzpFeSPhJUd6I8hrlKe8ZyhtRXqM85SP55z//
OWDAALGxW+sa9TSRV155RQSZPn261v3553Iic+fOFd9u2bJFfH3LLbfoGx88
eHDmzJmBK8aPHy+2ifHArCfixYpSQUFBeXm5K7tyF5My8W1SlDfhHHEq4SdF
eRPKU16jvDcob0J5ymuUD3Pp0qXU1NS///3vrqxo0tNE6uvrxSO9+eabtSvv
BHjwwQflOwHWrVsn7rrnnnvklhcvXszKykpKSrr//vtfe+21Z5555oYbbhAb
7N27N5YDs5iIRytKoVAoPT099v2E6+rq+qVnUX+cSZl4NykTyptwjjiVeJMy
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

    "], {{0, 40.}, {650., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{650., 40.},
  PlotRange->{{0, 650.}, {0, 40.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[514]=",
 CellID->1713591456,ExpressionUUID->"8aeb0f9d-b7ed-4dff-a8b6-94ba4b26e922"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qtCNOT", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}], "]"}]], "Input",
 CellLabel->"In[515]:=",
 CellID->1878344926,ExpressionUUID->"e40643f3-4618-49de-9b0d-c737f754e2ce"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{3, -1}, {10, -1}}, {{3, -2}, {10, -2}}, {{3, -5}, {
      10, -5}}, {{3, -6}, {10, -6}}}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {10, -3}}, {{
     0, -4}, {10, -4}}, {{0, -5}, {3, -5}}, {{0, -6}, {3, -6}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"1"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.46875}, {-0.1625, \
-3.4375}, {-0.1625, -2.0625}, {-0.1625, -2.03125}, {-0.1, -2.}}], 
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.53125}, {-0.1625, \
-3.5625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Chi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.325, -3.5}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      LineBox[{{1, -1}, {1, -2}}], 
      DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
          1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
      LineBox[{{1, -5}, {1, -6}}], 
      DiskBox[{1, -5}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
          1, -6.266666666666667}, {1, -5.733333333333333}}}]}}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
      LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
       1.6, -5.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]},
        LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
        2.6, -1.4}}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]},
        LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
        2.6, -2.4}}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]},
        LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
        2.6, -5.4}}]}, 
      CircleBox[{3, -5.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -5.2}, {3.24, -4.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -6.4}, {3.4, -5.6}]},
        LineBox[{{2.6, -6.4}, {3.4, -6.4}, {3.4, -5.6}, {2.6, -5.6}, {
        2.6, -6.4}}]}, 
      CircleBox[{3, -6.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -6.2}, {3.24, -5.76}}]}}, {
     LineBox[{{4, -2}, {4, -4}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -3}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, 
     LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
      5.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -6}, {7, -4}}], 
     DiskBox[{7, -6}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -5}, {8, -4}}], 
     DiskBox[{8, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, 
     LineBox[{{7.6, -4.4}, {8.4, -4.4}, {8.4, -3.6}, {7.6, -3.6}, {
      7.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -5}, {9, -3}}], 
     DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     LineBox[{{8.6, -3.4}, {9.4, -3.4}, {9.4, -2.6}, {8.6, -2.6}, {
      8.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-13, 2], 
       Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>], {
    Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 0|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 0|>], 
     "Label" -> Ket["\[Chi]"]}], {
    Q3`CNOT[{
       $CellContext`S[1, Q3`$]} -> {1}, {
      $CellContext`S[2, Q3`$]}], 
    Q3`CNOT[{
       $CellContext`S[5, Q3`$]} -> {1}, {
      $CellContext`S[6, Q3`$]}]}, {
    $CellContext`S[1, 6], 
    $CellContext`S[5, 6]}, 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[5, 3], 
     $CellContext`S[6, 3]}], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[3, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[6, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[4, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]]]]], "Echo",
 CellID->727911928,ExpressionUUID->"88106ab8-bf74-4e02-82ad-f72e437eed1d"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJzt3WtsFeW6wPFeuKWVykU3iCUVayXyBagET7xAjtykasESXKKWiFqgppEG
mpw0KkQLaDQBRCAawGgDISASIUKMIQblon7AkpIYUlpQ8cIGpWCxXO2c9/Ae
38ye1a7OWnN51ir/X7KJro7zTP8Pk8nqLmXIs/NKZmekpaUt6KV+KZn1P/89
f/6s6ml91L9Mf3FB+ZwXy56f/GJV2Zyy+f/1bKZ6car63+3d09L+758tAAAA
AAAAAAAAAAAAAAAAAMB1Zvv27aWlpZMmTfL3tDfffLO/J0xF8+bNW7FihfRV
dIJNWUKborxFeTmUl8JzIVVwj0ihvBTKS6G8lEDLz5w5s1evXnPnzt20aZO/
Z2Z3yvLly4cPHy59FZ1gU5bQpihvUV4O5aXwXEgV3CNSKC+F8lIoLyW48p9/
/rl6i33w4MEgTs7ulGPHjqWlpalfpS8kFjZlCW2K8hbl5VBeCs+FVME9IoXy
UigvhfJSgiu/ZMmS8ePH+35ajd1pw4cPX7ZsmfRVxMKmtPA3RXmN8lIoL4Xn
QqrgHpFCeSmUl0J5KQGVf+mll2bMmOH7aTV2py1atGjMmDHSVxELm9LC3xTl
NcpLobwUngupgntECuWlUF4K5aUEVF78XfaFCxdqa2vLy8tD+yP/4U88dOhQ
Zmbm6dOnwxmXADalhb8pymuUl5pIeamJPBcScz1sivIa5aUmUl5qIuWlJgZU
XvBd9vvvvz9hwoScnJy0awoLCwO6DMGJxm233bZ+/frQxsWLTRkhb4ryBuUp
b1E+mbApg3uE8hblg0R5g/Jdqbzgu+yioqI0mxBKhj/RqKysfPTRR0MbFy82
ZYS8KcoblKe8RflkwqYM7hHKW5QPEuUNynel8oLvss+ePfvva15++eVwSoY/
0dizZ0+vXr3Onz8f2sS4sCkj5E1R3qA85S3KJxM2ZXCPUN6ifJAob1C+K5UX
/3PZyrJly0IuGf7Eq1ev3nTTTR9//HFoE+PCpoyQN0V5g/JSEykvNZHnQmK6
/KYob1BeaiLlpSZSXmpiEOV5lx2aWbNmPf3002FOdI9N2YW5KcrbUV5kokV5
oYkWz4WEdPlNUd6O8iITLcoLTbQoLzTRCqA877JDs3379r59+165ciXMoS6x
KbswN0V5O8qLTLQoLzTR4rmQkC6/KcrbUV5kokV5oYkW5YUmWgGUf/755599
9lm/zubg4+6am5vr6urOnDnjy4WFP1FpbW3Nzs7evXu3Xyf0EZuyC3NTlLej
vMhEi/JCEy2eCwnp8puivB3lRSZalBeaaFFeaKLld/m///57wIABH3zwgS9n
i+bL7o4ePTphwgTz4+buuOOOzZs3e7yw8CdqJSUlFRUVvpzKX2zKIbRNUd6B
8pTXKC+OTTlwj1Beo7zvKO9A+VQv/9VXX0UiEZX35MmTHR3T1tb2d8c6HeF9
dxcvXiwoKEhPT3/qqafee++911577c4771QHf/31127OnDwTtdra2tzcXO/n
icamUmVTDpR3oDzlNcp7x3MhVTblQHkHylNeo7zvKO/gS/lTp06p68nOzv7x
xx9jHGb/QkG0Y8eOxZ7ifXcHDhxQH3r44YfNK3/99demTZvcnDapJmrHjx93
0y0BbMqviVpwm3KgvAPlKa9R3jueC35N1LhHKK9R3neUd6B8Spe/cuXKO++8
o97733XXXS0tLR0d9uuvvzZ0rNMvhnvf3a5du9SHfP+uifAnaur3wMCBA9va
2nw/M5vyV3CbcqC8A+Upr1HeO54L/uIeobxGed9R3oHyXaD8pUuXcnJytm3b
5v1U7fK+uzNnzvTv3z89Pb2ysvKnn36KPuC7774rLy8fPXp0QUHB5MmTt2zZ
EvRE4/Lly2VlZdOmTfvjjz/cDFUikcjs2bNjHHDkyJGxY8eqC3j88cfVdlye
1js25RDapijvQHnKa5Q3eC74ONFI5k1R3oHylNcob1A+JcrPmDFDfe4uR8fL
lz9Tv3///ry8PHVAZmamCrVv3z7zoXfffVe9qD5T9fqUKVOysrLUYUuWLAlu
ol1FRYXL77vT9Nc0du3aFeOY0tJS8+18Yf7UWTZlF+amKG9HeS8T7ShPee/Y
lB33iJeJdpSnfDTK21Hey0Q78fJSf192SUnJv/5xww036Ks1r0yaNMl+sPqs
P/zww1GjRunDIpGI/upBQ0ODuvjTp0/rwxobGzMyMm699dbgJhobNmxQr6tZ
6tempiY3NT777LPevXtfvHgxxjHz5883u1u4cKGb0/qCTdmFuSnK21Ge8pSP
xnPBr4lGkm+K8naUpzzlo1E+JcpLvcsePXp0WsdGjBjR7n+1d+/ekSNHqgOW
Ll3a7gHqo2ovV69eDXRifX19VlZWYWFhTU1NmuuvkMydO3f69Omxj/nhhx8e
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
Ktu3b+/bt++VK1dCmEV5O8qLTLQoLzTRCrd8vNiUHfeIyESL8kITLcoLTbR4
LiSky2+K8nYuy3e9d9nNzc11dXVnzpzx5cLCn6i0trZmZ2fv3r3brxPGQHk7
yotMtCgvNNEKt3y82JQd94jIRIvyQhMtygtNtHguJKTLb4rydi7Lf/PNNz17
9lQH+zU3Mb7s7ujRoxMmTDA/bu6OO+7YvHmzxwsLf6JWUlJSUVHhy6lio7wD
5SmvUV4cm3LgHqG8RnnfUd6B50K8uvymKO/gpvylS5eysrI++eQTXyYmzPvu
Ll68WFBQkJ6e/tRTT7333nuvvfbanXfeqQ7++uuvvVxY+BO12tra3Nxc7+fp
FOUdKE95jfLetbW1/d2xTv9zNuXAPUJ5jfK+o7wDz4V4db1NOVDewWX58vLy
oUOH7t69+8KFC96HJsb77g4cOKA+9PDDD5tX/vrrr02bNnm8sPAnasePH1cn
P3bsmC9ni4HyDpSnvEZ57+xfQI7W6UQ25cA9QnmN8r6jvAPPhXh1vU05UN7B
fflnnnlGHVlTU+PL3AR4392uXbvUh3z/ronwJ2rq98DAgQPb2tqCOLkd5R0o
T3mN8t79+uuvDR3r9P+2YFMO3COU1yjvO8o78FyIV9fblAPlHVyWf/vtt2+8
8ca5c+c2NTUFcRlueN/dmTNn+vfvn56eXllZ+dNPP0Uf8N1335WXl48ePbqg
oGDy5MlbtmwJeqJx+fLlsrKyadOm/fHHH26GKpFIZPbs2TEOOHLkyNixY9UF
PP7445cuXXJ52miUd6A85TXKG36VjxebcuAeobxGeYPyqV4+XmzKgXskactb
1/5m7d69e69fv97lOQPiy5+p379/f15enjogMzNThdq3b5/50LvvvqteVKnV
61OmTMnKylKHLVmyJLiJdhUVFS6/E0ZTd0FOTs6uXbtiHFNaWmq+wcbLTxek
vB3lvUy0ozzlvWNTdtwjXibaUZ7y0Shvx3OBTUWjvJ2b8srBgwe7dev2+++/
uzlncGLsrqSk5F//uOGGG3QE88qkSZPsB6vP+sMPPxw1apQ+LBKJ6K/bNDQ0
zJgx4/Tp0/qwxsbGjIyMW2+9NbiJxoYNG9Trapb61eV3C3z22We9e/e+ePFi
jGPmz59v7pqFCxe6OW27KG9HecpTPppf5ePFpuy4RyhP+WiUT/Xy8WJTdtwj
yVzeSoW/L3v06NFpHRsxYkS7/9XevXtHjhypDli6dGm7B6iPqr1cvXo10In1
9fVZWVmFhYU1NTVprr9CMnfu3OnTp8c+5ocffnjsscf0JT333HNuTtsuyttR
nvKUj+ZX+XixKTvuEcpTPhrlY09M/vLxYlN23CPJXN5KhXfZCfv5559VrokT
J0Z/aPPmzd26dXvhhRcCnXj27NmCgoL+/fsfP3588eLFLnfX1tY2aNCgjRs3
uplYXFyc5u4bKjpCeYPy3idSPvpDlE8YmzK4R7xPpHz0hyhvUN7guWDHpgzK
G+7Ld5l32eoTqaqqam1tNa9s27ZN5SotLTWv7Ny5s6ioaMiQIWpxlZWVzc3N
wU1UK5g6daoa9MUXX6h/db+7b7/9tnv37m6u7dy5cz179lSn/fLLLxP+LChv
UN7jRMpT3l9syuAe8TiR8pSPjfIGzwWLTbWH8ob78l3mXXYkElFx8vPzFyxY
sHr16rKyMnVOlW7v3r3mGNX2vvvuGzx4sDpyzJgxhw4dCm7i66+/rj66cuVK
fbD73VVXV48fP77Tw5qamu655x51zgcffNDLZ0F5g/IeJ1Ke8v5iUwb3iMeJ
lKd8bJQ3eC5YbKo9lDdclre60Lvstra2NWvWDB06NCMjI+0a9c87d+5s9+AD
Bw6oDfbr1++3334LYqI6f2ZmZp8+fV79x7hx49QBlZWVb731VuzTDhs2bNWq
VbGP2b9/f05Ojjrh/fffH/tH03eK8gblvUykPOV9x6YM7hEvEylP+U5R3uC5
YMemDMobbsprXeZdttHS0lJXV2d+SF1H1q1bp2LW1tYGMfGjjz4a8p+ys7PV
uNzc3FGjRsU4VUNDgzrsxIkTsSc2Njaq3xirV6/2/tfQU16jvMeJlI+B8olh
Uxr3iMeJlI+B8hrlNZ4L0diURnnNZXmt673LbteOHTsOHz5sf6W6ulpVUq8H
Otdw+X0Ib7755t133+3mhOfPn/fjuij//yjvO8oblE8Mm9K4R3xHeYPyGuU1
ngtsqiOU19yXt66Pd9mXL1/Oy8vr0aPHnDlzamtrP/3004qKioyMjPz8/JaW
luDm2rnc3b333ltTUxPOJWmU1yjvO8pT3iM2pXGP+I7ylHegvMZzgU11hPJa
XOXVJzJo0CDPl+ZV0F8hOXXq1MyZMwcMGKC/LT89Pb24uNjl3zzuC/1H7GPv
7uTJk+p3lOMrOUGjvEX5YFCe8h6xKYt7JBiUp7wD5S2eC9ewqY5Q3oq//JNP
PllUVOTH1XkS9O6MX375pb6+PrQvjMRl7dq1+fn5IQ+lvEV5OZSXIlI+XmzK
4h6RQ3kplJfCc8GOTTlQ3nJdXr0Z37p160MPPdSzZ8+DBw+GcGGxhba7ZBaJ
RKqqqkIeSnmL8nIoL0WkfLzYlMU9IofyUigvhedCquAekeKy/CuvvHL77bfP
mDHj+++/D+GqOsXupFBeCuWlUD5VsCkplJdCeSmUTxVsSgrlUxe7k0J5KZSX
QvlUwaakUF4K5aVQPlWwKSmUT13sTgrlpVBeCuVTBZuSQnkplJdC+VTBpqRQ
HgAAAAAAAAAAAAAAAAAAAAAAH/0v4+7ssQ==
    "], {{0, 40.}, {657., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{657., 40.},
  PlotRange->{{0, 657.}, {0, 40.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[515]=",
 CellID->428411075,ExpressionUUID->"0ab9553d-d103-41f4-9b17-f6322f6dcc3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qtCNOT", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1"}], "}"}], "]"}]], "Input",
 CellLabel->"In[516]:=",
 CellID->1240376261,ExpressionUUID->"8e340e8c-6366-4bcf-995a-2cd0a1f115e0"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{3, -1}, {10, -1}}, {{3, -2}, {10, -2}}, {{3, -5}, {
      10, -5}}, {{3, -6}, {10, -6}}}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {10, -3}}, {{
     0, -4}, {10, -4}}, {{0, -5}, {3, -5}}, {{0, -6}, {3, -6}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"1"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"1"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.46875}, {-0.1625, \
-3.4375}, {-0.1625, -2.0625}, {-0.1625, -2.03125}, {-0.1, -2.}}], 
       BSplineCurveBox[{{-0.225, -3.5}, {-0.1625, -3.53125}, {-0.1625, \
-3.5625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Chi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.325, -3.5}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      LineBox[{{1, -1}, {1, -2}}], 
      DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
          1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
      LineBox[{{1, -5}, {1, -6}}], 
      DiskBox[{1, -5}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
       LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
          1, -6.266666666666667}, {1, -5.733333333333333}}}]}}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
      LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
       1.6, -5.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]},
        LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
        2.6, -1.4}}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]},
        LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
        2.6, -2.4}}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]},
        LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
        2.6, -5.4}}]}, 
      CircleBox[{3, -5.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -5.2}, {3.24, -4.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -6.4}, {3.4, -5.6}]},
        LineBox[{{2.6, -6.4}, {3.4, -6.4}, {3.4, -5.6}, {2.6, -5.6}, {
        2.6, -6.4}}]}, 
      CircleBox[{3, -6.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -6.2}, {3.24, -5.76}}]}}, {
     LineBox[{{4, -2}, {4, -4}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -3}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, 
     LineBox[{{5.6, -3.4}, {6.4, -3.4}, {6.4, -2.6}, {5.6, -2.6}, {
      5.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -6}, {7, -4}}], 
     DiskBox[{7, -6}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -5}, {8, -4}}], 
     DiskBox[{8, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, 
     LineBox[{{7.6, -4.4}, {8.4, -4.4}, {8.4, -3.6}, {7.6, -3.6}, {
      7.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -5}, {9, -3}}], 
     DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     LineBox[{{8.6, -3.4}, {9.4, -3.4}, {9.4, -2.6}, {8.6, -2.6}, {
      8.6, -3.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-13, 2], 
       Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>], {
    Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 0|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 
         0, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 0, $CellContext`S[5, Q3`$] -> 1|>] + 
     Rational[1, 2] 
      Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
         1, $CellContext`S[4, Q3`$] -> 1, $CellContext`S[5, Q3`$] -> 0|>], 
     "Label" -> Ket["\[Chi]"]}], {
    Q3`CNOT[{
       $CellContext`S[1, Q3`$]} -> {1}, {
      $CellContext`S[2, Q3`$]}], 
    Q3`CNOT[{
       $CellContext`S[5, Q3`$]} -> {1}, {
      $CellContext`S[6, Q3`$]}]}, {
    $CellContext`S[1, 6], 
    $CellContext`S[5, 6]}, 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[5, 3], 
     $CellContext`S[6, 3]}], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    $CellContext`S[3, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[6, Q3`$]} -> {1}, 
    $CellContext`S[4, 1]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[4, 3]], 
   Q3`ControlledGate[{
      $CellContext`S[5, Q3`$]} -> {1}, 
    $CellContext`S[3, 3]]]]], "Echo",
 CellID->1016600475,ExpressionUUID->"1c7e375d-cf0a-4d32-888b-3bf7d2ada26c"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnX1sFVXex/umkBaQF3dhsaSypTSrMWghShRoHgSBigVK8C5oK1ULVJul
AeKTZq1GK7LBBF0ovgQh61VD8IUsxqIhxOAisP6BJa0SLW8qgixdAbdQoMXO
c56e5WS8vZ3OdGbuudN+Ponk3plzz2/u53t/dzLj3OnIh5cWLEpKSEhY3lf8
U1D8v/+zbFlxxdyB4sm8Py0vXfynkkdn/GlFyeKSZeMfThYLZ4v/xl2TkPD/
jw0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAgDhj27ZthYWF06ZNsx72m9/8Jjbb
E88sXbr0pZdeinFRzBuY1wfmdaHFvFNIyqBH9EGPBAV6RBeY1wXmdRGI/YI1
RUVFffv2XbJkyebNm61HkrjgxRdfHDNmTIyLYt7AvD4wrwst5p1CUgY9og96
JCjQI7rAvC4wr4tA7Bcs2LFjhzgw379/v53BJC44evRoQkKC+DeWRTFvYF4f
mNeFFvNOISmDHtEHPRIU6BFdYF4XmNdFIPYLFqxcuXLKlCk2B5O4ZMyYMWvW
rIllRcxLMK8LzOsi9uadQlISekQX9EhQoEd0gXldYF4X8b9fsODPf/7z/Pnz
bQ4mccnTTz89adKkWFbEvATzusC8LmJv3ikkJaFHdEGPBAV6RBeY1wXmdRH/
+wULPD82v3jxYjgcLi0tjc3P8Ovr65944gnh/+abb164cOGbb74Zg6IHDhxI
Tk5ubGyMQS0J5iWYNzBvAvPxAElJ6BGj15h3CklJ6BED8yYw7weYl8T/fsEC
D4/NN23aNHXq1AEDBiS0k5OT48UGWrF9+/Z+/fol/Jri4uKWlha/S994440b
N270u4oC8wrMY97AfDxBUgp6pJeYdwpJKegRzBuY9xPMK+J8v2CBh8fmeXl5
ZvN+J37o0KHk5GRR6L777qutrT1x4kR1dXVKSopYUlFR4WtpQXl5uajrdxUF
5hWYx7yB+XiCpBT0SC8x7xSSUtAjmDcw7yeYV8T5fsECD4/Nz5079692nnzy
yRgkXlZWJqpMnDjRfO5l06ZNYuGgQYPOnz/va/Vdu3b17dvX7yoKzCswj3kD
8/EESSnokV5i3ikkpaBHMG9g3k8wr4jz/YIFftwLbs2aNX4nfuHChbS0NFHl
/fffNy9vbW0dNmyYWL5hwwb/qguuXLly/fXXR1T3D8wrMI95M5jXDkkp6JFe
Yt4pJKWgRzBvBvOeg3lFnO8XLAjosflXX30lSqSmpnb8wcLjjz8uVi1dutS/
6pLi4uIHH3zQ7yoSzJvBfMQqzGNeIyRlhh6JWNUjzTuFpMzQIxGrMI95D8G8
mXjeL1gQ0GPzHTt2iBKjRo0y2k+MVFZWLliw4MsvvxRPV69eLVbNnTvXv+qS
bdu2DRo0qLW11e9CBuZ/DeYxr8C8dkjKDD3SG8w7haTM0COYV2DeczBvJp73
CxY8+uijDz/8sM3BHiZ+9uzZ2traM2fO2Cwdgfy1woQJE8TjmpoaeU+DWbNm
iafhcFg8Hj9+vLcVO9Lc3JyWlrZz506vJrQA82Ywj3kF5rVDUmbokd5g3ikk
ZYYewbwC856DeTPxvF/ojF9++WXo0KF/+9vfbI73JPFDhw5NnTo14SqjRo3a
smWL3S2+yiuvvCJeO3nyZKP9/vxyqpkzZ4qnYjbx+NZbb/W2YlQKCgrKyso8
mcoazEeAecxLMK8dkoqAHunx5p1CUhHQI5iXYN5zMB9B3O4XovKPf/wjFAqJ
EE+dOmXzJe4Tv3TpUlZWVmJi4gMPPPDaa689++yzo0ePFoP37dvnYNPbr1IQ
r7rllluMq1dKPPTQQ/JKiXXr1olV9957r7cVoxIOh9PT093P0yWYjwDzmJdg
3j1tbW2/dE6XLyepCOiRnmeeHglKUhFgPgLMY16C+Tjk9OnT4l2npaV99913
9l/lPvG9e/ea4zDa7+O3efNm+9sg2b9/v5gn6vbIvwuwaNEibytG5dixY2Ly
o0ePejKbBZiPAPNmMI95N5hPVneky4okFQE9YqZnmKdHul0xKvSIGcxj3kMw
H0HMzLuntbV13bp1o0eP/sMf/tDU1GTzVe4Tl1c1uL+6oLGxMTExUUx14MCB
iFW33367WP788897WzEq4pMzbNiwtrY2PyY3g/kIMG8G85h3w8mTJxs6p8v/
LUhSEdAjZnqGeXrEW+gRM5jHvIdgPoKYmfeKy5cvDxgwYOvWrTbHu0/8zJkz
Q4YMEWGVl5d///33HQd88cUXpaWlIrWsrKwZM2a88847nVWZPn16xyjr6urE
wqSkJHWGpMuKipaWlpKSkrlz5/7000923qYgFAqp0z5R+frrr3Nzc8UG3H//
/cK2zWk7gvkIMK/APOYlXpl3CklFQI8oeqp5p5BUBPSIAvOYl2A+6OY9ZP78
+cKwzcGe3GFgz549GRkZYkBycrLQ+9lnn6lVr776qlgo/Ijls2bNSk1NFcNW
rlwZdZ6PPvpITvLWW2/JJSdPnszOzhYL58yZY7OiGfHhsXl9mkSe2di+fbvF
mMLCQnXZm5v7BGLeDOYxr8C8wivzTiEpM/RIbzDvFJIyQ49gXoF5BeaDbt5D
vPr75gUFBb+9Sr9+/eR7VEumTZtmHixcvfHGG+PGjZPDQqGQPFPR0NAgNqax
sVEOO3z4cFJS0g033BC1YltbW1FRkXh5YmLi2LFj8/LyhH/xdMSIEd98803E
4M4qKsTHRiwXtcS/R44csWPj448/7t+//6VLlyzGLFu2TCX+1FNP2Zk2Kpg3
g3nMY74jXpl3CkmZoUd6g3mnkJQZegTzmO8I5oNu3kO8OjaXvx3oDPN98s3s
3r37tttuSzD96CACsVZ8fq5cuRJ1rQi9srJy8ODBskpKSkpubu4PP/xg8Rai
Vqyrq0tNTc3JyamqqkqwfTZmyZIl8+bNsx7z7bffzpkzR27eI488YmfaqGDe
DOYxj/mOeGXeKSRlhh7pDeadQlJm6BHMY74jmLeuGP/mPcSrY/NuIwISNu65
556Oq7Zs2SJCfOyxx6xnELkfPHhw3759Fy5c6EbFc+fOZWVlDRky5NixY889
95zNxEXR4cOHv/3223Yq5ufnJ3R+yYcdMG8uinnMdw/M+wFJmYvSI73BvFNI
ylyUHsF898C8HTBvLhrP+wULYnxsvmvXrhUrVjQ3N6slW7duFTYKCwvVkpqa
mry8vJEjR4q4y8vLz549619FEdzs2bNFoU8++UQ8tZ/4559/fs0119jZtp9/
/rlPnz5i2k8//bTb7wLzCsy7rIh5zHsLSSnoEZcVg2LeKSSloEdcVsQ85q3B
vCLO9wsWxPjYPBQKifeemZm5fPny9evXl5SUiDmF8N27d6sxIpG77rprxIgR
YuSkSZM63nvfw4qrVq0Sa9euXSsH20+8oqJiypQpXQ47cuTIHXfcIeacPHmy
m3eBeQXmXVbEPOa9haQU9IjLikEx7xSSUtAjLitiHvPWYF4R5/sFC2J8bN7W
1vbyyy9nZ2cnJSUltCMe19TURB28d+9ekfvgwYN//PFHPyqK+ZOTkwcOHPjM
Ve6++24xoLy8/IUXXrCe9qabbqqurrYes2fPHnnTgwkTJlj/UYAuwbwC824q
Yh7znkNSCnrETcUAmXcKSSnoETcVMY/5LsG8Is73Cxbo+r15U1NTbW2tutFf
Z7z++uvCWDgc9qPiu+++O/LXpKWliXLp6enjxo2zmKqhoUEMO378uHXFw4cP
i4/T+vXr3f/Je8xLMO+yIuYtwHz3ICkJPeKyYoDMO4WkJPSIy4qYtwDzEsxL
4n+/YIH2e8GZ+eCDD+rr681LKioqhFux3Ne6CptXSqxevXrs2LF2Jjx//rwX
24X5/4J5z8G8AvPdg6Qk9IjnxK15p5CUhB7xHMwrMC/BvCT+9wsWPPPMMzNn
zrQ52NfEW1paMjIyrr322sWLF4fD4Q8//LCsrCwpKSkzM7Opqcm/umZsJn7n
nXdWVVXFZpMkmJdg3nMwj3mXkJSEHvGcuDXvFJKS0COeg3nMR4B5SfzvFyzY
unXrdddd991339kZ7PfZmNOnTxcVFQ0dOlT+3CAxMTE/P9/m35f3BHnDAevE
T506JT6HEWeN/AbzBub9AfOYdwlJGfSIP8SteaeQlEGP+APmMR8B5o2A7Bcs
aG1tnThxYnp6+tq1a2tra60H+5244sSJE3V1dTE7CeOIDRs2ZGZmxrgo5g3M
6wPzutBi3ikkZdAj+qBHzJBUBJg3MK8PzOsiEPsFa5qbm1etWpWTk5ORkWE9
MmaJxzOhUGjFihUxLop5A/P6wLwutJh3CkkZ9Ig+6JGgQI/oAvO6wLwuArFf
8AoS1wXmdYF5XWA+KJCULjAfFEhKF5jXBeZ1gfneBonrAvO6wLwuMB8USEoX
mA8KJKULzOsC87rAfG+DxHWBeV1gXheYDwokpQvMBwWS0gXmdYF5XWAeAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAj
3M9fsHTp0pdeeinGRTFvYF4fmNeFFvNOISmDHtEHPRIU6BFdYF4XfDsFBZtJ
VVdX5+fn/+Uvf/nPf/4Tg62yCQkKXnzxxTFjxsS4KOYNzOsD87rQYt4pJGXQ
I/qgR4ICPaILzOuCb6egYDOp+vp6cWCemZn5u9/97vjx4zHYMDuQoODo0aMJ
CQni31gWxbyBeX1gXhdazDuFpAx6RB/0SFCgR3SBeV3w7RQUHCV1+fLl3Nzc
P/7xj35vlU1IUDJmzJg1a9bEsiLmJZjXBeZ1EXvzTiEpCT2iC3okKNAjusC8
Lvh2CgqOknrvvfcyMjL83BwHkKDk6aefnjRpUiwrYl6CeV1gXhexN+8UkpLQ
I7qgR4ICPaILzOuCb6eg4CipXbt2XX/99b5uj33sJHjx4sVwOFxaWhqbGyDU
19c/8cQTwufNN9+8cOHCN998MwZFDxw4kJyc3NjYGINaEsxLMG9g3gTm4wGS
ktAjRq8x7xSSktAjBuZNYD4eICmJo6QCdGy+adOmqVOnDhgwIKGdnJwcv7dn
+/bt/fr1S/g1xcXFLS0tfpe+8cYbN27c6HcVBeYVmMe8gfl4gqQU9EgvMe8U
klLQI5g3MB9PkJTCflIBOjbPy8szm/Q7wUOHDiUnJ4tC9913X21t7YkTJ6qr
q1NSUsSSiooKX0sLysvLRV2/qygwr8A85g3MxxMkpaBHeol5p5CUgh7BvIH5
eIKkFPaTCtCx+blz5/7VzpNPPhmDBMvKykSViRMnms+lbNq0SSwcNGjQ+fPn
fa0ucunbt6/fVRSYV2Ae8wbm4wmSUtAjvcS8U0hKQY9g3sB8PEFSCvtJBejY
XLFmzRq/E7xw4UJaWpqo8v7775uXt7a2Dhs2TCzfsGGDf9UFV65cEblEVPcP
zCswj3kzmNcOSSnokV5i3ikkpaBHMG8G89ohKYX9pDg2j8pXX30lSqSmpnb8
AcLjjz8uVi1dutS/6pLi4uIHH3zQ7yoSzJvBfMQqzGNeIyRlhh6JWNUjzTuF
pMzQIxGrMI95jZCUGZtJcWwelR07dogSo0aNMtpPdFRWVi5YsODLL78UT1ev
Xi1WzZ0717/qkm3btg0aNKi1tdXvQgbmfw3mMa/AvHZIygw90hvMO4WkzNAj
mFdgXjskZcZmUj312Pzs2bO1tbVnzpzp3pbIXx9MmDBBPK6pqZH3KJg1a5Z4
Gg6HxePx48d7W7Ejzc3NaWlpO3fu9GpCCzBvBvOYV2BeOyRlhh7pDeadQlJm
6BHMKzCvHZIyYzOpf/7zn3369BGDvarrBk8SPHTo0NSpUxOuMmrUqC1btjjd
kldeeUW8dvLkyUb7/fblVDNnzhRPxWzi8a233uptxagUFBSUlZV5MpU1mI8A
85iXYF47JBUBPdLjzTuFpCKgRzAvwbx2SCoCO0ldvnw5NTX173//uycV29ra
fumcLl/uPsFLly5lZWUlJiY+8MADr7322rPPPjt69GgxeN++fY7eyLZt28Sr
brnlFuPqlQ8PPfSQvPJh3bp1YtW9997rbcWohMPh9PR09/N0CeYjwDzmJZh3
D/uFoCQVAeYjoEe6pMcnFQHmI8B8zzPPt5OWpEpLS7Ozs3fu3Hnx4kWXFc0n
GTpy9OhR65e7T3Dv3r1mvUb7ffk2b97s6F0I9u/fL+aJuj3yPv+LFi3ytmJU
jh07ZsebezAfAebNYB7zbmC/0O2KUaFHzPQM8/RItytGhR4xg3nMu4Fvp25X
jIr9pBYuXChGVlVVuax48uTJhs7p8gSL+wTlVQrur+tobGxMTEwUUx04cCBi
1e233y6WP//8895WjIr4JAwbNqytrc2Pyc1gPgLMm8E85t3AfsFb6BEzPcM8
PeIt9IgZzGPeDXw7eYvNpP76179ed911S5YsOXLkiB+bYR/3CZ45c2bIkCFC
fnl5+ffff99xwBdffFFaWipSyMrKmjFjxjvvvNNZlenTp3eMpq6uTixMSkpS
Zzy6rKhoaWkpKSmZO3fuTz/9ZOdtCkKhkDqNE5Wvv/46NzdXbMD9999/+fJl
m9N2BPMRYF6BecxLvDLvFJKKgB5R9FTzTiGpCOgRBeYxL+HbyQhIUkb7Jff9
+/ffuHGjzTl9xZM7BuzZsycjI0MMSE5OFro+++wzterVV18VC4VwsXzWrFmp
qali2MqVK6PO89FHH8lJ3nrrLbnk5MmT2dnZYuGcOXNsVjQjPgw2rwCRiN4Z
MGDA9u3bLcYUFhaqC0vc3KER82Ywj3kF5hVemXcKSZmhR3qDeaeQlBl6BPMK
zCv4djICkpTRfvl9SkrKv//9bztz+o1FggUFBb+9Sr9+/aQKtWTatGnmweK9
v/HGG+PGjZPDQqGQPEfU0NAwf/78xsZGOezw4cNJSUk33HBD1IptbW1FRUXi
5YmJiWPHjs3LyxM+xdMRI0Z88803EYM7q6gQHwOxXNQS/9q8PuHjjz/u37//
pUuXLMYsW7ZM9dpTTz1lZ9qoYN4M5jGP+Y54Zd4pJGWGHukN5p1CUmboEcxj
viN8OxkBScoIzt83l78F6Azzfe/N7N69+7bbbksw/YggArFWfB6uXLkSda0I
sbKycvDgwbJKSkpKbm7uDz/8YPEWolasq6tLTU3NycmpqqpKsH12ZcmSJfPm
zbMe8+23386ZM0du3iOPPGJn2qhg3gzmMY/5jnhl3ikkZYYe6Q3mnUJSZugR
zGO+I3w7SeI/KSM4x+bdRggX0u65556Oq7Zs2SJCeeyxx6xnEDkePHhw3759
Fy5c6EbFc+fOZWVlDRky5NixY88995zNBEXR4cOHv/3223Yq5ufnJ3R+CYcd
MG8uinnMdw/M+wFJmYvSI73BvFNIylyUHsF898C8H5CUuajNpHrYsbl4OytW
rGhublZLtm7dKqQVFhaqJTU1NXl5eSNHjhTxlZeXnz171r+KIojZs2eLQp98
8ol4aj/Bzz///JprrrGzbT///HOfPn3EtJ9++mm33wXmFZh3WRHzmPcWklLQ
Iy4rBsW8U0hKQY+4rIh5zHsLSSnsJ9XDjs1DoZBQlJmZuXz58vXr15eUlIg5
hcDdu3erMcLwXXfdNWLECDFy0qRJHe+l72HFVatWibVr166Vg+0nWFFRMWXK
lC6HHTly5I477hBzTp482c27wLwC8y4rYh7z3kJSCnrEZcWgmHcKSSnoEZcV
MY95byEphc2kjB53bN7W1vbyyy9nZ2cnJSUltCMe19TURB28d+9ekePgwYN/
/PFHPyqK+ZOTkwcOHPjMVe6++24xoLy8/IUXXrCe9qabbqqurrYes2fPHnkT
gwkTJljf5L9LMK/AvJuKmMe855CUgh5xUzFA5p1CUgp6xE1FzGPec0hKYScp
SQ87Nlc0NTXV1taqG/d1xuuvvy6UhsNhPyq+++67I39NWlqaKJeenj5u3DiL
qRoaGsSw48ePW1c8fPiw+HisX7++yz9h3yWYl2DeZUXMW4D57kFSEnrEZcUA
mXcKSUnoEZcVMW8B5rsHSUlsJiXpqcfmUfnggw/q6+vNSyoqKoQrsdzXugqb
Vz6sXr167NixdiY8f/68F9uF+f+Cec/BvALz3YOkJPSI58SteaeQlIQe8RzM
KzDfPUhKYj8pozcdm7e0tGRkZFx77bWLFy8Oh8MffvhhWVlZUlJSZmZmU1OT
f3XN2EzwzjvvrKqqis0mSTAvwbznYB7zLiEpCT3iOXFr3ikkJaFHPAfzmHcJ
SUkcJSXeyPDhw11vmjf4fXbl9OnTRUVFQ4cOlT8fSExMzM/Pt/n34j1B3kDA
OsFTp06Jz1XEWSC/wbyBeX/APOZdQlIGPeIPcWveKSRl0CP+gHnMu4SkDOdJ
LViwIC8vz4ut8wC/E1ScOHGirq4uZidVHLFhw4bMzMwYF8W8gXl9YF4XWsw7
haQMekQf9IgZkooA8wbm9cG3k5kekJQ4hH/vvfemT5/ep0+f/fv3x2DD7BCz
BOOZUCi0YsWKGBfFvIF5fWBeF1rMO4WkDHpEH/RIUKBHdIF5XfDtFBRsJlVZ
Wfn73/9+/vz5Bw8ejMFW2YQEdYF5XWBeF5gPCiSlC8wHBZLSBeZ1gfmgQFJB
hwR1gXldYF4XmA8KJKULzAcFktIF5nWB+aBAUkGHBHWBeV1gXheYDwokpQvM
BwWS0gXmdYH5oEBSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9gP8DQumoIg==

    "], {{0, 40.}, {666., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{666., 40.},
  PlotRange->{{0, 666.}, {0, 40.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[516]=",
 CellID->1939752781,ExpressionUUID->"598a84ba-fc31-44a5-9869-3e9c8667a9b0"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "bc1adbe3-ceb2-47a9-af3a-94152a62d974"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"1518b4de-722c-46d3-8da0-\
bc1a72aa959a"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Algorithms",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumAlgorithms"]], 
         "RelatedTutorials",ExpressionUUID->
         "85a821bd-ce76-43f2-959c-0a3b579d44db"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "QuantumCircuit Usage Examples",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumCircuitUsage"]], 
         "RelatedTutorials",ExpressionUUID->
         "f36525c9-96d2-47b4-8cec-42a51a5baff6"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "078eaeae-e76c-479b-b11b-fd63fe483fd1"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"e1ba7455-53c1-43d6-9f85-\
e502d21827a7"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{
         "Related", " ", "Wolfram", " ", "Education", " ", "Group", " ", 
          "Courses"}], "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-EIWL.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "An Elementary Introduction to the Wolfram Language"}]]]], 
          "https://www.wolfram.com/language/elementary-introduction/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "2eb401a1-ea3b-4f55-93c2-95a4e54b4a4b"]], "TutorialRelatedLinks",
        ExpressionUUID->"8ecf38b6-99a7-4fcd-827d-f56e9f7be294"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-FastIntro.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "The Wolfram Language: Fast Introduction for Programmers"}]]]],
           "https://www.wolfram.com/language/fast-introduction-for-\
programmers/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "3d02b420-95d0-400a-b117-b7b1ea61583e"]], "TutorialRelatedLinks",
        ExpressionUUID->"19b74253-f9f8-4aaf-a328-bda2e73efc83"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"26a06c90-bb01-4d3a-b5cc-\
9bf60d9ddf8d"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "C. H. Bennet, G. Brassard, C. Crepeau, R. Jozsa, A. Peres, \
and W. K. Wootters, Physical Review Letters 70, 1895 (1993)"}]]]], 
             "https://doi.org/10.1103/PhysRevLett.70.1895"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "11bcd4f4-1562-4381-8c35-c4edb95c34fe"]}]],ExpressionUUID->
         "cc19f568-9262-426c-bea3-3084b87d58d3"],
        ", \[OpenCurlyDoubleQuote]Teleporting an Unknown Quantum State via \
Dual Classical and Einstein-Podolsky-Rosen Channels.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "4800e2e7-984e-4588-9d00-336512f4c077"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "C. H. Bennett and S. J. Wiesner, Physical Review Letters \
69 (20), 2881 (1992)"}]]]], "https://doi.org/10.1103/PhysRevLett.69.2881"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "9f0cf374-8110-4345-a573-b69f8cce1c31"]}]],ExpressionUUID->
         "c8513203-1442-43ab-8ffe-9df43fe9e714"],
        ", \[OpenCurlyDoubleQuote]Communication via one- and two-particle \
operators on Einstein-Podolsky-Rosen states.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "cdb1afb5-1d0d-4c32-aaf0-7ce530535dec"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Gottesman and I. Chuang, Nature 402, 390-393 \
(1999)"}]]]], "https://doi.org/10.1038/46503"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "39203255-94df-4588-96a1-bf6354a7df08"]}]],ExpressionUUID->
         "0583081c-f920-460e-93a1-2b113de7d863"],
        ", \"Quantum teleportation as a universal computational primitive.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "9389307e-d19e-418a-94eb-b7d2dea7de24"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. A. Nielsen. Physics Letters A, 308, 96\[Dash]100 \
(2003)"}]]]], "https://doi.org/10.1016/S0375-9601(02)01803-0"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c52bf38e-fa2f-4c0a-a639-9f5da617ddb8"]}]],ExpressionUUID->
         "c5430c45-fc97-4ba6-84e5-4f4c69f9fc13"],
        ", \[OpenCurlyDoubleQuote]Quantum computation by measurement and \
quantum memory.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "583eb53e-f5c9-457c-babc-1df2dc001c28"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. W. Leung, International Journal of Quantum Information \
2, 33-43, (2004)"}]]]], "https://doi.org/10.1142/S0219749904000055"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "b0c2b954-9bf8-4059-8906-3614f7d59651"]}]],ExpressionUUID->
         "32209f32-4f15-44ae-ab88-3924e009641b"],
        ", \[OpenCurlyDoubleQuote]Quantum computation by measurements.\
\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "5d55051c-ec7d-47ba-85f4-a1ceb8ca6f0c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "E. Knill, R. Laflamme, and G. J. Bilburn, Nature 409, 46 \
(2001)"}]]]], "https://doi.org/10.1038/35051009"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "fe108856-e0d2-4aa4-bc19-3de0afd69778"]}]],ExpressionUUID->
         "1e4368e0-2ff3-48a2-b5ba-0384a19a238a"],
        ", \"A scheme for efficient quantum computation with linear \
optics.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c61c154e-1210-47e9-9d9b-92c3463f3e7c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "ecc9e9f1-c70d-4d0e-9554-a852b700d15a"]}]],ExpressionUUID->
         "7e9997cb-517e-4278-8ebc-141e9bb0949a"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "5d8a7044-9a96-4c48-a826-1b22372bd788"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "3b7c6dc2-b1de-4a49-9f86-572190e7c05d"]}]],ExpressionUUID->
         "dd5dff02-e27a-4bab-a514-9c006bb0d820"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "39491a6f-db00-44cd-beb9-0688c83c9f8f"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"3786f956-00ce-48a7-bb6b-\
9527f55d8043"],

Cell[" ", "FooterCell",ExpressionUUID->"6b847fe5-1508-4dd4-81da-6a0f4c63137e"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Quantum Teleportation",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", "2021"}, 
  "ShowCitation" -> False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2023, 2, 20, 19, 35, 28.406180}", 
    "history" -> {"12", "13", "", ""}, "context" -> "Q3`", 
    "keywords" -> {
     "quantum teleportation", "quantum entanglement", "quantum communication",
       "quantum information"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 4.1 of the Quantum Workbook (Springer, 2022). Quantum \
teleportation is a communication protocol that sends quantum information to a \
distant party by utilizing a pre-shared pair of entangled particles (Bennett \
et al., 1993). The protocol has attracted public interest since it resembles \
(fictional) teleportation. In science fiction, (hypothetical) teleportation \
instantly transports matter or energy across space. Quantum teleportation \
does not transfer physical objects but only quantum information. Quantum \
teleportation is also conceptually distinguished from telefax. Telefax makes \
a copy of the document and sends the duplicated copy while the original \
document remains at its origin. In quantum teleportation, a quantum state is \
transferred and disappears from the original system. Quantum teleportation is \
one of the first quantum information protocols that vividly illustrates the \
significance of quantum entanglement as a valuable resource. In this section, \
we discuss the physical principle behind quantum teleportation and \
demonstrate the protocol. Another closely related quantum communication \
protocol is the so-called superdense coding (Bennett and Wiesenr, 1992).", 
    "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$23902, "title" -> 
    "Quantum Teleportation", "titlemodifier" -> "", "windowtitle" -> 
    "Quantum Teleportation", "type" -> "Tutorial", "uri" -> 
    "Q3/tutorial/QuantumTeleportation"}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.2 for Mac OS X ARM (64-bit) (January 30, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"6dffac02-903c-4378-8623-06eeae2c4fb0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "RasterizedOutput"->{
  Cell[210436, 5837, 9269, 158, 61, "Output",ExpressionUUID->"bf2acbae-2bab-486c-9083-4599e3cc6cd2",
   CellTags->"RasterizedOutput",
   CellID->1962058963],
  Cell[229317, 6215, 9290, 159, 61, "Output",ExpressionUUID->"8aeb0f9d-b7ed-4dff-a8b6-94ba4b26e922",
   CellTags->"RasterizedOutput",
   CellID->1713591456],
  Cell[248218, 6594, 8288, 142, 61, "Output",ExpressionUUID->"0ab9553d-d103-41f4-9b17-f6322f6dcc3c",
   CellTags->"RasterizedOutput",
   CellID->428411075],
  Cell[266118, 6956, 9412, 161, 61, "Output",ExpressionUUID->"598a84ba-fc31-44a5-9869-3e9c8667a9b0",
   CellTags->"RasterizedOutput",
   CellID->1939752781]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"RasterizedOutput", 291156, 7511}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 7345, 174, 57, "AnchorBarGrid",ExpressionUUID->"16d8f8b3-5f0d-417f-a472-229c26f97c44",
 CellID->1],
Cell[CellGroupData[{
Cell[7963, 199, 1177, 31, 59, "ObjectNameGrid",ExpressionUUID->"f2e49850-3451-42e6-a73a-7c9c06073bef"],
Cell[9143, 232, 5472, 119, 97, "TutorialJumpBox",ExpressionUUID->"bcdd1ecd-aae8-4198-b7b9-750eb8542d3d"],
Cell[14618, 353, 410, 13, 38, "Text",ExpressionUUID->"a1c45584-4cbb-4b95-bb86-8312b187a022",
 CellID->1308734266],
Cell[15031, 368, 913, 16, 156, "Text",ExpressionUUID->"b2c763b6-b692-40b3-affc-55068600cd74",
 CellID->646075679],
Cell[15947, 386, 501, 8, 108, "Text",ExpressionUUID->"3186cab3-dda4-4a98-b27c-92f4f2fe6cbd",
 CellID->916617721],
Cell[16451, 396, 387, 6, 84, "Text",ExpressionUUID->"e1797c10-cbbf-42ff-9675-e1ef393e44ea",
 CellID->1693836916],
Cell[16841, 404, 2484, 64, 249, "DefinitionBox",ExpressionUUID->"000b48ff-c85b-4b50-93ba-e3ad3631040a",
 CellID->2096742444],
Cell[19328, 470, 151, 1, 36, "Caption",ExpressionUUID->"6f3aedc2-a9f9-45fe-bd19-93199b02a969",
 CellID->1891092685],
Cell[19482, 473, 192, 4, 70, "MathCaption",ExpressionUUID->"ed76b3b5-a806-4c91-ac58-8b35d055b8cb",
 CellID->1428640008],
Cell[19677, 479, 147, 3, 70, "Input",ExpressionUUID->"7bbe438d-9dea-4110-b236-08980f631554",
 CellID->853967906],
Cell[19827, 484, 310, 6, 70, "MathCaption",ExpressionUUID->"460f0004-a488-42f9-b996-1a5fc83725e9",
 CellID->1937193009],
Cell[20140, 492, 271, 6, 70, "Input",ExpressionUUID->"5d7bb87d-142a-4b91-99eb-975bf99c5af0",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[20448, 503, 102, 1, 70, "Section",ExpressionUUID->"98276746-b394-4c77-9691-298645f43018",
 CellID->255888865],
Cell[20553, 506, 1067, 31, 70, "Text",ExpressionUUID->"65ef87c4-46ff-4c2d-b5bc-b60db4f316e1",
 CellID->1461892761],
Cell[21623, 539, 513, 14, 70, "Text",ExpressionUUID->"1764bc83-568e-4e1a-98ee-07ff994a90d9",
 CellID->671228800]
}, Open  ]],
Cell[CellGroupData[{
Cell[22173, 558, 107, 1, 70, "Section",ExpressionUUID->"1aff1c39-5ba2-4404-97af-3b4cf6b34834",
 CellID->610843909],
Cell[22283, 561, 148, 3, 70, "Input",ExpressionUUID->"3efcd23e-941b-48d0-9608-3a163a26d9c5",
 CellID->1866199296],
Cell[22434, 566, 272, 6, 70, "Input",ExpressionUUID->"53594233-bf93-44ba-978e-a412bcea26e7",
 CellID->1151055825],
Cell[22709, 574, 608, 17, 70, "Text",ExpressionUUID->"2a5f717f-821b-46c7-a8e4-5fc48c3cad9c",
 CellID->1481745903],
Cell[23320, 593, 1485, 62, 70, "DisplayMath",ExpressionUUID->"f61cc824-c5f9-4b1e-86ea-09fe9305a292",
 CellID->1483021109],
Cell[CellGroupData[{
Cell[24830, 659, 262, 7, 70, "Input",ExpressionUUID->"97697232-9e18-45db-8e65-7323cd1c19b1",
 CellID->1440571881],
Cell[25095, 668, 5385, 160, 62, "Output",ExpressionUUID->"bfc40ae4-9ac6-40aa-a810-7d1fb6dd28a8",
 CellID->551051522]
}, Open  ]],
Cell[30495, 831, 275, 7, 70, "Text",ExpressionUUID->"11c4f4fb-7fb0-49f9-90b5-7653c26e3a81",
 CellID->1906923583],
Cell[30773, 840, 557, 21, 70, "DisplayMath",ExpressionUUID->"427e08b3-3ca9-415e-b7ea-b632c42a53aa",
 CellID->618711653],
Cell[CellGroupData[{
Cell[31355, 865, 443, 13, 70, "Input",ExpressionUUID->"3d414470-4334-4d10-b25b-72f95d641fbd",
 CellID->570933197],
Cell[31801, 880, 1179, 41, 41, "Output",ExpressionUUID->"86d1fcd6-67f8-459f-84a0-b2e13110243d",
 CellID->1581637035]
}, Open  ]],
Cell[32995, 924, 354, 9, 70, "Text",ExpressionUUID->"06d811e3-bb1e-4b73-bcef-aa78939459ba",
 CellID->1956114070],
Cell[33352, 935, 1009, 38, 70, "DisplayMath",ExpressionUUID->"b1ced1e1-bd96-433c-bd19-258cca559d81",
 CellID->582022567],
Cell[CellGroupData[{
Cell[34386, 977, 231, 6, 70, "Input",ExpressionUUID->"4d9986aa-f015-4871-bf59-de51b684b26c",
 CellID->265271484],
Cell[34620, 985, 4438, 139, 62, "Output",ExpressionUUID->"eb1cfee7-4b07-4503-bef2-81bcbbe3c289",
 CellID->304695646]
}, Open  ]],
Cell[39073, 1127, 247, 9, 70, "MathCaption",ExpressionUUID->"84c98925-0cce-41a4-a4cb-2e0be13e007e",
 CellID->337551720],
Cell[CellGroupData[{
Cell[39345, 1140, 345, 10, 70, "Input",ExpressionUUID->"ac1d9b3e-b68f-4ae0-b973-a98086cee91e",
 CellID->1685891102],
Cell[39693, 1152, 2426, 79, 62, "Output",ExpressionUUID->"394e9450-d3a3-40b5-900c-869c1930ae31",
 CellID->433501179]
}, Open  ]],
Cell[42134, 1234, 315, 8, 70, "Text",ExpressionUUID->"a2a8ea89-b29a-4102-8131-a3607cbb9dc4",
 CellID->564391588],
Cell[42452, 1244, 2312, 85, 70, "DisplayMath",ExpressionUUID->"53bdb13b-933a-4986-8edb-cc4ea7fcf48a",
 CellID->294150717],
Cell[CellGroupData[{
Cell[44789, 1333, 687, 21, 70, "Input",ExpressionUUID->"4d3eaba2-5a2a-4012-9bd4-a3d1272510ac",
 CellID->283745225],
Cell[45479, 1356, 15013, 398, 172, "Output",ExpressionUUID->"c778b219-e170-4ac7-a3c6-edded7a59e2a",
 CellID->606896830]
}, Open  ]],
Cell[60507, 1757, 758, 20, 70, "Text",ExpressionUUID->"7f055d76-85e1-4ebd-afbb-10bc9bd42e9d",
 CellID->628536332],
Cell[61268, 1779, 1493, 53, 70, "DisplayMath",ExpressionUUID->"8cce4004-c464-440e-a97b-c93110fd1bf3",
 CellID->338072331],
Cell[CellGroupData[{
Cell[62786, 1836, 584, 17, 70, "Input",ExpressionUUID->"10247fd3-2085-4359-95bd-2d936717a734",
 CellID->1887420802],
Cell[63373, 1855, 14914, 397, 172, "Output",ExpressionUUID->"aaccfd6c-b9d1-4f70-9c18-184da3cc1e96",
 CellID->714324845]
}, Open  ]],
Cell[78302, 2255, 2536, 74, 70, "Text",ExpressionUUID->"ce04a70a-1a3f-4f43-807f-b151a88df3bc",
 CellID->1268048119],
Cell[80841, 2331, 180, 4, 70, "Text",ExpressionUUID->"ff3b27d3-7d37-405b-8200-5fdb10c4233d",
 CellID->457023205],
Cell[81024, 2337, 671, 17, 70, "ItemNumbered",ExpressionUUID->"e9a3a6c4-2ec5-431a-8f55-b3fb5c112882",
 CellID->1787484763],
Cell[81698, 2356, 438, 12, 70, "ItemNumbered",ExpressionUUID->"da660e5d-194d-40c9-acff-c36f8b507719",
 CellID->1107673858],
Cell[82139, 2370, 228, 4, 70, "ItemNumbered",ExpressionUUID->"5f38619c-f64f-4fdd-89d6-809c5a93d0a9",
 CellID->138795563],
Cell[82370, 2376, 185, 3, 70, "ItemNumbered",ExpressionUUID->"19d548b6-0bf1-4118-81b5-1966f5e4b961",
 CellID->569786699]
}, Open  ]],
Cell[CellGroupData[{
Cell[82592, 2384, 107, 1, 70, "Section",ExpressionUUID->"ce71ca63-a02c-4aac-a616-8a2b3e50c444",
 CellID->775468120],
Cell[82702, 2387, 147, 3, 70, "Input",ExpressionUUID->"d9298cce-36f8-4a5b-9c20-3e748605c026",
 CellID->408379708],
Cell[82852, 2392, 271, 6, 70, "Input",ExpressionUUID->"9539b2ab-05d4-4410-8129-e5cf2d4ccb67",
 CellID->280016544],
Cell[83126, 2400, 363, 6, 70, "Text",ExpressionUUID->"cd9be0d1-370a-4ad8-a5f3-6f45a6d0bb8c",
 CellID->214439197],
Cell[CellGroupData[{
Cell[83514, 2410, 122, 1, 70, "Subsection",ExpressionUUID->"a046bcfd-ea13-48ad-9b51-e8703516840c",
 CellID->602024313],
Cell[83639, 2413, 973, 24, 70, "Text",ExpressionUUID->"e1fc78c0-6820-4590-9d3c-b540b8271749",
 CellID->1427167574],
Cell[84615, 2439, 998, 39, 70, "DisplayMath",ExpressionUUID->"6c7077bf-f55e-4c68-913b-1d6bc59d7713",
 CellID->1160562875],
Cell[85616, 2480, 617, 16, 70, "Text",ExpressionUUID->"c1161204-bc27-4793-9de8-4f9e037ab426",
 CellID->2133758071],
Cell[CellGroupData[{
Cell[86258, 2500, 395, 11, 70, "Input",ExpressionUUID->"d9886e7e-1b83-4451-9435-7fb766cd6705",
 CellID->1242478044],
Cell[86656, 2513, 1372, 32, 95, "Output",ExpressionUUID->"b8ac1056-f8b7-4196-bbe0-bf72dac1f248",
 CellID->451008042]
}, Open  ]],
Cell[88043, 2548, 183, 4, 70, "Text",ExpressionUUID->"f2f5ff0c-f7c8-46a1-b32a-2cb2ad51ac4e",
 CellID->1555223945],
Cell[CellGroupData[{
Cell[88251, 2556, 499, 14, 70, "Input",ExpressionUUID->"a4b9019e-7c65-4161-a57c-6d91684c126c",
 CellID->1625375978],
Cell[88753, 2572, 9462, 268, 172, "Output",ExpressionUUID->"bf9e572a-68d8-4167-9c4e-73e6053eb61b",
 CellID->737767785]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98264, 2846, 121, 1, 70, "Subsection",ExpressionUUID->"adac3158-8cc1-47a2-b45e-8f805e1cc3c4",
 CellID->101265955],
Cell[98388, 2849, 1023, 28, 70, "Text",ExpressionUUID->"3ed3f8ab-5862-4b14-8522-76f8d3f41c0e",
 CellID->1169857261],
Cell[99414, 2879, 810, 15, 70, "Text",ExpressionUUID->"52b37ffd-1403-43e4-bf2b-85b365b69cf3",
 CellID->1578197342],
Cell[CellGroupData[{
Cell[100249, 2898, 395, 11, 70, "Input",ExpressionUUID->"e68a9e05-d272-45d6-840b-36e3634897b9",
 CellID->1192202897],
Cell[100647, 2911, 1378, 33, 95, "Output",ExpressionUUID->"b2d0261a-47ae-42ae-9141-3bf08edf1ccb",
 CellID->1746072306]
}, Open  ]],
Cell[CellGroupData[{
Cell[102062, 2949, 502, 14, 70, "Input",ExpressionUUID->"c929f6cc-5594-4d90-aa54-ac5f201b7df6",
 CellID->191673749],
Cell[102567, 2965, 9275, 259, 172, "Output",ExpressionUUID->"f683e1f8-2950-49e1-8a5c-ce68653a371a",
 CellID->198655586]
}, Open  ]],
Cell[111857, 3227, 1185, 41, 70, "Text",ExpressionUUID->"7f254402-d6a5-45f5-9e93-36d57c3ea54b",
 CellID->2122934521]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113091, 3274, 109, 1, 70, "Section",ExpressionUUID->"665dd56a-09c2-4747-8cb4-65af7e5eec7c",
 CellID->1867183189],
Cell[113203, 3277, 147, 3, 70, "Input",ExpressionUUID->"48bb5b71-f751-4566-9354-0b624daacafc",
 CellID->605069054],
Cell[113353, 3282, 272, 6, 70, "Input",ExpressionUUID->"5922d56c-4d8a-4e2c-9deb-6f0d2c9a973d",
 CellID->1060522033],
Cell[113628, 3290, 256, 6, 70, "Text",ExpressionUUID->"2ad63dc5-33b6-47fd-8769-1e3fd06cd4d0",
 CellID->569323912],
Cell[CellGroupData[{
Cell[113909, 3300, 789, 21, 70, "Input",ExpressionUUID->"26045eb9-7475-4d9b-8b42-9f3d17864d0a",
 CellID->1587341599],
Cell[114701, 3323, 2145, 51, 182, "Output",ExpressionUUID->"6f4c638c-8bdf-404c-bea5-113c3c8ce564",
 CellID->419919473]
}, Open  ]],
Cell[116861, 3377, 326, 8, 70, "Text",ExpressionUUID->"ba2dd9ff-e955-4c80-b3e5-a77a6ad43b0a",
 CellID->89151289],
Cell[CellGroupData[{
Cell[117212, 3389, 439, 13, 70, "Input",ExpressionUUID->"3c689df2-4e16-4503-8b19-e1950fd71108",
 CellID->2061792057],
Cell[117654, 3404, 1178, 41, 41, "Output",ExpressionUUID->"4a8f02ad-482f-4395-9dd1-b2bd7a43b0bd",
 CellID->814355289]
}, Open  ]],
Cell[118847, 3448, 151, 1, 70, "Text",ExpressionUUID->"da65f36b-186d-4b5e-8d08-ceed376191a1",
 CellID->1694211991],
Cell[CellGroupData[{
Cell[119023, 3453, 384, 10, 70, "Input",ExpressionUUID->"9a564a23-db9e-4a94-9701-df421bb34f6c",
 CellID->1135257164],
Cell[119410, 3465, 2664, 64, 163, "Output",ExpressionUUID->"655ef570-463c-49e9-a1a1-ac378be1ce41",
 CellID->859293260]
}, Open  ]],
Cell[122089, 3532, 137, 1, 70, "Text",ExpressionUUID->"94149fb7-f708-429d-9f48-e6ab176b5418",
 CellID->700603084],
Cell[CellGroupData[{
Cell[122251, 3537, 254, 5, 70, "Input",ExpressionUUID->"dfea8ec5-e292-4da1-8f8c-ae9154a02355",
 CellID->383196287],
Cell[122508, 3544, 4439, 139, 62, "Output",ExpressionUUID->"37d823a8-c814-4da5-b22e-3bfea2dcd2fb",
 CellID->1399804005],
Cell[126950, 3685, 3180, 92, 62, "Output",ExpressionUUID->"e17eb069-5829-4f7e-a659-a31a93c6c80a",
 CellID->822559150]
}, Open  ]],
Cell[130145, 3780, 279, 6, 70, "Text",ExpressionUUID->"fc657542-35f4-4f96-ab86-801b1c092b47",
 CellID->1938265960],
Cell[CellGroupData[{
Cell[130449, 3790, 1344, 37, 70, "Input",ExpressionUUID->"7072a82b-73b9-429d-89df-83e16814d85d",
 CellID->1256548377],
Cell[131796, 3829, 2367, 53, 187, "Output",ExpressionUUID->"c1f52362-e6bf-4ae0-b4c1-1b8178efe8a8",
 CellID->1669976044],
Cell[134166, 3884, 9276, 259, 172, "Output",ExpressionUUID->"cf5bb7ce-585e-4f55-beb5-b5af9306b5df",
 CellID->1823588865]
}, Open  ]],
Cell[143457, 4146, 140, 1, 70, "Text",ExpressionUUID->"243986b2-66a5-436a-ac80-ca76d53462e7",
 CellID->551325794],
Cell[CellGroupData[{
Cell[143622, 4151, 248, 5, 70, "Input",ExpressionUUID->"f8883b90-2daa-4894-b29d-9644530f585e",
 CellID->1888166600],
Cell[143873, 4158, 4477, 100, 165, "Output",ExpressionUUID->"326b4a0f-a537-4880-be6d-f9327ab26f75",
 CellID->797534236]
}, Open  ]],
Cell[148365, 4261, 160, 3, 70, "Text",ExpressionUUID->"d593f302-91de-4abc-8bd6-3321fc8d21e5",
 CellID->450547474],
Cell[CellGroupData[{
Cell[148550, 4268, 759, 22, 70, "Input",ExpressionUUID->"29f0b595-b158-443e-b72c-29f7f12e5542",
 CellID->324056196],
Cell[149312, 4292, 2369, 71, 52, "Output",ExpressionUUID->"2d86d0b0-00a7-4e93-bfc1-9582ee2caaa2",
 CellID->736776562]
}, Open  ]],
Cell[151696, 4366, 430, 10, 70, "Text",ExpressionUUID->"0261fa4f-d3da-4266-bbf6-e59571eeea7d",
 CellID->549601959],
Cell[152129, 4378, 203, 4, 70, "Text",ExpressionUUID->"0fcc0174-8b06-4499-bfe5-42fa39f92f2c",
 CellID->158133487],
Cell[CellGroupData[{
Cell[152357, 4386, 640, 17, 70, "Input",ExpressionUUID->"1055f01f-5a2e-4abc-be29-55c202e6e7ae",
 CellID->1612209499],
Cell[153000, 4405, 5733, 129, 166, "Output",ExpressionUUID->"ad47c0ca-dec0-4710-b11d-64afda13e692",
 CellID->1694038429]
}, Open  ]],
Cell[158748, 4537, 134, 1, 70, "Text",ExpressionUUID->"99494841-5ccc-491c-bbf8-a615c2383fc6",
 CellID->98808169],
Cell[CellGroupData[{
Cell[158907, 4542, 320, 8, 70, "Input",ExpressionUUID->"ddb8b835-971e-499e-a2ae-31ccf573cf56",
 CellID->629111375],
Cell[159230, 4552, 2368, 71, 52, "Output",ExpressionUUID->"b563fb95-6a76-4416-88bd-3b76bf7dd86c",
 CellID->79002155]
}, Open  ]],
Cell[161613, 4626, 355, 7, 70, "Text",ExpressionUUID->"177e7dd9-ef1c-4137-9da1-ed20a081f1ec",
 CellID->1580905],
Cell[CellGroupData[{
Cell[161993, 4637, 1119, 32, 70, "Input",ExpressionUUID->"ff33ff11-83c8-469f-88b8-267be03d196e",
 CellID->800466571],
Cell[163115, 4671, 116, 1, 70, "EchoTiming",ExpressionUUID->"2e99954e-92a4-42a2-8da1-794e520611bd",
 CellID->1221222170],
Cell[163234, 4674, 4766, 126, 70, "Output",ExpressionUUID->"5697eece-b7de-461e-a5c2-3aef85f21415",
 CellID->1579796811]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[168049, 4806, 106, 1, 70, "Section",ExpressionUUID->"33ec6e84-e8de-4c3c-8ce9-799dce3a3c85",
 CellID->534588153],
Cell[168158, 4809, 148, 3, 70, "Input",ExpressionUUID->"1994c13a-8406-47fe-8154-2a335d7d434c",
 CellID->1368600113],
Cell[168309, 4814, 271, 6, 70, "Input",ExpressionUUID->"8e4dea32-2063-4c94-9a1b-d9943df3a134",
 CellID->364756174],
Cell[168583, 4822, 598, 9, 70, "Text",ExpressionUUID->"376f49a1-c60c-4847-b12c-e640b81c702f",
 CellID->92429197],
Cell[169184, 4833, 304, 5, 70, "Text",ExpressionUUID->"26bef74c-1864-4102-a00a-9d8e2ffc6499",
 CellID->1611475377],
Cell[169491, 4840, 8252, 178, 70, "Text",ExpressionUUID->"a831faa7-5619-418d-abdc-2f909ac5234a",
 CellID->1813710902],
Cell[177746, 5020, 704, 12, 70, "Caption",ExpressionUUID->"946ff3f0-eeea-4746-a930-e435a4167620",
 CellID->2117616808],
Cell[178453, 5034, 174, 3, 70, "MathCaption",ExpressionUUID->"dc33b546-b975-4efe-b7df-02bec4228032",
 CellID->1018270130],
Cell[CellGroupData[{
Cell[178652, 5041, 1078, 30, 70, "Input",ExpressionUUID->"ba1f1d48-dcd1-4923-8652-b838eccd8555",
 CellID->1376831930],
Cell[179733, 5073, 3926, 91, 164, "Output",ExpressionUUID->"2619e3a0-1f42-49e8-af72-d2ec07e6acbd",
 CellID->138188345]
}, Open  ]],
Cell[CellGroupData[{
Cell[183696, 5169, 383, 11, 70, "Input",ExpressionUUID->"777c8158-acbf-464b-a8f9-d39204ed8b69",
 CellID->1149330186],
Cell[184082, 5182, 5208, 147, 52, "Output",ExpressionUUID->"5e82665c-b180-49ce-a38e-908a2ce6e7ae",
 CellID->842641301]
}, Open  ]],
Cell[189305, 5332, 209, 4, 70, "MathCaption",ExpressionUUID->"d5559424-0fdb-4f67-9f93-9ac89a8fca08",
 CellID->1088805765],
Cell[CellGroupData[{
Cell[189539, 5340, 2027, 57, 70, "Input",ExpressionUUID->"98ec1ece-d7a4-4550-bcb5-f5edc6af809a",
 CellID->69120072],
Cell[191569, 5399, 7495, 167, 239, "Output",ExpressionUUID->"f9ca494b-7042-43a0-8aa4-bfdedf1e6bc5",
 CellID->1100065657]
}, Open  ]],
Cell[199079, 5569, 196, 4, 70, "MathCaption",ExpressionUUID->"f0b23c22-93dc-4e66-a991-60873c712c46",
 CellID->627577103],
Cell[199278, 5575, 1559, 43, 70, "Input",ExpressionUUID->"57b47f85-53e7-4d2f-9108-1c3d45189d6c",
 CellID->1746593056],
Cell[CellGroupData[{
Cell[200862, 5622, 206, 5, 70, "Input",ExpressionUUID->"9e6472e6-80c4-4493-afbd-ed44842edf14",
 CellID->150274438],
Cell[201071, 5629, 9362, 206, 70, "Echo",ExpressionUUID->"c63e01ca-ad51-443f-8d6c-1fd2c8cf4944",
 CellID->1910444916],
Cell[210436, 5837, 9269, 158, 61, "Output",ExpressionUUID->"bf2acbae-2bab-486c-9083-4599e3cc6cd2",
 CellTags->"RasterizedOutput",
 CellID->1962058963]
}, Open  ]],
Cell[CellGroupData[{
Cell[219742, 6000, 207, 5, 70, "Input",ExpressionUUID->"93655636-6d70-4db4-8a8c-e045f38e6f9d",
 CellID->1433668926],
Cell[219952, 6007, 9362, 206, 70, "Echo",ExpressionUUID->"0e670722-72c6-4dac-aa0f-3185a54707a8",
 CellID->1614405197],
Cell[229317, 6215, 9290, 159, 61, "Output",ExpressionUUID->"8aeb0f9d-b7ed-4dff-a8b6-94ba4b26e922",
 CellTags->"RasterizedOutput",
 CellID->1713591456]
}, Open  ]],
Cell[CellGroupData[{
Cell[238644, 6379, 207, 5, 70, "Input",ExpressionUUID->"e40643f3-4618-49de-9b0d-c737f754e2ce",
 CellID->1878344926],
Cell[238854, 6386, 9361, 206, 70, "Echo",ExpressionUUID->"88106ab8-bf74-4e02-82ad-f72e437eed1d",
 CellID->727911928],
Cell[248218, 6594, 8288, 142, 61, "Output",ExpressionUUID->"0ab9553d-d103-41f4-9b17-f6322f6dcc3c",
 CellTags->"RasterizedOutput",
 CellID->428411075]
}, Open  ]],
Cell[CellGroupData[{
Cell[256543, 6741, 207, 5, 70, "Input",ExpressionUUID->"8e340e8c-6366-4bcf-995a-2cd0a1f115e0",
 CellID->1240376261],
Cell[256753, 6748, 9362, 206, 70, "Echo",ExpressionUUID->"1c7e375d-cf0a-4d32-888b-3bf7d2ada26c",
 CellID->1016600475],
Cell[266118, 6956, 9412, 161, 61, "Output",ExpressionUUID->"598a84ba-fc31-44a5-9869-3e9c8667a9b0",
 CellTags->"RasterizedOutput",
 CellID->1939752781]
}, Open  ]]
}, Open  ]],
Cell[275557, 7121, 714, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"1518b4de-722c-46d3-8da0-bc1a72aa959a"],
Cell[276274, 7141, 1372, 36, 70, "RelatedTutorialsSection",ExpressionUUID->"e1ba7455-53c1-43d6-9f85-e502d21827a7"],
Cell[277649, 7179, 2163, 59, 70, "TutorialRelatedLinksSection",ExpressionUUID->"26a06c90-bb01-4d3a-b5cc-9bf60d9ddf8d"],
Cell[279815, 7240, 7861, 198, 70, "TutorialRelatedLinksSection",ExpressionUUID->"3786f956-00ce-48a7-bb6b-9527f55d8043"],
Cell[287679, 7440, 78, 0, 70, "FooterCell",ExpressionUUID->"6b847fe5-1508-4dd4-81da-6a0f4c63137e"]
}
]
*)

(* End of internal cache information *)

