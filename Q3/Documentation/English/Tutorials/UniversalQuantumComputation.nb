(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72283,       2066]
NotebookOptionsPosition[     63148,       1879]
NotebookOutlinePosition[     65779,       1941]
CellTagsIndexPosition[     65736,       1938]
WindowTitle->Universal Quantum Computation: Demonstration
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 TUTORIAL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"QuantumCircuit Usage \
Examples\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumCircuitUsage"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumTeleportation"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"RelatedTutorialsSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/QuissoPackageGuide"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialMoreAboutSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Functions",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Functions", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/GrayTwoLevelU"], "\<\"TwoLevelDecomposition\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelDecomposition"], "\<\"TwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/TwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialFunction"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->
         False], {"\<\"Q3/tutorial/UniversalQuantumComputation\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/UniversalQuantumComputation"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputation.html"], StandardForm]], "Input", 
              TextClipboardType -> "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$210991], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/tutorial/UniversalQuantumComputation", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell["Universal Quantum Computation: Demonstration", "Title",
 CellID->509267359],

Cell["\<\
Here we provide a simple demonstration that any arbitrary unitary operation \
can be implemented by combining CNOT gate and single-qubit rotations.\
\>", "Text",
 CellID->1534169418],

Cell[BoxData[GridBox[{
   {
    ButtonBox["TwoLevelDecomposition",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/TwoLevelDecomposition"], Cell[
    "returns a list of two-level unitary operators.", "TableText"]},
   {
    ButtonBox["TwoLevelU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/TwoLevelU"], Cell[
    "represents the two-level unitary operators.", "TableText"]},
   {
    ButtonBox["GrayTwoLevelU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/GrayTwoLevelU"], Cell["\<\
rewrites the two-level unitary operators in terms of CNOT and controlled-U \
gates.\
\>", "TableText"]}
  }]], "DefinitionBox",
 CellID->2096742444],

Cell["\<\
Some functions conveniently used for the demonstration of universal quantum \
computation.\
\>", "Caption",
 CellID->1891092685],

Cell[CellGroupData[{

Cell["Step 1. Decomposition into two-Level unitary operations", "Subsection",
 CellID->1707128225],

Cell["\<\
We first decompose the unitary operation into two-level unitary operations, \
that is, unitary operators acting only on a two-dimensional subspace.\
\>", "Text",
 CellID->915265898],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2058623809],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->526990913],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "MathCaption",
 CellID->679432361],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.04290064431651064`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4896643062756701`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2297947064735421`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2730924419504529`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2657577234002205`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.21517238065223648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0964375576410251`"}], "-", 
       RowBox[{"0.7104764524154807`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.3140825159274006`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.04359073346229306`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0684689094862267`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.27205416456509457`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.755415771056892`"}], "+", 
       RowBox[{"0.43877220072980144`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.23292055376777474`"}], "+", 
       RowBox[{"0.05765887147048508`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35213019935361217`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.30708011817998004`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7192609505574507`"}], "-", 
       RowBox[{"0.21982834752585173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07245592364382512`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.18180083599787208`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.047064073871935945`"}], "-", 
       RowBox[{"0.4189616622782714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2778559954950203`"}], "+", 
       RowBox[{"0.601948994941394`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4391845306615894`"}], "-", 
       RowBox[{"0.188068024016943`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10314955034390082`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2663802041933207`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35653568098847865`"}], "+", 
       RowBox[{"0.3514041617373028`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1799526331]
}, Open  ]],

Cell["\<\
This is an explicit operator expression of the unitary transformation.\
\>", "MathCaption",
 CellID->535905292],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1603109497],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.043177550885479046`"}], "+", 
    RowBox[{"0.3237308671439849`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11363996745050496`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.09680336686250157`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13842939017273903`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.34602705211436213`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10546648279174989`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11139473536551382`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24933913858399764`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0787567545908757`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0964375576410251`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.7104764524154807`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.755415771056892`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.43877220072980144`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3956573650076008`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05950604708151852`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.7192609505574507`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.21982834752585173`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2778559954950203`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.601948994941394`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09886232778684773`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.057128368276397445`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.016418584816222895`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1364156260613608`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04352716565398862`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.24757407109846152`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10085583486564692`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.012001703992786189`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09136531630080308`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07293461016390926`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.20861603313565072`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1549854688278069`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->936741998]
}, Open  ]],

Cell[TextData[{
 "\[LineSeparator]Here is a two-level decomposition, where the results are in \
terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->445690626],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[9]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.9845057518669844`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.17535228695635405`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.20713001626198127`"}], "+", 
          RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3606599513847742`"}], "-", 
          RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9313532554349825`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9313532554349825`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.3606599513847742`"}], "+", 
          RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.15741059565731794`"}], "-", 
          RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.6202730057309884`"}], "-", 
          RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.15741059565731794`"}], "+", 
          RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8708549832646049`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8708549832646049`"}], ",", 
         RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.912157804537438`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.912157804537438`"}], ",", 
         RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.12140326962613521`"}], "-", 
          RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->957276195]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->1307945734],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.9845057518669844`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.17535228695635405`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.9845057518669844, 0.17535228695635405`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.20713001626198127`"}], "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.4341531879165092, -0.378609424861444], Complex[
         0.20713001626198127`, 0.7907357771034078], Complex[
         0.4341531879165092, 0.378609424861444], 
         Complex[-0.20713001626198127`, 0.7907357771034078]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.3606599513847742`"}], "-", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], 
        "0.9313532554349825`", "0"},
       {"0", 
        RowBox[{"-", "0.9313532554349825`"}], 
        RowBox[{
         RowBox[{"-", "0.3606599513847742`"}], "+", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.3606599513847742, -0.05005510021758498], 
         0.9313532554349825, 
         Complex[-0.3606599513847742, 
          0.05005510021758498], -0.9313532554349825, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.15741059565731794`"}], "-", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6202730057309884`"}], "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.15741059565731794`"}], "+", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.15741059565731794`, -0.2808086976564618], 
         Complex[-0.6202730057309884, -0.7152830055696386], 
         Complex[-0.15741059565731794`, 0.2808086976564618], Complex[
         0.6202730057309884, -0.7152830055696386]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], 
        "0.8708549832646049`", "0", "0"},
       {
        RowBox[{"-", "0.8708549832646049`"}], 
        RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[0.042900644316510646`, 0.4896643062756702], 
         0.8708549832646049, Complex[
         0.042900644316510646`, -0.4896643062756702], -0.8708549832646049, 1, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], 
        "0.912157804537438`", "0"},
       {"0", 
        RowBox[{"-", "0.912157804537438`"}], 
        RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.2638725285949477, 0.3135911801603312], 0.912157804537438,
          Complex[
         0.2638725285949477, -0.3135911801603312], -0.912157804537438, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.12140326962613521`"}], "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.33455696451046996`, 0.2708761107540548], 
         Complex[-0.12140326962613521`, -0.8944042800905982], Complex[
         0.33455696451046996`, -0.2708761107540548], Complex[
         0.12140326962613521`, -0.8944042800905982]}}]]]]}], "}"}]], "Output",\

 CellLabel->"Out[10]=",
 CellID->1103995177]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "MathCaption",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[11]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->1972002259]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2. Rewriting two-level unitary operators to elementary gates.\
\>", "Subsection",
 CellID->1577472075],

Cell["\<\
Now we rewrite each two-level unitary operator in terms of elementary gates, \
that is, in a combination of CNOT gates and one controlled-U gate.\
\>", "Text",
 CellID->485925136],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " does the job."
}], "MathCaption",
 CellID->441254417],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Catenate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"GrayTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", "nn"}]}], "]"}], "&"}], "/@", "mm"}], 
   "]"}]}]], "Input",
 CellLabel->"In[13]:=",
 CellID->268246946],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.9922528759334922`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.08767614347817702`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.007747124066507793`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.08767614347817702`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.3606599513847742`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9313532554349825`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.15741059565731794`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{"0.8708549832646049`", " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{"0.8708549832646049`", " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.912157804537438`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[13]=",
 CellID->799215880]
}, Open  ]],

Cell["\<\
Here is a quantum circuit model of the decomposition. Here controlled-U gates \
are all labeled by the same character \"U\" but in fact they are different \
operators. Also do not forget to reverse the order of the elementary gates in \
the quantum circuit model.\
\>", "MathCaption",
 CellID->342917987],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Reverse", "@", "gates"}], "]"}]}]], "Input",
 CellLabel->"In[14]:=",
 CellID->970727010],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{13, -1}, {13, -2}}], DiskBox[{13, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {13, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[14]=",
 CellID->1942160583]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->1356294199],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.043177550885479046`"}], "+", 
    RowBox[{"0.3237308671439848`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.46224256868759717`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.02760409893246564`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4927564989031319`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05439331458835906`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3224982517957991`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.00962535375467856`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.16345622477530533`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.036315904338638405`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2750957921195744`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.08186782766950922`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06913140083619713`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.07315911321180145`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12194793648224461`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.11731615837442422`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.22871089373993797`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.01648145369049455`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11363996745050495`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.09680336686250163`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.013554290418882849`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05557922251855029`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1919948485799111`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.029972875235105775`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09886232778684781`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05712836827639746`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1499906747182267`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.04102542933194875`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11396003949585798`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05862535841742376`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10085583486564692`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.01200170399278608`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[15]=",
 CellID->125388609]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "opU"}], "//", "Elaborate"}], "//", "Chop"}]], "Input",\

 CellLabel->"In[16]:=",
 CellID->1665455186],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[16]=",
 CellID->1760688896]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "TutorialMoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->23220180],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso Package Guide",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/guide/QuissoPackageGuide"]], "TutorialMoreAbout",
 CellID->1567025153],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Tutorials"
}], "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellID->415694126],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso: Quick Start",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuissoQuickStart"]], "RelatedTutorials",
 CellID->2025894544],

Cell[TextData[ButtonBox["QuantumCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumCircuitUsage"]], "RelatedTutorials",
 CellID->485574297],

Cell[TextData[ButtonBox["Quantum Fourier Transform",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumFourierTransform"]], "RelatedTutorials",
 CellID->806871991],

Cell[TextData[ButtonBox["Quantum Teleportation",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], "RelatedTutorials",
 CellID->1648188840],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Wolfram Education Group Courses"
}], "TutorialRelatedLinksSection",
 WholeCellGroupOpener->True,
 CellID->415694148],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["An Elementary Introduction to the Wolfram Language"]], 
   "https://www.wolfram.com/language/elementary-introduction/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->415694149],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["The Wolfram Language: Fast Introduction for Programmers"]], 
   "https://www.wolfram.com/language/fast-introduction-for-programmers/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation: Demonstration",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "TutorialColor", 
  "LinkTrails" -> GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "ExampleCounter" -> 1, "NeedPlatMsgIn" -> None, "RootCaptions" -> 
  "", "Metadata" -> {
   "built" -> "{2021, 8, 28, 20, 48, 45.071620}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "Here we provide a simple demonstration that any arbitrary unitary \
operation can be implemented by combining CNOT gate and single-qubit \
rotations. Some functions conveniently used for the demonstration of \
universal quantum computation. We first decompose the unitary operation into \
two-level unitary operations, that is, unitary operators acting only on a \
two-dimensional subspace.", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$210904, "title" -> 
    "Universal Quantum Computation: Demonstration", "titlemodifier" -> "", 
    "windowtitle" -> "Universal Quantum Computation: Demonstration", "type" -> 
    "Tutorial", "uri" -> "Q3/tutorial/UniversalQuantumComputation", 
    "WorkflowDockedCell" -> ""}, "SearchTextTranslated" -> ""},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (July 9, 2021)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[616, 21, 4949, 121, 70, "AnchorBarGrid",ExpressionUUID->"93f98403-d3c8-49f4-8682-b1e9a9bd77b3",
 CellID->1],
Cell[CellGroupData[{
Cell[5590, 146, 81, 1, 70, "Title",ExpressionUUID->"26edbd43-51a3-418b-b025-54602f296055",
 CellID->509267359],
Cell[5674, 149, 192, 4, 70, "Text",ExpressionUUID->"9f6a9b7c-d562-4552-9f94-59b4b92fb49a",
 CellID->1534169418],
Cell[5869, 155, 663, 19, 70, "DefinitionBox",ExpressionUUID->"9da31739-adc4-46e5-8a29-14ec1fe39f47",
 CellID->2096742444],
Cell[6535, 176, 138, 4, 70, "Caption",ExpressionUUID->"a3d2b478-efd8-4b36-958c-990c2843de2a",
 CellID->1891092685],
Cell[CellGroupData[{
Cell[6698, 184, 98, 1, 70, "Subsection",ExpressionUUID->"478b5f7d-743b-43cd-9e23-429e9cd8475d",
 CellID->1707128225],
Cell[6799, 187, 191, 4, 70, "Text",ExpressionUUID->"549ce6ac-dd72-427b-ade4-0bd35b54c55c",
 CellID->915265898],
Cell[6993, 193, 91, 3, 70, "Input",ExpressionUUID->"a36cef2d-aa88-49c8-8335-771c852eb3ae",
 CellID->2058623809],
Cell[7087, 198, 126, 4, 70, "Input",ExpressionUUID->"aa1c6a3a-d52d-4401-bec1-45048b5516c9",
 CellID->526990913],
Cell[7216, 204, 250, 10, 70, "MathCaption",ExpressionUUID->"9032b3e7-5e4c-455a-8546-43165946c502",
 CellID->679432361],
Cell[CellGroupData[{
Cell[7491, 218, 311, 9, 70, "Input",ExpressionUUID->"99daeca6-7a9a-4e29-9912-273974c2ac88",
 CellID->1893084922],
Cell[7805, 229, 2617, 59, 70, "Output",ExpressionUUID->"eb53f6dd-a9bf-4f27-b86b-07f78518dc13",
 CellID->1799526331]
}, Open  ]],
Cell[10437, 291, 121, 3, 70, "MathCaption",ExpressionUUID->"5a4498f1-6bf8-4001-8c61-7ca48e7db296",
 CellID->535905292],
Cell[CellGroupData[{
Cell[10583, 298, 393, 12, 70, "Input",ExpressionUUID->"f166eac9-fed9-4a78-bb9d-b3d667729199",
 CellID->1603109497],
Cell[10979, 312, 8031, 250, 70, "Output",ExpressionUUID->"a841560d-15ad-4a21-80e2-1032175edbcc",
 CellID->936741998]
}, Open  ]],
Cell[19025, 565, 316, 11, 70, "MathCaption",ExpressionUUID->"b67e21e5-399e-46e7-981e-cec04b19b4a6",
 CellID->445690626],
Cell[CellGroupData[{
Cell[19366, 580, 143, 4, 70, "Input",ExpressionUUID->"ea4f3298-3ba7-496e-9c3a-68ac78cfeecd",
 CellID->874151237],
Cell[19512, 586, 5291, 141, 70, "Output",ExpressionUUID->"1a5910a8-9f1c-4814-92b1-1b18e87097f0",
 CellID->957276195]
}, Open  ]],
Cell[24818, 730, 312, 11, 70, "MathCaption",ExpressionUUID->"f87f2bee-6fbb-48f4-871c-e6fdcbcc75e1",
 CellID->1307945734],
Cell[CellGroupData[{
Cell[25155, 745, 133, 4, 70, "Input",ExpressionUUID->"0e393438-c371-4fad-803a-9ca9003f0f7d",
 CellID->344948808],
Cell[25291, 751, 8975, 224, 70, "Output",ExpressionUUID->"0232cdc0-dd9f-486a-864c-0c3fb2bab84e",
 CellID->1103995177]
}, Open  ]],
Cell[34281, 978, 92, 1, 70, "MathCaption",ExpressionUUID->"9ba7032d-7a05-4fe8-9b8a-41656fff10a3",
 CellID->732431213],
Cell[CellGroupData[{
Cell[34398, 983, 292, 10, 70, "Input",ExpressionUUID->"8a46be95-190e-4ced-a312-ec4999a364a8",
 CellID->367426686],
Cell[34693, 995, 613, 19, 70, "Output",ExpressionUUID->"b167a1b8-51e0-4645-bc01-29ecb0f09ede",
 CellID->1972002259]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35355, 1020, 117, 3, 70, "Subsection",ExpressionUUID->"434c4d58-f543-4dd2-ac09-d7a74bb98dc4",
 CellID->1577472075],
Cell[35475, 1025, 189, 4, 70, "Text",ExpressionUUID->"7fc6b1e1-c5de-4c9a-8e0b-79863f0e7a51",
 CellID->485925136],
Cell[35667, 1031, 245, 9, 70, "MathCaption",ExpressionUUID->"8e190d5c-63dd-4842-99e1-db0f4d6f1e09",
 CellID->441254417],
Cell[CellGroupData[{
Cell[35937, 1044, 281, 10, 70, "Input",ExpressionUUID->"acbd54a6-886c-45f3-b262-a09028ee985f",
 CellID->268246946],
Cell[36221, 1056, 10964, 325, 70, "Output",ExpressionUUID->"ac270fa0-1dc7-4d81-8108-ff2edc20729f",
 CellID->799215880]
}, Open  ]],
Cell[47200, 1384, 314, 6, 70, "MathCaption",ExpressionUUID->"8f42b773-1c20-4d8d-b908-4a92704accc8",
 CellID->342917987],
Cell[CellGroupData[{
Cell[47539, 1394, 169, 5, 70, "Input",ExpressionUUID->"f6833c3d-c8f2-4070-9ac1-1bb0c4695416",
 CellID->970727010],
Cell[47711, 1401, 4629, 105, 70, "Output",ExpressionUUID->"4162a295-488c-4cba-92df-a576ea86b0b5",
 CellID->1942160583]
}, Open  ]],
Cell[CellGroupData[{
Cell[52377, 1511, 137, 4, 70, "Input",ExpressionUUID->"e8e0d991-ce30-4c36-b5f6-e835f68f5c76",
 CellID->1356294199],
Cell[52517, 1517, 8039, 250, 70, "Output",ExpressionUUID->"85c79f89-02e9-4838-93bc-268c9969ac96",
 CellID->125388609]
}, Open  ]],
Cell[CellGroupData[{
Cell[60593, 1772, 160, 6, 70, "Input",ExpressionUUID->"f32b56fd-6a61-4e6a-9eab-5f8bd7450219",
 CellID->1665455186],
Cell[60756, 1780, 73, 2, 70, "Output",ExpressionUUID->"cd5ade0b-6905-469e-ba8b-b89d3fb35366",
 CellID->1760688896]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60878, 1788, 164, 7, 70, "TutorialMoreAboutSection",ExpressionUUID->"80645d4e-0fea-470a-99fd-f0d6ad985f11",
 CellID->23220180],
Cell[61045, 1797, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"431a66da-6339-4a31-8b5f-af74ec068e20"],
Cell[61079, 1799, 162, 3, 70, "TutorialMoreAbout",ExpressionUUID->"b5e4fa9e-1392-423d-a1d1-b445063ba306",
 CellID->1567025153],
Cell[61244, 1804, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"7cc81476-ab4c-4676-abd7-3934d9c9e271"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61312, 1809, 167, 7, 70, "RelatedTutorialsSection",ExpressionUUID->"bc27919f-c6e3-4d2e-9ce9-08806e295a22",
 CellID->415694126],
Cell[61482, 1818, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"b8b0fdec-2bd9-4ecf-97c5-0aa6ceccf29d"],
Cell[61516, 1820, 161, 3, 70, "RelatedTutorials",ExpressionUUID->"4482f511-775b-49a3-81d0-b4ddd9ef0a0e",
 CellID->2025894544],
Cell[61680, 1825, 173, 3, 70, "RelatedTutorials",ExpressionUUID->"fdabd2b5-3fd5-4cd6-841f-8d73189992e0",
 CellID->485574297],
Cell[61856, 1830, 176, 4, 70, "RelatedTutorials",ExpressionUUID->"1147f425-4036-4337-8602-ac0b6f6217ad",
 CellID->806871991],
Cell[62035, 1836, 167, 3, 70, "RelatedTutorials",ExpressionUUID->"53af90ce-bb7c-4110-a85d-50ad6f8a67dc",
 CellID->1648188840],
Cell[62205, 1841, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"6f18324a-6ef3-43ba-a137-f5663c0ab968"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62273, 1846, 193, 7, 70, "TutorialRelatedLinksSection",ExpressionUUID->"f9ab060b-19c7-4eb8-847f-3cc1932e84d2",
 CellID->415694148],
Cell[62469, 1855, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"0e70fa42-6e2c-4502-9c74-5cdb5921c0a9"],
Cell[62503, 1857, 286, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"2e85930a-67ec-4fca-a997-7d813d05faed",
 CellID->415694149],
Cell[62792, 1866, 302, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"780c8e51-9db1-4c71-8815-7000601c3c63",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],
Cell[63121, 1877, 23, 0, 70, "FooterCell",ExpressionUUID->"ca0b7149-afb0-44c9-bed0-5f370e3d7ab3"]
}
]
*)

(* End of internal cache information *)
