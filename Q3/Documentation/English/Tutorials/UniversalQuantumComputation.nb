(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72284,       2066]
NotebookOptionsPosition[     63148,       1879]
NotebookOutlinePosition[     65780,       1941]
CellTagsIndexPosition[     65737,       1938]
WindowTitle->Universal Quantum Computation: Demonstration
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 TUTORIAL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"QuantumCircuit Usage \
Examples\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumCircuitUsage"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumTeleportation"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"RelatedTutorialsSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/QuissoPackageGuide"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialMoreAboutSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Functions",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Functions", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/GrayTwoLevelU"], "\<\"TwoLevelDecomposition\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelDecomposition"], "\<\"TwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/TwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialFunction"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->
         False], {"\<\"Q3/tutorial/UniversalQuantumComputation\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/UniversalQuantumComputation"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputation.html"], StandardForm]], "Input", 
              TextClipboardType -> "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$202184], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/tutorial/UniversalQuantumComputation", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell["Universal Quantum Computation: Demonstration", "Title",
 CellID->509267359],

Cell["\<\
Here we provide a simple demonstration that any arbitrary unitary operation \
can be implemented by combining CNOT gate and single-qubit rotations.\
\>", "Text",
 CellID->1534169418],

Cell[BoxData[GridBox[{
   {
    ButtonBox["TwoLevelDecomposition",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/TwoLevelDecomposition"], Cell[
    "returns a list of two-level unitary operators.", "TableText"]},
   {
    ButtonBox["TwoLevelU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/TwoLevelU"], Cell[
    "represents the two-level unitary operators.", "TableText"]},
   {
    ButtonBox["GrayTwoLevelU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/GrayTwoLevelU"], Cell["\<\
rewrites the two-level unitary operators in terms of CNOT and controlled-U \
gates.\
\>", "TableText"]}
  }]], "DefinitionBox",
 CellID->2096742444],

Cell["\<\
Some functions conveniently used for the demonstration of universal quantum \
computation.\
\>", "Caption",
 CellID->1891092685],

Cell[CellGroupData[{

Cell["Step 1. Decomposition into two-Level unitary operations", "Subsection",
 CellID->1707128225],

Cell["\<\
We first decompose the unitary operation into two-level unitary operations, \
that is, unitary operators acting only on a two-dimensional subspace.\
\>", "Text",
 CellID->915265898],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2058623809],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->526990913],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "MathCaption",
 CellID->679432361],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.04290064431651064`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4896643062756701`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2297947064735421`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2730924419504529`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2657577234002205`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.21517238065223648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0964375576410251`"}], "-", 
       RowBox[{"0.7104764524154807`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.3140825159274006`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.04359073346229306`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0684689094862267`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.27205416456509457`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.755415771056892`"}], "+", 
       RowBox[{"0.43877220072980144`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.23292055376777474`"}], "+", 
       RowBox[{"0.05765887147048508`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35213019935361217`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.30708011817998004`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7192609505574507`"}], "-", 
       RowBox[{"0.21982834752585173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07245592364382512`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.18180083599787208`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.047064073871935945`"}], "-", 
       RowBox[{"0.4189616622782714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2778559954950203`"}], "+", 
       RowBox[{"0.601948994941394`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4391845306615894`"}], "-", 
       RowBox[{"0.188068024016943`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10314955034390082`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2663802041933207`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35653568098847865`"}], "+", 
       RowBox[{"0.3514041617373028`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1799526331]
}, Open  ]],

Cell["\<\
This is an explicit operator expression of the unitary transformation.\
\>", "MathCaption",
 CellID->535905292],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1603109497],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.043177550885479046`"}], "+", 
    RowBox[{"0.3237308671439849`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11363996745050496`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.09680336686250157`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13842939017273903`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.34602705211436213`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10546648279174989`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11139473536551382`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24933913858399764`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0787567545908757`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0964375576410251`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.7104764524154807`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.755415771056892`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.43877220072980144`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3956573650076008`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05950604708151852`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.7192609505574507`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.21982834752585173`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2778559954950203`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.601948994941394`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09886232778684773`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.057128368276397445`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.016418584816222895`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1364156260613608`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04352716565398862`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.24757407109846152`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10085583486564692`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.012001703992786189`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09136531630080308`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07293461016390926`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.20861603313565072`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1549854688278069`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->936741998]
}, Open  ]],

Cell[TextData[{
 "\[LineSeparator]Here is a two-level decomposition, where the results are in \
terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->445690626],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[9]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.9845057518669844`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.17535228695635405`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.20713001626198127`"}], "+", 
          RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3606599513847742`"}], "-", 
          RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9313532554349825`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9313532554349825`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.3606599513847742`"}], "+", 
          RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.15741059565731794`"}], "-", 
          RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.6202730057309884`"}], "-", 
          RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.15741059565731794`"}], "+", 
          RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8708549832646049`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8708549832646049`"}], ",", 
         RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.912157804537438`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.912157804537438`"}], ",", 
         RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.12140326962613521`"}], "-", 
          RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->957276195]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->1307945734],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.9845057518669844`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.17535228695635405`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.9845057518669844, 0.17535228695635405`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.20713001626198127`"}], "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.4341531879165092, -0.378609424861444], Complex[
         0.20713001626198127`, 0.7907357771034078], Complex[
         0.4341531879165092, 0.378609424861444], 
         Complex[-0.20713001626198127`, 0.7907357771034078]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.3606599513847742`"}], "-", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], 
        "0.9313532554349825`", "0"},
       {"0", 
        RowBox[{"-", "0.9313532554349825`"}], 
        RowBox[{
         RowBox[{"-", "0.3606599513847742`"}], "+", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.3606599513847742, -0.05005510021758498], 
         0.9313532554349825, 
         Complex[-0.3606599513847742, 
          0.05005510021758498], -0.9313532554349825, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.15741059565731794`"}], "-", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6202730057309884`"}], "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.15741059565731794`"}], "+", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.15741059565731794`, -0.2808086976564618], 
         Complex[-0.6202730057309884, -0.7152830055696386], 
         Complex[-0.15741059565731794`, 0.2808086976564618], Complex[
         0.6202730057309884, -0.7152830055696386]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], 
        "0.8708549832646049`", "0", "0"},
       {
        RowBox[{"-", "0.8708549832646049`"}], 
        RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[0.042900644316510646`, 0.4896643062756702], 
         0.8708549832646049, Complex[
         0.042900644316510646`, -0.4896643062756702], -0.8708549832646049, 1, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], 
        "0.912157804537438`", "0"},
       {"0", 
        RowBox[{"-", "0.912157804537438`"}], 
        RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.2638725285949477, 0.3135911801603312], 0.912157804537438,
          Complex[
         0.2638725285949477, -0.3135911801603312], -0.912157804537438, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.12140326962613521`"}], "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.33455696451046996`, 0.2708761107540548], 
         Complex[-0.12140326962613521`, -0.8944042800905982], Complex[
         0.33455696451046996`, -0.2708761107540548], Complex[
         0.12140326962613521`, -0.8944042800905982]}}]]]]}], "}"}]], "Output",\

 CellLabel->"Out[10]=",
 CellID->1103995177]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "MathCaption",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[11]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->1972002259]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2. Rewriting two-level unitary operators to elementary gates.\
\>", "Subsection",
 CellID->1577472075],

Cell["\<\
Now we rewrite each two-level unitary operator in terms of elementary gates, \
that is, in a combination of CNOT gates and one controlled-U gate.\
\>", "Text",
 CellID->485925136],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " does the job."
}], "MathCaption",
 CellID->441254417],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Catenate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"GrayTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", "nn"}]}], "]"}], "&"}], "/@", "mm"}], 
   "]"}]}]], "Input",
 CellLabel->"In[13]:=",
 CellID->268246946],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.9922528759334922`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.08767614347817702`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.007747124066507793`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.08767614347817702`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.3606599513847742`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9313532554349825`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.15741059565731794`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{"0.8708549832646049`", " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{"0.8708549832646049`", " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.912157804537438`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[13]=",
 CellID->799215880]
}, Open  ]],

Cell["\<\
Here is a quantum circuit model of the decomposition. Here controlled-U gates \
are all labeled by the same character \"U\" but in fact they are different \
operators. Also do not forget to reverse the order of the elementary gates in \
the quantum circuit model.\
\>", "MathCaption",
 CellID->342917987],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Reverse", "@", "gates"}], "]"}]}]], "Input",
 CellLabel->"In[14]:=",
 CellID->970727010],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{13, -1}, {13, -2}}], DiskBox[{13, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {13, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[14]=",
 CellID->1942160583]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->1356294199],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.043177550885479046`"}], "+", 
    RowBox[{"0.3237308671439848`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.46224256868759717`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.02760409893246564`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4927564989031319`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05439331458835906`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3224982517957991`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.00962535375467856`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.16345622477530533`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.036315904338638405`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2750957921195744`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.08186782766950922`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06913140083619713`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.07315911321180145`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12194793648224461`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.11731615837442422`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.22871089373993797`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.01648145369049455`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11363996745050495`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.09680336686250163`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.013554290418882849`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05557922251855029`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1919948485799111`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.029972875235105775`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09886232778684781`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05712836827639746`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1499906747182267`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.04102542933194875`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11396003949585798`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05862535841742376`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10085583486564692`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.01200170399278608`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[15]=",
 CellID->125388609]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "opU"}], "//", "Elaborate"}], "//", "Chop"}]], "Input",\

 CellLabel->"In[16]:=",
 CellID->1665455186],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[16]=",
 CellID->1760688896]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "TutorialMoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->23220180],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso Package Guide",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/guide/QuissoPackageGuide"]], "TutorialMoreAbout",
 CellID->1567025153],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Tutorials"
}], "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellID->415694126],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso: Quick Start",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuissoQuickStart"]], "RelatedTutorials",
 CellID->2025894544],

Cell[TextData[ButtonBox["QuantumCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumCircuitUsage"]], "RelatedTutorials",
 CellID->485574297],

Cell[TextData[ButtonBox["Quantum Fourier Transform",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumFourierTransform"]], "RelatedTutorials",
 CellID->806871991],

Cell[TextData[ButtonBox["Quantum Teleportation",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], "RelatedTutorials",
 CellID->1648188840],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Wolfram Education Group Courses"
}], "TutorialRelatedLinksSection",
 WholeCellGroupOpener->True,
 CellID->415694148],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["An Elementary Introduction to the Wolfram Language"]], 
   "https://www.wolfram.com/language/elementary-introduction/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->415694149],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["The Wolfram Language: Fast Introduction for Programmers"]], 
   "https://www.wolfram.com/language/fast-introduction-for-programmers/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation: Demonstration",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "TutorialColor", 
  "LinkTrails" -> GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "ExampleCounter" -> 1, "NeedPlatMsgIn" -> None, "RootCaptions" -> 
  "", "Metadata" -> {
   "built" -> "{2021, 7, 19, 14, 18, 5.820919}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "Here we provide a simple demonstration that any arbitrary unitary \
operation can be implemented by combining CNOT gate and single-qubit \
rotations. Some functions conveniently used for the demonstration of \
universal quantum computation. We first decompose the unitary operation into \
two-level unitary operations, that is, unitary operators acting only on a \
two-dimensional subspace.", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$202097, "title" -> 
    "Universal Quantum Computation: Demonstration", "titlemodifier" -> "", 
    "windowtitle" -> "Universal Quantum Computation: Demonstration", "type" -> 
    "Tutorial", "uri" -> "Q3/tutorial/UniversalQuantumComputation", 
    "WorkflowDockedCell" -> ""}, "SearchTextTranslated" -> ""},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (June 19, 2021)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[616, 21, 4949, 121, 70, "AnchorBarGrid",ExpressionUUID->"cce2d4e1-5b81-4280-8968-2dbe1cb44814",
 CellID->1],
Cell[CellGroupData[{
Cell[5590, 146, 81, 1, 70, "Title",ExpressionUUID->"d1f0507e-4444-44e2-9033-82d020c9d9c5",
 CellID->509267359],
Cell[5674, 149, 192, 4, 70, "Text",ExpressionUUID->"634e5b2f-781b-41f9-8947-8af87dbf4f0e",
 CellID->1534169418],
Cell[5869, 155, 663, 19, 70, "DefinitionBox",ExpressionUUID->"d88a8960-1ea6-4fc7-87f1-e2256a620f16",
 CellID->2096742444],
Cell[6535, 176, 138, 4, 70, "Caption",ExpressionUUID->"4a8f3568-e3e5-4489-9f42-54e327f6485a",
 CellID->1891092685],
Cell[CellGroupData[{
Cell[6698, 184, 98, 1, 70, "Subsection",ExpressionUUID->"229f96f6-1bac-406c-889b-c0adaf4d9575",
 CellID->1707128225],
Cell[6799, 187, 191, 4, 70, "Text",ExpressionUUID->"853d6687-2649-46f1-957d-a0b9ad21caff",
 CellID->915265898],
Cell[6993, 193, 91, 3, 70, "Input",ExpressionUUID->"f8ad7ae4-65fb-4608-86d2-74d385833b13",
 CellID->2058623809],
Cell[7087, 198, 126, 4, 70, "Input",ExpressionUUID->"9348d3d6-7a5f-4c1a-b708-f75f29e02918",
 CellID->526990913],
Cell[7216, 204, 250, 10, 70, "MathCaption",ExpressionUUID->"249be951-a921-4aab-b277-864ac32d7c6e",
 CellID->679432361],
Cell[CellGroupData[{
Cell[7491, 218, 311, 9, 70, "Input",ExpressionUUID->"b56ca097-9e0e-4c78-82fe-8ae26e5eda51",
 CellID->1893084922],
Cell[7805, 229, 2617, 59, 70, "Output",ExpressionUUID->"988ae5cc-e75a-4fc3-90b3-031c00451bcc",
 CellID->1799526331]
}, Open  ]],
Cell[10437, 291, 121, 3, 70, "MathCaption",ExpressionUUID->"fb012f14-d5c5-4390-86e4-d0f172524c12",
 CellID->535905292],
Cell[CellGroupData[{
Cell[10583, 298, 393, 12, 70, "Input",ExpressionUUID->"e1f5bac8-6604-460d-82c4-a4eb45920cb0",
 CellID->1603109497],
Cell[10979, 312, 8031, 250, 70, "Output",ExpressionUUID->"472c397e-85cf-469c-b83e-14b566b8fe4f",
 CellID->936741998]
}, Open  ]],
Cell[19025, 565, 316, 11, 70, "MathCaption",ExpressionUUID->"c6f55806-c6d3-4136-887f-f1c02c738dc3",
 CellID->445690626],
Cell[CellGroupData[{
Cell[19366, 580, 143, 4, 70, "Input",ExpressionUUID->"35b55bb6-5915-486b-a986-fab9a52d5161",
 CellID->874151237],
Cell[19512, 586, 5291, 141, 70, "Output",ExpressionUUID->"8cea1be6-04ea-4155-b88c-68229f8aea38",
 CellID->957276195]
}, Open  ]],
Cell[24818, 730, 312, 11, 70, "MathCaption",ExpressionUUID->"f9090dd7-62ae-405d-bf8d-80f0b76a7c9f",
 CellID->1307945734],
Cell[CellGroupData[{
Cell[25155, 745, 133, 4, 70, "Input",ExpressionUUID->"9c7b608d-e2ec-4cb0-a998-9410fe239ad3",
 CellID->344948808],
Cell[25291, 751, 8975, 224, 70, "Output",ExpressionUUID->"d81aec65-98a1-4f79-b8fc-1c4d5004c2e6",
 CellID->1103995177]
}, Open  ]],
Cell[34281, 978, 92, 1, 70, "MathCaption",ExpressionUUID->"17e57b3b-cfc4-410a-a703-ee45f3c668e3",
 CellID->732431213],
Cell[CellGroupData[{
Cell[34398, 983, 292, 10, 70, "Input",ExpressionUUID->"fcdc96c6-11f7-4049-bc67-6715d408c92d",
 CellID->367426686],
Cell[34693, 995, 613, 19, 70, "Output",ExpressionUUID->"0e7a6cf7-15b2-4d96-b6f4-6bfeb643efbc",
 CellID->1972002259]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35355, 1020, 117, 3, 70, "Subsection",ExpressionUUID->"d075dbfc-5844-4a17-84e4-d669dd61e098",
 CellID->1577472075],
Cell[35475, 1025, 189, 4, 70, "Text",ExpressionUUID->"b1a14d11-80eb-4258-9313-dfb4cc37a74d",
 CellID->485925136],
Cell[35667, 1031, 245, 9, 70, "MathCaption",ExpressionUUID->"1e3f1da3-5547-49c6-b5f2-73a17943c5fd",
 CellID->441254417],
Cell[CellGroupData[{
Cell[35937, 1044, 281, 10, 70, "Input",ExpressionUUID->"b9479117-e07f-4c08-9efd-51ee7488b3db",
 CellID->268246946],
Cell[36221, 1056, 10964, 325, 70, "Output",ExpressionUUID->"65ceb9fe-dfbf-464d-9db3-070e4a1c23b6",
 CellID->799215880]
}, Open  ]],
Cell[47200, 1384, 314, 6, 70, "MathCaption",ExpressionUUID->"150b10e4-4a57-4ec0-a1ff-b9bd1b7602e3",
 CellID->342917987],
Cell[CellGroupData[{
Cell[47539, 1394, 169, 5, 70, "Input",ExpressionUUID->"8f71f324-5a7b-493d-adb3-9c3807e8a7c3",
 CellID->970727010],
Cell[47711, 1401, 4629, 105, 70, "Output",ExpressionUUID->"bc6a5386-9750-4c28-82d9-8e5dd269ca9a",
 CellID->1942160583]
}, Open  ]],
Cell[CellGroupData[{
Cell[52377, 1511, 137, 4, 70, "Input",ExpressionUUID->"4ae693b4-36c7-4ffc-8f96-8f69fec41570",
 CellID->1356294199],
Cell[52517, 1517, 8039, 250, 70, "Output",ExpressionUUID->"2028634f-54f4-4028-83f9-e941d703b596",
 CellID->125388609]
}, Open  ]],
Cell[CellGroupData[{
Cell[60593, 1772, 160, 6, 70, "Input",ExpressionUUID->"fafa165d-5416-4bcd-aa90-6d16a937ac78",
 CellID->1665455186],
Cell[60756, 1780, 73, 2, 70, "Output",ExpressionUUID->"ac00020f-db5f-4d1b-883f-b912e267a297",
 CellID->1760688896]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60878, 1788, 164, 7, 70, "TutorialMoreAboutSection",ExpressionUUID->"cc6953aa-66c1-43dd-9b0b-a06f6581cde9",
 CellID->23220180],
Cell[61045, 1797, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"488c2536-37c9-4821-82f9-608d537993e9"],
Cell[61079, 1799, 162, 3, 70, "TutorialMoreAbout",ExpressionUUID->"c1ad186e-3ed2-491b-b2ad-bbc7311faa41",
 CellID->1567025153],
Cell[61244, 1804, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"3e220a1d-9c94-4b98-8c38-3988fc9ab2bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61312, 1809, 167, 7, 70, "RelatedTutorialsSection",ExpressionUUID->"8e159f40-73b6-42b6-955c-1870256497c5",
 CellID->415694126],
Cell[61482, 1818, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"a4364946-0bda-4d25-af6a-bf0d1ced223e"],
Cell[61516, 1820, 161, 3, 70, "RelatedTutorials",ExpressionUUID->"13806189-1c06-41ee-bb5d-169fb2bbbd3c",
 CellID->2025894544],
Cell[61680, 1825, 173, 3, 70, "RelatedTutorials",ExpressionUUID->"6e82df9a-6eb1-42ca-9559-cd61d7a492a0",
 CellID->485574297],
Cell[61856, 1830, 176, 4, 70, "RelatedTutorials",ExpressionUUID->"93ccdcd6-0192-4897-ae38-3ff862235bca",
 CellID->806871991],
Cell[62035, 1836, 167, 3, 70, "RelatedTutorials",ExpressionUUID->"b03a9a00-1f17-4588-97de-4c52a145428c",
 CellID->1648188840],
Cell[62205, 1841, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"0ea2d095-d3d5-47a4-b7ab-9df1b54d8f46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62273, 1846, 193, 7, 70, "TutorialRelatedLinksSection",ExpressionUUID->"f0f5f24f-92f7-4b0e-bbe3-7a98d727da9e",
 CellID->415694148],
Cell[62469, 1855, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"73cc5cd7-b55e-415e-b16e-0be95c957734"],
Cell[62503, 1857, 286, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"3d8c22a1-d5d8-44ef-bf94-435ae8f9014b",
 CellID->415694149],
Cell[62792, 1866, 302, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"77625929-d39e-41b0-9628-469c32e091ad",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],
Cell[63121, 1877, 23, 0, 70, "FooterCell",ExpressionUUID->"edf143b1-f5eb-4142-91cf-1e94ad612a7c"]
}
]
*)

(* End of internal cache information *)
