(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72393,       2078]
NotebookOptionsPosition[     63155,       1890]
NotebookOutlinePosition[     65769,       1951]
CellTagsIndexPosition[     65726,       1948]
WindowTitle->Universal Quantum Computation: Demonstration
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 TUTORIAL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"QuissoCircuit Usage \
Examples\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoCircuitUsage"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumTeleportation"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"RelatedTutorialsSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/QuissoPackageGuide"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialMoreAboutSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Functions",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Functions", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/GrayTwoLevelU"], "\<\"TwoLevelDecomposition\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelDecomposition"], "\<\"TwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/TwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialFunction"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->
         False], {"\<\"Q3/tutorial/UniversalQuantumComputation\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/UniversalQuantumComputation"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputation.html"], StandardForm]], "Input", 
              TextClipboardType -> "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$188271], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/tutorial/UniversalQuantumComputation", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell["Universal Quantum Computation: Demonstration", "Title",
 CellID->509267359],

Cell["\<\
Here we provide a simple demonstration that any arbitrary unitary operation \
can be implemented by combining CNOT gate and single-qubit rotations.\
\>", "Text",
 CellID->1534169418],

Cell[BoxData[GridBox[{
   {
    ButtonBox["TwoLevelDecomposition",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/TwoLevelDecomposition"], Cell[
    "returns a list of two-level unitary operators.", "TableText"]},
   {
    ButtonBox["TwoLevelU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/TwoLevelU"], Cell[
    "represents the two-level unitary operators.", "TableText"]},
   {
    ButtonBox["GrayTwoLevelU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/GrayTwoLevelU"], Cell["\<\
rewrites the two-level unitary operators in terms of CNOT and controlled-U \
gates.\
\>", "TableText"]}
  }]], "DefinitionBox",
 CellID->2096742444],

Cell["\<\
Some functions conveniently used for the demonstration of universal quantum \
computation.\
\>", "Caption",
 CellID->1891092685],

Cell[CellGroupData[{

Cell["Step 1. Decomposition into two-Level unitary operations", "Subsection",
 CellID->1707128225],

Cell["\<\
We first decompose the unitary operation into two-level unitary operations, \
that is, unitary operators acting only on a two-dimensional subspace.\
\>", "Text",
 CellID->915265898],

Cell[TextData[{
 StyleBox["Gray", "Input"],
 " is a supplementary package and is not loaded by default when the ",
 StyleBox["Q3", "Input"],
 " App is loaded. You need to load it manually."
}], "MathCaption",
 CellID->836781195],

Cell[BoxData[
 RowBox[{"<<", "Q3`Gray`"}]], "Input",
 CellLabel->"In[163]:=",
 CellID->2058623809],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[164]:=",
 CellID->526990913],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "MathCaption",
 CellID->679432361],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[165]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.32781147947398936`"}], "-", 
       RowBox[{"0.36782185304559306`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.02311438445838168`"}], "-", 
       RowBox[{"0.5928514159564058`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07827581339039831`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35402616617011784`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3112784314899689`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4205754997273139`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2053644246836983`"}], "-", 
       RowBox[{"0.37442659014018126`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3906914173075876`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0035270919769997133`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7050600261714859`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1336715551917968`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25810966200827967`"}], "+", 
       RowBox[{"0.28875532019401323`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.3973698028355266`"}], "+", 
       RowBox[{"0.21653216166497857`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.09469582906008855`"}], "+", 
       RowBox[{"0.440906599133851`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.22208000799824035`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3314589341934716`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6003676248097203`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2687364761790907`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.608056451349636`"}], "+", 
       RowBox[{"0.018849794395293606`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4644178921495503`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.27620787849766687`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4376026491417334`"}], "+", 
       RowBox[{"0.05366574314771523`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.30754448839642395`"}], "-", 
       RowBox[{"0.22130875189212834`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[167]//MatrixForm=",
 CellID->939510463]
}, Open  ]],

Cell["\<\
This is an explicit operator expression of the unitary transformation.\
\>", "MathCaption",
 CellID->535905292],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"QuissoExpression", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]}], "Input",
 CellLabel->"In[172]:=",
 CellID->1603109497],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.005646135641146327`"}], "-", 
    RowBox[{"0.06353614469181251`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.07839654431293255`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.023622665347491523`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03378821505076007`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.02989475690200763`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13135055489659972`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0013987822858540777`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2535008621120638`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.4297726845177949`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2267855542427661`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1772401873185186`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03123664070219824`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.2995432925959387`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09781094620251671`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.32242005635584825`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1083738897119`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.21393005843153426`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.31203184829406033`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.23102915777704816`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.028196439825964398`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.28388038163169416`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03751036155037139`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.061720484482976276`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03708610455794546`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11861123584248418`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.016428458368523274`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1612189466924453`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0008385231962122486`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.30505507854419256`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04721960009672817`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0453546852657518`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[174]=",
 CellID->981246007]
}, Open  ]],

Cell[TextData[{
 "Here is a two-level decomposition, where the results are in terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->445690626],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[175]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0886223767025246`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.996065296226907`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.524091881026576`"}], "+", 
          RowBox[{"0.2855847301429709`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.09583543052257419`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7966082050843719`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.09583543052257419`"}], "-", 
          RowBox[{"0.7966082050843719`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.524091881026576`"}], "-", 
          RowBox[{"0.2855847301429709`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.23599701666165215`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4302768523222814`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8713020363125691`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8713020363125691`"}], ",", 
         RowBox[{"0.23599701666165215`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4302768523222814`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.6611147913986201`"}], "+", 
          RowBox[{"0.24858020981215107`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.515059855275046`"}], "+", 
          RowBox[{"0.4856423142269984`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.515059855275046`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4856423142269984`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.6611147913986201`"}], "-", 
          RowBox[{"0.24858020981215107`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3278114794739893`"}], "-", 
          RowBox[{"0.367821853045593`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8701992406036564`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8701992406036564`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.3278114794739893`"}], "+", 
          RowBox[{"0.367821853045593`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.026562174936336704`"}], "-", 
          RowBox[{"0.6812823871750855`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.7315386249458521`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.7315386249458521`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.026562174936336704`"}], "+", 
          RowBox[{"0.6812823871750855`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.12296220079068251`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.556133940284361`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.48898221988164386`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6606752048322401`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.48898221988164386`"}], "-", 
          RowBox[{"0.6606752048322401`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.12296220079068251`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.556133940284361`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[175]=",
 CellID->1710743866]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->1307945734],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[176]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.0886223767025246`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.996065296226907`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.0886223767025246, -0.996065296226907]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.524091881026576`"}], "+", 
         RowBox[{"0.2855847301429709`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.09583543052257419`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7966082050843719`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.09583543052257419`"}], "-", 
         RowBox[{"0.7966082050843719`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.524091881026576`"}], "-", 
         RowBox[{"0.2855847301429709`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.524091881026576, 0.2855847301429709], Complex[
         0.09583543052257419, -0.7966082050843719], 
         Complex[-0.524091881026576, -0.2855847301429709], 
         Complex[-0.09583543052257419, -0.7966082050843719]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.23599701666165215`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4302768523222814`", " ", "\[ImaginaryI]"}]}], 
        "0.8713020363125691`", "0"},
       {"0", 
        RowBox[{"-", "0.8713020363125691`"}], 
        RowBox[{"0.23599701666165215`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4302768523222814`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.23599701666165215`, 0.4302768523222814], 
         0.8713020363125691, Complex[
         0.23599701666165215`, -0.4302768523222814], -0.8713020363125691, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.6611147913986201`"}], "+", 
         RowBox[{"0.24858020981215107`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.515059855275046`"}], "+", 
         RowBox[{"0.4856423142269984`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.515059855275046`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4856423142269984`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6611147913986201`"}], "-", 
         RowBox[{"0.24858020981215107`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.6611147913986201, 0.24858020981215107`], 
         Complex[-0.515059855275046, 0.4856423142269984], 
         Complex[-0.6611147913986201, -0.24858020981215107`], Complex[
         0.515059855275046, 0.4856423142269984]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.3278114794739893`"}], "-", 
         RowBox[{"0.367821853045593`", " ", "\[ImaginaryI]"}]}], 
        "0.8701992406036564`", "0", "0"},
       {
        RowBox[{"-", "0.8701992406036564`"}], 
        RowBox[{
         RowBox[{"-", "0.3278114794739893`"}], "+", 
         RowBox[{"0.367821853045593`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.3278114794739893, -0.367821853045593], 0.8701992406036564, 
         Complex[-0.3278114794739893, 0.367821853045593], -0.8701992406036564,
          1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.026562174936336704`"}], "-", 
         RowBox[{"0.6812823871750855`", " ", "\[ImaginaryI]"}]}], 
        "0.7315386249458521`", "0"},
       {"0", 
        RowBox[{"-", "0.7315386249458521`"}], 
        RowBox[{
         RowBox[{"-", "0.026562174936336704`"}], "+", 
         RowBox[{"0.6812823871750855`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.026562174936336704`, -0.6812823871750855], 
         0.7315386249458521, 
         Complex[-0.026562174936336704`, 
          0.6812823871750855], -0.7315386249458521, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.12296220079068251`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.556133940284361`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.48898221988164386`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6606752048322401`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.48898221988164386`"}], "-", 
         RowBox[{"0.6606752048322401`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.12296220079068251`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.556133940284361`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.12296220079068251`, 0.556133940284361], Complex[
         0.48898221988164386`, -0.6606752048322401], Complex[
         0.12296220079068251`, -0.556133940284361], 
         Complex[-0.48898221988164386`, -0.6606752048322401]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[176]=",
 CellID->1426001618]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "MathCaption",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[177]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[178]//MatrixForm=",
 CellID->124904640]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2. Rewriting two-level unitary operators to elementary gates.\
\>", "Subsection",
 CellID->1577472075],

Cell["\<\
Now we rewrite each two-level unitary operator in terms of elementary gates, \
that is, in a combination of CNOT gates and one controlled-U gate.\
\>", "Text",
 CellID->485925136],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " does the job."
}], "MathCaption",
 CellID->441254417],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Catenate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"GrayTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", "nn"}]}], "]"}], "&"}], "/@", "mm"}], 
   "]"}]}]], "Input",
 CellLabel->"In[183]:=",
 CellID->268246946],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.5443111883512624`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4980326481134535`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.4556888116487377`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4980326481134535`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.524091881026576`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7966082050843719`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.09583543052257419`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2855847301429709`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.23599701666165215`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8713020363125691`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4302768523222814`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.6611147913986201`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4856423142269984`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.515059855275046`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.24858020981215107`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.3278114794739893`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8701992406036564`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.367821853045593`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.026562174936336704`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7315386249458521`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6812823871750855`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.12296220079068251`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6606752048322401`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.48898221988164386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.556133940284361`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[183]=",
 CellID->1334456569]
}, Open  ]],

Cell["\<\
Here is a quantum circuit model of the decomposition. Here controlled-U gates \
are all labeled by the same character \"U\" but in fact they are different \
operators. Also do not forget to reverse the order of the elementary gates in \
the quantum circuit model.\
\>", "MathCaption",
 CellID->342917987],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"Reverse", "@", "gates"}], "]"}]}]], "Input",
 CellLabel->"In[184]:=",
 CellID->970727010],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{13, -1}, {13, -2}}], DiskBox[{13, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {13, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImageSize->Medium,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellLabel->"Out[184]=",
 CellID->1800355954]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[185]:=",
 CellID->1356294199],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.005646135641146487`"}], "-", 
    RowBox[{"0.06353614469181242`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.07839654431293229`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.02362266534749141`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.033788215050760226`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.029894756902007706`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1313505548965997`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0013987822858541124`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25350086211206385`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.42977268451779493`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.22678555424276597`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17724018731851848`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03123664070219804`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.2995432925959386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09781094620251658`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.3224200563558479`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10837388971190008`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.21393005843153423`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3120318482940601`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.23102915777704813`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.028196439825964165`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.28388038163169416`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03751036155037145`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.06172048448297639`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0370861045579454`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11861123584248415`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.01642845836852326`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.16121894669244527`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0008385231962122763`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.3050550785441925`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04721960009672814`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.045354685265751905`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[185]=",
 CellID->2085486671]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "opU"}], "//", "Garner"}], "//", "Chop"}]], "Input",
 CellLabel->"In[186]:=",
 CellID->1665455186],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[186]=",
 CellID->791501146]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "TutorialMoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->23220180],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso Package Guide",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/guide/QuissoPackageGuide"]], "TutorialMoreAbout",
 CellID->1567025153],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Tutorials"
}], "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellID->415694126],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso: Quick Start",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuissoQuickStart"]], "RelatedTutorials",
 CellID->2025894544],

Cell[TextData[ButtonBox["QuissoCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuissoCircuitUsage"]], "RelatedTutorials",
 CellID->485574297],

Cell[TextData[ButtonBox["Quantum Fourier Transform",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumFourierTransform"]], "RelatedTutorials",
 CellID->806871991],

Cell[TextData[ButtonBox["Quantum Teleportation",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], "RelatedTutorials",
 CellID->1648188840],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Wolfram Education Group Courses"
}], "TutorialRelatedLinksSection",
 WholeCellGroupOpener->True,
 CellID->415694148],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["An Elementary Introduction to the Wolfram Language"]], 
   "https://www.wolfram.com/language/elementary-introduction/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->415694149],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["The Wolfram Language: Fast Introduction for Programmers"]], 
   "https://www.wolfram.com/language/fast-introduction-for-programmers/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation: Demonstration",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "TutorialColor", 
  "LinkTrails" -> GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "ExampleCounter" -> 1, "NeedPlatMsgIn" -> None, "RootCaptions" -> 
  "", "Metadata" -> {
   "built" -> "{2021, 3, 8, 12, 21, 37.213292}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`", "keywords" -> {}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "Here we provide a simple demonstration that any arbitrary unitary \
operation can be implemented by combining CNOT gate and single-qubit \
rotations. Some functions conveniently used for the demonstration of \
universal quantum computation. We first decompose the unitary operation into \
two-level unitary operations, that is, unitary operators acting only on a \
two-dimensional subspace.", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$188184, "title" -> 
    "Universal Quantum Computation: Demonstration", "titlemodifier" -> "", 
    "windowtitle" -> "Universal Quantum Computation: Demonstration", "type" -> 
    "Tutorial", "uri" -> "Q3/tutorial/UniversalQuantumComputation", 
    "WorkflowDockedCell" -> ""}, "SearchTextTranslated" -> ""},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[616, 21, 4947, 121, 70, "AnchorBarGrid",ExpressionUUID->"4050592d-34cc-4a40-935f-859ae6e6f77b",
 CellID->1],
Cell[CellGroupData[{
Cell[5588, 146, 81, 1, 70, "Title",ExpressionUUID->"a705bef7-1fd2-4b53-9cdb-9f9fe02cccd2",
 CellID->509267359],
Cell[5672, 149, 192, 4, 70, "Text",ExpressionUUID->"bde49f9b-b7a4-44ff-a81e-ff0ddbc22103",
 CellID->1534169418],
Cell[5867, 155, 663, 19, 70, "DefinitionBox",ExpressionUUID->"dd8d0c7b-b2ac-44a6-a4c4-c796cb348b0a",
 CellID->2096742444],
Cell[6533, 176, 138, 4, 70, "Caption",ExpressionUUID->"a760b175-e162-4747-b637-69539e654ef8",
 CellID->1891092685],
Cell[CellGroupData[{
Cell[6696, 184, 98, 1, 70, "Subsection",ExpressionUUID->"885800dd-e8ba-4838-b48d-4fce42f0b374",
 CellID->1707128225],
Cell[6797, 187, 191, 4, 70, "Text",ExpressionUUID->"a251fc5e-b63b-4c4f-92c8-cad198624845",
 CellID->915265898],
Cell[6991, 193, 228, 6, 70, "MathCaption",ExpressionUUID->"0d855fd7-a7e3-4f93-841e-1678bac0e402",
 CellID->836781195],
Cell[7222, 201, 98, 3, 70, "Input",ExpressionUUID->"55523acb-1f61-4fda-bfb5-f4497c1a9c6b",
 CellID->2058623809],
Cell[7323, 206, 128, 4, 70, "Input",ExpressionUUID->"eec7fbb2-df1b-44b4-8c85-1a03819153e7",
 CellID->526990913],
Cell[7454, 212, 250, 10, 70, "MathCaption",ExpressionUUID->"363f6b0f-199d-453d-9f7e-d7e697038efb",
 CellID->679432361],
Cell[CellGroupData[{
Cell[7729, 226, 313, 9, 70, "Input",ExpressionUUID->"cae4729c-4358-41d1-b682-95392cf63337",
 CellID->1893084922],
Cell[8045, 237, 2626, 60, 70, "Output",ExpressionUUID->"2ffdd1ef-1308-4718-8ab3-7068d748ae6e",
 CellID->939510463]
}, Open  ]],
Cell[10686, 300, 121, 3, 70, "MathCaption",ExpressionUUID->"56bab8b0-0897-4df3-95aa-d9a83bb1cba8",
 CellID->535905292],
Cell[CellGroupData[{
Cell[10832, 307, 398, 12, 70, "Input",ExpressionUUID->"856e81a3-efb6-44c6-a8c3-a15ade05a42e",
 CellID->1603109497],
Cell[11233, 321, 8040, 250, 70, "Output",ExpressionUUID->"188f5d9c-5496-4d46-b2b9-1bd238a336a9",
 CellID->981246007]
}, Open  ]],
Cell[19288, 574, 298, 10, 70, "MathCaption",ExpressionUUID->"1413c955-defa-4090-8125-6533832e6942",
 CellID->445690626],
Cell[CellGroupData[{
Cell[19611, 588, 145, 4, 70, "Input",ExpressionUUID->"e105e5cc-5ac4-4d90-ac52-af5e4da0cf1e",
 CellID->874151237],
Cell[19759, 594, 5312, 145, 70, "Output",ExpressionUUID->"0d0fb839-0405-497a-9f57-50b31f8355f0",
 CellID->1710743866]
}, Open  ]],
Cell[25086, 742, 312, 11, 70, "MathCaption",ExpressionUUID->"25ccbdd4-112e-4824-babb-08e48d30c24c",
 CellID->1307945734],
Cell[CellGroupData[{
Cell[25423, 757, 134, 4, 70, "Input",ExpressionUUID->"49e65312-924c-4940-9428-c31e0ddde6a9",
 CellID->344948808],
Cell[25560, 763, 8979, 227, 70, "Output",ExpressionUUID->"65eba63a-f869-41e8-a5cb-381b0b7cfa27",
 CellID->1426001618]
}, Open  ]],
Cell[34554, 993, 92, 1, 70, "MathCaption",ExpressionUUID->"2f6c86c0-b32b-490d-ae3f-12fe04cc4850",
 CellID->732431213],
Cell[CellGroupData[{
Cell[34671, 998, 293, 10, 70, "Input",ExpressionUUID->"5b322522-bf47-4088-aa1d-b915eb3d1f0b",
 CellID->367426686],
Cell[34967, 1010, 613, 19, 70, "Output",ExpressionUUID->"fb7b8b48-e265-4c15-9e6b-0c60fc297dc9",
 CellID->124904640]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35629, 1035, 117, 3, 70, "Subsection",ExpressionUUID->"b010bfd6-4564-4620-a8bc-77ce5a116b74",
 CellID->1577472075],
Cell[35749, 1040, 189, 4, 70, "Text",ExpressionUUID->"a39d4dff-b7ea-4a8b-89d2-978e5dd94de0",
 CellID->485925136],
Cell[35941, 1046, 245, 9, 70, "MathCaption",ExpressionUUID->"02839f34-a9e8-4cca-9613-213b2a35fb97",
 CellID->441254417],
Cell[CellGroupData[{
Cell[36211, 1059, 282, 10, 70, "Input",ExpressionUUID->"215711ff-fcaf-4f6e-9cb9-2e163e972a4b",
 CellID->268246946],
Cell[36496, 1071, 10741, 322, 70, "Output",ExpressionUUID->"1ee4228c-e319-4767-8bd8-306616af756c",
 CellID->1334456569]
}, Open  ]],
Cell[47252, 1396, 314, 6, 70, "MathCaption",ExpressionUUID->"62a50925-5833-4bc0-8020-32f9cfd2f245",
 CellID->342917987],
Cell[CellGroupData[{
Cell[47591, 1406, 169, 5, 70, "Input",ExpressionUUID->"123cdb3e-e560-4402-bccd-9f62ad0db095",
 CellID->970727010],
Cell[47763, 1413, 4579, 105, 70, "Output",ExpressionUUID->"5b5977b1-0404-45a1-9513-5e767056041d",
 CellID->1800355954]
}, Open  ]],
Cell[CellGroupData[{
Cell[52379, 1523, 141, 4, 70, "Input",ExpressionUUID->"41bfea58-54ea-4547-8653-706b92ecad2f",
 CellID->1356294199],
Cell[52523, 1529, 8046, 250, 70, "Output",ExpressionUUID->"cdb3c5ee-79a8-433f-b9bc-020e996ca370",
 CellID->2085486671]
}, Open  ]],
Cell[CellGroupData[{
Cell[60606, 1784, 156, 5, 70, "Input",ExpressionUUID->"c9f19ffb-17b2-406e-a6ab-168a1737e788",
 CellID->1665455186],
Cell[60765, 1791, 73, 2, 70, "Output",ExpressionUUID->"34ea4c5a-36f4-4bc5-855b-ed5d1d64f0ad",
 CellID->791501146]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60887, 1799, 164, 7, 70, "TutorialMoreAboutSection",ExpressionUUID->"bde03e3c-1956-460d-b711-9317c196cb7b",
 CellID->23220180],
Cell[61054, 1808, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"35ae0d24-92e0-4543-ab1a-07cb522c7176"],
Cell[61088, 1810, 162, 3, 70, "TutorialMoreAbout",ExpressionUUID->"f71c7e4b-be2c-4939-a1aa-ddc4a6a48ad3",
 CellID->1567025153],
Cell[61253, 1815, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"c78ee9ee-1a82-4daf-911f-4895178889a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61321, 1820, 167, 7, 70, "RelatedTutorialsSection",ExpressionUUID->"e30dd063-7c9a-440f-b587-d7d750f8e7f2",
 CellID->415694126],
Cell[61491, 1829, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"eb725c42-fb76-403a-b0bf-98cd289a135a"],
Cell[61525, 1831, 161, 3, 70, "RelatedTutorials",ExpressionUUID->"f6664a5f-b37d-4c31-9e8e-266de4a4bd92",
 CellID->2025894544],
Cell[61689, 1836, 171, 3, 70, "RelatedTutorials",ExpressionUUID->"a8f46531-cdfa-4150-9977-7c9abfa730df",
 CellID->485574297],
Cell[61863, 1841, 176, 4, 70, "RelatedTutorials",ExpressionUUID->"d6da8f41-1126-4d1f-ba08-bf09d9e21585",
 CellID->806871991],
Cell[62042, 1847, 167, 3, 70, "RelatedTutorials",ExpressionUUID->"ebb7cdfa-77ba-437c-b9a9-85099ad60421",
 CellID->1648188840],
Cell[62212, 1852, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"c251c738-e442-465f-82de-c70c41e87d80"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62280, 1857, 193, 7, 70, "TutorialRelatedLinksSection",ExpressionUUID->"6f618291-fbc4-402e-b97b-04e5a0f494b0",
 CellID->415694148],
Cell[62476, 1866, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"0abb2859-2070-40cd-b9d6-84e2e68ff0fa"],
Cell[62510, 1868, 286, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"c4fa0bec-11d8-4adc-a923-43f1c89d136c",
 CellID->415694149],
Cell[62799, 1877, 302, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"94a56b08-3da5-40d3-9374-c436163b3287",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],
Cell[63128, 1888, 23, 0, 70, "FooterCell",ExpressionUUID->"c43d90bc-edcb-4e57-88cc-eeda3678efbb"]
}
]
*)

(* End of internal cache information *)
