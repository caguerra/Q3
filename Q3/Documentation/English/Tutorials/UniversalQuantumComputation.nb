(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105385,       2815]
NotebookOptionsPosition[     89283,       2502]
NotebookOutlinePosition[     92157,       2568]
CellTagsIndexPosition[     92114,       2565]
WindowTitle->Universal Quantum Computation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "01326f4e-0987-4e8b-9ced-fd585c01c54b"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "a8f69449-2f12-4200-abcb-6d0d229a4951"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[Cell[BoxData[
     TagBox[
      ActionMenuBox[
       FrameBox[Cell[TextData[{
         "URL",
         " ",
         Cell[BoxData[
          GraphicsBox[
           {GrayLevel[0.66667], Thickness[0.13], 
            LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
           AspectRatio->1,
           AxesStyle->Large,
           FrameStyle->Large,
           ImageSize->20,
           PlotRange->{{-3, 4}, {-1, 1}},
           PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
          "2338268e-4af2-4ecd-9bb5-a0455b47f2e3"]
        }],ExpressionUUID->"f5444206-73f2-4f4f-aff3-430044f34a13"],
        StripOnInput->
         False], {"\<\"Q3/tutorial/UniversalQuantumComputation\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/UniversalQuantumComputation"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputation.html"], StandardForm]], "Input", 
              TextClipboardType -> "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$254572], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"] <> 
            "Q3/tutorial/UniversalQuantumComputation" <> ".html"], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"],
      MouseAppearanceTag["LinkHand"]]],
     LineSpacing->{1.4, 0},ExpressionUUID->
     "8b31274b-86c7-470f-b050-38393e2b2735"]], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "8154eafd-4efe-40d1-948a-ebad1130ffee"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1,ExpressionUUID->"aa5ead46-43fa-4030-82c4-8a7363ea883f"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Universal Quantum Computation", "TechNoteTitle",ExpressionUUID->
      "7e8ce155-a99f-44e5-8a84-5f5710c51c38"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"2e8e30ea-ba34-4f7b-9d95-8ac58dad5db0"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "0345398e-46a3-4588-8584-6ccb2ea666f3"]
    }],ExpressionUUID->"f94ae729-3949-4d91-8adf-675ab21f57d3"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 13\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 13",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "be528ab1-ae0c-4e26-9861-e59a08c25eb2"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"96bdac9e-9d30-460d-9307-0daa8e106268"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Decomposition into Two-Level Unitary Matrices"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1255432361", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell[
      "Implementation of Two-Level Unitary Matrices: Gray Code Sequence"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1829642645", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Implementation of Two-Level Unitary Matrices: Idea"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1012467270", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Universal Quantum Computation Theorem"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#205503201", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"a5c4d5ae-d134-4bfa-8142-\
589d54f93f4f"],

Cell[TextData[{
 "See also Section 2.4 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "96fad681-459e-4875-9edb-5a9f0bd9e4ae"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"cd7affe0-c3ae-4dfb-b7d0-0853cd25daac"],

Cell["\<\
In classical computation, it is known that a finite set of logic gates\
\[LongDash]typically including AND, OR, and NOT\[LongDash]is sufficient to \
calculate any binary function. The set is said to be universal for classical \
computation. Does there exist a universal set of elementary quantum logic \
gates for quantum computation that enables to implement any arbitrary quantum \
unitary operation?\
\>", "TechNoteText",
 CellID->1061332761,ExpressionUUID->"e9441fc1-19eb-4fa2-815b-0a3a5e2d354f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelDecomposition"]], 
      "paclet:Q3/ref/TwoLevelDecomposition", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TechNoteTableText",ExpressionUUID->
     "135bb918-ba21-4fe7-838d-bd76eb85a6b4"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TechNoteTableText",
     ExpressionUUID->"25bb8f78-fd82-4859-9547-723d1a3d8890"]},
   {
    TemplateBox[{
      Cell[
       TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrites a two-level unitary operator in terms of CNOT and controlled-unitary \
gates\
\>", "TechNoteTableText",ExpressionUUID->
     "4cc3010a-3c0f-410e-906e-c4913b208489"]}
  }]], "DefinitionBox",
 CellID->472512640,ExpressionUUID->"bf505026-fbf3-4341-a38e-2f9909c88685"],

Cell["\<\
Q3 functions related to the universal quantum computation theorem.\
\>", "TechNoteCaption",
 CellID->125413874,ExpressionUUID->"073b085c-b6ef-4f33-8a16-7c3c73b357b0"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"01567d04-7786-40d5-a776-0683eece03cb"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"042305f2-c4d0-464c-97d1-9705cf5b0a03"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"a47f28bb-8975-4a68-8dd9-f569c7ea9f52"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->403330096,ExpressionUUID->"1171620e-e7b1-4e30-a92f-ba5ec3b13382"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Two-Level Unitary Matrices", "TechNoteSection",
 CellID->1255432361,ExpressionUUID->"216b9cba-f125-4ad0-bd5a-7c2a179bf900"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1908124157,ExpressionUUID->"22bd2af8-fc78-4b48-891d-1bebe8dc7355"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1469406048,ExpressionUUID->"7a8338e9-52f8-4f23-badf-2b569858bb39"],

Cell[TextData[{
 "Suppose that we want to implement an arbitrary unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f8e7f712-66b2-469b-91c5-70766698cd2f"],
 " on an ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "02ad58a7-038d-459c-be46-69a53c6c9ffe"],
 "-qubit register. We start by decomposing ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "a979d1ca-e55c-48df-8fff-84ef8898cbdc"],
 " into a set of two-level unitary transformations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "k"], TraditionalForm]],ExpressionUUID->
  "6938f624-6af7-4afe-9385-e2d6bf225b87"],
 ", that is,"
}], "TechNoteText",
 CellID->2093541217,ExpressionUUID->"7d0272e9-d4c4-44e8-9ca0-8cd622168dba"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "8a7877e5-1915-4b75-9d69-c0b0212715c5"],
 " ."
}], "TechNoteText",
 CellID->330293091,ExpressionUUID->"b5472347-d9f5-483f-8acc-14e65d412e46"],

Cell[TextData[{
 "\tThe procedure is detailed for arbitrary two-qubit unitary gates in ",
 ButtonBox["Two-Qubit Gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1476129218"],
 ". To summarize the procedure, first  remove the off-diagonal element ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"1", " ", "n"}]], TraditionalForm]],ExpressionUUID->
  "b5abc3bf-eff5-45bc-8fba-08dc50cd423a"],
 " at the top-right corner of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "5205c472-6b15-492a-a4a2-e887b4351c3b"],
 " by multiplying ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0f2cf070-f8f7-4bcf-b4e8-3168cadbb533"],
 " with a two-level unitary transformation ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["T", "1", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "f3d03b53-65df-4ed5-9bfb-11b5ed75f62c"],
 " on the right, and repeat it along the top row and then the next \
consecutive rows to zero all off-diagonal elements and to set every diagonal \
element to unity, so that"
}], "TechNoteText",
 CellID->2138236589,ExpressionUUID->"1ff97e2c-10fd-4fc8-a148-e0fde1293239"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubsuperscriptBox["T", "1", "\[Dagger]"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "L", "\[Dagger]"]}], "=", "I"}], 
   TraditionalForm]],ExpressionUUID->"fcd43c47-0396-448c-9a13-58933bcdfbe6"],
 " ."
}], "TechNoteText",
 CellID->1351002425,ExpressionUUID->"6ab4a457-53b3-4659-83a9-3e92d60e42c2"],

Cell[TextData[{
 "The decomposition of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1b14462f-3797-443a-af09-5482dcfd502c"],
 " is then given by"
}], "TechNoteText",
 CellID->953157244,ExpressionUUID->"47b754bb-2b5c-4ea0-989b-5f4fc0e4cbd6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "79700840-f66e-4aa9-af58-dcab2d51a8e9"],
 " ."
}], "TechNoteText",
 CellID->1633276935,ExpressionUUID->"bbe002bf-9215-4cf4-b07a-3f648f26be06"],

Cell["as desired.", "TechNoteText",
 CellID->1349470591,ExpressionUUID->"c11022fd-2311-4ba7-ad7d-20ebc508196e"],

Cell["\<\
\tFor demonstration, consider a three-qubit system, and an arbitrary unitary \
operation on it.\
\>", "TechNoteText",
 CellID->1917505328,ExpressionUUID->"e70bf7f7-5d78-4c21-b127-b26b521aa4d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->86358426,ExpressionUUID->"8ce8c59d-1507-41d9-baac-e6f28ef3edae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.20207423319608817`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5480570192630587`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3297796798191822`"}], "+", 
       RowBox[{"0.1764795864517839`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.13118804942225143`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.042804517134228386`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.12754187084020574`"}], "+", 
       RowBox[{"0.4775518365206549`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6115961916729864`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11315792261487773`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11799001393273797`"}], "+", 
       RowBox[{"0.01340022267734161`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.06837689322783363`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.020350550286551642`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0026764092993458166`"}], "-", 
       RowBox[{"0.24386311333018407`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6222559830634691`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.33667496188861945`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->977426970,ExpressionUUID->"675ec45d-d2be-41e6-ba2d-2612a31b38e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[7]:=",
 CellID->1264688223,ExpressionUUID->"13470334-afa2-4a48-964f-d421664a66f9"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[8]=",
 CellID->1512668887,ExpressionUUID->"da7f4725-0e6d-402c-a824-143747f18971"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}], ";"}]], "Input",
 CellLabel->"In[17]:=",
 CellID->104214177,ExpressionUUID->"d1419428-6351-4b9c-ac35-ad34f650df87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->1514570623,ExpressionUUID->"f95be8e0-5df2-4ee6-80fd-403b636fe97f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.3155067626282984`"}], "-", 
         RowBox[{"0.9489233281650372`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}}}, {1, 1, 1, 1, 1, 1, Complex[1., 0.], 
         Complex[-0.3155067626282984, -0.9489233281650372]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.5296059615107873`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7782627363062116`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.22317173256815426`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.25301979486184617`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.22317173256815426`"}], "-", 
         RowBox[{"0.25301979486184617`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5296059615107873`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7782627363062116`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 8, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}, {8}, {7}}}, {
        1, 1, 1, 1, 1, 1, Complex[0.5296059615107873, 0.7782627363062116], 
         Complex[0.22317173256815426`, -0.25301979486184617`], Complex[
         0.5296059615107873, -0.7782627363062116], 
         Complex[-0.22317173256815426`, -0.25301979486184617`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"0.42354929487249454`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.21483324570835588`", " ", "\[ImaginaryI]"}]}], 
        "0.8800299263953617`", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"-", "0.8800299263953617`"}], 
        RowBox[{"0.42354929487249454`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.21483324570835588`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         7}, {6}, {8}}}, {
        1, 1, 1, 1, 1, Complex[0.42354929487249454`, -0.21483324570835588`], 
         0.8800299263953617, Complex[
         0.42354929487249454`, 0.21483324570835588`], -0.8800299263953617, 
         1}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[19]=",
 CellID->1264792870,ExpressionUUID->"ccef3d6f-d6ef-4d9c-9d96-b7693ae5e8c4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Two-Level Unitary Matrices: Idea", "TechNoteSection",
 CellID->1012467270,ExpressionUUID->"81fac2d6-b5f8-4453-9349-6648a3dc99e8"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1876122441,ExpressionUUID->"ad25c749-5a29-40bc-8cbe-a16d3f17ea91"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->375590397,ExpressionUUID->"f3877a20-7652-4c99-9ccc-82a09fbe7ad8"],

Cell[TextData[{
 "Some two-level unitary transformations are themselves ",
 ButtonBox["multi-control unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/MultiControlUnitaryGates"],
 ", which can be implemented in terms of elementary gates. The most common \
example is"
}], "TechNoteText",
 CellID->1580628084,ExpressionUUID->"d247359d-3f2a-4ba3-b9a7-c6bda02ca5ae"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "ff01b149-03d4-4ddb-9d40-68d5ad3704f3"],
 " ."
}], "TechNoteText",
 CellID->1243494398,ExpressionUUID->"27e17d40-bc68-4ce4-9ef3-7468b52887b1"],

Cell["On three qubits, another example is", "TechNoteText",
 CellID->99494582,ExpressionUUID->"d8786581-ed76-4e9f-9f13-ee58408ef30d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]", "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "11"], "0", 
       SubscriptBox["V", "12"]},
      {"0", "0", "\[CenterEllipsis]", "0", "1", "0"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "21"], "0", 
       SubscriptBox["V", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "169caf16-7444-47b1-846e-218430bf2ce5"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "dab55c92-5556-46a3-9fc3-caea79e5953b"],
 ","
}], "TechNoteText",
 CellID->1463162308,ExpressionUUID->"9d99ec70-5521-4dc3-afdc-5bdfaeda35a7"],

Cell[TextData[{
 "where the gate with label \[OpenCurlyQuote]",
 StyleBox["V",
  FontSlant->"Italic"],
 " \[CloseCurlyQuote] on the second qubit indicates unitary operator"
}], "TechNoteText",
 CellID->533668759,ExpressionUUID->"65eb5b40-2af0-43d0-9147-6e414fe69f59"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"]},
       {
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "b26f7870-3bcf-45f6-864b-b9052bd43b23"],
 " ."
}], "TechNoteText",
 CellID->1479122641,ExpressionUUID->"cddd2759-4b0c-4d05-8f3a-7cf4824a4f64"],

Cell["\<\
\tSome other two-level unitary transformations are not multi-control unitary \
gates and yet simple variants. An example is\
\>", "TechNoteText",
 CellID->343529615,ExpressionUUID->"3f2ae36d-36f9-46b0-b54a-f5c45c80cc25"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "11"], "0", "0", "0", 
       SubscriptBox["V", "12"], "0"},
      {"0", "0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "21"], "0", "0", "0", 
       SubscriptBox["V", "22"], "0"},
      {"0", "0", "0", "0", "0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "45d3e868-d0a4-4f3c-913e-0d0f52b2dfdd"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -2}, {2, -3}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "bd3ee466-6a1c-4860-b86e-bf381d9e7070"],
 ","
}], "TechNoteText",
 CellID->1266196169,ExpressionUUID->"24b63257-4c41-486b-9c5b-c48a95cd5961"],

Cell[TextData[{
 "In this case, unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "dbfea059-d389-46ad-9631-7ae2f97dd3ce"],
 " acts conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9 (rather than |1\:27e9), and the above two-level unitary transformation \
is a simple variant of multi-control unitary gate."
}], "TechNoteText",
 CellID->1543554260,ExpressionUUID->"452d027d-8dd1-4a7e-8c7e-ae869a4be58e"],

Cell["\<\
\tThrough these examples, we see that any two-level unitary gate with the two \
non-trivial columns and rows attributed to two logical basis states differing \
only in one qubit is either a multi- control unitary gate or a simple variant \
of it. It is thus clear that such a two-level unitary transformation can be \
implemented in terms of elementary gates.\
\>", "TechNoteText",
 CellID->913992060,ExpressionUUID->"59291a23-72db-4b5a-adbc-fcfd83c25b89"],

Cell["\<\
\tTwo-level unitary transformations that do not belong to the above class \
requires additional manipulation. The basic idea is to simultaneously \
exchange columns and rows so that the resulting matrix corresponds to a \
controlled-unitary gate such as the one seen above. Furthermore, a series of \
simultaneous exchanges of columns and rows bring any two-level unitary \
transformation to a multi-control unitary gate and that each exchange of \
columns of rows can be carried by the multi-control NOT gate or a simple \
variant of it.\
\>", "TechNoteText",
 CellID->514025429,ExpressionUUID->"20f7839a-9ded-47c6-a27f-8bbcbda8d6b0"],

Cell[TextData[{
 "\tFor example, consider a two-level unitary transformation ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "6a674295-ab1a-4ab0-9169-7f53bc123629"],
 " on three qubits of the following form,"
}], "TechNoteText",
 CellID->2046156969,ExpressionUUID->"c26b9277-62af-46d5-acb6-a23d78881a89"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"], "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "18db046a-feca-4a2c-af98-eaf0ef2ddddf"],
 "  ."
}], "TechNoteText",
 CellID->2104538572,ExpressionUUID->"93c0f8c4-0a00-4bae-9625-56792d074599"],

Cell[TextData[{
 "The simultaneous exchange of the last two columns and rows brings the above \
two-level unitary matrix to the ",
 ButtonBox["form seen at the beginning",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/UniversalQuantumComputation#1463162308"],
 ". On the other hand, given that the last two columns (or rows) in the \
matrix representation correspond to the logical basis states |110\:27e9 and \
|111\:27e9, respectively, the simultaneous exchange of the last two columns \
and rows can be carried out by the multi-control NOT gate with the first two \
qubits as controls and the third qubit as target. Putting these two \
observations together, we find that"
}], "TechNoteText",
 CellID->1924113514,ExpressionUUID->"ae2606e0-8a4d-4809-b087-94035c33fb33"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "="}], TraditionalForm]],ExpressionUUID->
  "2d808003-c8b8-4513-a208-b35d74bd23ec"],
 " ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "6d820027-6b29-42a2-8aa5-de7e8d0af46e"],
 "."
}], "TechNoteText",
 CellID->1767073272,ExpressionUUID->"1969a6ce-bf19-4d3b-967d-00d531b0b658"],

Cell["For demonstration, consider one of the two above examples.", \
"TechNoteMathCaption",
 CellID->826895218,ExpressionUUID->"45bf697c-e084-4d18-8564-17b518d4d965"],

Cell[BoxData[{
 RowBox[{"<<", "Q3`"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]}], "Input",
 CellLabel->"In[140]:=",
 CellID->1940070093,ExpressionUUID->"7e47e730-04b5-4f7f-b298-2eec0d94894b"],

Cell[TextData[{
 "A two-level unitary matrix is represented in a compact way by ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "940f800c-0c48-497c-846c-234ac842c760"],
 "."
}], "TechNoteMathCaption",
 CellID->735486019,ExpressionUUID->"7b4e31cb-bb0c-4368-a585-38b584905deb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opT", "=", 
  RowBox[{"TwoLevelU", "[", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "7"}], "}"}], ",", "8"}], "]"}]}]], "Input",
 CellLabel->"In[142]:=",
 CellID->880800639,ExpressionUUID->"0140ebca-da01-494a-af11-90534879c162"],

Cell[BoxData[
 RowBox[{"TwoLevelU", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SqrtBox["3"], "2"], ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox[
        SqrtBox["3"], "2"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7"}], "}"}], ",", "8"}], "]"}]], "Output",
 CellLabel->"Out[142]=",
 CellID->1973353292,ExpressionUUID->"1205d6f6-5173-4904-9622-90905c74ce65"]
}, Open  ]],

Cell["\<\
Here is the conventional form of the above two-level unitary matrix.\
\>", "TechNoteMathCaption",
 CellID->1465223655,ExpressionUUID->"df19e3fa-a1fa-44e4-b240-c84201a269c8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", "opT"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[143]:=",
 CellID->2100283434,ExpressionUUID->"3f9792cf-4436-4656-8a06-9cb09b05ee94"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       7}, {6}, {8}}}, {
      1, 1, 1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1}}]]]]], "Output",
 CellLabel->"Out[144]//MatrixForm=",
 CellID->1506345210,ExpressionUUID->"6fee9359-3dd5-470c-9503-a693b1f5719c"]
}, Open  ]],

Cell["\<\
We want to exchange the last two columns and rows simultaneously. This may be \
achieved by using the corresponding permutation matrix, which happens to be \
equivalent to the matrix representation of the CNOT gate in this case.\
\>", "TechNoteMathCaption",
 CellID->1663484699,ExpressionUUID->"e8e8a5fc-c9e0-49e1-b816-471d41703cb7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[145]:=",
 CellID->1579699414,ExpressionUUID->"69b26565-bb92-4e99-8b71-4a91b9caf158"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {2}, {1}, {3}, {4}, {
       4}, {3}, {5}, {6}, {6}, {5}, {7}, {8}, {8}, {7}}}, {1, 0, 1, 0, 1, 0, 
      1, 0, 1, 0, 1, 0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[146]//MatrixForm=",
 CellID->1701567124,ExpressionUUID->"9299e093-b2bd-446d-96bd-1b194e4195c0"]
}, Open  ]],

Cell["\<\
Here is the resulting matrix after the simultaneous exchange of the last two \
columns and rows.\
\>", "TechNoteMathCaption",
 CellID->591924919,ExpressionUUID->"66dc3638-7ee2-4b6a-b436-ca9809fd2262"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"P", ".", "mat", ".", 
    RowBox[{"Topple", "[", "P", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[156]:=",
 CellID->1560387399,ExpressionUUID->"5c87a42b-7ec7-4e37-b1e7-7a56608799be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 12, 16, 20, 24}, {{1}, {2}, {1}, {2}, {3}, {4}, {
       3}, {4}, {5}, {6}, {7}, {8}, {5}, {6}, {7}, {8}, {7}, {8}, {5}, {6}, {
       7}, {8}, {5}, {6}}}, {
      1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 
       0, Rational[-1, 2], 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 0, 
       Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[157]//MatrixForm=",
 CellID->985534445,ExpressionUUID->"de19ba0a-907c-40e1-83a1-c26f80629c87"]
}, Open  ]],

Cell["\<\
The above matrix is nothing but a multi-control unitary operator with the \
first and third as the control qubits.\
\>", "TechNoteMathCaption",
 CellID->1391660944,ExpressionUUID->"f404862c-3ecc-467c-9f03-9f3068f8db52"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"Rotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "@", 
    RowBox[{"Matrix", "[", "op", "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[160]:=",
 CellID->1987632204,ExpressionUUID->"a95e8680-5fcc-4763-af6a-c9f67f0907e2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[161]//MatrixForm=",
 CellID->226194879,ExpressionUUID->"e973a537-c486-4c58-ba9a-6ec8b87bf3ae"]
}, Open  ]],

Cell["\<\
In summary, the two-level unitary matrix is equivalent to the following \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->919087155,ExpressionUUID->"8a99211d-07eb-4098-9d9b-185f3c5f177d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[175]:=",
 CellID->1230259461,ExpressionUUID->"125353de-a41a-4d43-91de-fe943bbeda06"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
    LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
        3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->190.79999999999998`,
  PlotRange->NCache[{
     Rational[-7, 2], 
     Rational[-1, 2]}, {-3.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[175]=",
 CellID->1621878921,ExpressionUUID->"79c6317d-5d46-46f3-b88e-9eaea15be73c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "-", "mat"}], "//", "Normal"}], "//",
    "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[176]:=",
 CellID->833756916,ExpressionUUID->"51e7ce8c-aa9c-4c85-9462-0f89a15d11ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[176]//MatrixForm=",
 CellID->339731586,ExpressionUUID->"1272a93f-2d05-4037-9944-e62ff89d29b6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Two-Level Unitary Matrices: Gray Code Sequence\
\>", "TechNoteSection",
 CellID->1829642645,ExpressionUUID->"d3966235-9e7a-406b-87e3-4c3e4893967b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1037329788,ExpressionUUID->"430a4d1e-8029-495f-98c4-28ea4d0e907b"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1129500570,ExpressionUUID->"e38f669c-5639-4dc2-938a-a88a55669cf9"],

Cell[TextData[{
 "So far, the exchanges of columns and rows have been performed on an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " basis. An irritating issue is that every exchange of columns or rows \
cannot be carried out by a single multi-control NOT gate or a simple variant \
of it. Fortunately, however, one can achieve any desired exchange by \
combining a sequence of other exchanges that can be carried out by a \
multi-control NOT gate (or a simple variant)."
}], "TechNoteText",
 CellID->1649128141,ExpressionUUID->"95db1c42-43b7-4951-8d12-1ff43f78761b"],

Cell["\<\
\tFor example, suppose that we want to exchange the sixth and seventh columns \
and rows. Noting that these columns and rows in the matrix representation \
correspond to logical basis states |101\:27e9 and |110\:27e9, it is clear \
that the exchange cannot be fulfilled by a single multi-control NOT gate. \
However, it can be achieved by first exchanging the sixth and eighth columns \
and rows (respectively corresponding to logical basis states |101\:27e9 and \
|111\:27e9) and then the eighth and seventh columns and rows (respectively \
corresponding to |111\:27e9 and |110\:27e9). The first exchange can be \
carried out by the multi-control NOT gate with the first and third qubit as \
controls and the second qubit as target while the second exchange can be \
implemented by the multi-control NOT gate with the first two qubits as \
controls and the third qubit as target.\
\>", "TechNoteText",
 CellID->1472717605,ExpressionUUID->"cc43d4d1-b46a-442d-b0b1-c55e50715416"],

Cell["\<\
\tThe key point is that each exchange must be between a pair of columns (and \
rows) corresponding to logical basis states that differ in only one qubit. \
For this purpose, a systematic and efficient way is to use the Gray code \
sequence. In terms of classical bits, it is a sequence of bit strings where \
any two successive strings are different only in one bit. As an example, the \
Gray code sequence from |010\:27e9 to |101\:27e9 is given by\
\>", "TechNoteText",
 CellID->68271913,ExpressionUUID->"874ea511-f581-4666-926e-510561ff03ee"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"010"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"110"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"111"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"101"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "05cffff1-fbb7-4372-ac82-7383b39a884f"],
 "."
}], "TechNoteText",
 CellID->689774293,ExpressionUUID->"022137f3-0285-4afa-a98b-4bc603c35171"],

Cell["\<\
The first step in the above sequence corresponds to the NOT gate on the first \
qubit conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9, which is a simple variant of the multi-control NOT gate with the last \
two qubits as control and the first qubit as target\[LongDash]it just needs \
additional NOT gates on the third qubit before and after the multi-control \
NOT gate. The other steps can be carried out simply by multi-control NOT \
gates.\
\>", "TechNoteText",
 CellID->919815945,ExpressionUUID->"8ce47210-e247-4cf6-8387-977ac5b9b2d8"],

Cell["\<\
For demonstration, let us consider a particular two-level unitary matrix on a \
three-qubit system. We want to implement it in terms of elementary quantum \
logic gates.\
\>", "TechNoteMathCaption",
 CellID->274114911,ExpressionUUID->"a04e528a-dd9c-4841-87be-6bb18d489993"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[177]:=",
 CellID->408162463,ExpressionUUID->"84234ece-3178-487e-b893-5909bbd189f0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[178]//MatrixForm=",
 CellID->1493541954,ExpressionUUID->"8e7585b3-7f7f-4813-aa4b-7d42cfee7deb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"2", "^", "$n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[179]:=",
 CellID->140937410,ExpressionUUID->"f62d9139-e60f-4d57-8671-8e198a23630b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellLabel->"Out[182]//MatrixForm=",
 CellID->1586880286,ExpressionUUID->"60bf48d6-7459-4740-bbf5-223ee6337d50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]], "Input",
 CellLabel->"In[183]:=",
 CellID->1202374181,ExpressionUUID->"7171e22f-1285-459e-8e8f-ed498777d481"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}]}]], "Output",
 CellLabel->"Out[183]=",
 CellID->1659522100,ExpressionUUID->"a3411351-975d-4a15-a9e5-550a629e2ade"]
}, Open  ]],

Cell[TextData[{
 "Our implementation is based on the Gray code sequence. Notice the function ",
 StyleBox["Reverse", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->671324729,ExpressionUUID->"55a8a2ad-3891-4c20-8595-9446bd7fb11c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"GrayTwoLevelU", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "SS"}], "]"}]}]}]], "Input",
 CellLabel->"In[184]:=",
 CellID->779608136,ExpressionUUID->"94672c23-4988-4909-92c9-5afe4b29450f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "}"}]], "Output",
 CellLabel->"Out[184]=",
 CellID->2126726716,ExpressionUUID->"0a02b518-8fb7-4e2f-89f4-dc35fc2e9fd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Dot", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Matrix", "[", 
          RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
        RowBox[{"Elaborate", "/@", "gates"}]}]}], "]"}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[185]:=",
 CellID->1607904042,ExpressionUUID->"627b63a3-327d-4a28-ba7b-254fb55a2867"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[186]//MatrixForm=",
 CellID->459507781,ExpressionUUID->"d54fd431-8e6c-4c0a-91e9-43e8a9e69efc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"gates", "[", 
    RowBox[{"[", 
     RowBox[{";;", "10"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"gates", "[", 
    RowBox[{"[", 
     RowBox[{"11", ";;"}], "]"}], "]"}]}]}]}], "Input",
 CellLabel->"In[187]:=",
 CellID->1663700242,ExpressionUUID->"7e9f6425-0594-463f-84c5-3adcc67e2510"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {
    11, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
        5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -2}, {7, -3}}], DiskBox[{7, -1}, 0.09], 
    DiskBox[{7, -2}, 0.09], {CircleBox[{7, -3}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -3}, {7.266666666666667, -3}}, {{
        7, -3.2666666666666666`}, {7, -2.7333333333333334`}}}]}}, {
    LineBox[{{8, -1}, {8, -3}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    DiskBox[{8, -3}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
        8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {9, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{10, -1}, {10, -2}, {10, -3}}], DiskBox[{10, -1}, 0.09], 
    DiskBox[{10, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -3.4}, {10.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {10, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->442.8,
  PlotRange->NCache[{
     Rational[-7, 2], 
     Rational[-1, 2]}, {-3.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[187]=",
 CellID->113314253,ExpressionUUID->"a5824131-8ae2-45e0-af8d-b855e96eab0c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}, {{0, -3}, {
    10, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
        3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
        5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}, {8, -3}}], DiskBox[{8, -1}, 0.09], 
    DiskBox[{8, -2}, 0.09], {CircleBox[{8, -3}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -3}, {8.266666666666667, -3}}, {{
        8, -3.2666666666666666`}, {8, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {9, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->406.8,
  PlotRange->NCache[{
     Rational[-7, 2], 
     Rational[-1, 2]}, {-3.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[188]=",
 CellID->1802138929,ExpressionUUID->"3c2e99db-ca18-4603-93d1-7f6a9423677c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Matrix", "[", "qc2", "]"}], ".", 
      RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[189]:=",
 CellID->722239880,ExpressionUUID->"1e32bb0c-30a8-46f2-8fd3-4bfe96afa21b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[190]//MatrixForm=",
 CellID->1366348004,ExpressionUUID->"28c9a4c0-2335-471b-8235-a937233433a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<PortSize\>\"", "->", "0.2"}]}], "]"}]], "Input",
 CellLabel->"In[191]:=",
 CellID->1008687980,ExpressionUUID->"f9ae8a97-4fb1-4123-8216-4bb9af9558b4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
    LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
        3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{7.2, 7.2}, {1, 1}},
  ImageSize->158.4,
  PlotRange->NCache[{
     Rational[-7, 2], 
     Rational[-1, 2]}, {-3.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[191]=",
 CellID->933535923,ExpressionUUID->"d25bc1c8-5f4b-4ccd-aca5-3e6e6710d855"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Universal Quantum Computation Theorem", "TechNoteSection",
 CellID->205503201,ExpressionUUID->"9bdd3830-f606-4350-8509-faa426711816"],

Cell["\<\
We have seen that one can implement any unitary operation combining the CNOT \
and single-qubit gates. \
\>", "TechNoteText",
 CellID->608169919,ExpressionUUID->"57057b07-b2ee-479b-b4f3-c5bf60d9c5a1"],

Cell["\<\
\tA subtle issue is that single-qubit gates form a continuum of unitary \
operators. It is impractical to implement them to an infinite accuracy. \
Fortunately, it is known that a discrete set of gates is sufficient to \
perform universal quantum computation. The Hadamard, quadrant phase, octant \
phase, and CNOT gates form a universal set of gates in the sense that an \
arbitrary gate on n qubits can be approximated to arbitrary accuracy using a \
quantum circuit composed of only such gates.\
\>", "TechNoteText",
 CellID->1278444818,ExpressionUUID->"88b153a9-2845-4ba6-abdd-fa05a8f77b50"],

Cell["\<\
\tThe quadrant phase gate is equal to the square of the octant phase, and it \
may sound redundant to include the quadrant phase. In the context of the \
universal set of elementary gates alone, it is certainly true. However, the \
quadrant phase gate is typically included in the universal set because it is \
required to fault-tolerantly implement the octant phase.\
\>", "TechNoteText",
 CellID->1089412868,ExpressionUUID->"8497d007-83e3-4b28-bbdf-1064f2a47153"],

Cell["\<\
\tIt is also interesting to note that the set remains universal if octant \
phase gates are replaced with Toffoli gates.\
\>", "TechNoteText",
 CellID->123415854,ExpressionUUID->"c4e9a123-79fb-4c56-b953-4fd1a345fc91"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/guide/QuantumComputationAndQuantumInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "a6ee67ad-6025-4979-b67b-5b3d4e5b97d2"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"5d338da1-d217-469d-9114-\
09763e209c90"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tutorials"}], "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Universal Quantum Computation: Demonstration",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/UniversalQuantumComputationDemonstration"]], 
         "RelatedTutorials",ExpressionUUID->
         "fac47d61-6998-4aa8-ae37-f5c6a8687952"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "035752a0-3475-4f29-bade-43aa61f3647b"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"]], 
         "RelatedTutorials",ExpressionUUID->
         "689ebb85-8d10-48c1-9d79-2eb6eb0f2c7f"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"ebaa111c-c081-4d53-9cb2-\
fb25357e7528"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "fee76355-e7e1-444b-801e-8a0d4e9dd24d"]}]],ExpressionUUID->
         "01d4f98e-ee97-43e3-b432-9b357f271be8"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "910dfb30-b2db-435b-8dad-51504572f382"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "a791693b-9a53-4c05-9646-86ce0eea456b"]}]],ExpressionUUID->
         "c70924a2-1f7b-4959-b06b-a27274ee7137"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c0021d4a-9dc2-4ad3-a1bc-b6ff1a837731"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"30c30f5e-dcb8-42a0-be27-\
55f092dd80e9"],

Cell[" ", "FooterCell",ExpressionUUID->"bbbc85cb-fa48-49ad-b9d9-e64ebe0a3b32"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2021", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 6, 21, 4, 39, 4.251127}", 
    "history" -> {"13", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"universal quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tech Note", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 2.4 of the Quantum Workbook (Springer, 2022). In \
classical computation, it is known that a finite set of logic \
gates\\[LongDash]typically including AND, OR, and NOT\\[LongDash]is \
sufficient to calculate any binary function. The set is said to be universal \
for classical computation. Does there exist a universal set of elementary \
quantum logic gates for quantum computation that enables to implement any \
arbitrary quantum unitary operation? Suppose that we want to implement an \
arbitrary unitary operation U on an n-qubit register. We start by decomposing \
U into a set of two-level unitary transformations T_k, that is,", 
    "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$254509, "title" -> 
    "Universal Quantum Computation", "titlemodifier" -> "", "windowtitle" -> 
    "Universal Quantum Computation", "type" -> "Tech Note", "uri" -> 
    "Q3/tutorial/UniversalQuantumComputation", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> ""},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.0 for Mac OS X ARM (64-bit) (February 4, 2022)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"fa38690a-6496-434e-b53b-c39053fe8a9d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[601, 21, 3527, 82, 57, "AnchorBarGrid",ExpressionUUID->"aa5ead46-43fa-4030-82c4-8a7363ea883f",
 CellID->1],
Cell[CellGroupData[{
Cell[4153, 107, 1404, 38, 61, "ObjectNameGrid",ExpressionUUID->"96bdac9e-9d30-460d-9307-0daa8e106268"],
Cell[5560, 147, 4584, 97, 109, "TechNoteJumpBox",ExpressionUUID->"a5c4d5ae-d134-4bfa-8142-589d54f93f4f"],
Cell[10147, 246, 426, 13, 38, "TechNoteText",ExpressionUUID->"cd7affe0-c3ae-4dfb-b7d0-0853cd25daac",
 CellID->1308734266],
Cell[10576, 261, 510, 8, 84, "TechNoteText",ExpressionUUID->"e9441fc1-19eb-4fa2-815b-0a3a5e2d354f",
 CellID->1061332761],
Cell[11089, 271, 1223, 31, 141, "DefinitionBox",ExpressionUUID->"bf505026-fbf3-4341-a38e-2f9909c88685",
 CellID->472512640],
Cell[12315, 304, 176, 3, 31, "TechNoteCaption",ExpressionUUID->"073b085c-b6ef-4f33-8a16-7c3c73b357b0",
 CellID->125413874],
Cell[12494, 309, 288, 7, 36, "TechNoteMathCaption",ExpressionUUID->"01567d04-7786-40d5-a776-0683eece03cb",
 CellID->1428640008],
Cell[12785, 318, 145, 3, 29, "Input",ExpressionUUID->"042305f2-c4d0-464c-97d1-9705cf5b0a03",
 CellID->853967906],
Cell[12933, 323, 318, 6, 57, "TechNoteMathCaption",ExpressionUUID->"a47f28bb-8975-4a68-8dd9-f569c7ea9f52",
 CellID->1937193009],
Cell[13254, 331, 269, 6, 48, "Input",ExpressionUUID->"1171620e-e7b1-4e30-a92f-ba5ec3b13382",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[13560, 342, 148, 1, 81, "TechNoteSection",ExpressionUUID->"216b9cba-f125-4ad0-bd5a-7c2a179bf900",
 CellID->1255432361],
Cell[13711, 345, 146, 3, 29, "Input",ExpressionUUID->"22bd2af8-fc78-4b48-891d-1bebe8dc7355",
 CellID->1908124157],
Cell[13860, 350, 270, 6, 48, "Input",ExpressionUUID->"7a8338e9-52f8-4f23-badf-2b569858bb39",
 CellID->1469406048],
Cell[14133, 358, 762, 20, 70, "TechNoteText",ExpressionUUID->"7d0272e9-d4c4-44e8-9ca0-8cd622168dba",
 CellID->2093541217],
Cell[14898, 380, 381, 12, 70, "TechNoteText",ExpressionUUID->"b5472347-d9f5-483f-8acc-14e65d412e46",
 CellID->330293091],
Cell[15282, 394, 1197, 28, 70, "TechNoteText",ExpressionUUID->"1ff97e2c-10fd-4fc8-a148-e0fde1293239",
 CellID->2138236589],
Cell[16482, 424, 447, 12, 70, "TechNoteText",ExpressionUUID->"6ab4a457-53b3-4659-83a9-3e92d60e42c2",
 CellID->1351002425],
Cell[16932, 438, 265, 7, 70, "TechNoteText",ExpressionUUID->"47b754bb-2b5c-4ea0-989b-5f4fc0e4cbd6",
 CellID->953157244],
Cell[17200, 447, 382, 12, 70, "TechNoteText",ExpressionUUID->"bbe002bf-9215-4cf4-b07a-3f648f26be06",
 CellID->1633276935],
Cell[17585, 461, 111, 1, 70, "TechNoteText",ExpressionUUID->"c11022fd-2311-4ba7-ad7d-20ebc508196e",
 CellID->1349470591],
Cell[17699, 464, 203, 4, 70, "TechNoteText",ExpressionUUID->"e70bf7f7-5d78-4c21-b127-b26b521aa4d7",
 CellID->1917505328],
Cell[CellGroupData[{
Cell[17927, 472, 652, 20, 70, "Input",ExpressionUUID->"8ce8c59d-1507-41d9-baac-e6f28ef3edae",
 CellID->86358426],
Cell[18582, 494, 1759, 40, 82, "Output",ExpressionUUID->"675ec45d-d2be-41e6-ba2d-2612a31b38e3",
 CellID->977426970]
}, Open  ]],
Cell[CellGroupData[{
Cell[20378, 539, 436, 12, 70, "Input",ExpressionUUID->"13470334-afa2-4a48-964f-d421664a66f9",
 CellID->1264688223],
Cell[20817, 553, 726, 18, 132, "Output",ExpressionUUID->"da7f4725-0e6d-402c-a824-143747f18971",
 CellID->1512668887]
}, Open  ]],
Cell[21558, 574, 219, 5, 70, "Input",ExpressionUUID->"d1419428-6351-4b9c-ac35-ad34f650df87",
 CellID->104214177],
Cell[CellGroupData[{
Cell[21802, 583, 266, 7, 70, "Input",ExpressionUUID->"f95be8e0-5df2-4ee6-80fd-403b636fe97f",
 CellID->1514570623],
Cell[22071, 592, 4758, 108, 297, "Output",ExpressionUUID->"ccef3d6f-d6ef-4d9c-9d96-b7693ae5e8c4",
 CellID->1264792870]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26878, 706, 153, 1, 70, "TechNoteSection",ExpressionUUID->"81fac2d6-b5f8-4453-9349-6648a3dc99e8",
 CellID->1012467270],
Cell[27034, 709, 146, 3, 70, "Input",ExpressionUUID->"ad25c749-5a29-40bc-8cbe-a16d3f17ea91",
 CellID->1876122441],
Cell[27183, 714, 269, 6, 70, "Input",ExpressionUUID->"f3877a20-7652-4c99-9ccc-82a09fbe7ad8",
 CellID->375590397],
Cell[27455, 722, 384, 8, 70, "TechNoteText",ExpressionUUID->"d247359d-3f2a-4ba3-b9a7-c6bda02ca5ae",
 CellID->1580628084],
Cell[27842, 732, 642, 19, 70, "TechNoteText",ExpressionUUID->"27e17d40-bc68-4ce4-9ef3-7468b52887b1",
 CellID->1243494398],
Cell[28487, 753, 133, 1, 70, "TechNoteText",ExpressionUUID->"d8786581-ed76-4e9f-9f13-ee58408ef30d",
 CellID->99494582],
Cell[28623, 756, 1532, 41, 70, "TechNoteText",ExpressionUUID->"9d99ec70-5521-4dc3-afdc-5bdfaeda35a7",
 CellID->1463162308],
Cell[30158, 799, 267, 6, 70, "TechNoteText",ExpressionUUID->"65eb5b40-2af0-43d0-9147-6e414fe69f59",
 CellID->533668759],
Cell[30428, 807, 459, 16, 70, "TechNoteText",ExpressionUUID->"cddd2759-4b0c-4d05-8f3a-7cf4824a4f64",
 CellID->1479122641],
Cell[30890, 825, 230, 4, 70, "TechNoteText",ExpressionUUID->"3f2ae36d-36f9-46b0-b54a-f5c45c80cc25",
 CellID->343529615],
Cell[31123, 831, 2166, 58, 70, "TechNoteText",ExpressionUUID->"24b63257-4c41-486b-9c5b-c48a95cd5961",
 CellID->1266196169],
Cell[33292, 891, 466, 9, 70, "TechNoteText",ExpressionUUID->"452d027d-8dd1-4a7e-8c7e-ae869a4be58e",
 CellID->1543554260],
Cell[33761, 902, 466, 7, 70, "TechNoteText",ExpressionUUID->"59291a23-72db-4b5a-adbc-fcfd83c25b89",
 CellID->913992060],
Cell[34230, 911, 645, 10, 70, "TechNoteText",ExpressionUUID->"20f7839a-9ded-47c6-a27f-8bbcbda8d6b0",
 CellID->514025429],
Cell[34878, 923, 326, 7, 70, "TechNoteText",ExpressionUUID->"c26b9277-62af-46d5-acb6-a23d78881a89",
 CellID->2046156969],
Cell[35207, 932, 814, 22, 70, "TechNoteText",ExpressionUUID->"93c0f8c4-0a00-4bae-9625-56792d074599",
 CellID->2104538572],
Cell[36024, 956, 780, 13, 70, "TechNoteText",ExpressionUUID->"ae2606e0-8a4d-4809-b087-94035c33fb33",
 CellID->1924113514],
Cell[36807, 971, 1581, 37, 70, "TechNoteText",ExpressionUUID->"1969a6ce-bf19-4d3b-967d-00d531b0b658",
 CellID->1767073272],
Cell[38391, 1010, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"45bf697c-e084-4d18-8564-17b518d4d965",
 CellID->826895218],
Cell[38560, 1014, 234, 5, 70, "Input",ExpressionUUID->"7e47e730-04b5-4f7f-b298-2eec0d94894b",
 CellID->1940070093],
Cell[38797, 1021, 468, 12, 70, "TechNoteMathCaption",ExpressionUUID->"7b4e31cb-bb0c-4368-a585-38b584905deb",
 CellID->735486019],
Cell[CellGroupData[{
Cell[39290, 1037, 399, 11, 70, "Input",ExpressionUUID->"0140ebca-da01-494a-af11-90534879c162",
 CellID->880800639],
Cell[39692, 1050, 565, 19, 56, "Output",ExpressionUUID->"1205d6f6-5173-4904-9622-90905c74ce65",
 CellID->1973353292]
}, Open  ]],
Cell[40272, 1072, 183, 3, 70, "TechNoteMathCaption",ExpressionUUID->"df19e3fa-a1fa-44e4-b240-c84201a269c8",
 CellID->1465223655],
Cell[CellGroupData[{
Cell[40480, 1079, 265, 6, 70, "Input",ExpressionUUID->"3f9792cf-4436-4656-8a06-9cb09b05ee94",
 CellID->2100283434],
Cell[40748, 1087, 1363, 36, 188, "Output",ExpressionUUID->"6fee9359-3dd5-470c-9503-a693b1f5719c",
 CellID->1506345210]
}, Open  ]],
Cell[42126, 1126, 343, 5, 70, "TechNoteMathCaption",ExpressionUUID->"e8e8a5fc-c9e0-49e1-b816-471d41703cb7",
 CellID->1663484699],
Cell[CellGroupData[{
Cell[42494, 1135, 442, 13, 70, "Input",ExpressionUUID->"69b26565-bb92-4e99-8b71-4a91b9caf158",
 CellID->1579699414],
Cell[42939, 1150, 1162, 28, 168, "Output",ExpressionUUID->"9299e093-b2bd-446d-96bd-1b194e4195c0",
 CellID->1701567124]
}, Open  ]],
Cell[44116, 1181, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"66dc3638-7ee2-4b6a-b436-ca9809fd2262",
 CellID->591924919],
Cell[CellGroupData[{
Cell[44351, 1189, 305, 7, 70, "Input",ExpressionUUID->"5c87a42b-7ec7-4e37-b1e7-7a56608799be",
 CellID->1560387399],
Cell[44659, 1198, 1493, 38, 188, "Output",ExpressionUUID->"de19ba0a-907c-40e1-83a1-c26f80629c87",
 CellID->985534445]
}, Open  ]],
Cell[46167, 1239, 229, 4, 70, "TechNoteMathCaption",ExpressionUUID->"f404862c-3ecc-467c-9f03-9f3068f8db52",
 CellID->1391660944],
Cell[CellGroupData[{
Cell[46421, 1247, 634, 20, 70, "Input",ExpressionUUID->"a95e8680-5fcc-4763-af6a-c9f67f0907e2",
 CellID->1987632204],
Cell[47058, 1269, 1093, 30, 188, "Output",ExpressionUUID->"e973a537-c486-4c58-ba9a-6ec8b87bf3ae",
 CellID->226194879]
}, Open  ]],
Cell[48166, 1302, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"8a99211d-07eb-4098-9d9b-185f3c5f177d",
 CellID->919087155],
Cell[CellGroupData[{
Cell[48395, 1310, 577, 17, 70, "Input",ExpressionUUID->"125353de-a41a-4d43-91de-fe943bbeda06",
 CellID->1230259461],
Cell[48975, 1329, 1512, 32, 131, "Output",ExpressionUUID->"79c6317d-5d46-46f3-b88e-9eaea15be73c",
 CellID->1621878921]
}, Open  ]],
Cell[CellGroupData[{
Cell[50524, 1366, 288, 8, 70, "Input",ExpressionUUID->"51e7ce8c-aa9c-4c85-9462-0f89a15d11ce",
 CellID->833756916],
Cell[50815, 1376, 936, 23, 168, "Output",ExpressionUUID->"1272a93f-2d05-4037-9944-e62ff89d29b6",
 CellID->339731586]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51800, 1405, 175, 3, 70, "TechNoteSection",ExpressionUUID->"d3966235-9e7a-406b-87e3-4c3e4893967b",
 CellID->1829642645],
Cell[51978, 1410, 146, 3, 70, "Input",ExpressionUUID->"430a4d1e-8029-495f-98c4-28ea4d0e907b",
 CellID->1037329788],
Cell[52127, 1415, 270, 6, 70, "Input",ExpressionUUID->"e38f669c-5639-4dc2-938a-a88a55669cf9",
 CellID->1129500570],
Cell[52400, 1423, 570, 10, 70, "TechNoteText",ExpressionUUID->"95db1c42-43b7-4951-8d12-1ff43f78761b",
 CellID->1649128141],
Cell[52973, 1435, 988, 14, 70, "TechNoteText",ExpressionUUID->"cc43d4d1-b46a-442d-b0b1-c55e50715416",
 CellID->1472717605],
Cell[53964, 1451, 554, 8, 70, "TechNoteText",ExpressionUUID->"874ea511-f581-4666-926e-510561ff03ee",
 CellID->68271913],
Cell[54521, 1461, 446, 16, 70, "TechNoteText",ExpressionUUID->"022137f3-0285-4afa-a98b-4bc603c35171",
 CellID->689774293],
Cell[54970, 1479, 580, 9, 70, "TechNoteText",ExpressionUUID->"8ce47210-e247-4cf6-8387-977ac5b9b2d8",
 CellID->919815945],
Cell[55553, 1490, 283, 5, 70, "TechNoteMathCaption",ExpressionUUID->"a04e528a-dd9c-4841-87be-6bb18d489993",
 CellID->274114911],
Cell[CellGroupData[{
Cell[55861, 1499, 323, 9, 70, "Input",ExpressionUUID->"84234ece-3178-487e-b893-5909bbd189f0",
 CellID->408162463],
Cell[56187, 1510, 946, 29, 86, "Output",ExpressionUUID->"8e7585b3-7f7f-4813-aa4b-7d42cfee7deb",
 CellID->1493541954]
}, Open  ]],
Cell[CellGroupData[{
Cell[57170, 1544, 653, 19, 70, "Input",ExpressionUUID->"f62d9139-e60f-4d57-8671-8e198a23630b",
 CellID->140937410],
Cell[57826, 1565, 1371, 37, 188, "Output",ExpressionUUID->"60bf48d6-7459-4740-bbf5-223ee6337d50",
 CellID->1586880286]
}, Open  ]],
Cell[CellGroupData[{
Cell[59234, 1607, 218, 5, 70, "Input",ExpressionUUID->"7171e22f-1285-459e-8e8f-ed498777d481",
 CellID->1202374181],
Cell[59455, 1614, 3519, 127, 52, "Output",ExpressionUUID->"a3411351-975d-4a15-a9e5-550a629e2ade",
 CellID->1659522100]
}, Open  ]],
Cell[62989, 1744, 233, 5, 70, "TechNoteMathCaption",ExpressionUUID->"55a8a2ad-3891-4c20-8595-9446bd7fb11c",
 CellID->671324729],
Cell[CellGroupData[{
Cell[63247, 1753, 312, 8, 70, "Input",ExpressionUUID->"94672c23-4988-4909-92c9-5afe4b29450f",
 CellID->779608136],
Cell[63562, 1763, 6635, 239, 102, "Output",ExpressionUUID->"0a02b518-8fb7-4e2f-89f4-dc35fc2e9fd4",
 CellID->2126726716]
}, Open  ]],
Cell[CellGroupData[{
Cell[70234, 2007, 533, 15, 70, "Input",ExpressionUUID->"627b63a3-327d-4a28-ba7b-254fb55a2867",
 CellID->1607904042],
Cell[70770, 2024, 1093, 30, 188, "Output",ExpressionUUID->"d54fd431-8e6c-4c0a-91e9-43e8a9e69efc",
 CellID->459507781]
}, Open  ]],
Cell[CellGroupData[{
Cell[71900, 2059, 442, 12, 70, "Input",ExpressionUUID->"7e9f6425-0594-463f-84c5-3adcc67e2510",
 CellID->1663700242],
Cell[72345, 2073, 3630, 80, 131, "Output",ExpressionUUID->"a5824131-8ae2-45e0-af8d-b855e96eab0c",
 CellID->113314253],
Cell[75978, 2155, 3214, 70, 131, "Output",ExpressionUUID->"3c2e99db-ca18-4603-93d1-7f6a9423677c",
 CellID->1802138929]
}, Open  ]],
Cell[CellGroupData[{
Cell[79229, 2230, 405, 11, 70, "Input",ExpressionUUID->"1e32bb0c-30a8-46f2-8fd3-4bfe96afa21b",
 CellID->722239880],
Cell[79637, 2243, 1094, 30, 188, "Output",ExpressionUUID->"28c9a4c0-2335-471b-8235-a937233433a3",
 CellID->1366348004]
}, Open  ]],
Cell[CellGroupData[{
Cell[80768, 2278, 874, 25, 70, "Input",ExpressionUUID->"f9ae8a97-4fb1-4123-8216-4bb9af9558b4",
 CellID->1008687980],
Cell[81645, 2305, 1431, 31, 131, "Output",ExpressionUUID->"d25bc1c8-5f4b-4ccd-aca5-3e6e6710d855",
 CellID->933535923]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83125, 2342, 139, 1, 70, "TechNoteSection",ExpressionUUID->"9bdd3830-f606-4350-8509-faa426711816",
 CellID->205503201],
Cell[83267, 2345, 210, 4, 70, "TechNoteText",ExpressionUUID->"57057b07-b2ee-479b-b4f3-c5bf60d9c5a1",
 CellID->608169919],
Cell[83480, 2351, 605, 9, 70, "TechNoteText",ExpressionUUID->"88b153a9-2845-4ba6-abdd-fa05a8f77b50",
 CellID->1278444818],
Cell[84088, 2362, 475, 7, 70, "TechNoteText",ExpressionUUID->"8497d007-83e3-4b28-bbdf-1064f2a47153",
 CellID->1089412868],
Cell[84566, 2371, 227, 4, 70, "TechNoteText",ExpressionUUID->"c4e9a123-79fb-4c56-b953-4fd1a345fc91",
 CellID->123415854]
}, Open  ]],
Cell[84808, 2378, 755, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"5d338da1-d217-469d-9114-09763e209c90"],
Cell[85566, 2399, 1465, 37, 70, "RelatedTutorialsSection",ExpressionUUID->"ebaa111c-c081-4d53-9cb2-fb25357e7528"],
Cell[87034, 2438, 2164, 60, 70, "TutorialRelatedLinksSection",ExpressionUUID->"30c30f5e-dcb8-42a0-be27-55f092dd80e9"],
Cell[89201, 2500, 78, 0, 70, "FooterCell",ExpressionUUID->"bbbc85cb-fa48-49ad-b9d9-e64ebe0a3b32"]
}
]
*)

(* End of internal cache information *)

