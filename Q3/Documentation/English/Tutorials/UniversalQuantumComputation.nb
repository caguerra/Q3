(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87231,       2315]
NotebookOptionsPosition[     74478,       2064]
NotebookOutlinePosition[     77489,       2132]
CellTagsIndexPosition[     77446,       2129]
WindowTitle->Universal Quantum Computation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "751211b4-a28d-4774-ad29-9965f7a8ece7"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "487bf2df-2eb8-46ba-a847-c48b32642136"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[Cell[BoxData[
     TagBox[
      ActionMenuBox[
       FrameBox[Cell[TextData[{
         "URL",
         " ",
         Cell[BoxData[
          GraphicsBox[
           {GrayLevel[0.66667], Thickness[0.13], 
            LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
           AspectRatio->1,
           AxesStyle->Large,
           FrameStyle->Large,
           ImageSize->20,
           PlotRange->{{-3, 4}, {-1, 1}},
           PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
          "d02d3c3a-212f-4bb8-acc7-9b13d0e778bd"]
        }],ExpressionUUID->"dc776785-c71d-4324-b7d0-400fe9aea3a8"],
        StripOnInput->
         False], {"\<\"Q3/tutorial/UniversalQuantumComputation\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/UniversalQuantumComputation"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputation.html"], StandardForm]], "Input", 
              TextClipboardType -> "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$252720], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"] <> 
            "Q3/tutorial/UniversalQuantumComputation" <> ".html"], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"],
      MouseAppearanceTag["LinkHand"]]],
     LineSpacing->{1.4, 0},ExpressionUUID->
     "9a00c169-fd4c-4931-91de-76463173a2da"]], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "737363c7-cf72-4649-8d7b-2a8e0556b348"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1,ExpressionUUID->"7f911472-9fd8-4fb6-bacc-254a72faaedb"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Universal Quantum Computation", "TechNoteTitle",ExpressionUUID->
      "fb4875d1-ee8f-4427-b238-37fb20d89136"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"f46a7877-0597-4668-aa7f-e2244c9f50fb"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "567eb21e-a04a-4941-823f-cf2e69bbdbaa"]
    }],ExpressionUUID->"a7f95bbf-9f19-40ae-abcb-7787629dfa88"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 13\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 13",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "9aa6a408-0a29-4e6a-b82f-5a00e8461cb1"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,
 CellID->1094699113,ExpressionUUID->"8609af08-bf57-4084-8aac-f3477658391c"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Decomposition into Two-Level Unitary Matrices"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1255432361", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell[
      "Implementation of Two-Level Unitary Matrices: Gray Code Sequence"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1829642645", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Implementation of Two-Level Unitary Matrices: Idea"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1012467270", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Universal Quantum Computation Theorem"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#205503201", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",
 CellID->1115588342,ExpressionUUID->"d2e16e4a-821c-4fd3-86c8-adaa10489072"],

Cell[TextData[{
 "See also Section 2.4 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "ccfb4194-66a8-4866-8094-98d67308aa62"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"cd7affe0-c3ae-4dfb-b7d0-0853cd25daac"],

Cell["\<\
In classical computation, it is known that a finite set of logic gates\
\[LongDash]typically including AND, OR, and NOT\[LongDash]is sufficient to \
calculate any binary function. The set is said to be universal for classical \
computation. Does there exist a universal set of elementary quantum logic \
gates for quantum computation that enables to implement any arbitrary quantum \
unitary operation?\
\>", "TechNoteText",
 CellID->1061332761,ExpressionUUID->"e9441fc1-19eb-4fa2-815b-0a3a5e2d354f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelDecomposition"]], 
      "paclet:Q3/ref/TwoLevelDecomposition", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TechNoteTableText",ExpressionUUID->
     "135bb918-ba21-4fe7-838d-bd76eb85a6b4"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TechNoteTableText",
     ExpressionUUID->"25bb8f78-fd82-4859-9547-723d1a3d8890"]},
   {
    TemplateBox[{
      Cell[
       TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrites a two-level unitary operator in terms of CNOT and controlled-unitary \
gates\
\>", "TechNoteTableText",ExpressionUUID->
     "4cc3010a-3c0f-410e-906e-c4913b208489"]}
  }]], "DefinitionBox",
 CellID->472512640,ExpressionUUID->"bf505026-fbf3-4341-a38e-2f9909c88685"],

Cell["\<\
Q3 functions related to the universal quantum computation theorem.\
\>", "TechNoteCaption",
 CellID->125413874,ExpressionUUID->"073b085c-b6ef-4f33-8a16-7c3c73b357b0"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"01567d04-7786-40d5-a776-0683eece03cb"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"042305f2-c4d0-464c-97d1-9705cf5b0a03"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"a47f28bb-8975-4a68-8dd9-f569c7ea9f52"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->403330096,ExpressionUUID->"1171620e-e7b1-4e30-a92f-ba5ec3b13382"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Two-Level Unitary Matrices", "TechNoteSection",
 CellID->1255432361,ExpressionUUID->"216b9cba-f125-4ad0-bd5a-7c2a179bf900"],

Cell[TextData[{
 "Suppose that we want to implement an arbitrary unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f8e7f712-66b2-469b-91c5-70766698cd2f"],
 " on an ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "02ad58a7-038d-459c-be46-69a53c6c9ffe"],
 "-qubit register. We start by decomposing ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "a979d1ca-e55c-48df-8fff-84ef8898cbdc"],
 " into a set of two-level unitary transformations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "k"], TraditionalForm]],ExpressionUUID->
  "6938f624-6af7-4afe-9385-e2d6bf225b87"],
 ", that is,"
}], "TechNoteText",
 CellID->2093541217,ExpressionUUID->"7d0272e9-d4c4-44e8-9ca0-8cd622168dba"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "8a7877e5-1915-4b75-9d69-c0b0212715c5"],
 " ."
}], "TechNoteText",
 CellID->330293091,ExpressionUUID->"b5472347-d9f5-483f-8acc-14e65d412e46"],

Cell[TextData[{
 "\tThe procedure is detailed for arbitrary two-qubit unitary gates in ",
 ButtonBox["Two-Qubit Gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1476129218"],
 ". To summarize the procedure, first  remove the off-diagonal element ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"1", " ", "n"}]], TraditionalForm]],ExpressionUUID->
  "b5abc3bf-eff5-45bc-8fba-08dc50cd423a"],
 " at the top-right corner of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "5205c472-6b15-492a-a4a2-e887b4351c3b"],
 " by multiplying ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0f2cf070-f8f7-4bcf-b4e8-3168cadbb533"],
 " with a two-level unitary transformation ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["T", "1", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "f3d03b53-65df-4ed5-9bfb-11b5ed75f62c"],
 " on the right, and repeat it along the top row and then the next \
consecutive rows to zero all off-diagonal elements and to set every diagonal \
element to unity, so that"
}], "TechNoteText",
 CellID->2138236589,ExpressionUUID->"1ff97e2c-10fd-4fc8-a148-e0fde1293239"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubsuperscriptBox["T", "1", "\[Dagger]"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "L", "\[Dagger]"]}], "=", "I"}], 
   TraditionalForm]],ExpressionUUID->"fcd43c47-0396-448c-9a13-58933bcdfbe6"],
 " ."
}], "TechNoteText",
 CellID->1351002425,ExpressionUUID->"6ab4a457-53b3-4659-83a9-3e92d60e42c2"],

Cell[TextData[{
 "The decomposition of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1b14462f-3797-443a-af09-5482dcfd502c"],
 " is then given by"
}], "TechNoteText",
 CellID->953157244,ExpressionUUID->"47b754bb-2b5c-4ea0-989b-5f4fc0e4cbd6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "79700840-f66e-4aa9-af58-dcab2d51a8e9"],
 " ."
}], "TechNoteText",
 CellID->1633276935,ExpressionUUID->"bbe002bf-9215-4cf4-b07a-3f648f26be06"],

Cell["as desired.", "TechNoteText",
 CellID->1349470591,ExpressionUUID->"c11022fd-2311-4ba7-ad7d-20ebc508196e"],

Cell["\<\
\tFor demonstration, consider a three-qubit system, and an arbitrary unitary \
operation on it.\
\>", "TechNoteText",
 CellID->1917505328,ExpressionUUID->"e70bf7f7-5d78-4c21-b127-b26b521aa4d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->86358426,ExpressionUUID->"8ce8c59d-1507-41d9-baac-e6f28ef3edae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.20207423319608817`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5480570192630587`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3297796798191822`"}], "+", 
       RowBox[{"0.1764795864517839`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.13118804942225143`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.042804517134228386`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.12754187084020574`"}], "+", 
       RowBox[{"0.4775518365206549`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6115961916729864`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11315792261487773`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11799001393273797`"}], "+", 
       RowBox[{"0.01340022267734161`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.06837689322783363`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.020350550286551642`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0026764092993458166`"}], "-", 
       RowBox[{"0.24386311333018407`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6222559830634691`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.33667496188861945`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->977426970,ExpressionUUID->"675ec45d-d2be-41e6-ba2d-2612a31b38e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[7]:=",
 CellID->1264688223,ExpressionUUID->"13470334-afa2-4a48-964f-d421664a66f9"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[8]=",
 CellID->1512668887,ExpressionUUID->"da7f4725-0e6d-402c-a824-143747f18971"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}], ";"}]], "Input",
 CellLabel->"In[17]:=",
 CellID->104214177,ExpressionUUID->"d1419428-6351-4b9c-ac35-ad34f650df87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->1514570623,ExpressionUUID->"f95be8e0-5df2-4ee6-80fd-403b636fe97f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.3155067626282984`"}], "-", 
         RowBox[{"0.9489233281650372`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}}}, {1, 1, 1, 1, 1, 1, Complex[1., 0.], 
         Complex[-0.3155067626282984, -0.9489233281650372]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.5296059615107873`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7782627363062116`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.22317173256815426`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.25301979486184617`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.22317173256815426`"}], "-", 
         RowBox[{"0.25301979486184617`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5296059615107873`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7782627363062116`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 8, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}, {8}, {7}}}, {
        1, 1, 1, 1, 1, 1, Complex[0.5296059615107873, 0.7782627363062116], 
         Complex[0.22317173256815426`, -0.25301979486184617`], Complex[
         0.5296059615107873, -0.7782627363062116], 
         Complex[-0.22317173256815426`, -0.25301979486184617`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"0.42354929487249454`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.21483324570835588`", " ", "\[ImaginaryI]"}]}], 
        "0.8800299263953617`", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"-", "0.8800299263953617`"}], 
        RowBox[{"0.42354929487249454`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.21483324570835588`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         7}, {6}, {8}}}, {
        1, 1, 1, 1, 1, Complex[0.42354929487249454`, -0.21483324570835588`], 
         0.8800299263953617, Complex[
         0.42354929487249454`, 0.21483324570835588`], -0.8800299263953617, 
         1}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[19]=",
 CellID->1264792870,ExpressionUUID->"ccef3d6f-d6ef-4d9c-9d96-b7693ae5e8c4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Two-Level Unitary Matrices: Idea", "TechNoteSection",
 CellID->1012467270,ExpressionUUID->"81fac2d6-b5f8-4453-9349-6648a3dc99e8"],

Cell[TextData[{
 "Some two-level unitary transformations are themselves ",
 ButtonBox["multi-control unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/MultiControlUnitaryGates"],
 ", which can be implemented in terms of elementary gates. The most common \
example is"
}], "TechNoteText",
 CellID->1580628084,ExpressionUUID->"d247359d-3f2a-4ba3-b9a7-c6bda02ca5ae"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "ff01b149-03d4-4ddb-9d40-68d5ad3704f3"],
 " ."
}], "TechNoteText",
 CellID->1243494398,ExpressionUUID->"27e17d40-bc68-4ce4-9ef3-7468b52887b1"],

Cell["On three qubits, another example is", "TechNoteText",
 CellID->99494582,ExpressionUUID->"d8786581-ed76-4e9f-9f13-ee58408ef30d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]", "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "11"], "0", 
       SubscriptBox["V", "12"]},
      {"0", "0", "\[CenterEllipsis]", "0", "1", "0"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "21"], "0", 
       SubscriptBox["V", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "169caf16-7444-47b1-846e-218430bf2ce5"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "dab55c92-5556-46a3-9fc3-caea79e5953b"],
 ","
}], "TechNoteText",
 CellID->1463162308,ExpressionUUID->"9d99ec70-5521-4dc3-afdc-5bdfaeda35a7"],

Cell[TextData[{
 "where the gate with label \[OpenCurlyQuote]",
 StyleBox["V",
  FontSlant->"Italic"],
 " \[CloseCurlyQuote] on the second qubit indicates unitary operator"
}], "TechNoteText",
 CellID->533668759,ExpressionUUID->"65eb5b40-2af0-43d0-9147-6e414fe69f59"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"]},
       {
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "b26f7870-3bcf-45f6-864b-b9052bd43b23"],
 " ."
}], "TechNoteText",
 CellID->1479122641,ExpressionUUID->"cddd2759-4b0c-4d05-8f3a-7cf4824a4f64"],

Cell["\<\
\tSome other two-level unitary transformations are not multi-control unitary \
gates and yet simple variants. An example is\
\>", "TechNoteText",
 CellID->343529615,ExpressionUUID->"3f2ae36d-36f9-46b0-b54a-f5c45c80cc25"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "11"], "0", "0", "0", 
       SubscriptBox["V", "12"], "0"},
      {"0", "0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "21"], "0", "0", "0", 
       SubscriptBox["V", "22"], "0"},
      {"0", "0", "0", "0", "0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "45d3e868-d0a4-4f3c-913e-0d0f52b2dfdd"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -2}, {2, -3}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "bd3ee466-6a1c-4860-b86e-bf381d9e7070"],
 ","
}], "TechNoteText",
 CellID->1266196169,ExpressionUUID->"24b63257-4c41-486b-9c5b-c48a95cd5961"],

Cell[TextData[{
 "In this case, unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "dbfea059-d389-46ad-9631-7ae2f97dd3ce"],
 " acts conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9 (rather than |1\:27e9), and the above two-level unitary transformation \
is a simple variant of multi-control unitary gate."
}], "TechNoteText",
 CellID->1543554260,ExpressionUUID->"452d027d-8dd1-4a7e-8c7e-ae869a4be58e"],

Cell["\<\
\tThrough these examples, we see that any two-level unitary gate with the two \
non-trivial columns and rows attributed to two logical basis states differing \
only in one qubit is either a multi- control unitary gate or a simple variant \
of it. It is thus clear that such a two-level unitary transformation can be \
implemented in terms of elementary gates.\
\>", "TechNoteText",
 CellID->913992060,ExpressionUUID->"59291a23-72db-4b5a-adbc-fcfd83c25b89"],

Cell["\<\
\tTwo-level unitary transformations that do not belong to the above class \
requires additional manipulation. The basic idea is to simultaneously \
exchange columns and rows so that the resulting matrix corresponds to a \
controlled-unitary gate such as the one seen above. Furthermore, a series of \
simultaneous exchanges of columns and rows bring any two-level unitary \
transformation to a multi-control unitary gate and that each exchange of \
columns of rows can be carried by the multi-control NOT gate or a simple \
variant of it.\
\>", "TechNoteText",
 CellID->514025429,ExpressionUUID->"20f7839a-9ded-47c6-a27f-8bbcbda8d6b0"],

Cell[TextData[{
 "\tFor example, consider a two-level unitary transformation ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "6a674295-ab1a-4ab0-9169-7f53bc123629"],
 " on three qubits of the following form,"
}], "TechNoteText",
 CellID->2046156969,ExpressionUUID->"c26b9277-62af-46d5-acb6-a23d78881a89"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"], "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "18db046a-feca-4a2c-af98-eaf0ef2ddddf"],
 "  ."
}], "TechNoteText",
 CellID->2104538572,ExpressionUUID->"93c0f8c4-0a00-4bae-9625-56792d074599"],

Cell[TextData[{
 "The simultaneous exchange of the last two columns and rows brings the above \
two-level unitary matrix to the ",
 ButtonBox["form seen at the beginning",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/UniversalQuantumComputation#1463162308"],
 ". On the other hand, given that the last two columns (or rows) in the \
matrix representation correspond to the logical basis states |110\:27e9 and \
|111\:27e9, respectively, the simultaneous exchange of the last two columns \
and rows can be carried out by the multi-control NOT gate with the first two \
qubits as controls and the third qubit as target. Putting these two \
observations together, we find that"
}], "TechNoteText",
 CellID->1924113514,ExpressionUUID->"ae2606e0-8a4d-4809-b087-94035c33fb33"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "="}], TraditionalForm]],ExpressionUUID->
  "2d808003-c8b8-4513-a208-b35d74bd23ec"],
 " ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "6d820027-6b29-42a2-8aa5-de7e8d0af46e"],
 "."
}], "TechNoteText",
 CellID->1767073272,ExpressionUUID->"1969a6ce-bf19-4d3b-967d-00d531b0b658"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Two-Level Unitary Matrices: Gray Code Sequence\
\>", "TechNoteSection",
 CellID->1829642645,ExpressionUUID->"d3966235-9e7a-406b-87e3-4c3e4893967b"],

Cell[TextData[{
 "So far, the exchanges of columns and rows have been performed on an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " basis. An irritating issue is that every exchange of columns or rows \
cannot be carried out by a single multi-control NOT gate or a simple variant \
of it. Fortunately, however, one can achieve any desired exchange by \
combining a sequence of other exchanges that can be carried out by a \
multi-control NOT gate (or a simple variant)."
}], "TechNoteText",
 CellID->1649128141,ExpressionUUID->"95db1c42-43b7-4951-8d12-1ff43f78761b"],

Cell["\<\
\tFor example, suppose that we want to exchange the sixth and seventh columns \
and rows. Noting that these columns and rows in the matrix representation \
correspond to logical basis states |101\:27e9 and |110\:27e9, it is clear \
that the exchange cannot be fulfilled by a single multi-control NOT gate. \
However, it can be achieved by first exchanging the sixth and eighth columns \
and rows (respectively corresponding to logical basis states |101\:27e9 and \
|111\:27e9) and then the eighth and seventh columns and rows (respectively \
corresponding to |111\:27e9 and |110\:27e9). The first exchange can be \
carried out by the multi-control NOT gate with the first and third qubit as \
controls and the second qubit as target while the second exchange can be \
implemented by the multi-control NOT gate with the first two qubits as \
controls and the third qubit as target.\
\>", "TechNoteText",
 CellID->1472717605,ExpressionUUID->"cc43d4d1-b46a-442d-b0b1-c55e50715416"],

Cell["\<\
\tThe key point is that each exchange must be between a pair of columns (and \
rows) corresponding to logical basis states that differ in only one qubit. \
For this purpose, a systematic and efficient way is to use the Gray code \
sequence. In terms of classical bits, it is a sequence of bit strings where \
any two successive strings are different only in one bit. As an example, the \
Gray code sequence from |010\:27e9 to |101\:27e9 is given by\
\>", "TechNoteText",
 CellID->68271913,ExpressionUUID->"874ea511-f581-4666-926e-510561ff03ee"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"010"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"110"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"111"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"101"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "05cffff1-fbb7-4372-ac82-7383b39a884f"],
 "."
}], "TechNoteText",
 CellID->689774293,ExpressionUUID->"022137f3-0285-4afa-a98b-4bc603c35171"],

Cell["\<\
The first step in the above sequence corresponds to the NOT gate on the first \
qubit conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9, which is a simple variant of the multi-control NOT gate with the last \
two qubits as control and the first qubit as target\[LongDash]it just needs \
additional NOT gates on the third qubit before and after the multi-control \
NOT gate. The other steps can be carried out simply by multi-control NOT \
gates.\
\>", "TechNoteText",
 CellID->919815945,ExpressionUUID->"8ce47210-e247-4cf6-8387-977ac5b9b2d8"],

Cell["\<\
\tFor demonstration, let us consider a particular two-level unitary matrix on \
a three-qubit system. We want to implement it in terms of elementary quantum \
logic gates.\
\>", "TechNoteText",
 CellID->274114911,ExpressionUUID->"a04e528a-dd9c-4841-87be-6bb18d489993"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[8]:=",
 CellID->408162463,ExpressionUUID->"84234ece-3178-487e-b893-5909bbd189f0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1759296509,ExpressionUUID->"7d3f37e1-fa87-4c1a-ba2c-be19865e35cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"2", "^", "$n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[16]:=",
 CellID->140937410,ExpressionUUID->"f62d9139-e60f-4d57-8671-8e198a23630b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellLabel->"Out[19]//MatrixForm=",
 CellID->1941574867,ExpressionUUID->"e79f8f9d-6f41-46ea-adf5-5c72d5b1e9d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]], "Input",
 CellLabel->"In[20]:=",
 CellID->1202374181,ExpressionUUID->"7171e22f-1285-459e-8e8f-ed498777d481"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}]}]], "Output",
 CellLabel->"Out[20]=",
 CellID->1034773504,ExpressionUUID->"f5af4895-1a6b-4638-8b2b-0b5b68024818"]
}, Open  ]],

Cell[TextData[{
 "Our implementation is based on the Gray code sequence. Notice the function ",
 StyleBox["Reverse", "Input"],
 "."
}], "TechNoteText",
 CellID->671324729,ExpressionUUID->"55a8a2ad-3891-4c20-8595-9446bd7fb11c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"GrayTwoLevelU", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "SS"}], "]"}]}]}]], "Input",
 CellLabel->"In[21]:=",
 CellID->779608136,ExpressionUUID->"94672c23-4988-4909-92c9-5afe4b29450f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], ",", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]]}], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "}"}]], "Output",
 CellLabel->"Out[21]=",
 CellID->1115708322,ExpressionUUID->"0dd0b4bc-511e-4fd5-8a64-b4f79143e545"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Dot", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Matrix", "[", 
          RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
        RowBox[{"Elaborate", "/@", "gates"}]}]}], "]"}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[22]:=",
 CellID->1607904042,ExpressionUUID->"627b63a3-327d-4a28-ba7b-254fb55a2867"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[23]//MatrixForm=",
 CellID->2030045897,ExpressionUUID->"71b86a78-c210-4d03-801c-b43d9999936a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"gates", "[", 
    RowBox[{"[", 
     RowBox[{";;", "10"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"gates", "[", 
    RowBox[{"[", 
     RowBox[{"11", ";;"}], "]"}], "]"}]}]}]}], "Input",
 CellLabel->"In[24]:=",
 CellID->1663700242,ExpressionUUID->"7e9f6425-0594-463f-84c5-3adcc67e2510"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {
    11, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
        5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -2}, {7, -3}}], DiskBox[{7, -1}, 0.09], 
    DiskBox[{7, -2}, 0.09], {CircleBox[{7, -3}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -3}, {7.266666666666667, -3}}, {{
        7, -3.2666666666666666`}, {7, -2.7333333333333334`}}}]}}, {
    LineBox[{{8, -1}, {8, -3}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    DiskBox[{8, -3}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
        8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {9, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{10, -1}, {10, -2}, {10, -3}}], DiskBox[{10, -1}, 0.09], 
    DiskBox[{10, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -3.4}, {10.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {10, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->442.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[24]=",
 CellID->1908690990,ExpressionUUID->"c29ea51f-dc42-4aaf-87e1-e1e481957a3f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}, {{0, -3}, {
    10, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
        3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
        5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}, {8, -3}}], DiskBox[{8, -1}, 0.09], 
    DiskBox[{8, -2}, 0.09], {CircleBox[{8, -3}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -3}, {8.266666666666667, -3}}, {{
        8, -3.2666666666666666`}, {8, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {9, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->406.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[25]=",
 CellID->258750044,ExpressionUUID->"1f964de0-b32a-4957-b5e9-33465e487913"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Matrix", "[", "qc2", "]"}], ".", 
      RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[26]:=",
 CellID->722239880,ExpressionUUID->"1e32bb0c-30a8-46f2-8fd3-4bfe96afa21b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[27]//MatrixForm=",
 CellID->157604333,ExpressionUUID->"2fad2bf2-2e40-4a1d-9e79-bfe2e5d93c89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<PortSize\>\"", "->", "0.2"}]}], "]"}]], "Input",
 CellLabel->"In[28]:=",
 CellID->1008687980,ExpressionUUID->"f9ae8a97-4fb1-4123-8216-4bb9af9558b4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
    LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
        3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{7.2, 7.2}, {5, 5}},
  ImageSize->158.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[28]=",
 CellID->782970442,ExpressionUUID->"d3d6d38d-c5e0-4693-8279-1bc919c68d08"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Universal Quantum Computation Theorem", "TechNoteSection",
 CellID->205503201,ExpressionUUID->"9bdd3830-f606-4350-8509-faa426711816"],

Cell["\<\
We have seen that one can implement any unitary operation combining the CNOT \
and single-qubit gates. \
\>", "TechNoteText",
 CellID->608169919,ExpressionUUID->"57057b07-b2ee-479b-b4f3-c5bf60d9c5a1"],

Cell["\<\
\tA subtle issue is that single-qubit gates form a continuum of unitary \
operators. It is impractical to implement them to an infinite accuracy. \
Fortunately, it is known that a discrete set of gates is sufficient to \
perform universal quantum computation. The Hadamard, quadrant phase, octant \
phase, and CNOT gates form a universal set of gates in the sense that an \
arbitrary gate on n qubits can be approximated to arbitrary accuracy using a \
quantum circuit composed of only such gates.\
\>", "TechNoteText",
 CellID->1278444818,ExpressionUUID->"88b153a9-2845-4ba6-abdd-fa05a8f77b50"],

Cell["\<\
\tThe quadrant phase gate is equal to the square of the octant phase, and it \
may sound redundant to include the quadrant phase. In the context of the \
universal set of elementary gates alone, it is certainly true. However, the \
quadrant phase gate is typically included in the universal set because it is \
required to fault-tolerantly implement the octant phase.\
\>", "TechNoteText",
 CellID->1089412868,ExpressionUUID->"8497d007-83e3-4b28-bbdf-1064f2a47153"],

Cell["\<\
\tIt is also interesting to note that the set remains universal if octant \
phase gates are replaced with Toffoli gates.\
\>", "TechNoteText",
 CellID->123415854,ExpressionUUID->"c4e9a123-79fb-4c56-b953-4fd1a345fc91"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/guide/QuantumComputationAndQuantumInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "a6ee67ad-6025-4979-b67b-5b3d4e5b97d2"]}]}
     }]}
  }]], "TutorialMoreAboutSection",
 CellID->13542037,ExpressionUUID->"5d254f30-d496-4d0c-acec-2e2ae0ed8dd3"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tutorials"}], "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Universal Quantum Computation: Demonstration",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/UniversalQuantumComputationDemonstration"]], 
         "RelatedTutorials",ExpressionUUID->
         "fac47d61-6998-4aa8-ae37-f5c6a8687952"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "035752a0-3475-4f29-bade-43aa61f3647b"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"]], 
         "RelatedTutorials",ExpressionUUID->
         "689ebb85-8d10-48c1-9d79-2eb6eb0f2c7f"]}]}
     }]}
  }]], "RelatedTutorialsSection",
 CellID->2115232924,ExpressionUUID->"fd61d6ce-a247-4613-afec-d32ede61123a"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "dfa3cb18-75ac-4f09-a1ad-71373e56efd9"]}]],ExpressionUUID->
         "2d0673fa-6d00-4289-8303-bc90065cd216"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "910dfb30-b2db-435b-8dad-51504572f382"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "1010d63b-6e7f-4a4c-9788-a057bb7298f3"]}]],ExpressionUUID->
         "62637d72-a260-486c-aa49-765874ae1a6e"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c0021d4a-9dc2-4ad3-a1bc-b6ff1a837731"]}
     }]}
  }]], "TutorialRelatedLinksSection",
 CellID->1275461230,ExpressionUUID->"595a6884-8656-4dc6-9f3c-d01efac61152"],

Cell[" ", "FooterCell",
 CellID->495128256,ExpressionUUID->"3510e5d8-af64-465a-8f2d-a9848d5c00bf"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2021", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 4, 4, 22, 58, 32.541954}", 
    "history" -> {"13", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"universal quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tech Note", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 2.4 of the Quantum Workbook (Springer, 2022). In \
classical computation, it is known that a finite set of logic \
gates\\[LongDash]typically including AND, OR, and NOT\\[LongDash]is \
sufficient to calculate any binary function. The set is said to be universal \
for classical computation. Does there exist a universal set of elementary \
quantum logic gates for quantum computation that enables to implement any \
arbitrary quantum unitary operation? Suppose that we want to implement an \
arbitrary unitary operation U on an n-qubit register. We start by decomposing \
U into a set of two-level unitary transformations T_k, that is,", 
    "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$252663, "title" -> 
    "Universal Quantum Computation", "titlemodifier" -> "", "windowtitle" -> 
    "Universal Quantum Computation", "type" -> "Tech Note", "uri" -> 
    "Q3/tutorial/UniversalQuantumComputation", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> ""},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]], 
    CellID -> 864888073], 
   Cell[
    StyleData["Input"], CellContext -> Notebook, CellID -> 2004520015], 
   Cell[
    StyleData["Output"], CellContext -> Notebook, CellID -> 244437969], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 132728272], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 1676041918], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 693518127]}, 
  Visible -> False, FrontEndVersion -> 
  "13.0 for Mac OS X ARM (64-bit) (February 4, 2022)", StyleDefinitions -> 
  "Default.nb"],
ExpressionUUID->"a9e6acca-5bbf-4747-80cb-3a1c6b77cd15"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[601, 21, 3527, 82, 57, "AnchorBarGrid",ExpressionUUID->"7f911472-9fd8-4fb6-bacc-254a72faaedb",
 CellID->1],
Cell[CellGroupData[{
Cell[4153, 107, 1425, 39, 61, "ObjectNameGrid",ExpressionUUID->"8609af08-bf57-4084-8aac-f3477658391c",
 CellID->1094699113],
Cell[5581, 148, 4603, 97, 109, "TechNoteJumpBox",ExpressionUUID->"d2e16e4a-821c-4fd3-86c8-adaa10489072",
 CellID->1115588342],
Cell[10187, 247, 426, 13, 38, "TechNoteText",ExpressionUUID->"cd7affe0-c3ae-4dfb-b7d0-0853cd25daac",
 CellID->1308734266],
Cell[10616, 262, 510, 8, 84, "TechNoteText",ExpressionUUID->"e9441fc1-19eb-4fa2-815b-0a3a5e2d354f",
 CellID->1061332761],
Cell[11129, 272, 1223, 31, 141, "DefinitionBox",ExpressionUUID->"bf505026-fbf3-4341-a38e-2f9909c88685",
 CellID->472512640],
Cell[12355, 305, 176, 3, 31, "TechNoteCaption",ExpressionUUID->"073b085c-b6ef-4f33-8a16-7c3c73b357b0",
 CellID->125413874],
Cell[12534, 310, 288, 7, 36, "TechNoteMathCaption",ExpressionUUID->"01567d04-7786-40d5-a776-0683eece03cb",
 CellID->1428640008],
Cell[12825, 319, 145, 3, 29, "Input",ExpressionUUID->"042305f2-c4d0-464c-97d1-9705cf5b0a03",
 CellID->853967906],
Cell[12973, 324, 318, 6, 57, "TechNoteMathCaption",ExpressionUUID->"a47f28bb-8975-4a68-8dd9-f569c7ea9f52",
 CellID->1937193009],
Cell[13294, 332, 269, 6, 48, "Input",ExpressionUUID->"1171620e-e7b1-4e30-a92f-ba5ec3b13382",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[13600, 343, 148, 1, 81, "TechNoteSection",ExpressionUUID->"216b9cba-f125-4ad0-bd5a-7c2a179bf900",
 CellID->1255432361],
Cell[13751, 346, 762, 20, 60, "TechNoteText",ExpressionUUID->"7d0272e9-d4c4-44e8-9ca0-8cd622168dba",
 CellID->2093541217],
Cell[14516, 368, 381, 12, 70, "TechNoteText",ExpressionUUID->"b5472347-d9f5-483f-8acc-14e65d412e46",
 CellID->330293091],
Cell[14900, 382, 1197, 28, 70, "TechNoteText",ExpressionUUID->"1ff97e2c-10fd-4fc8-a148-e0fde1293239",
 CellID->2138236589],
Cell[16100, 412, 447, 12, 70, "TechNoteText",ExpressionUUID->"6ab4a457-53b3-4659-83a9-3e92d60e42c2",
 CellID->1351002425],
Cell[16550, 426, 265, 7, 70, "TechNoteText",ExpressionUUID->"47b754bb-2b5c-4ea0-989b-5f4fc0e4cbd6",
 CellID->953157244],
Cell[16818, 435, 382, 12, 70, "TechNoteText",ExpressionUUID->"bbe002bf-9215-4cf4-b07a-3f648f26be06",
 CellID->1633276935],
Cell[17203, 449, 111, 1, 70, "TechNoteText",ExpressionUUID->"c11022fd-2311-4ba7-ad7d-20ebc508196e",
 CellID->1349470591],
Cell[17317, 452, 203, 4, 70, "TechNoteText",ExpressionUUID->"e70bf7f7-5d78-4c21-b127-b26b521aa4d7",
 CellID->1917505328],
Cell[CellGroupData[{
Cell[17545, 460, 652, 20, 70, "Input",ExpressionUUID->"8ce8c59d-1507-41d9-baac-e6f28ef3edae",
 CellID->86358426],
Cell[18200, 482, 1759, 40, 82, "Output",ExpressionUUID->"675ec45d-d2be-41e6-ba2d-2612a31b38e3",
 CellID->977426970]
}, Open  ]],
Cell[CellGroupData[{
Cell[19996, 527, 436, 12, 70, "Input",ExpressionUUID->"13470334-afa2-4a48-964f-d421664a66f9",
 CellID->1264688223],
Cell[20435, 541, 726, 18, 132, "Output",ExpressionUUID->"da7f4725-0e6d-402c-a824-143747f18971",
 CellID->1512668887]
}, Open  ]],
Cell[21176, 562, 219, 5, 70, "Input",ExpressionUUID->"d1419428-6351-4b9c-ac35-ad34f650df87",
 CellID->104214177],
Cell[CellGroupData[{
Cell[21420, 571, 266, 7, 70, "Input",ExpressionUUID->"f95be8e0-5df2-4ee6-80fd-403b636fe97f",
 CellID->1514570623],
Cell[21689, 580, 4758, 108, 297, "Output",ExpressionUUID->"ccef3d6f-d6ef-4d9c-9d96-b7693ae5e8c4",
 CellID->1264792870]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26496, 694, 153, 1, 70, "TechNoteSection",ExpressionUUID->"81fac2d6-b5f8-4453-9349-6648a3dc99e8",
 CellID->1012467270],
Cell[26652, 697, 384, 8, 70, "TechNoteText",ExpressionUUID->"d247359d-3f2a-4ba3-b9a7-c6bda02ca5ae",
 CellID->1580628084],
Cell[27039, 707, 642, 19, 70, "TechNoteText",ExpressionUUID->"27e17d40-bc68-4ce4-9ef3-7468b52887b1",
 CellID->1243494398],
Cell[27684, 728, 133, 1, 70, "TechNoteText",ExpressionUUID->"d8786581-ed76-4e9f-9f13-ee58408ef30d",
 CellID->99494582],
Cell[27820, 731, 1532, 41, 70, "TechNoteText",ExpressionUUID->"9d99ec70-5521-4dc3-afdc-5bdfaeda35a7",
 CellID->1463162308],
Cell[29355, 774, 267, 6, 70, "TechNoteText",ExpressionUUID->"65eb5b40-2af0-43d0-9147-6e414fe69f59",
 CellID->533668759],
Cell[29625, 782, 459, 16, 70, "TechNoteText",ExpressionUUID->"cddd2759-4b0c-4d05-8f3a-7cf4824a4f64",
 CellID->1479122641],
Cell[30087, 800, 230, 4, 70, "TechNoteText",ExpressionUUID->"3f2ae36d-36f9-46b0-b54a-f5c45c80cc25",
 CellID->343529615],
Cell[30320, 806, 2166, 58, 70, "TechNoteText",ExpressionUUID->"24b63257-4c41-486b-9c5b-c48a95cd5961",
 CellID->1266196169],
Cell[32489, 866, 466, 9, 70, "TechNoteText",ExpressionUUID->"452d027d-8dd1-4a7e-8c7e-ae869a4be58e",
 CellID->1543554260],
Cell[32958, 877, 466, 7, 70, "TechNoteText",ExpressionUUID->"59291a23-72db-4b5a-adbc-fcfd83c25b89",
 CellID->913992060],
Cell[33427, 886, 645, 10, 70, "TechNoteText",ExpressionUUID->"20f7839a-9ded-47c6-a27f-8bbcbda8d6b0",
 CellID->514025429],
Cell[34075, 898, 326, 7, 70, "TechNoteText",ExpressionUUID->"c26b9277-62af-46d5-acb6-a23d78881a89",
 CellID->2046156969],
Cell[34404, 907, 814, 22, 70, "TechNoteText",ExpressionUUID->"93c0f8c4-0a00-4bae-9625-56792d074599",
 CellID->2104538572],
Cell[35221, 931, 780, 13, 70, "TechNoteText",ExpressionUUID->"ae2606e0-8a4d-4809-b087-94035c33fb33",
 CellID->1924113514],
Cell[36004, 946, 1581, 37, 70, "TechNoteText",ExpressionUUID->"1969a6ce-bf19-4d3b-967d-00d531b0b658",
 CellID->1767073272]
}, Open  ]],
Cell[CellGroupData[{
Cell[37622, 988, 175, 3, 70, "TechNoteSection",ExpressionUUID->"d3966235-9e7a-406b-87e3-4c3e4893967b",
 CellID->1829642645],
Cell[37800, 993, 570, 10, 70, "TechNoteText",ExpressionUUID->"95db1c42-43b7-4951-8d12-1ff43f78761b",
 CellID->1649128141],
Cell[38373, 1005, 988, 14, 70, "TechNoteText",ExpressionUUID->"cc43d4d1-b46a-442d-b0b1-c55e50715416",
 CellID->1472717605],
Cell[39364, 1021, 554, 8, 70, "TechNoteText",ExpressionUUID->"874ea511-f581-4666-926e-510561ff03ee",
 CellID->68271913],
Cell[39921, 1031, 446, 16, 70, "TechNoteText",ExpressionUUID->"022137f3-0285-4afa-a98b-4bc603c35171",
 CellID->689774293],
Cell[40370, 1049, 580, 9, 70, "TechNoteText",ExpressionUUID->"8ce47210-e247-4cf6-8387-977ac5b9b2d8",
 CellID->919815945],
Cell[40953, 1060, 278, 5, 70, "TechNoteText",ExpressionUUID->"a04e528a-dd9c-4841-87be-6bb18d489993",
 CellID->274114911],
Cell[CellGroupData[{
Cell[41256, 1069, 321, 9, 70, "Input",ExpressionUUID->"84234ece-3178-487e-b893-5909bbd189f0",
 CellID->408162463],
Cell[41580, 1080, 944, 29, 86, "Output",ExpressionUUID->"7d3f37e1-fa87-4c1a-ba2c-be19865e35cd",
 CellID->1759296509]
}, Open  ]],
Cell[CellGroupData[{
Cell[42561, 1114, 652, 19, 70, "Input",ExpressionUUID->"f62d9139-e60f-4d57-8671-8e198a23630b",
 CellID->140937410],
Cell[43216, 1135, 1370, 37, 188, "Output",ExpressionUUID->"e79f8f9d-6f41-46ea-adf5-5c72d5b1e9d7",
 CellID->1941574867]
}, Open  ]],
Cell[CellGroupData[{
Cell[44623, 1177, 217, 5, 70, "Input",ExpressionUUID->"7171e22f-1285-459e-8e8f-ed498777d481",
 CellID->1202374181],
Cell[44843, 1184, 3518, 127, 52, "Output",ExpressionUUID->"f5af4895-1a6b-4638-8b2b-0b5b68024818",
 CellID->1034773504]
}, Open  ]],
Cell[48376, 1314, 226, 5, 70, "TechNoteText",ExpressionUUID->"55a8a2ad-3891-4c20-8595-9446bd7fb11c",
 CellID->671324729],
Cell[CellGroupData[{
Cell[48627, 1323, 311, 8, 70, "Input",ExpressionUUID->"94672c23-4988-4909-92c9-5afe4b29450f",
 CellID->779608136],
Cell[48941, 1333, 6634, 239, 102, "Output",ExpressionUUID->"0dd0b4bc-511e-4fd5-8a64-b4f79143e545",
 CellID->1115708322]
}, Open  ]],
Cell[CellGroupData[{
Cell[55612, 1577, 532, 15, 70, "Input",ExpressionUUID->"627b63a3-327d-4a28-ba7b-254fb55a2867",
 CellID->1607904042],
Cell[56147, 1594, 1093, 30, 188, "Output",ExpressionUUID->"71b86a78-c210-4d03-801c-b43d9999936a",
 CellID->2030045897]
}, Open  ]],
Cell[CellGroupData[{
Cell[57277, 1629, 441, 12, 70, "Input",ExpressionUUID->"7e9f6425-0594-463f-84c5-3adcc67e2510",
 CellID->1663700242],
Cell[57721, 1643, 3547, 77, 132, "Output",ExpressionUUID->"c29ea51f-dc42-4aaf-87e1-e1e481957a3f",
 CellID->1908690990],
Cell[61271, 1722, 3129, 67, 132, "Output",ExpressionUUID->"1f964de0-b32a-4957-b5e9-33465e487913",
 CellID->258750044]
}, Open  ]],
Cell[CellGroupData[{
Cell[64437, 1794, 404, 11, 70, "Input",ExpressionUUID->"1e32bb0c-30a8-46f2-8fd3-4bfe96afa21b",
 CellID->722239880],
Cell[64844, 1807, 1092, 30, 188, "Output",ExpressionUUID->"2fad2bf2-2e40-4a1d-9e79-bfe2e5d93c89",
 CellID->157604333]
}, Open  ]],
Cell[CellGroupData[{
Cell[65973, 1842, 873, 25, 70, "Input",ExpressionUUID->"f9ae8a97-4fb1-4123-8216-4bb9af9558b4",
 CellID->1008687980],
Cell[66849, 1869, 1347, 28, 116, "Output",ExpressionUUID->"d3d6d38d-c5e0-4693-8279-1bc919c68d08",
 CellID->782970442]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68245, 1903, 139, 1, 70, "TechNoteSection",ExpressionUUID->"9bdd3830-f606-4350-8509-faa426711816",
 CellID->205503201],
Cell[68387, 1906, 210, 4, 70, "TechNoteText",ExpressionUUID->"57057b07-b2ee-479b-b4f3-c5bf60d9c5a1",
 CellID->608169919],
Cell[68600, 1912, 605, 9, 70, "TechNoteText",ExpressionUUID->"88b153a9-2845-4ba6-abdd-fa05a8f77b50",
 CellID->1278444818],
Cell[69208, 1923, 475, 7, 70, "TechNoteText",ExpressionUUID->"8497d007-83e3-4b28-bbdf-1064f2a47153",
 CellID->1089412868],
Cell[69686, 1932, 227, 4, 70, "TechNoteText",ExpressionUUID->"c4e9a123-79fb-4c56-b953-4fd1a345fc91",
 CellID->123415854]
}, Open  ]],
Cell[69928, 1939, 772, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"5d254f30-d496-4d0c-acec-2e2ae0ed8dd3",
 CellID->13542037],
Cell[70703, 1960, 1484, 37, 70, "RelatedTutorialsSection",ExpressionUUID->"fd61d6ce-a247-4613-afec-d32ede61123a",
 CellID->2115232924],
Cell[72190, 1999, 2183, 60, 70, "TutorialRelatedLinksSection",ExpressionUUID->"595a6884-8656-4dc6-9f3c-d01efac61152",
 CellID->1275461230],
Cell[74376, 2061, 98, 1, 70, "FooterCell",ExpressionUUID->"3510e5d8-af64-465a-8f2d-a9848d5c00bf",
 CellID->495128256]
}
]
*)

(* End of internal cache information *)

