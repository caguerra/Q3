(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103676,       2723]
NotebookOptionsPosition[     87511,       2405]
NotebookOutlinePosition[     90542,       2477]
CellTagsIndexPosition[     90462,       2472]
WindowTitle->Universal Quantum Computation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "8bb93584-4bea-4363-b322-77040d4c9b56"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "11121d9b-42cb-4a79-8be5-b17e06220e59"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[Cell[BoxData[
     TagBox[
      ActionMenuBox[
       FrameBox[Cell[TextData[{
         "URL",
         " ",
         Cell[BoxData[
          GraphicsBox[
           {GrayLevel[0.66667], Thickness[0.13], 
            LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
           AspectRatio->1,
           AxesStyle->Large,
           FrameStyle->Large,
           ImageSize->20,
           PlotRange->{{-3, 4}, {-1, 1}},
           PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
          "0052b005-2ca2-4210-be3f-9bf993cc2042"]
        }],ExpressionUUID->"75d7155e-7af4-412a-87e6-447140758ce7"],
        StripOnInput->
         False], {"\<\"Q3/tutorial/UniversalQuantumComputation\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/UniversalQuantumComputation"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputation.html"], StandardForm]], "Input", 
              TextClipboardType -> "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$39773], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"] <> 
            "Q3/tutorial/UniversalQuantumComputation" <> ".html"], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"],
      MouseAppearanceTag["LinkHand"]]],
     LineSpacing->{1.4, 0},ExpressionUUID->
     "da8ffd77-ec1a-47df-8419-778ee70326b6"]], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "b580106d-d600-4b74-a58e-772e5606e544"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1,ExpressionUUID->"fae8dcf1-9075-4b5d-8601-12824e3e5c7b"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Universal Quantum Computation", "TechNoteTitle",ExpressionUUID->
      "39b59720-5164-4278-a6ad-5e097e1666e3"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"9310b942-af32-47dd-8c79-7c933edf349b"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "8ef10f7e-6988-418f-8be1-fc2d047034bb"]
    }],ExpressionUUID->"142cbff8-990e-40bb-8e4b-d2510508817a"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 13\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 13.2",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "4e35e77e-766f-4818-924e-d73ab7864f9d"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"c09f3b0d-3bd3-44cd-af23-a8997a76f85e"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Decomposition into Two-Level Unitary Matrices"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1255432361", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell[
      "Implementation of Two-Level Unitary Matrices: Gray Code Sequence"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1829642645", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Implementation of Two-Level Unitary Matrices: Idea"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#1012467270", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Universal Quantum Computation Theorem"], 
      "paclet:Q3/tutorial/UniversalQuantumComputation#205503201", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"f80da686-435e-4017-8983-\
eb7b9d508c80"],

Cell[TextData[{
 "See also Section 2.4 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "85698421-cc9f-428c-ad28-2772c2b0c839"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"cd7affe0-c3ae-4dfb-b7d0-0853cd25daac"],

Cell["\<\
In classical computation, it is known that a finite set of logic gates\
\[LongDash]typically including AND, OR, and NOT\[LongDash]is sufficient to \
calculate any binary function. The set is said to be universal for classical \
computation. Does there exist a universal set of elementary quantum logic \
gates for quantum computation that enables to implement any arbitrary quantum \
unitary operation?\
\>", "TechNoteText",
 CellID->1061332761,ExpressionUUID->"e9441fc1-19eb-4fa2-815b-0a3a5e2d354f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelDecomposition"]], 
      "paclet:Q3/ref/TwoLevelDecomposition", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TechNoteTableText",ExpressionUUID->
     "135bb918-ba21-4fe7-838d-bd76eb85a6b4"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TechNoteTableText",
     ExpressionUUID->"25bb8f78-fd82-4859-9547-723d1a3d8890"]},
   {
    TemplateBox[{
      Cell[
       TextData["FromTwoLevelU"]], "paclet:Q3/ref/FromTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrites a two-level unitary operator in terms of CNOT and controlled-unitary \
gates\
\>", "TechNoteTableText",ExpressionUUID->
     "4cc3010a-3c0f-410e-906e-c4913b208489"]}
  }]], "DefinitionBox",
 CellID->472512640,ExpressionUUID->"bf505026-fbf3-4341-a38e-2f9909c88685"],

Cell["\<\
Q3 functions related to the universal quantum computation theorem.\
\>", "TechNoteCaption",
 CellID->125413874,ExpressionUUID->"073b085c-b6ef-4f33-8a16-7c3c73b357b0"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"01567d04-7786-40d5-a776-0683eece03cb"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[351]:=",
 CellID->853967906,ExpressionUUID->"042305f2-c4d0-464c-97d1-9705cf5b0a03"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"a47f28bb-8975-4a68-8dd9-f569c7ea9f52"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[352]:=",
 CellID->403330096,ExpressionUUID->"1171620e-e7b1-4e30-a92f-ba5ec3b13382"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Two-Level Unitary Matrices", "TechNoteSection",
 CellID->1255432361,ExpressionUUID->"216b9cba-f125-4ad0-bd5a-7c2a179bf900"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[354]:=",
 CellID->1908124157,ExpressionUUID->"22bd2af8-fc78-4b48-891d-1bebe8dc7355"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[355]:=",
 CellID->1469406048,ExpressionUUID->"7a8338e9-52f8-4f23-badf-2b569858bb39"],

Cell[TextData[{
 "Suppose that we want to implement an arbitrary unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f8e7f712-66b2-469b-91c5-70766698cd2f"],
 " on an ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "02ad58a7-038d-459c-be46-69a53c6c9ffe"],
 "-qubit register. We start by decomposing ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "a979d1ca-e55c-48df-8fff-84ef8898cbdc"],
 " into a set of two-level unitary transformations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "k"], TraditionalForm]],ExpressionUUID->
  "6938f624-6af7-4afe-9385-e2d6bf225b87"],
 ", that is,"
}], "TechNoteText",
 CellID->2093541217,ExpressionUUID->"7d0272e9-d4c4-44e8-9ca0-8cd622168dba"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "8a7877e5-1915-4b75-9d69-c0b0212715c5"],
 " ."
}], "TechNoteText",
 CellID->330293091,ExpressionUUID->"b5472347-d9f5-483f-8acc-14e65d412e46"],

Cell[TextData[{
 "The procedure is detailed for arbitrary two-qubit unitary gates in ",
 ButtonBox["Two-Qubit Gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/TwoQubitGates#1476129218"],
 ". To summarize the procedure, first  remove the off-diagonal element ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"1", " ", "n"}]], TraditionalForm]],ExpressionUUID->
  "b5abc3bf-eff5-45bc-8fba-08dc50cd423a"],
 " at the top-right corner of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "5205c472-6b15-492a-a4a2-e887b4351c3b"],
 " by multiplying ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0f2cf070-f8f7-4bcf-b4e8-3168cadbb533"],
 " with a two-level unitary transformation ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["T", "1", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "f3d03b53-65df-4ed5-9bfb-11b5ed75f62c"],
 " on the right, and repeat it along the top row and then the next \
consecutive rows to zero all off-diagonal elements and to set every diagonal \
element to unity, so that"
}], "TechNoteText",
 CellID->2138236589,ExpressionUUID->"1ff97e2c-10fd-4fc8-a148-e0fde1293239"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubsuperscriptBox["T", "1", "\[Dagger]"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "L", "\[Dagger]"]}], "=", "I"}], 
   TraditionalForm]],ExpressionUUID->"fcd43c47-0396-448c-9a13-58933bcdfbe6"],
 " ."
}], "TechNoteText",
 CellID->1351002425,ExpressionUUID->"6ab4a457-53b3-4659-83a9-3e92d60e42c2"],

Cell[TextData[{
 "The decomposition of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1b14462f-3797-443a-af09-5482dcfd502c"],
 " is then given by"
}], "TechNoteText",
 CellID->953157244,ExpressionUUID->"47b754bb-2b5c-4ea0-989b-5f4fc0e4cbd6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "79700840-f66e-4aa9-af58-dcab2d51a8e9"],
 " ."
}], "TechNoteText",
 CellID->1633276935,ExpressionUUID->"bbe002bf-9215-4cf4-b07a-3f648f26be06"],

Cell["as desired.", "TechNoteText",
 CellID->1349470591,ExpressionUUID->"c11022fd-2311-4ba7-ad7d-20ebc508196e"],

Cell["\<\
For demonstration, consider a three-qubit system, and an arbitrary unitary \
operation on it.\
\>", "TechNoteText",
 CellID->1917505328,ExpressionUUID->"e70bf7f7-5d78-4c21-b127-b26b521aa4d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[357]:=",
 CellID->86358426,ExpressionUUID->"8ce8c59d-1507-41d9-baac-e6f28ef3edae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.48697839704442025`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.41856786271395663`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.36707279864820913`"}], "-", 
       RowBox[{"0.024067164834639027`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.009624091943156877`"}], "+", 
       RowBox[{"0.00614460294020885`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.12162434403388557`"}], "+", 
       RowBox[{"0.2266454125271249`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.051165611615700324`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5200967968593755`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35285177691506586`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1657599290345455`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.5326668418136715`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.12400725725559744`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.024319972479525734`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.20234150497635028`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.548457746948257`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.19990570117884243`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[360]//MatrixForm=",
 CellID->134219759,ExpressionUUID->"d6ac5fd8-97c1-421a-ae24-f6da92a51787"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[361]:=",
 CellID->1264688223,ExpressionUUID->"13470334-afa2-4a48-964f-d421664a66f9"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJzt3E8orXkcx/HTGTTpYKKESCMLsrCVukoWmiwUjYWFujfObSIjdxjqLijF
QpGk7l7+xEKSUKSTlU4UxUZyFrI4JVKSYuaMX1fTNPd5xvOox/OZ96uO/Pny
/Py8F885z3F+/PBrQzgYCAQ+fZ940/D+9+ru7vf9jT8kPvi589MvHzvbWn/q
/K3tY1t3xYfvEp88SdwuE7e/3v8DAAAAAAAAAAAAAAAAAABomZiYeOcTZ2dn
Xu8W3q6urq6ATxwfH3u9W3i7TMkdHR2RN6ywsJCSYc2UPDY25vVCrJSUlFAy
rFEyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAy
NFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyXlEkEvniER+VPDg46NUuxeNxr/fA
H8Lh8Ou+8NR/56OSPRSNRr3eA3+Ynp4Oe8RHJTc1NXm1S7FYzOs9gA0flcx5
MixQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQ
MjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQ
MjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQMjRQ
MjRQMjRQMjRQMjRQMjRQMjRQMjRQMjS4LPnq6iotLS0UCmVmZt7c3FhMVlVV
hZ6sra299CiUDFsuS97c3Aw8ycvLsxi7u7tLSUkxk0dHRy89CiXDlsuSh4eH
TZ/19fUWY7u7u2YsPT398fHxpUehZNhyWXJDQ4NJdGhoyGJscnLSjFVXVzs4
CiXDlsuS8/PzTaLr6+sWYy0tLWast7fXwVEoGbbclHxxcRH46vLy0mKytLTU
jC0sLDg4ECXDlpuSl5eXTZ/FxcUWY9fX18Fg0EzGYjEHB6Jk2HJT8ufPn02f
zc3NFmNbW1tmLDs729kiKRm23JRcW1trErX+9pGRETNWV1fnbJGUDFtuSs7M
zDSJ7uzsWIw1NjaasYGBAWeLpGTYclzyycmJ6TMpKen29tZisqCgwEyurq46
WyQlw5bjkmdnZ02f5eXlFmPn5+fPj2/E43Fni6Rk2HJccm9vr+mztbXVYmxm
ZsaMFRUVOV4kJftFOBwOeMRxyc9396ampizG2trazFjid3S8P6ZkD0WjUceL
/1/xY8llZWXmJ2xvb39r5v7+Picnx4w5uyZiUDJsOS65uLjY/JU3Nja+NTM3
N2dmQqHQ1dWV40VydgFbjkuuqakxlfb09PzrwP7+flZWlpnp7Ox0s0hKhi3H
JY+OjppKg8Hg/Pz8P766t7f3/GhzRkaGs4vUzygZthyXnDhbeH6gOPD0dM3x
8fHE6UR/f39lZWVycvLzl5aWllwukpJhy801vsPDw9zcXIs7Sunp6YuLi+4X
Scmw5fL5ydfX1319fRUVFampqX9vOHFG0d7efnp6+iqLpGTYeq3/rX54eDg6
OlpbW1tZWTk4OLC+fv1SlAxbvEoANFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAy
NFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAy
NFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAy
NFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAyNFAy
NFAyNFAyNFAyNFAyNFAyXtH09HTYIz4quampyatdisViXu+BPyT2KuARH5Xs
oWg06vUe+EMkEvniER+VPDg46NUuxeNxr/cANnxUMufJsEDJ0EDJ0EDJ0EDJ
0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ0EDJ
0EDJ0EDJ0EDJ0EDJ0GBK7ujoiLxhhYWFlAxrpmRfoGRYmJiYeOcTZ2dnXu8W
AAAAAAAAAAAAAAAAfO9PVRl0DQ==
    "], {{0, 110.}, {119., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{119., 110.},
  PlotRange->{{0, 119.}, {0, 110.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[362]=",
 CellID->1755806384,ExpressionUUID->"af72337c-4225-447f-bbb9-ecbec7ee88d9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}], ";"}]], "Input",
 CellLabel->"In[363]:=",
 CellID->104214177,ExpressionUUID->"d1419428-6351-4b9c-ac35-ad34f650df87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[364]:=",
 CellID->1514570623,ExpressionUUID->"f95be8e0-5df2-4ee6-80fd-403b636fe97f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"0.9115423502024782`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.41120620592026896`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}}}, {1, 1, 1, 1, 1, 1, Complex[1., 0.], Complex[
         0.9115423502024782, 0.41120620592026896`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.5882424324262984`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4818702096807101`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.19428464814681468`"}], "-", 
         RowBox[{"0.6196978434769067`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.19428464814681468`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6196978434769067`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5882424324262984`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4818702096807101`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 8, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}, {8}, {7}}}, {
        1, 1, 1, 1, 1, 1, Complex[0.5882424324262984, -0.4818702096807101], 
         Complex[-0.19428464814681468`, -0.6196978434769067], Complex[
         0.5882424324262984, 0.4818702096807101], Complex[
         0.19428464814681468`, -0.6196978434769067]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.40473037029300785`"}], "-", 
         RowBox[{"0.46227479257500065`", " ", "\[ImaginaryI]"}]}], 
        "0.788983740968231`", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"-", "0.788983740968231`"}], 
        RowBox[{
         RowBox[{"-", "0.40473037029300785`"}], "+", 
         RowBox[{"0.46227479257500065`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         7}, {6}, {8}}}, {
        1, 1, 1, 1, 1, Complex[-0.40473037029300785`, -0.46227479257500065`], 
         0.788983740968231, 
         Complex[-0.40473037029300785`, 
          0.46227479257500065`], -0.788983740968231, 1}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[364]=",
 CellID->253059588,ExpressionUUID->"992ab643-2ae1-4971-ae05-bb8bc1ba99a8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Two-Level Unitary Matrices: Idea", "TechNoteSection",
 CellID->1012467270,ExpressionUUID->"81fac2d6-b5f8-4453-9349-6648a3dc99e8"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[365]:=",
 CellID->1876122441,ExpressionUUID->"ad25c749-5a29-40bc-8cbe-a16d3f17ea91"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[366]:=",
 CellID->375590397,ExpressionUUID->"f3877a20-7652-4c99-9ccc-82a09fbe7ad8"],

Cell[TextData[{
 "Some two-level unitary transformations are themselves ",
 ButtonBox["multi-control unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/MultiControlUnitaryGates"],
 ", which can be implemented in terms of elementary gates. The most common \
example is"
}], "TechNoteText",
 CellID->1580628084,ExpressionUUID->"d247359d-3f2a-4ba3-b9a7-c6bda02ca5ae"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "ff01b149-03d4-4ddb-9d40-68d5ad3704f3"],
 " ."
}], "TechNoteText",
 CellID->1243494398,ExpressionUUID->"27e17d40-bc68-4ce4-9ef3-7468b52887b1"],

Cell["On three qubits, another example is", "TechNoteText",
 CellID->99494582,ExpressionUUID->"d8786581-ed76-4e9f-9f13-ee58408ef30d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]", "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "11"], "0", 
       SubscriptBox["V", "12"]},
      {"0", "0", "\[CenterEllipsis]", "0", "1", "0"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "21"], "0", 
       SubscriptBox["V", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "169caf16-7444-47b1-846e-218430bf2ce5"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "dab55c92-5556-46a3-9fc3-caea79e5953b"],
 ","
}], "TechNoteText",
 CellID->1463162308,ExpressionUUID->"9d99ec70-5521-4dc3-afdc-5bdfaeda35a7"],

Cell[TextData[{
 "where the gate with label \[OpenCurlyQuote]",
 StyleBox["V",
  FontSlant->"Italic"],
 " \[CloseCurlyQuote] on the second qubit indicates unitary operator"
}], "TechNoteText",
 CellID->533668759,ExpressionUUID->"65eb5b40-2af0-43d0-9147-6e414fe69f59"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"]},
       {
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "b26f7870-3bcf-45f6-864b-b9052bd43b23"],
 " ."
}], "TechNoteText",
 CellID->1479122641,ExpressionUUID->"cddd2759-4b0c-4d05-8f3a-7cf4824a4f64"],

Cell["\<\
Some other two-level unitary transformations are not multi-control unitary \
gates and yet simple variants. An example is\
\>", "TechNoteText",
 CellID->343529615,ExpressionUUID->"3f2ae36d-36f9-46b0-b54a-f5c45c80cc25"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "11"], "0", "0", "0", 
       SubscriptBox["V", "12"], "0"},
      {"0", "0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "21"], "0", "0", "0", 
       SubscriptBox["V", "22"], "0"},
      {"0", "0", "0", "0", "0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "45d3e868-d0a4-4f3c-913e-0d0f52b2dfdd"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{2, -2}, {2, -3}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "bd3ee466-6a1c-4860-b86e-bf381d9e7070"],
 ","
}], "TechNoteText",
 CellID->1266196169,ExpressionUUID->"24b63257-4c41-486b-9c5b-c48a95cd5961"],

Cell[TextData[{
 "In this case, unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "dbfea059-d389-46ad-9631-7ae2f97dd3ce"],
 " acts conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9 (rather than |1\:27e9), and the above two-level unitary transformation \
is a simple variant of multi-control unitary gate."
}], "TechNoteText",
 CellID->1543554260,ExpressionUUID->"452d027d-8dd1-4a7e-8c7e-ae869a4be58e"],

Cell["\<\
Through these examples, we see that any two-level unitary gate with the two \
non-trivial columns and rows attributed to two logical basis states differing \
only in one qubit is either a multi- control unitary gate or a simple variant \
of it. It is thus clear that such a two-level unitary transformation can be \
implemented in terms of elementary gates.\
\>", "TechNoteText",
 CellID->913992060,ExpressionUUID->"59291a23-72db-4b5a-adbc-fcfd83c25b89"],

Cell["\<\
Two-level unitary transformations that do not belong to the above class \
requires additional manipulation. The basic idea is to simultaneously \
exchange columns and rows so that the resulting matrix corresponds to a \
controlled-unitary gate such as the one seen above. Furthermore, a series of \
simultaneous exchanges of columns and rows bring any two-level unitary \
transformation to a multi-control unitary gate and that each exchange of \
columns of rows can be carried by the multi-control NOT gate or a simple \
variant of it.\
\>", "TechNoteText",
 CellID->514025429,ExpressionUUID->"20f7839a-9ded-47c6-a27f-8bbcbda8d6b0"],

Cell[TextData[{
 "For example, consider a two-level unitary transformation ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "6a674295-ab1a-4ab0-9169-7f53bc123629"],
 " on three qubits of the following form,"
}], "TechNoteText",
 CellID->2046156969,ExpressionUUID->"c26b9277-62af-46d5-acb6-a23d78881a89"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"], "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "18db046a-feca-4a2c-af98-eaf0ef2ddddf"],
 "  ."
}], "TechNoteText",
 CellID->2104538572,ExpressionUUID->"93c0f8c4-0a00-4bae-9625-56792d074599"],

Cell[TextData[{
 "The simultaneous exchange of the last two columns and rows brings the above \
two-level unitary matrix to the ",
 ButtonBox["form seen at the beginning",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/UniversalQuantumComputation#1463162308"],
 ". On the other hand, given that the last two columns (or rows) in the \
matrix representation correspond to the logical basis states |110\:27e9 and \
|111\:27e9, respectively, the simultaneous exchange of the last two columns \
and rows can be carried out by the multi-control NOT gate with the first two \
qubits as controls and the third qubit as target. Putting these two \
observations together, we find that"
}], "TechNoteText",
 CellID->1924113514,ExpressionUUID->"ae2606e0-8a4d-4809-b087-94035c33fb33"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "="}], TraditionalForm]],ExpressionUUID->
  "2d808003-c8b8-4513-a208-b35d74bd23ec"],
 " ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "6d820027-6b29-42a2-8aa5-de7e8d0af46e"],
 "."
}], "TechNoteText",
 CellID->1767073272,ExpressionUUID->"1969a6ce-bf19-4d3b-967d-00d531b0b658"],

Cell["For demonstration, consider one of the two above examples.", \
"TechNoteMathCaption",
 CellID->826895218,ExpressionUUID->"45bf697c-e084-4d18-8564-17b518d4d965"],

Cell[BoxData[{
 RowBox[{"<<", "Q3`"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]}], "Input",
 CellLabel->"In[368]:=",
 CellID->1940070093,ExpressionUUID->"7e47e730-04b5-4f7f-b298-2eec0d94894b"],

Cell[TextData[{
 "A two-level unitary matrix is represented in a compact way by ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "940f800c-0c48-497c-846c-234ac842c760"],
 "."
}], "TechNoteMathCaption",
 CellID->735486019,ExpressionUUID->"7b4e31cb-bb0c-4368-a585-38b584905deb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opT", "=", 
  RowBox[{"TwoLevelU", "[", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "7"}], "}"}], ",", "8"}], "]"}]}]], "Input",
 CellLabel->"In[370]:=",
 CellID->880800639,ExpressionUUID->"0140ebca-da01-494a-af11-90534879c162"],

Cell[BoxData[
 RowBox[{"TwoLevelU", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SqrtBox["3"], "2"], ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox[
        SqrtBox["3"], "2"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7"}], "}"}], ",", "8"}], "]"}]], "Output",
 CellLabel->"Out[370]=",
 CellID->1469834162,ExpressionUUID->"80eb53f2-2956-4308-b03d-ed273c3246ad"]
}, Open  ]],

Cell["\<\
Here is the conventional form of the above two-level unitary matrix.\
\>", "TechNoteMathCaption",
 CellID->1465223655,ExpressionUUID->"df19e3fa-a1fa-44e4-b240-c84201a269c8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", "opT"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[371]:=",
 CellID->2100283434,ExpressionUUID->"3f9792cf-4436-4656-8a06-9cb09b05ee94"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       7}, {6}, {8}}}, {
      1, 1, 1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1}}]]]]], "Output",
 CellLabel->"Out[372]//MatrixForm=",
 CellID->907244765,ExpressionUUID->"9a4427c8-a5d9-48a1-a179-90c6e3d94827"]
}, Open  ]],

Cell["\<\
We want to exchange the last two columns and rows simultaneously. This may be \
achieved by using the corresponding permutation matrix, which happens to be \
equivalent to the matrix representation of the CNOT gate in this case.\
\>", "TechNoteMathCaption",
 CellID->1663484699,ExpressionUUID->"e8e8a5fc-c9e0-49e1-b816-471d41703cb7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[373]:=",
 CellID->1579699414,ExpressionUUID->"69b26565-bb92-4e99-8b71-4a91b9caf158"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {2}, {1}, {3}, {4}, {
       4}, {3}, {5}, {6}, {6}, {5}, {7}, {8}, {8}, {7}}}, {1, 0, 1, 0, 1, 0, 
      1, 0, 1, 0, 1, 0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[374]//MatrixForm=",
 CellID->336847260,ExpressionUUID->"938ddf4c-12c2-44b0-8df0-10c503111406"]
}, Open  ]],

Cell["\<\
Here is the resulting matrix after the simultaneous exchange of the last two \
columns and rows.\
\>", "TechNoteMathCaption",
 CellID->591924919,ExpressionUUID->"66dc3638-7ee2-4b6a-b436-ca9809fd2262"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"P", ".", "mat", ".", 
    RowBox[{"Topple", "[", "P", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[375]:=",
 CellID->1560387399,ExpressionUUID->"5c87a42b-7ec7-4e37-b1e7-7a56608799be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 12, 16, 20, 24}, {{1}, {2}, {1}, {2}, {3}, {4}, {
       3}, {4}, {5}, {6}, {7}, {8}, {5}, {6}, {7}, {8}, {7}, {8}, {5}, {6}, {
       7}, {8}, {5}, {6}}}, {
      1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 
       0, Rational[-1, 2], 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 0, 
       Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[376]//MatrixForm=",
 CellID->72822929,ExpressionUUID->"5b5498b6-9d2c-45a9-8cbd-1e6e5b76b2ba"]
}, Open  ]],

Cell["\<\
The above matrix is nothing but a multi-control unitary operator with the \
first and third as the control qubits.\
\>", "TechNoteMathCaption",
 CellID->1391660944,ExpressionUUID->"f404862c-3ecc-467c-9f03-9f3068f8db52"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"Rotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "@", 
    RowBox[{"Matrix", "[", "op", "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[377]:=",
 CellID->1987632204,ExpressionUUID->"a95e8680-5fcc-4763-af6a-c9f67f0907e2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[378]//MatrixForm=",
 CellID->1203442392,ExpressionUUID->"9283db02-26ab-4994-bab6-270d3d921fa5"]
}, Open  ]],

Cell["\<\
In summary, the two-level unitary matrix is equivalent to the following \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->919087155,ExpressionUUID->"8a99211d-07eb-4098-9d9b-185f3c5f177d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[379]:=",
 CellID->1230259461,ExpressionUUID->"125353de-a41a-4d43-91de-fe943bbeda06"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
      1.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -1}, {3, -2}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, 
    Q3`Rotation[Rational[1, 3] Pi, 
     $CellContext`S[2, 2]]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 1}, {
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[379]=",
 CellID->1110281939,ExpressionUUID->"b3b620d6-12c3-4683-9623-ed1fac5cf20f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "-", "mat"}], "//", "Normal"}], "//",
    "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[380]:=",
 CellID->833756916,ExpressionUUID->"51e7ce8c-aa9c-4c85-9462-0f89a15d11ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[380]//MatrixForm=",
 CellID->1348629787,ExpressionUUID->"2989e9bb-9799-4a65-a082-5d953c1421cb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Two-Level Unitary Matrices: Gray Code Sequence\
\>", "TechNoteSection",
 CellID->1829642645,ExpressionUUID->"d3966235-9e7a-406b-87e3-4c3e4893967b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[381]:=",
 CellID->1037329788,ExpressionUUID->"430a4d1e-8029-495f-98c4-28ea4d0e907b"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[382]:=",
 CellID->1129500570,ExpressionUUID->"e38f669c-5639-4dc2-938a-a88a55669cf9"],

Cell[TextData[{
 "So far, the exchanges of columns and rows have been performed on an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " basis. An irritating issue is that every exchange of columns or rows \
cannot be carried out by a single multi-control NOT gate or a simple variant \
of it. Fortunately, however, one can achieve any desired exchange by \
combining a sequence of other exchanges that can be carried out by a \
multi-control NOT gate (or a simple variant)."
}], "TechNoteText",
 CellID->1649128141,ExpressionUUID->"95db1c42-43b7-4951-8d12-1ff43f78761b"],

Cell["\<\
For example, suppose that we want to exchange the sixth and seventh columns \
and rows. Noting that these columns and rows in the matrix representation \
correspond to logical basis states |101\:27e9 and |110\:27e9, it is clear \
that the exchange cannot be fulfilled by a single multi-control NOT gate. \
However, it can be achieved by first exchanging the sixth and eighth columns \
and rows (respectively corresponding to logical basis states |101\:27e9 and \
|111\:27e9) and then the eighth and seventh columns and rows (respectively \
corresponding to |111\:27e9 and |110\:27e9). The first exchange can be \
carried out by the multi-control NOT gate with the first and third qubit as \
controls and the second qubit as target while the second exchange can be \
implemented by the multi-control NOT gate with the first two qubits as \
controls and the third qubit as target.\
\>", "TechNoteText",
 CellID->1472717605,ExpressionUUID->"cc43d4d1-b46a-442d-b0b1-c55e50715416"],

Cell["\<\
The key point is that each exchange must be between a pair of columns (and \
rows) corresponding to logical basis states that differ in only one qubit. \
For this purpose, a systematic and efficient way is to use the Gray code \
sequence. In terms of classical bits, it is a sequence of bit strings where \
any two successive strings are different only in one bit. As an example, the \
Gray code sequence from |010\:27e9 to |101\:27e9 is given by\
\>", "TechNoteText",
 CellID->68271913,ExpressionUUID->"874ea511-f581-4666-926e-510561ff03ee"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"010"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"110"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"111"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"101"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "05cffff1-fbb7-4372-ac82-7383b39a884f"],
 "."
}], "TechNoteText",
 CellID->689774293,ExpressionUUID->"022137f3-0285-4afa-a98b-4bc603c35171"],

Cell["\<\
The first step in the above sequence corresponds to the NOT gate on the first \
qubit conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9, which is a simple variant of the multi-control NOT gate with the last \
two qubits as control and the first qubit as target\[LongDash]it just needs \
additional NOT gates on the third qubit before and after the multi-control \
NOT gate. The other steps can be carried out simply by multi-control NOT \
gates.\
\>", "TechNoteText",
 CellID->919815945,ExpressionUUID->"8ce47210-e247-4cf6-8387-977ac5b9b2d8"],

Cell["\<\
For demonstration, let us consider a particular two-level unitary matrix on a \
three-qubit system. We want to implement it in terms of elementary quantum \
logic gates.\
\>", "TechNoteMathCaption",
 CellID->274114911,ExpressionUUID->"a04e528a-dd9c-4841-87be-6bb18d489993"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[384]:=",
 CellID->408162463,ExpressionUUID->"84234ece-3178-487e-b893-5909bbd189f0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[385]//MatrixForm=",
 CellID->51043004,ExpressionUUID->"d8592c56-00b0-4bf5-8d1d-5ed9a5fe2369"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"2", "^", "$n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[386]:=",
 CellID->140937410,ExpressionUUID->"f62d9139-e60f-4d57-8671-8e198a23630b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellLabel->"Out[389]//MatrixForm=",
 CellID->494561840,ExpressionUUID->"12caacaf-7254-4971-af18-c4a78b67b4a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]], "Input",
 CellLabel->"In[390]:=",
 CellID->1202374181,ExpressionUUID->"7171e22f-1285-459e-8e8f-ed498777d481"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 4], 
     $CellContext`S[2, 5], 
     $CellContext`S[3, 5]]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 5], 
     $CellContext`S[2, 4], 
     $CellContext`S[3, 4]]]}]}]], "Output",
 CellLabel->"Out[390]=",
 CellID->485930985,ExpressionUUID->"90540dd8-3ed2-4267-aeae-ea79b548ff58"]
}, Open  ]],

Cell[TextData[{
 "Our implementation is based on the Gray code sequence. Notice the function ",
 StyleBox["Reverse", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->671324729,ExpressionUUID->"55a8a2ad-3891-4c20-8595-9446bd7fb11c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"FromTwoLevelU", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "SS"}], "]"}]}]}]], "Input",
 CellLabel->"In[391]:=",
 CellID->779608136,ExpressionUUID->"94672c23-4988-4909-92c9-5afe4b29450f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`S[1, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[3, 2]]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`S[1, Q3`$]], "}"}]}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[391]=",
 CellID->294737197,ExpressionUUID->"b053054a-e5ad-4d35-9bfd-53f3a0b42c18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Dot", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Matrix", "[", 
          RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
        RowBox[{"Elaborate", "/@", "gates"}]}]}], "]"}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[392]:=",
 CellID->1607904042,ExpressionUUID->"627b63a3-327d-4a28-ba7b-254fb55a2867"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[393]//MatrixForm=",
 CellID->680748862,ExpressionUUID->"4d3620ab-138f-4e79-802e-2677ec74752c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}]], "Input",
 CellLabel->"In[400]:=",
 CellID->1663700242,ExpressionUUID->"7e9f6425-0594-463f-84c5-3adcc67e2510"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
      2.6, -3.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 0}, Rational[1, 2] 3^Rational[1, 2] + 
    Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellLabel->"Out[400]=",
 CellID->1456122879,ExpressionUUID->"1650c322-26b7-41b1-a270-58c2258f0ce3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[401]:=",
 CellID->722239880,ExpressionUUID->"1e32bb0c-30a8-46f2-8fd3-4bfe96afa21b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[402]//MatrixForm=",
 CellID->1581493272,ExpressionUUID->"2a10c6ed-d6c6-4975-ae8a-5ed914fa2105"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<PortSize\>\"", "->", "0.2"}]}], "]"}]], "Input",
 CellLabel->"In[403]:=",
 CellID->1008687980,ExpressionUUID->"f9ae8a97-4fb1-4123-8216-4bb9af9558b4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
      1.6, -2.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -1}, {3, -2}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {1, 1}},
   ImageSize->158.4,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, 
    $CellContext`S[2, 1], "Label" -> "V"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 1}, {
     $CellContext`S[3, Q3`$]}], "PortSize" -> 0.2]]], "Output",
 CellLabel->"Out[403]=",
 CellID->1093868713,ExpressionUUID->"a299c950-1a14-4cc9-9254-88112032f013"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Universal Quantum Computation Theorem", "TechNoteSection",
 CellID->205503201,ExpressionUUID->"9bdd3830-f606-4350-8509-faa426711816"],

Cell["\<\
We have seen that one can implement any unitary operation combining the CNOT \
and single-qubit gates. \
\>", "TechNoteText",
 CellID->608169919,ExpressionUUID->"57057b07-b2ee-479b-b4f3-c5bf60d9c5a1"],

Cell["\<\
A subtle issue is that single-qubit gates form a continuum of unitary \
operators. It is impractical to implement them to an infinite accuracy. \
Fortunately, it is known that a discrete set of gates is sufficient to \
perform universal quantum computation. The Hadamard, quadrant phase, octant \
phase, and CNOT gates form a universal set of gates in the sense that an \
arbitrary gate on n qubits can be approximated to arbitrary accuracy using a \
quantum circuit composed of only such gates.\
\>", "TechNoteText",
 CellID->1278444818,ExpressionUUID->"88b153a9-2845-4ba6-abdd-fa05a8f77b50"],

Cell["\<\
The quadrant phase gate is equal to the square of the octant phase, and it \
may sound redundant to include the quadrant phase. In the context of the \
universal set of elementary gates alone, it is certainly true. However, the \
quadrant phase gate is typically included in the universal set because it is \
required to fault-tolerantly implement the octant phase.\
\>", "TechNoteText",
 CellID->1089412868,ExpressionUUID->"8497d007-83e3-4b28-bbdf-1064f2a47153"],

Cell["\<\
It is also interesting to note that the set remains universal if octant phase \
gates are replaced with Toffoli gates.\
\>", "TechNoteText",
 CellID->123415854,ExpressionUUID->"c4e9a123-79fb-4c56-b953-4fd1a345fc91"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "a6ee67ad-6025-4979-b67b-5b3d4e5b97d2"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"0093c66d-607d-4e4d-9cb8-\
47cf148c1b03"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Universal Quantum Computation: Demonstration",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/UniversalQuantumComputationDemonstration"]], 
         "RelatedTutorials",ExpressionUUID->
         "fac47d61-6998-4aa8-ae37-f5c6a8687952"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "035752a0-3475-4f29-bade-43aa61f3647b"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "689ebb85-8d10-48c1-9d79-2eb6eb0f2c7f"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"9e712cf9-e3dd-4a7e-b375-\
4dc6c3ab2bfc"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "b6950c4c-255d-4da8-be32-ed60de1afe13"]}]],ExpressionUUID->
         "1295440b-0509-48b2-bd4a-1d1343c03b6a"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "910dfb30-b2db-435b-8dad-51504572f382"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "16745e39-49d1-4663-8dad-a0116f07592a"]}]],ExpressionUUID->
         "a3f633e2-5b0b-42cd-b051-8eaac86b338c"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c0021d4a-9dc2-4ad3-a1bc-b6ff1a837731"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"551abec3-ebba-4f0a-bcd1-\
555e31309ebf"],

Cell[" ", "FooterCell",ExpressionUUID->"b1954e1a-119a-4c05-ba0d-37e9fef488a6"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2021", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2023, 2, 21, 2, 56, 40.281578}", 
    "history" -> {"13", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"universal quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tech Note", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "See also Section 2.4 of the Quantum Workbook (Springer, 2022). In \
classical computation, it is known that a finite set of logic \
gates\\[LongDash]typically including AND, OR, and NOT\\[LongDash]is \
sufficient to calculate any binary function. The set is said to be universal \
for classical computation. Does there exist a universal set of elementary \
quantum logic gates for quantum computation that enables to implement any \
arbitrary quantum unitary operation? Suppose that we want to implement an \
arbitrary unitary operation U on an n-qubit register. We start by decomposing \
U into a set of two-level unitary transformations T_k, that is,", 
    "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$39709, "title" -> 
    "Universal Quantum Computation", "titlemodifier" -> "", "windowtitle" -> 
    "Universal Quantum Computation", "type" -> "Tech Note", "uri" -> 
    "Q3/tutorial/UniversalQuantumComputation"}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.2 for Mac OS X ARM (64-bit) (January 30, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"e83af0bc-7880-443e-9da5-05bd416df886"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "RasterizedOutput"->{
  Cell[20822, 552, 2611, 49, 131, "Output",ExpressionUUID->"af72337c-4225-447f-bbb9-ecbec7ee88d9",
   CellTags->"RasterizedOutput",
   CellID->1755806384]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"RasterizedOutput", 90282, 2465}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[601, 21, 3526, 82, 57, "AnchorBarGrid",ExpressionUUID->"fae8dcf1-9075-4b5d-8601-12824e3e5c7b",
 CellID->1],
Cell[CellGroupData[{
Cell[4152, 107, 1406, 38, 61, "ObjectNameGrid",ExpressionUUID->"c09f3b0d-3bd3-44cd-af23-a8997a76f85e"],
Cell[5561, 147, 4584, 97, 109, "TechNoteJumpBox",ExpressionUUID->"f80da686-435e-4017-8983-eb7b9d508c80"],
Cell[10148, 246, 426, 13, 38, "TechNoteText",ExpressionUUID->"cd7affe0-c3ae-4dfb-b7d0-0853cd25daac",
 CellID->1308734266],
Cell[10577, 261, 510, 8, 84, "TechNoteText",ExpressionUUID->"e9441fc1-19eb-4fa2-815b-0a3a5e2d354f",
 CellID->1061332761],
Cell[11090, 271, 1223, 31, 141, "DefinitionBox",ExpressionUUID->"bf505026-fbf3-4341-a38e-2f9909c88685",
 CellID->472512640],
Cell[12316, 304, 176, 3, 31, "TechNoteCaption",ExpressionUUID->"073b085c-b6ef-4f33-8a16-7c3c73b357b0",
 CellID->125413874],
Cell[12495, 309, 288, 7, 36, "TechNoteMathCaption",ExpressionUUID->"01567d04-7786-40d5-a776-0683eece03cb",
 CellID->1428640008],
Cell[12786, 318, 147, 3, 29, "Input",ExpressionUUID->"042305f2-c4d0-464c-97d1-9705cf5b0a03",
 CellID->853967906],
Cell[12936, 323, 318, 6, 57, "TechNoteMathCaption",ExpressionUUID->"a47f28bb-8975-4a68-8dd9-f569c7ea9f52",
 CellID->1937193009],
Cell[13257, 331, 271, 6, 48, "Input",ExpressionUUID->"1171620e-e7b1-4e30-a92f-ba5ec3b13382",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[13565, 342, 148, 1, 81, "TechNoteSection",ExpressionUUID->"216b9cba-f125-4ad0-bd5a-7c2a179bf900",
 CellID->1255432361],
Cell[13716, 345, 148, 3, 29, "Input",ExpressionUUID->"22bd2af8-fc78-4b48-891d-1bebe8dc7355",
 CellID->1908124157],
Cell[13867, 350, 272, 6, 48, "Input",ExpressionUUID->"7a8338e9-52f8-4f23-badf-2b569858bb39",
 CellID->1469406048],
Cell[14142, 358, 762, 20, 60, "TechNoteText",ExpressionUUID->"7d0272e9-d4c4-44e8-9ca0-8cd622168dba",
 CellID->2093541217],
Cell[14907, 380, 381, 12, 70, "TechNoteText",ExpressionUUID->"b5472347-d9f5-483f-8acc-14e65d412e46",
 CellID->330293091],
Cell[15291, 394, 1195, 28, 70, "TechNoteText",ExpressionUUID->"1ff97e2c-10fd-4fc8-a148-e0fde1293239",
 CellID->2138236589],
Cell[16489, 424, 447, 12, 70, "TechNoteText",ExpressionUUID->"6ab4a457-53b3-4659-83a9-3e92d60e42c2",
 CellID->1351002425],
Cell[16939, 438, 265, 7, 70, "TechNoteText",ExpressionUUID->"47b754bb-2b5c-4ea0-989b-5f4fc0e4cbd6",
 CellID->953157244],
Cell[17207, 447, 382, 12, 70, "TechNoteText",ExpressionUUID->"bbe002bf-9215-4cf4-b07a-3f648f26be06",
 CellID->1633276935],
Cell[17592, 461, 111, 1, 70, "TechNoteText",ExpressionUUID->"c11022fd-2311-4ba7-ad7d-20ebc508196e",
 CellID->1349470591],
Cell[17706, 464, 201, 4, 70, "TechNoteText",ExpressionUUID->"e70bf7f7-5d78-4c21-b127-b26b521aa4d7",
 CellID->1917505328],
Cell[CellGroupData[{
Cell[17932, 472, 651, 20, 70, "Input",ExpressionUUID->"8ce8c59d-1507-41d9-baac-e6f28ef3edae",
 CellID->86358426],
Cell[18586, 494, 1758, 39, 82, "Output",ExpressionUUID->"d6ac5fd8-97c1-421a-ae24-f6da92a51787",
 CellID->134219759]
}, Open  ]],
Cell[CellGroupData[{
Cell[20381, 538, 438, 12, 70, "Input",ExpressionUUID->"13470334-afa2-4a48-964f-d421664a66f9",
 CellID->1264688223],
Cell[20822, 552, 2611, 49, 131, "Output",ExpressionUUID->"af72337c-4225-447f-bbb9-ecbec7ee88d9",
 CellTags->"RasterizedOutput",
 CellID->1755806384]
}, Open  ]],
Cell[23448, 604, 220, 5, 70, "Input",ExpressionUUID->"d1419428-6351-4b9c-ac35-ad34f650df87",
 CellID->104214177],
Cell[CellGroupData[{
Cell[23693, 613, 267, 7, 70, "Input",ExpressionUUID->"f95be8e0-5df2-4ee6-80fd-403b636fe97f",
 CellID->1514570623],
Cell[23963, 622, 4760, 110, 297, "Output",ExpressionUUID->"992ab643-2ae1-4971-ae05-bb8bc1ba99a8",
 CellID->253059588]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28772, 738, 153, 1, 70, "TechNoteSection",ExpressionUUID->"81fac2d6-b5f8-4453-9349-6648a3dc99e8",
 CellID->1012467270],
Cell[28928, 741, 148, 3, 70, "Input",ExpressionUUID->"ad25c749-5a29-40bc-8cbe-a16d3f17ea91",
 CellID->1876122441],
Cell[29079, 746, 271, 6, 70, "Input",ExpressionUUID->"f3877a20-7652-4c99-9ccc-82a09fbe7ad8",
 CellID->375590397],
Cell[29353, 754, 384, 8, 70, "TechNoteText",ExpressionUUID->"d247359d-3f2a-4ba3-b9a7-c6bda02ca5ae",
 CellID->1580628084],
Cell[29740, 764, 642, 19, 70, "TechNoteText",ExpressionUUID->"27e17d40-bc68-4ce4-9ef3-7468b52887b1",
 CellID->1243494398],
Cell[30385, 785, 133, 1, 70, "TechNoteText",ExpressionUUID->"d8786581-ed76-4e9f-9f13-ee58408ef30d",
 CellID->99494582],
Cell[30521, 788, 1532, 41, 70, "TechNoteText",ExpressionUUID->"9d99ec70-5521-4dc3-afdc-5bdfaeda35a7",
 CellID->1463162308],
Cell[32056, 831, 267, 6, 70, "TechNoteText",ExpressionUUID->"65eb5b40-2af0-43d0-9147-6e414fe69f59",
 CellID->533668759],
Cell[32326, 839, 459, 16, 70, "TechNoteText",ExpressionUUID->"cddd2759-4b0c-4d05-8f3a-7cf4824a4f64",
 CellID->1479122641],
Cell[32788, 857, 228, 4, 70, "TechNoteText",ExpressionUUID->"3f2ae36d-36f9-46b0-b54a-f5c45c80cc25",
 CellID->343529615],
Cell[33019, 863, 2166, 58, 70, "TechNoteText",ExpressionUUID->"24b63257-4c41-486b-9c5b-c48a95cd5961",
 CellID->1266196169],
Cell[35188, 923, 466, 9, 70, "TechNoteText",ExpressionUUID->"452d027d-8dd1-4a7e-8c7e-ae869a4be58e",
 CellID->1543554260],
Cell[35657, 934, 464, 7, 70, "TechNoteText",ExpressionUUID->"59291a23-72db-4b5a-adbc-fcfd83c25b89",
 CellID->913992060],
Cell[36124, 943, 643, 10, 70, "TechNoteText",ExpressionUUID->"20f7839a-9ded-47c6-a27f-8bbcbda8d6b0",
 CellID->514025429],
Cell[36770, 955, 324, 7, 70, "TechNoteText",ExpressionUUID->"c26b9277-62af-46d5-acb6-a23d78881a89",
 CellID->2046156969],
Cell[37097, 964, 814, 22, 70, "TechNoteText",ExpressionUUID->"93c0f8c4-0a00-4bae-9625-56792d074599",
 CellID->2104538572],
Cell[37914, 988, 780, 13, 70, "TechNoteText",ExpressionUUID->"ae2606e0-8a4d-4809-b087-94035c33fb33",
 CellID->1924113514],
Cell[38697, 1003, 1581, 37, 70, "TechNoteText",ExpressionUUID->"1969a6ce-bf19-4d3b-967d-00d531b0b658",
 CellID->1767073272],
Cell[40281, 1042, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"45bf697c-e084-4d18-8564-17b518d4d965",
 CellID->826895218],
Cell[40450, 1046, 234, 5, 70, "Input",ExpressionUUID->"7e47e730-04b5-4f7f-b298-2eec0d94894b",
 CellID->1940070093],
Cell[40687, 1053, 468, 12, 70, "TechNoteMathCaption",ExpressionUUID->"7b4e31cb-bb0c-4368-a585-38b584905deb",
 CellID->735486019],
Cell[CellGroupData[{
Cell[41180, 1069, 399, 11, 70, "Input",ExpressionUUID->"0140ebca-da01-494a-af11-90534879c162",
 CellID->880800639],
Cell[41582, 1082, 565, 19, 56, "Output",ExpressionUUID->"80eb53f2-2956-4308-b03d-ed273c3246ad",
 CellID->1469834162]
}, Open  ]],
Cell[42162, 1104, 183, 3, 70, "TechNoteMathCaption",ExpressionUUID->"df19e3fa-a1fa-44e4-b240-c84201a269c8",
 CellID->1465223655],
Cell[CellGroupData[{
Cell[42370, 1111, 265, 6, 70, "Input",ExpressionUUID->"3f9792cf-4436-4656-8a06-9cb09b05ee94",
 CellID->2100283434],
Cell[42638, 1119, 1362, 36, 188, "Output",ExpressionUUID->"9a4427c8-a5d9-48a1-a179-90c6e3d94827",
 CellID->907244765]
}, Open  ]],
Cell[44015, 1158, 343, 5, 70, "TechNoteMathCaption",ExpressionUUID->"e8e8a5fc-c9e0-49e1-b816-471d41703cb7",
 CellID->1663484699],
Cell[CellGroupData[{
Cell[44383, 1167, 442, 13, 70, "Input",ExpressionUUID->"69b26565-bb92-4e99-8b71-4a91b9caf158",
 CellID->1579699414],
Cell[44828, 1182, 1161, 28, 168, "Output",ExpressionUUID->"938ddf4c-12c2-44b0-8df0-10c503111406",
 CellID->336847260]
}, Open  ]],
Cell[46004, 1213, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"66dc3638-7ee2-4b6a-b436-ca9809fd2262",
 CellID->591924919],
Cell[CellGroupData[{
Cell[46239, 1221, 305, 7, 70, "Input",ExpressionUUID->"5c87a42b-7ec7-4e37-b1e7-7a56608799be",
 CellID->1560387399],
Cell[46547, 1230, 1492, 38, 188, "Output",ExpressionUUID->"5b5498b6-9d2c-45a9-8cbd-1e6e5b76b2ba",
 CellID->72822929]
}, Open  ]],
Cell[48054, 1271, 229, 4, 70, "TechNoteMathCaption",ExpressionUUID->"f404862c-3ecc-467c-9f03-9f3068f8db52",
 CellID->1391660944],
Cell[CellGroupData[{
Cell[48308, 1279, 637, 20, 70, "Input",ExpressionUUID->"a95e8680-5fcc-4763-af6a-c9f67f0907e2",
 CellID->1987632204],
Cell[48948, 1301, 1094, 30, 188, "Output",ExpressionUUID->"9283db02-26ab-4994-bab6-270d3d921fa5",
 CellID->1203442392]
}, Open  ]],
Cell[50057, 1334, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"8a99211d-07eb-4098-9d9b-185f3c5f177d",
 CellID->919087155],
Cell[CellGroupData[{
Cell[50286, 1342, 577, 17, 70, "Input",ExpressionUUID->"125353de-a41a-4d43-91de-fe943bbeda06",
 CellID->1230259461],
Cell[50866, 1361, 2125, 49, 131, "Output",ExpressionUUID->"b3b620d6-12c3-4683-9623-ed1fac5cf20f",
 CellID->1110281939]
}, Open  ]],
Cell[CellGroupData[{
Cell[53028, 1415, 288, 8, 70, "Input",ExpressionUUID->"51e7ce8c-aa9c-4c85-9462-0f89a15d11ce",
 CellID->833756916],
Cell[53319, 1425, 937, 23, 168, "Output",ExpressionUUID->"2989e9bb-9799-4a65-a082-5d953c1421cb",
 CellID->1348629787]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54305, 1454, 175, 3, 70, "TechNoteSection",ExpressionUUID->"d3966235-9e7a-406b-87e3-4c3e4893967b",
 CellID->1829642645],
Cell[54483, 1459, 148, 3, 70, "Input",ExpressionUUID->"430a4d1e-8029-495f-98c4-28ea4d0e907b",
 CellID->1037329788],
Cell[54634, 1464, 272, 6, 70, "Input",ExpressionUUID->"e38f669c-5639-4dc2-938a-a88a55669cf9",
 CellID->1129500570],
Cell[54909, 1472, 570, 10, 70, "TechNoteText",ExpressionUUID->"95db1c42-43b7-4951-8d12-1ff43f78761b",
 CellID->1649128141],
Cell[55482, 1484, 986, 14, 70, "TechNoteText",ExpressionUUID->"cc43d4d1-b46a-442d-b0b1-c55e50715416",
 CellID->1472717605],
Cell[56471, 1500, 552, 8, 70, "TechNoteText",ExpressionUUID->"874ea511-f581-4666-926e-510561ff03ee",
 CellID->68271913],
Cell[57026, 1510, 446, 16, 70, "TechNoteText",ExpressionUUID->"022137f3-0285-4afa-a98b-4bc603c35171",
 CellID->689774293],
Cell[57475, 1528, 580, 9, 70, "TechNoteText",ExpressionUUID->"8ce47210-e247-4cf6-8387-977ac5b9b2d8",
 CellID->919815945],
Cell[58058, 1539, 283, 5, 70, "TechNoteMathCaption",ExpressionUUID->"a04e528a-dd9c-4841-87be-6bb18d489993",
 CellID->274114911],
Cell[CellGroupData[{
Cell[58366, 1548, 323, 9, 70, "Input",ExpressionUUID->"84234ece-3178-487e-b893-5909bbd189f0",
 CellID->408162463],
Cell[58692, 1559, 944, 29, 86, "Output",ExpressionUUID->"d8592c56-00b0-4bf5-8d1d-5ed9a5fe2369",
 CellID->51043004]
}, Open  ]],
Cell[CellGroupData[{
Cell[59673, 1593, 650, 19, 70, "Input",ExpressionUUID->"f62d9139-e60f-4d57-8671-8e198a23630b",
 CellID->140937410],
Cell[60326, 1614, 1370, 37, 188, "Output",ExpressionUUID->"12caacaf-7254-4971-af18-c4a78b67b4a2",
 CellID->494561840]
}, Open  ]],
Cell[CellGroupData[{
Cell[61733, 1656, 218, 5, 70, "Input",ExpressionUUID->"7171e22f-1285-459e-8e8f-ed498777d481",
 CellID->1202374181],
Cell[61954, 1663, 5121, 149, 52, "Output",ExpressionUUID->"90540dd8-3ed2-4267-aeae-ea79b548ff58",
 CellID->485930985]
}, Open  ]],
Cell[67090, 1815, 233, 5, 70, "TechNoteMathCaption",ExpressionUUID->"55a8a2ad-3891-4c20-8595-9446bd7fb11c",
 CellID->671324729],
Cell[CellGroupData[{
Cell[67348, 1824, 312, 8, 70, "Input",ExpressionUUID->"94672c23-4988-4909-92c9-5afe4b29450f",
 CellID->779608136],
Cell[67663, 1834, 4402, 154, 102, "Output",ExpressionUUID->"b053054a-e5ad-4d35-9bfd-53f3a0b42c18",
 CellID->294737197]
}, Open  ]],
Cell[CellGroupData[{
Cell[72102, 1993, 533, 15, 70, "Input",ExpressionUUID->"627b63a3-327d-4a28-ba7b-254fb55a2867",
 CellID->1607904042],
Cell[72638, 2010, 1093, 30, 188, "Output",ExpressionUUID->"4d3620ab-138f-4e79-802e-2677ec74752c",
 CellID->680748862]
}, Open  ]],
Cell[CellGroupData[{
Cell[73768, 2045, 192, 4, 70, "Input",ExpressionUUID->"7e9f6425-0594-463f-84c5-3adcc67e2510",
 CellID->1663700242],
Cell[73963, 2051, 2981, 64, 131, "Output",ExpressionUUID->"1650c322-26b7-41b1-a270-58c2258f0ce3",
 CellID->1456122879]
}, Open  ]],
Cell[CellGroupData[{
Cell[76981, 2120, 338, 9, 70, "Input",ExpressionUUID->"1e32bb0c-30a8-46f2-8fd3-4bfe96afa21b",
 CellID->722239880],
Cell[77322, 2131, 1094, 30, 188, "Output",ExpressionUUID->"2a10c6ed-d6c6-4975-ae8a-5ed914fa2105",
 CellID->1581493272]
}, Open  ]],
Cell[CellGroupData[{
Cell[78453, 2166, 877, 25, 70, "Input",ExpressionUUID->"f9ae8a97-4fb1-4123-8216-4bb9af9558b4",
 CellID->1008687980],
Cell[79333, 2193, 2041, 47, 131, "Output",ExpressionUUID->"a299c950-1a14-4cc9-9254-88112032f013",
 CellID->1093868713]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81423, 2246, 139, 1, 70, "TechNoteSection",ExpressionUUID->"9bdd3830-f606-4350-8509-faa426711816",
 CellID->205503201],
Cell[81565, 2249, 210, 4, 70, "TechNoteText",ExpressionUUID->"57057b07-b2ee-479b-b4f3-c5bf60d9c5a1",
 CellID->608169919],
Cell[81778, 2255, 603, 9, 70, "TechNoteText",ExpressionUUID->"88b153a9-2845-4ba6-abdd-fa05a8f77b50",
 CellID->1278444818],
Cell[82384, 2266, 473, 7, 70, "TechNoteText",ExpressionUUID->"8497d007-83e3-4b28-bbdf-1064f2a47153",
 CellID->1089412868],
Cell[82860, 2275, 225, 4, 70, "TechNoteText",ExpressionUUID->"c4e9a123-79fb-4c56-b953-4fd1a345fc91",
 CellID->123415854]
}, Open  ]],
Cell[83100, 2282, 714, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"0093c66d-607d-4e4d-9cb8-47cf148c1b03"],
Cell[83817, 2302, 1442, 37, 70, "RelatedTutorialsSection",ExpressionUUID->"9e712cf9-e3dd-4a7e-b375-4dc6c3ab2bfc"],
Cell[85262, 2341, 2164, 60, 70, "TutorialRelatedLinksSection",ExpressionUUID->"551abec3-ebba-4f0a-bcd1-555e31309ebf"],
Cell[87429, 2403, 78, 0, 70, "FooterCell",ExpressionUUID->"b1954e1a-119a-4c05-ba0d-37e9fef488a6"]
}
]
*)

(* End of internal cache information *)

