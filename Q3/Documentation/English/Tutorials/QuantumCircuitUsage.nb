(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    628421,      18413]
NotebookOptionsPosition[    589965,      17637]
NotebookOutlinePosition[    592339,      17696]
CellTagsIndexPosition[    592296,      17693]
WindowTitle->QuantumCircuit Usage Examples
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TUTORIAL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "500a56c8-10db-419f-8659-5fa50e601bf6"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "cebdc94b-8968-4239-9900-8d1c816dbbe4"],
        Background->RGBColor[
         0.7450980392156863, 0.3254901960784314, 0.1411764705882353],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "b56e6524-0ad4-454f-8c12-e0ebbf6da6cc"]
         }],ExpressionUUID->"3f87af43-1648-40a4-a14c-3044dac47b47"],
         StripOnInput->
          False], {"\<\"Quantum Computation and Information: Overview\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumComputationAndInformationOverview"], \
"\<\"Quantum Computation: Overview\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumComputationOverview"], "\<\"Quantum \
Algorithms\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumAlgorithms"], "\<\"Quantum \
Error-Correction Codes\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumErrorCorrectionCodes"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumTeleportation"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum Fourier \
Transform: Semiclassical Implementation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumFourierTransformSemiclassical"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "55e4ecb4-8b25-49c7-8f9f-920ee23db0f2"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "e05a9bdb-539c-42e7-9722-96ba6bb176c7"]
         }],ExpressionUUID->"90b32ad4-d287-457b-82b6-48d36c712a11"],
         StripOnInput->False], {"\<\"Quantum Computation and Information\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/guide/QuantumComputationAndInformation"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "85e31644-30c5-4360-afaf-981f376dbe1a"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "259d15c9-be24-42d5-ba1b-c91dd64f387a"]
         }],ExpressionUUID->"4e022136-c1aa-4ba4-b3e4-42a79b91c009"],
         StripOnInput->False], {"\<\"CNOT\"\>":>Documentation`HelpLookup[
        "paclet:Q3/ref/CNOT"], "\<\"ControlledU\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/ControlledU"], "\<\"CZ\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/CZ"], "\<\"EulerRotation\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/EulerRotation"], "\<\"Phase\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/Phase"], "\<\"QuantumCircuit\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/QuantumCircuit"], "\<\"Rotation\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/Rotation"], "\<\"SWAP\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/SWAP"], "\<\"Toffoli\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/Toffoli"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "7a40fade-117f-43ec-a61d-7db61301a9e3"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d5cad857-271c-4501-b32a-88c984ade910"]
         }],ExpressionUUID->"61a46238-b6c7-45c0-a76e-12fc0d6bec79"],
         StripOnInput->False], {"\<\"Q3/tutorial/QuantumCircuitUsage\"\>":>
        None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell["Q3/tutorial/QuantumCircuitUsage"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        Delimiter, "\<\"Copy web URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell[
               BoxData[
                MakeBoxes[
                 Hyperlink[
                 "http://reference.wolfram.com/language/Q3/tutorial/\
QuantumCircuitUsage.html"], StandardForm]], "Input", TextClipboardType -> 
               "PlainText"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; 
         Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
          NotebookLocate[{
            URL[If[
               TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$304827], 
               "http://reference.wolfram.com/system-modeler/", 
               "http://reference.wolfram.com/language/"] <> 
             "Q3/tutorial/QuantumCircuitUsage" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "757a3d6f-de15-4b69-b9e8-ed69a8ce2afe"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "398642d2-cd9d-46dc-bfd9-24054955f584"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"08f1d732-161e-405a-ab6b-9d140407a013"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QuantumCircuit Usage Examples", "Title",ExpressionUUID->
      "a87f3731-d5d6-4cb0-81e5-fcf3782db760"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"58733284-e102-4862-a4d6-b7687045ec52"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "754082a5-2e2d-44ab-8766-4eb4711921fb"]
    }],ExpressionUUID->"12d1fd3a-91ba-4526-9cbc-c5e9cb25d6f7"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 13\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
        Right, Center}],
       AxesStyle->Large,
       FrameStyle->Large,
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "4fa7da45-f096-49a5-b8de-9f935cb00f67"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"010b10dd-7a84-4999-acd9-ad6197086bc0"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Elementary usage"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#1868432623", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples with Measurements"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#1921589536", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Grouping Circuit Elements With { }"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#188399535", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples with Controlled-U Gates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#580366830", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Automatic Conversion to Operator Expressions"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#729173090", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples with Arbitrary Controlled-U Gates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#87721419", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["More Complicated Gates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#2136908654", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Matrix on QuantumCircuit"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#462801707", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["With Inputs and Outputs"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#94058740", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Matrix on QuantumCircuit: With Measure"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#991141748", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Example with GraphStates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#175892259", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TutorialJumpBox",ExpressionUUID->"b0087466-3b87-448b-a4a5-\
d5c654191b8d"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f520676a-a240-4c66-9c11-983fdf929461"],
 " provides the graphical representation of the quantum circuits."
}], "Text",
 CellID->1534169418,ExpressionUUID->"9602d068-1fe2-473a-a422-f53619f1866b"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Graphical representation of quantum circuit", "TableText",ExpressionUUID->
     "1dc9dc9a-d639-4b1d-895a-fe8db5c3ba6c"]},
   {
    TemplateBox[{
      Cell[
       TextData["Phase"]], "paclet:Q3/ref/Phase", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Single-qubit phase gate (relative phase)", "TableText",ExpressionUUID->
     "34175092-e946-4ba9-bac3-8191e1f9fdce"]},
   {
    TemplateBox[{
      Cell[
       TextData["Rotation"]], "paclet:Q3/ref/Rotation", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Single-qubit rotation gate", "TableText",ExpressionUUID->
     "f2ee6318-799a-4520-b568-da3415a96c55"]},
   {
    TemplateBox[{
      Cell[
       TextData["EulerRotation"]], "paclet:Q3/ref/EulerRotation", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Single-qubit rotation gate specified by Euler angles", "TableText",
     ExpressionUUID->"f6c0ec78-cbe0-4704-afa0-75a1c64b57a7"]},
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Two-qubit controlled NOT gate", "TableText",ExpressionUUID->
     "8dce3d1b-beda-4bf2-ad08-044c713b7335"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:Q3/ref/CZ", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Two-qubit controlled Z gate", "TableText",ExpressionUUID->
     "bb7ddaa1-b053-43e7-a012-4b2e89587988"]},
   {
    TemplateBox[{
      Cell[
       TextData["SWAP"]], "paclet:Q3/ref/SWAP", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Two-qubit SWAP gate", "TableText",ExpressionUUID->
     "1ab45bbe-b778-4108-93ae-6e3da0b8d5b2"]},
   {
    TemplateBox[{
      Cell[
       TextData["Toffoli"]], "paclet:Q3/ref/Toffoli", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Three-qubit Toffoli gate", "TableText",ExpressionUUID->
     "9b08e567-198e-4884-9804-d0af83d7732b"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledU"]], "paclet:Q3/ref/ControlledU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Multi-qubit controlled-U gate", "TableText",ExpressionUUID->
     "664c3b35-ace5-4111-92dc-e43cecba60cc"]}
  }]], "DefinitionBox",
 CellID->2096742444,ExpressionUUID->"36a1a65f-f972-4904-bb2e-3bc83879888a"],

Cell["Frequently used quantum circuit elements.", "Caption",
 CellID->1891092685,ExpressionUUID->"7af12226-fca3-4243-a536-9da44513326a"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3 package",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " is loaded to use the demonstrations in this document."
}], "MathCaption",
 CellID->1428640008,ExpressionUUID->"d6f630f5-8586-4173-862a-1d1f3721c406"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"48a051d0-72b3-4fba-b484-48e37124b148"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "MathCaption",
 CellID->1937193009,ExpressionUUID->"e45f07e4-5de3-4c63-9849-f3c870b9290b"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->403330096,ExpressionUUID->"17a296a6-558b-4ae1-9180-fb0a1b764956"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elementary usage", "Section",
 CellID->1868432623,ExpressionUUID->"13de1dd1-88f4-44a7-8d53-d680f62dcf38"],

Cell["First load the application (the collection of packages).", "MathCaption",
 CellID->836781195,ExpressionUUID->"c60fb0a3-b3ed-4171-b14f-f9133f7dd6f7"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[205]:=",
 CellID->841456058,ExpressionUUID->"a5877577-04b7-4065-afe5-89c89d2cd216"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "cdd4f009-b8e3-46ca-bd61-179a8a9c814c"],
 " works for ",
 StyleBox["labeled",
  FontSlant->"Italic"],
 " qubits."
}], "MathCaption",
 CellID->1561112771,ExpressionUUID->"b1199825-0657-4881-8ff3-000daf354b58"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[206]:=",
 CellID->644371895,ExpressionUUID->"2cb154ae-075a-4491-bd38-b9a9d8aea2ff"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "16f3f72b-7063-4c04-a3ed-22607451ef77"],
 " is a collection of quantum logic gates. Usually, it is displayed in a \
graphical form."
}], "MathCaption",
 CellID->121218086,ExpressionUUID->"bdc5272d-86dc-4fab-b312-1f0742da0425"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[260]:=",
 CellID->359983136,ExpressionUUID->"2f25afb4-f718-4f2d-8eb0-c192c01d2b9f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[260]=",
 CellID->1362067654,ExpressionUUID->"f7140b4b-e29e-4bb8-9bd5-90e1c20559be"]
}, Open  ]],

Cell["\<\
Graphics directives can be used to change the style of labels of the quantum \
logic gates.\
\>", "MathCaption",
 CellID->648571534,ExpressionUUID->"46aaa030-5c36-402e-b406-7db694dd4fba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"Blue", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[261]:=",
 CellID->1027099769,ExpressionUUID->"fc755324-77e4-4aee-b90c-1e2b4ddc9631"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[261]=",
 CellID->2127595982,ExpressionUUID->"f8763e7c-915b-4ae0-ab3a-9dca4adcb4dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"Ket", "[", "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[262]:=",
 CellID->1753671624,ExpressionUUID->"bc30cf25-7366-4283-ba65-98cd0a2a972f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[262]=",
 CellID->1415989109,ExpressionUUID->"3a5caadc-536e-424b-a069-aa65dccbfe1b"]
}, Open  ]],

Cell["\<\
Here are all single-qubit gates displayed in a quantum circuit model.\
\>", "MathCaption",
 CellID->1179582981,ExpressionUUID->"cc7e3dbc-f969-46f3-9659-771d457d3ad0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"5", ",", "7"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"6", ",", "8"}], "]"}]}], "}"}], ",", "Null"}], "]"}]], "Input",\

 CellLabel->"In[263]:=",
 CellID->1498964105,ExpressionUUID->"5f40e815-6320-4bf4-94a3-7976ddd43780"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
    0, -4}, {2, -4}}, {{0, -5}, {2, -5}}, {{0, -6}, {2, -6}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"Y\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox["\<\"S\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
      StyleBox["\<\"T\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -6}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[263]=",
 CellID->960970743,ExpressionUUID->"46477ff8-ad81-4256-8053-554753851661"]
}, Open  ]],

Cell[TextData[{
 StyleBox["\[OpenCurlyDoubleQuote]Spacer\[CloseCurlyDoubleQuote]", "Input"],
 " is a special form to represent a time slice for no operation. It is useful \
for graphically extend certain time span. ",
 StyleBox["\[OpenCurlyDoubleQuote]Separator\[CloseCurlyDoubleQuote]", "Input"],
 " puts a vertical dotted line to indicate a particular time slice."
}], "MathCaption",
 CellID->1884848111,ExpressionUUID->"7467563a-5cd7-4698-9185-2c0e3a847116"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", "\"\<Separator\>\"", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[264]:=",
 CellID->1110924680,ExpressionUUID->"6cdb51b7-39b5-45fd-bcd1-fae70b511ccc"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[264]=",
 CellID->130678814,ExpressionUUID->"a6d049b0-de23-4559-97ea-abc8f9fe373e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[265]=",
 CellID->1590539664,ExpressionUUID->"37711f86-a393-4b5a-8ff7-0d308dffc48b"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{2, -2.5}, {
       2, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[266]=",
 CellID->323694992,ExpressionUUID->"11851643-c64d-412e-91d0-b9e5ce4ffe04"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpressionFor"]], "paclet:Q3/ref/ExpressionFor", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0b9f2610-729a-46c5-adb8-d7b775955117"],
 " or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Elaborate"]], "paclet:Q3/ref/Elaborate", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0a2bd759-9dd8-42f0-bff4-794bc5dc2a87"],
 " converts ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "89480c5d-97ee-44c1-abd5-3ae64ae46389"],
 " to usual operator expressions in terms of the Pauli operators."
}], "MathCaption",
 CellID->1581832416,ExpressionUUID->"44165402-0818-4498-8dde-7dd1be71fa23"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Blue", ",", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExpressionFor", "[", "qc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "qc", "]"}]}], "Input",
 CellLabel->"In[267]:=",
 CellID->9865852,ExpressionUUID->"8447a023-8a48-4510-a52e-686c1fa6f97a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], 
   {RGBColor[0, 0, 1], LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[267]=",
 CellID->1943608933,ExpressionUUID->"667b1686-eefe-4333-a34b-40555448ce5c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[268]=",
 CellID->861582414,ExpressionUUID->"592dc5e0-fac2-4af7-94bb-6ddf325a5f23"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[269]=",
 CellID->133400377,ExpressionUUID->"08f69b36-3cb3-4241-8564-1f8df8ae928e"]
}, Open  ]],

Cell["Here is another example.", "MathCaption",
 CellID->1800711653,ExpressionUUID->"e61ac71c-fc0b-47b4-8174-d58fd2b69a56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"Blue", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "\"\<Separator\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", " ", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[270]:=",
 CellID->599552766,ExpressionUUID->"22cfa0d1-160f-4240-b293-4b7c081f8b0b"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}}], 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-7, 2]}, {2, Rational[-1, 2]}}, {{
        2, -3.5}, {2, -0.5}}]]}, 
    {RGBColor[1, 0, 0], {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
       StyleBox["\<\"Y\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3, -3}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
    {RGBColor[0, 0, 1], LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[270]=",
 CellID->1360106759,ExpressionUUID->"fb625911-2827-463c-989d-b3b3d39f63e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], "**", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], "**", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "//", "Garner"}]}]], "Input",
 CellLabel->"In[271]:=",
 CellID->1534929666,ExpressionUUID->"c9510582-772f-4dcc-b1d4-2cab326d9f73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["\[ImaginaryI]", 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[271]=",
 CellID->2024611653,ExpressionUUID->"3832991a-837e-43ac-b435-5e9d1a0cf114"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "expr"}], "//", "Garner"}]}], "Input",
 CellLabel->"In[272]:=",
 CellID->474527143,ExpressionUUID->"2da94d43-d4a8-4b2c-afcc-56b8a6cc7c36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["\[ImaginaryI]", 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[272]=",
 CellID->432278511,ExpressionUUID->"96e791d1-d065-4c41-a57a-3c4d0624a9dd"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[273]=",
 CellID->367756576,ExpressionUUID->"bbdfdf0f-5551-4c53-8ac6-0515cc2c7ae9"]
}, Open  ]],

Cell["You can extend existing QuantumCircuit in a simple manner.", \
"MathCaption",
 CellID->1618406437,ExpressionUUID->"3477fbe9-6e1a-4edf-acc9-65ae61788b1c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"qc", ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[274]:=",
 CellID->529113757,ExpressionUUID->"48a6acd7-5afb-48bb-a1e6-4621c541ac36"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[274]=",
 CellID->643340808,ExpressionUUID->"46336ae1-0964-4e1d-b7a0-26b9d40ff432"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[275]=",
 CellID->48797411,ExpressionUUID->"c5a9b9b2-1109-408c-8cf9-af7d6357e386"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"S", "[", "nn", "]"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"nn", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{"S", "[", "nn", "]"}], "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[280]:=",
 CellID->1274883332,ExpressionUUID->"dcfcf789-7f33-49ce-ac28-b3eab9cd73b2"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[281]=",
 CellID->310436422,ExpressionUUID->"059bb615-d07b-4b13-9bcd-359f17670118"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[282]:=",
 CellID->81528505,ExpressionUUID->"6fee91c6-c567-47f4-86db-1a38f41e897b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[283]=",
 CellID->2020907422,ExpressionUUID->"0d84f759-0c75-4b49-9eba-c300360fe946"]
}, Open  ]],

Cell["You can give custom labels.", "MathCaption",
 CellID->468836632,ExpressionUUID->"367b75e9-bb01-44a8-906f-40c87518a7ed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{
      "\"\<Label\>\"", "\[Rule]", "\"\<|m\[RightAngleBracket]\>\""}]}], "}"}],
     ",", 
    RowBox[{"S", "[", 
     RowBox[{"nn", ",", "6"}], "]"}], ",", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{"S", "[", "nn", "]"}], "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Elaborate", "@", "qc"}]}], ";", 
  RowBox[{"LogicalForm", "@", "expr"}]}]}], "Input",
 CellLabel->"In[284]:=",
 CellID->619773181,ExpressionUUID->"e800c3da-d3e9-4c3f-bd2c-c282f59cf196"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox["\<\"|m\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|m\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|m\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[284]=",
 CellID->823083979,ExpressionUUID->"5eabdcfb-0f05-4ec1-bd16-17f7a498bb03"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[285]=",
 CellID->1630264726,ExpressionUUID->"9fe742cc-d1d9-4106-9ce7-23ccad260f3f"]
}, Open  ]],

Cell["\<\
If the custom label is a list, then its elements are rotated.\
\>", "MathCaption",
 CellID->251997855,ExpressionUUID->"1220155c-c48f-44e5-b3d3-aa705fc7a5c6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"S", "[", "nn", "]"}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<|\!\(\*SubscriptBox[\(m\), \(0\)]\)\[RightAngleBracket]\>\"", 
         ",", "\"\<|\!\(\*SubscriptBox[\(m\), \
\(1\)]\)\[RightAngleBracket]\>\""}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"nn", ",", "6"}], "]"}], ",", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{"S", "[", "nn", "]"}], "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Elaborate", "@", "qc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "@", "expr"}]}], "Input",
 CellLabel->"In[292]:=",
 CellID->490197101,ExpressionUUID->"63ab1b3c-d78c-4dc4-875d-fefcbdf9ce02"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(m\\), \\(0\\)]\\)\
\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)\
\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(m\\), \\(0\\)]\\)\
\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[292]=",
 CellID->1411003542,ExpressionUUID->"dd5512ba-0fce-4f6a-81be-2e26ae01156d"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[294]=",
 CellID->74616573,ExpressionUUID->"6b235cff-0102-4495-b04b-a2ed0cbe54aa"]
}, Open  ]],

Cell["Controlled-unitary gates", "MathCaption",
 CellID->1043674246,ExpressionUUID->"38b7ef06-48dd-4e1b-bf90-0282b5a0f9bd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "3"}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<R\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[295]:=",
 CellID->386623826,ExpressionUUID->"85c8a557-cdcb-40f6-b3b1-0bd03e26086a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[295]=",
 CellID->1835551336,ExpressionUUID->"db5052e8-df66-4ac2-acac-9d1d294dfe3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[296]=",
 CellID->1508714997,ExpressionUUID->"e5953693-758c-443c-b88b-e9bd2812efbe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        FractionBox["3", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      RowBox[{
       RowBox[{
        FractionBox["3", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SqrtBox["3"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          SqrtBox["3"]}], ")"}]}]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{5}, {6}, {6}, {5}, {7}, {8}, {
       8}, {7}, {1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {
      Rational[1, 4] (2 - 3^Rational[1, 2]) + 
       Rational[1, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), 0, 
       Rational[1, 4] (2 - 3^Rational[1, 2]) + 
       Rational[1, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), 0, 
       Rational[3, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), Rational[-1, 2], 
       Rational[3, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), Rational[1, 2], 
       Rational[1, 4] (2 - 3^Rational[1, 2]) + 
       Rational[1, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), 0, 
       Rational[1, 4] (2 - 3^Rational[1, 2]) + 
       Rational[1, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), 0, 
       Rational[1, 4] (2 - 3^Rational[1, 2]) + 
       Rational[1, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), 0, 
       Rational[1, 4] (2 - 3^Rational[1, 2]) + 
       Rational[1, 8] (-2 + 3^Rational[1, 2]) + 
       Rational[1, 8] (6 + 3^Rational[1, 2]), 0}}]]]]], "Output",
 CellLabel->"Out[298]//MatrixForm=",
 CellID->1633534450,ExpressionUUID->"cd0d719c-4504-433c-b754-3de4d980c6d3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grouping Circuit Elements With { }", "Section",
 CellID->188399535,ExpressionUUID->"2a4ef891-fa4e-468a-828b-97388e892f5e"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[299]:=",
 CellID->284388437,ExpressionUUID->"e215ca84-3b82-4f6c-8f92-6b82105c7f1d"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[300]:=",
 CellID->1565346084,ExpressionUUID->"2cd70ce4-ee25-4c7f-992e-5428c29af9c8"],

Cell[TextData[{
 "In ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "45b05fc8-e9f5-4406-b68b-4b1cff7a3185"],
 ", ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["List"]], "paclet:ref/List"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "42f7f556-87ca-471a-a152-c91e59c13765"],
 " (",
 Cell[BoxData[
  RowBox[{"{", 
   StyleBox["\[Ellipsis]", "TR"], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "aafda5b9-ab96-4409-a71e-63e797ced4e5"],
 ") can carry  two special meanings. First, it can put different quantum \
gates at the same time slice. Second, it can give options to particular \
quantum circuit elements."
}], "MathCaption",
 CellID->92524695,ExpressionUUID->"6713f97b-f8e0-4402-99f4-71e683ae786f"],

Cell[CellGroupData[{

Cell["\<\
Putting different quantum logic gates at the same time slice.\
\>", "Subsection",
 CellID->2096958038,ExpressionUUID->"57c2b702-44db-4a1c-beda-b5c7c8de6af5"],

Cell["\<\
Here all quantum logic gates are displayed at different time slices (along \
the horizontal direction).\
\>", "MathCaption",
 CellID->1219613749,ExpressionUUID->"56f2873b-feb0-41c0-a2d9-063055e50c10"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "6"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "6"}], "]"}], ",", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[302]:=",
 CellID->316868828,ExpressionUUID->"ad739872-f043-4114-a22c-d0b396269bdd"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    LineBox[{{{2.91, -1.09}, {3.09, -0.91}}, {{2.91, -0.91}, {3.09, -1.09}}}],
     LineBox[{{{2.91, -2.09}, {3.09, -1.91}}, {{2.91, -1.91}, {
     3.09, -2.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[302]=",
 CellID->2135567985,ExpressionUUID->"f7c4840f-f068-4265-946c-17adbfbe4c3a"]
}, Open  ]],

Cell["\<\
Here the first two gates are displayed at the same time slice while others \
are separated long the time (horizontal) direction.\
\>", "MathCaption",
 CellID->1646341244,ExpressionUUID->"c0bd4c15-1637-40fa-b255-99cd0f757114"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}]}], "}"}], ",", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[303]:=",
 CellID->1877979960,ExpressionUUID->"5a122140-b02c-4578-96a0-2bf27a86f635"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], 
    LineBox[{{{1.91, -1.09}, {2.09, -0.91}}, {{1.91, -0.91}, {2.09, -1.09}}}],
     LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {
     2.09, -2.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[303]=",
 CellID->1864730974,ExpressionUUID->"2c13256a-3810-48f9-bfe1-eb49720904ca"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Giving options to particular quantum logic gates or input/output states\
\>", "Subsection",
 CellID->1162686366,ExpressionUUID->"8761acad-4459-44e3-9c91-90ca60ab9b7a"],

Cell["This is one of the simplest cases.", "MathCaption",
 CellID->1316049309,ExpressionUUID->"a031824a-36b6-41c6-a018-46ab2052107e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[304]:=",
 CellID->1906655910,ExpressionUUID->"e27432ed-92d2-4cbd-9dfd-2f76acdf2f2a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[304]=",
 CellID->464626315,ExpressionUUID->"b3205e7c-2de1-4db1-88f3-0ea1d7df80ec"]
}, Open  ]],

Cell["\<\
In this example, the second and only the second gate is shown in red color.\
\>", "MathCaption",
 CellID->325334843,ExpressionUUID->"4c49afc5-0566-4a1a-98cb-8aa893a7b42b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"Red", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[305]:=",
 CellID->409341039,ExpressionUUID->"930cb2e2-7e35-45cd-abc9-af063f98af9f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {RGBColor[1, 0, 0], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[305]=",
 CellID->1796605450,ExpressionUUID->"eb667fac-3748-4758-a97b-a11a2be72848"]
}, Open  ]],

Cell["\<\
Unlike the example above, here all gates are displayed in red.\
\>", "MathCaption",
 CellID->1860334053,ExpressionUUID->"6f077d63-e705-48e7-a861-81d03a77daee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"Red", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[306]:=",
 CellID->1420012098,ExpressionUUID->"5ac9df08-1957-4830-8585-466b9cc1e3fb"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], 
   {RGBColor[1, 0, 0], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[306]=",
 CellID->1259740157,ExpressionUUID->"2f5b4f42-3748-4b95-8f0c-484518b58399"]
}, Open  ]],

Cell["\<\
Here the second gate takes an option and it is labeled with \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] (not the default label \
\[OpenCurlyDoubleQuote]Z\[CloseCurlyDoubleQuote]).\
\>", "MathCaption",
 CellID->1089755652,ExpressionUUID->"ec179609-e4e0-48ea-b642-92dd4713b348"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[307]:=",
 CellID->1782701548,ExpressionUUID->"a49ba6b4-f873-430e-b787-346bc5f333c1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[307]=",
 CellID->659066431,ExpressionUUID->"f31ec59c-96b5-49b6-9e68-99d55dd6f4fa"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Automatic Conversion to Operator Expressions", "Section",
 CellID->729173090,ExpressionUUID->"d94ab3cd-1b62-4e93-9739-d8f6ff9282d3"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[308]:=",
 CellID->2103953529,ExpressionUUID->"253fea1e-6654-4895-9f34-dae0a7c7fdf4"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[309]:=",
 CellID->1154931458,ExpressionUUID->"77ea4e26-f0d1-4981-aa6d-a60ced4ca375"],

Cell["Consider an example of the entangler circuit model.", "MathCaption",
 CellID->898557820,ExpressionUUID->"c6eba4d6-7470-40d1-bd37-586988ed954e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "6"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc1", ",", "qc2"}], "]"}]}]}], "Input",
 CellLabel->"In[310]:=",
 CellID->1173319708,ExpressionUUID->"fec90679-a206-473f-a180-cab500e95891"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[310]=",
 CellID->706284785,ExpressionUUID->"cabca94e-27cd-437c-a092-3848b20a5513"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[311]=",
 CellID->1386264526,ExpressionUUID->"41a9d7f6-468c-4c73-99cd-7958f7850e05"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[312]=",
 CellID->897802179,ExpressionUUID->"15f68244-4079-453f-a2dc-6bcb30ceeff2"]
}, Open  ]],

Cell["\<\
This is the usual way to convert quantum circuit models into operator \
expressions.\
\>", "MathCaption",
 CellID->1246009635,ExpressionUUID->"b3ad9356-38df-430f-9961-6ed6d0af0a5a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op1", "=", 
  RowBox[{"Elaborate", "[", "qc1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op2", "=", 
  RowBox[{"Elaborate", "[", "qc2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[313]:=",
 CellID->417857018,ExpressionUUID->"dc7cfa65-3b15-4d47-9a9a-b6901b6bdd8b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[313]=",
 CellID->1763991760,ExpressionUUID->"b79949cd-3073-4624-9fe1-d9a94a7c3472"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[314]=",
 CellID->1397763485,ExpressionUUID->"0a0467f1-8ec6-40dd-81f0-abd1149d9829"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[315]=",
 CellID->887277862,ExpressionUUID->"af39c773-3fc1-4d12-86f4-c31934661a2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "-", 
  RowBox[{"op2", "**", "op1"}]}]], "Input",
 CellLabel->"In[316]:=",
 CellID->1403589449,ExpressionUUID->"7290f97f-f84f-4fae-a095-234c0c193862"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[316]=",
 CellID->1491791819,ExpressionUUID->"5307b98b-6049-4694-ab14-38f0d8c71cdb"]
}, Open  ]],

Cell["\<\
The above can also be achieve directly regarding the quantum circuit models \
as operators.\
\>", "MathCaption",
 CellID->1276498133,ExpressionUUID->"49ffead8-818f-457b-a662-11347d9a23ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"qc2", "**", "qc1", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Notice", " ", "the", " ", 
     RowBox[{"order", "."}]}], " ", "*)"}]}]}]], "Input",
 CellLabel->"In[317]:=",
 CellID->438798576,ExpressionUUID->"711b5acd-a1d1-41a6-a56f-772660cc8d0b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[317]=",
 CellID->435789613,ExpressionUUID->"d9580b99-3f23-49b8-8d40-b0c99683d85e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "-", "new"}]], "Input",
 CellLabel->"In[318]:=",
 CellID->1266974318,ExpressionUUID->"575585e4-4614-487d-9011-dc858e65c780"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[318]=",
 CellID->452965174,ExpressionUUID->"1cc890df-7b6f-451f-b696-8221130f6dc9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["More Complicated Gates", "Section",
 CellID->2136908654,ExpressionUUID->"76c6ebfa-38e5-408d-9328-020c68b88295"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[319]:=",
 CellID->335909506,ExpressionUUID->"64e35b69-b2ce-41e4-9c55-916130a0cf6e"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[320]:=",
 CellID->210689171,ExpressionUUID->"ff52af69-9040-4dd9-8a99-554fa26f089d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat1", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat2", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mat2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat1", "-", "mat2"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[321]:=",
 CellID->2079061645,ExpressionUUID->"72c3a911-9ea6-43a6-a083-b918e0fab9f7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {LineBox[{{3, -2}, {3, -3}}], 
    DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[321]=",
 CellID->1156507739,ExpressionUUID->"23948b38-c7d3-4ef2-8189-24a9b513d939"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{"4", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[322]=",
 CellID->551080376,ExpressionUUID->"99685c03-7ada-452a-afa5-7dfa6a7ecd5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.004111`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[323]=",
 CellID->2058393568,ExpressionUUID->"96444293-d3e6-46d7-ab4a-5ecd97603bdb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.003925`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[324]=",
 CellID->1606627853,ExpressionUUID->"63fa157c-972c-42c6-8396-34494af5c837"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {5}, {3}, {7}, {2}, {6}, {
       4}, {8}, {2}, {6}, {4}, {8}, {1}, {5}, {3}, {7}, {3}, {7}, {1}, {5}, {
       4}, {8}, {2}, {6}, {4}, {8}, {2}, {6}, {3}, {7}, {1}, {5}, {5}, {1}, {
       7}, {3}, {6}, {2}, {8}, {4}, {6}, {2}, {8}, {4}, {5}, {1}, {7}, {3}, {
       7}, {3}, {5}, {1}, {8}, {4}, {6}, {2}, {8}, {4}, {6}, {2}, {7}, {3}, {
       5}, {1}}}, {
      Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[325]//MatrixForm=",
 CellID->134947993,ExpressionUUID->"7948dab2-77be-4171-af91-5756c1169678"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {5}, {3}, {7}, {2}, {6}, {
       4}, {8}, {2}, {6}, {4}, {8}, {1}, {5}, {3}, {7}, {3}, {7}, {1}, {5}, {
       4}, {8}, {2}, {6}, {4}, {8}, {2}, {6}, {3}, {7}, {1}, {5}, {5}, {1}, {
       7}, {3}, {6}, {2}, {8}, {4}, {6}, {2}, {8}, {4}, {5}, {1}, {7}, {3}, {
       7}, {3}, {5}, {1}, {8}, {4}, {6}, {2}, {8}, {4}, {6}, {2}, {7}, {3}, {
       5}, {1}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[326]//MatrixForm=",
 CellID->328187119,ExpressionUUID->"45642c8a-8c89-4189-a2e9-587b642be543"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "Red", ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[327]:=",
 CellID->408544247,ExpressionUUID->"501e0497-9e58-4de4-b852-13c904bf2c97"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, 
   {RGBColor[1, 0, 0], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[327]=",
 CellID->1597489102,ExpressionUUID->"a9cf6964-4bd8-465a-9f42-c6d2c8f9eb0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], "**", 
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "//", 
   "Elaborate"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "expr"}], "//", "Garner"}]}], "Input",
 CellLabel->"In[328]:=",
 CellID->1307807621,ExpressionUUID->"a8820569-b013-4541-a8eb-900c4e472b19"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[328]=",
 CellID->755392711,ExpressionUUID->"26fa73b5-1b25-4974-abe6-d01c2c50194d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[329]=",
 CellID->2109456360,ExpressionUUID->"a1591625-86b5-45ca-86d6-d39e8ecfae09"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[330]=",
 CellID->825514197,ExpressionUUID->"2a48ed34-18e2-4714-92b2-b445280a9451"]
}, Open  ]],

Cell["\<\
This is still another way to convert the quantum circuit to an operator \
expression.\
\>", "MathCaption",
 CellID->319766691,ExpressionUUID->"1360eadd-7686-4a8f-b9d3-146a04d7c56b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressionFor", "[", "qc", "]"}]], "Input",
 CellLabel->"In[331]:=",
 CellID->1718025104,ExpressionUUID->"b2e59a80-658a-4758-8580-ac2037977de6"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[331]=",
 CellID->2124284409,ExpressionUUID->"36152c93-95e9-448a-a8b4-48b145aa5f45"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With Inputs and Outputs", "Section",
 CellID->94058740,ExpressionUUID->"0e21c495-97b3-4b82-8414-72cf53bab05b"],

Cell["You can specifies input and output states.", "MathCaption",
 CellID->1881403532,ExpressionUUID->"30bba93e-d4c5-4691-af35-a543f2c67e1b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[332]:=",
 CellID->938466843,ExpressionUUID->"0dd176e1-e99c-4888-a8db-2270287f7c4e"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "a", ",", "b", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[333]:=",
 CellID->393774061,ExpressionUUID->"0c8e1f2a-db9d-4a8b-bfb3-450d17bfccd9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v1", ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "]"}]}]}], "Input",
 CellLabel->"In[335]:=",
 CellID->1763526820,ExpressionUUID->"94c7d5c7-70e0-490c-b88b-c01189ccd2d1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], InsetBox[
    StyleBox[
     RowBox[{
      TemplateBox[{
        TemplateBox[{"0"}, "RowDefault"]},
       "Ket"], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}]}],
     StripOnInput->False,
     FontSize->Scaled[0.16000000000000003`],
     FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->216,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[337]=",
 CellID->852793164,ExpressionUUID->"cba46d6f-92b5-40d4-a77c-5228c8987632"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v3", "=", 
   RowBox[{"LogicalForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "+", 
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v4", "=", 
   RowBox[{"LogicalForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v1", ",", "v4", ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1"}], "]"}], ",", "v3",
     ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<UnitLength\>\"", "\[Rule]", "42"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[338]:=",
 CellID->502407381,ExpressionUUID->"dfb92a69-5a53-4b72-b107-d9aeec783dd8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], {
     LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -2.}, {-0.1, -2}}], InsetBox[
      StyleBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"0", "0"}, "RowDefault"]},
         "Ket"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"1", "0"}, "RowDefault"]},
          "Ket"]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.30000000000000004, -2.5}, 
      ImageScaled[{1, Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2.1, -2}, {2.2, -2.}, {2.2, -1.}, {2.1, -1}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0", "0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"0", "1"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.3000000000000003, -1.5}, 
     ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{84, 84}, {5, 5}},
  ImageSize->252,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[340]=",
 CellID->1472141486,ExpressionUUID->"15021521-09c5-489a-961a-c8051872e614"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"expr", ",", "vec", ",", "mat"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "3"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}], "+", " ", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "[", "0", "]"}], "=", 
   RowBox[{"ThePauli", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "2", "]"}], "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{
     RowBox[{"mat", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"v1", ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"S", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "[", "1", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"expr", "[", "1", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}], ",", "v1"}], 
     "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[341]:=",
 CellID->1381993784,ExpressionUUID->"c214c71a-4602-4278-8c63-0a4248b99744"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
    0, -4}, {5, -4}}}], {
    LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -2.}, {-0.1, -2}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"1", "0"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"0", "1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.30000000000000004, -2.5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -3}, {1, -4}, {1, -1}, {1, -2}}], DiskBox[{1, -3}, 0.09], 
    DiskBox[{1, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}}, {
    LineBox[{{2, -1}, {2, -3}, {2, -4}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -2.6}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"A\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{3.6, -4.4}, {4.4, -1.6}]}, {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {5.1, -1}, ImageScaled[{0, Rational[1, 2]}]], {
     LineBox[{{5.1, -3}, {5.199999999999999, -3.}, {5.199999999999999, -2.}, {
       5.1, -2}}], InsetBox[
      StyleBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"0", "1"}, "RowDefault"]},
          "Ket"]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {5.3, -2.5}, ImageScaled[{0, Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[346]=",
 CellID->1237091436,ExpressionUUID->"3393cb33-7f23-4c96-a765-9e578bf78702"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "[", "2", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", "qc", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "]"}]}]], "Input",
 CellLabel->"In[347]:=",
 CellID->217392067,ExpressionUUID->"bcfdac63-25ca-4bd8-afbb-11e17dbe6867"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{6, -1}, {8, -1}}}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}}], {
    LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -2.}, {-0.1, -2}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"1", "0"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"0", "1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -2.5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"B\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -3}, {2, -4}, {2, -1}, {2, -2}}], DiskBox[{2, -3}, 0.09], 
    DiskBox[{2, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -0.6}]}}, {
    LineBox[{{3, -1}, {3, -3}, {3, -4}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -2.6}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"A\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{4.6, -4.4}, {5.4, -1.6}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
    CircleBox[{6, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{6, -1.2}, {6.24, -0.76}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {8.1, -1}, ImageScaled[{0, Rational[1, 2]}]], {
     LineBox[{{8.1, -3}, {8.2, -3.}, {8.2, -2.}, {8.1, -2}}], InsetBox[
      StyleBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"0", "1"}, "RowDefault"]},
          "Ket"]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {8.299999999999999, -2.5}, 
      ImageScaled[{0, Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->432,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[347]=",
 CellID->1683569938,ExpressionUUID->"79ce0658-7382-4fba-8929-c1d5965ad0cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"Red", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "[", "1", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<O\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Phase", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rotation", "[", 
       RowBox[{"\[Phi]", ",", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"expr", "[", "1", "]"}], ",", 
        RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"EulerRotation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "[", "0", "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", "0", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[348]:=",
 CellID->772534362,ExpressionUUID->"e70d8aa1-8e71-4280-8b45-4b172880b065"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}}], 
   {RGBColor[1, 0, 0], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -3.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{3, Rational[-5, 2]}, {3, -2.5}], 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"E\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[349]=",
 CellID->1843479452,ExpressionUUID->"4300c584-57b8-43f8-a3fa-393261ed8aca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox["3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox["3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox["3"]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"5", "/", "6"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
        SqrtBox["3"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}]], "Output",
 CellLabel->"Out[350]=",
 CellID->619298401,ExpressionUUID->"897e0e6f-879c-4c6e-97a7-a694c8125f08"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"a", "-", "c"}], "2"], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Cos", "[", 
              FractionBox["b", "2"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             FractionBox["\[Phi]", "2"], "]"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "-", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"1", "/", "3"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["b", "2"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"a", "+", "c"}], "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "2"], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {3}, {5}, {7}, {2}, {4}, {
       6}, {8}, {3}, {1}, {7}, {5}, {4}, {2}, {8}, {6}, {5}, {7}, {1}, {3}, {
       6}, {8}, {2}, {4}, {7}, {5}, {3}, {1}, {8}, {6}, {4}, {
       2}}}, {((-(Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
         Cos[Rational[1, 2] $CellContext`b] 
          Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
           Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, -1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) ((-
           Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
          Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
           Sin[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, 1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
         Cos[Rational[1, 2] $CellContext`b] 
          Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
           Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, -1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, -1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) ((-
           Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
          Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
           Sin[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, 1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) ((-
            Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)]) 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]), ((-(
           Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
         Cos[Rational[1, 2] $CellContext`b] 
          Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
           Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, 1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
         Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
          Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
           Sin[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, -1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, 1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, 1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
         Cos[Rational[1, 2] $CellContext`b] 
          Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
           Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, 1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] $CellContext`b] 
           Cos[Rational[1, 2] ($CellContext`a + $CellContext`c)] + (
            Complex[0, 1] Cos[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a + $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, 1] Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
          Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) - ((
         Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
         Rational[1, 2] (1 + (-1)^Rational[1, 3])) (
         Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
          Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
           Sin[Rational[1, 2] $CellContext`b]) 
          Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
        Cos[Rational[1, 2] $CellContext`\[Phi]] + 
        Complex[0, -1] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]), ((
          Complex[0, -1] (Rational[1, 2] (1 - (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] Sin[Rational[1, 2] $CellContext`\[Phi]]) + ((
          Complex[0, -1] (Rational[1, 2] (-1 + (-1)^Rational[1, 3]) + 
           Rational[1, 2] (1 + (-1)^Rational[1, 3]))) (
          Cos[Rational[1, 2] ($CellContext`a - $CellContext`c)] 
           Sin[Rational[1, 2] $CellContext`b] + (Complex[0, 1] 
            Sin[Rational[1, 2] $CellContext`b]) 
           Sin[Rational[1, 2] ($CellContext`a - $CellContext`c)])) (
         Cos[Rational[1, 2] $CellContext`\[Phi]] + 
         Complex[0, -1] 
          Sin[Rational[1, 2] $CellContext`\[Phi]])}}]]]]], "Output",
 CellLabel->"Out[352]//MatrixForm=",
 CellID->1842472245,ExpressionUUID->"d616294e-92c5-4ebf-aea1-71fdfa49b272"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]", ",", "a", ",", "b", ",", "c"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "Red", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<V\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"EulerRotation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[353]:=",
 CellID->100282607,ExpressionUUID->"794ab1c3-513f-404f-a604-4ed697600dd1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{5, -1}, {6, -1}}, {{5, -2}, {6, -2}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, 
   {RGBColor[1, 0, 0], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"E\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{4, Rational[-5, 2]}, {4, Rational[-1, 2]}}, {{
        4, -2.5}, {4, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
      CircleBox[{5, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
      CircleBox[{5, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[355]=",
 CellID->2098622841,ExpressionUUID->"cff7d046-2f15-493d-833b-6c1a65bd6fc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "Blue", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", " ", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2.5", ",", "0.5"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec", "[", "0", "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "0", "]"}], "//", "Normal"}]}], "Input",
 CellLabel->"In[356]:=",
 CellID->504240607,ExpressionUUID->"dfad103d-869b-4d84-8f72-6936cde510ce"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{"3", " ", 
        TemplateBox[{"0"},
         "Ket"]}], "+", 
       RowBox[{"4", " ", 
        TemplateBox[{"1"},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{"3", " ", 
        TemplateBox[{"0"},
         "Ket"]}], "+", 
       RowBox[{"4", " ", 
        TemplateBox[{"1"},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{"3", " ", 
        TemplateBox[{"0"},
         "Ket"]}], "+", 
       RowBox[{"4", " ", 
        TemplateBox[{"1"},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]]}, 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {RGBColor[1, 0, 0], {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {2, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
       StyleBox["\<\"Y\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {2, -3}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
    {RGBColor[0, 0, 1], LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}, {
     LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{90., 18.}, {5, 5}},
  ImageSize->324.,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[356]=",
 CellID->793813159,ExpressionUUID->"a4422398-528b-4872-bc48-58937abe2b15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "\[ImaginaryI]", " ", 
   SqrtBox["2"], " ", 
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"]}], "+", 
  RowBox[{"6", " ", "\[ImaginaryI]", " ", 
   SqrtBox["2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   SqrtBox["2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"56", " ", "\[ImaginaryI]", " ", 
   SqrtBox["2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"42", " ", "\[ImaginaryI]", " ", 
   SqrtBox["2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  FractionBox[
   RowBox[{"9", " ", "\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{"63", " ", "\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   SqrtBox["2"]], "-", 
  RowBox[{"42", " ", "\[ImaginaryI]", " ", 
   SqrtBox["2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->"Out[357]=",
 CellID->1449348149,ExpressionUUID->"4441e7bc-6e6f-4eb6-a301-411d1b0501c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "6"}], " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"]}], ",", 
   RowBox[{
    RowBox[{"-", "42"}], " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"27", " ", "\[ImaginaryI]"}], 
     SqrtBox["2"]], "-", 
    RowBox[{"18", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"27", " ", "\[ImaginaryI]"}], 
      SqrtBox["2"]]}], "-", 
    RowBox[{"18", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}]}], ",", 
   RowBox[{"6", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"]}], ",", 
   RowBox[{
    RowBox[{"-", "42"}], " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"]}], ",", 
   RowBox[{"8", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"]}], ",", 
   RowBox[{
    RowBox[{"-", "56"}], " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"]}]}], "}"}]], "Output",
 CellLabel->"Out[359]=",
 CellID->287332322,ExpressionUUID->"b4397d65-b1ad-413a-9ceb-35a04937eb32"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example with GraphStates", "Section",
 CellID->175892259,ExpressionUUID->"d0c2c477-3d6b-46f4-9564-d084758d6d63"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[360]:=",
 CellID->1240983965,ExpressionUUID->"a6266dd5-fc6d-407e-b12c-22d2d985eceb"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[361]:=",
 CellID->1651869782,ExpressionUUID->"83353182-14d7-4779-8f46-3fb04b15f813"],

Cell["Let us consider the graph states.", "MathCaption",
 CellID->1551054522,ExpressionUUID->"222e22e4-f607-4af0-b6dd-1159d4de3d2f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "4", "]"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "g"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc", ",", 
    RowBox[{"SWAP", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "qc", "]"}]}], "Input",
 CellLabel->"In[362]:=",
 CellID->306837658,ExpressionUUID->"187250a2-8826-4d61-bbbb-1a982c9d9183"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
       $CellContext`S[1], 
       $CellContext`S[2], 
       $CellContext`S[3], 
       $CellContext`S[4]}, {Null, {{1, 2}, {1, 3}, {1, 4}}}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{0.7745966692414834, 0.7745966692414834}, {0., 
       0.}, {0.7745966692414834, 0.}, {1.5491933384829668`, 0.}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
         ArrowBox[{{1, 2}, {1, 3}, {1, 4}}, 0.018845521490452433`]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.018845521490452433], DiskBox[2, 0.018845521490452433], 
         DiskBox[3, 0.018845521490452433], 
         DiskBox[4, 0.018845521490452433]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  AxesStyle->{},
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->{},
  FrameTicks->None,
  ImageSize->Automatic,
  PlotRangePadding->Automatic]], "Output",
 CellLabel->"Out[362]=",
 CellID->183346348,ExpressionUUID->"5d153547-e946-4ffe-8716-99390fdb337b"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09]}, {LineBox[{{4, -1}, {4, -3}}], 
    DiskBox[{4, -1}, 0.09], DiskBox[{4, -3}, 0.09]}, {
    LineBox[{{5, -1}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -4}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[363]=",
 CellID->2010521038,ExpressionUUID->"03350d66-125f-435a-a9d4-0a8b0cee1b98"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}, {{
    0, -4}, {7, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09]}, {LineBox[{{4, -1}, {4, -3}}], 
    DiskBox[{4, -1}, 0.09], DiskBox[{4, -3}, 0.09]}, {
    LineBox[{{5, -1}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -4}, 0.09]}, {LineBox[{{6, -1}, {6, -4}}], 
    LineBox[{{{5.91, -1.09}, {6.09, -0.91}}, {{5.91, -0.91}, {6.09, -1.09}}}],
     LineBox[{{{5.91, -4.09}, {6.09, -3.91}}, {{5.91, -3.91}, {
     6.09, -4.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[364]=",
 CellID->171900121,ExpressionUUID->"8095941f-f67f-4940-8e88-406c52bd806a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], "8"], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], "8"]}]], "Output",
 CellLabel->"Out[365]=",
 CellID->759828432,ExpressionUUID->"2cf7134a-266f-478f-a2e2-66f78f3da505"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "4", "]"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "g", "]"}]}], "Input",
 CellLabel->"In[366]:=",
 CellID->830388943,ExpressionUUID->"5882deee-91fc-4b45-b503-e84e2fd8f8c6"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
       $CellContext`S[1], 
       $CellContext`S[2], 
       $CellContext`S[3], 
       $CellContext`S[4]}, {Null, {{1, 2}, {2, 3}, {1, 3}, {1, 4}}}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{1.1140931545487447`, 0.4234377531712424}, {
       2.0313384837607686`, 0.}, {2.0312611838059835`, 0.8470577415943887}, {
       0., 0.423516252473954}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
         ArrowBox[{{1, 2}, {1, 3}, {1, 4}, {2, 3}}, 0.02286523635197532]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.02286523635197532], DiskBox[2, 0.02286523635197532], 
         DiskBox[3, 0.02286523635197532], DiskBox[4, 0.02286523635197532]}}]],
     
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  AxesStyle->{},
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->{},
  FrameTicks->None,
  ImageSize->Automatic,
  PlotRangePadding->Automatic]], "Output",
 CellLabel->"Out[366]=",
 CellID->2087987116,ExpressionUUID->"acbd523c-5c23-48b0-8443-f1b347128c3c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {LineBox[{{3, -2}, {3, -3}}], 
    DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    DiskBox[{4, -3}, 0.09]}, {LineBox[{{5, -1}, {5, -4}}], 
    DiskBox[{5, -1}, 0.09], DiskBox[{5, -4}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[367]=",
 CellID->769182985,ExpressionUUID->"28d29bd5-3018-4f41-9357-e04c9eb8a238"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"in", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"in", ",", "g"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "1", "]"}], "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "2", "]"}], "=", 
   RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "2", "]"}], "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "3", "]"}], "=", 
  RowBox[{"GraphState", "[", "g", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "-", 
    RowBox[{"v", "[", "3", "]"}]}], "//", "Simplify"}], "//", 
  "Normal"}]}], "Input",
 CellLabel->"In[368]:=",
 CellID->1766752151,ExpressionUUID->"4e78e2fe-d568-4189-ac6e-cb8d9695af40"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[368]=",
 CellID->2110753079,ExpressionUUID->"857361c3-54fd-4142-9c3b-2ba7c8acff79"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {LineBox[{{3, -2}, {3, -3}}], 
    DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    DiskBox[{4, -3}, 0.09]}, {LineBox[{{5, -1}, {5, -4}}], 
    DiskBox[{5, -1}, 0.09], DiskBox[{5, -4}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[369]=",
 CellID->1144633960,ExpressionUUID->"3571023c-5b76-47cc-a073-f1a35ab0e2db"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"]}]], "Output",
 CellLabel->"Out[370]=",
 CellID->704455894,ExpressionUUID->"046ecab1-6aac-4e73-b248-d60b64e70032"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"]}], "}"}]], "Output",
 CellLabel->"Out[372]=",
 CellID->712864547,ExpressionUUID->"01111949-bcb1-4895-88a0-504bcd4c7fc2"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"]}]], "Output",
 CellLabel->"Out[373]=",
 CellID->303174816,ExpressionUUID->"55b7fec0-e290-4f73-bb6f-df3dcacf9fe2"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[374]=",
 CellID->1627921828,ExpressionUUID->"24a50212-aee2-4374-b45f-c917abd8f915"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples with Measurements", "Section",
 CellID->1921589536,ExpressionUUID->"6ceec501-85ff-4abe-b085-29d790c2c283"],

Cell["Here are simple examples with measurements.", "MathCaption",
 CellID->1840143414,ExpressionUUID->"a0af3d47-dbb8-4bfd-8ff6-c3b441dd9191"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[375]:=",
 CellID->1718903328,ExpressionUUID->"407860a2-85a0-4b30-97fb-017f17ce15fa"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[376]:=",
 CellID->1263298518,ExpressionUUID->"9bd19736-28fb-40cc-8280-11bb16320f4a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[377]:=",
 CellID->87374137,ExpressionUUID->"6ece6ced-a29f-418c-9c9a-317aa489a82d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[377]=",
 CellID->130391091,ExpressionUUID->"8bf62f2c-2fcf-4e7f-9221-aeeda6f6faee"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[378]=",
 CellID->1049746497,ExpressionUUID->"4405d354-021e-42d6-a0f2-bc8d9e172d56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[379]:=",
 CellID->2017341787,ExpressionUUID->"55ec63bf-68b7-4cd1-8ff6-ed5845cc7660"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{3, -1}, {4, -1}}}]}, 
   LineBox[{{{0, -1}, {3, -1}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
    CircleBox[{3, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[379]=",
 CellID->407575183,ExpressionUUID->"63cd1788-0de6-4d2e-9ded-14cf41261773"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[380]=",
 CellID->1790750398,ExpressionUUID->"5d6d45d5-7fd6-4511-ab0a-68fd66242e6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[381]:=",
 CellID->2026449521,ExpressionUUID->"72d7acee-6855-4b57-813f-bb49e333dc25"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{2, -1}, {3, -1}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[381]=",
 CellID->938885266,ExpressionUUID->"a101ec41-af28-45e9-87ea-00fa30a8d1fb"],

Cell[BoxData[
 TemplateBox[{"\"\[SpaceIndicator]\""},
  "Ket"]], "Output",
 CellLabel->"Out[382]=",
 CellID->134827506,ExpressionUUID->"c9056635-7399-4290-9fcd-2c45b7282408"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "3"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[383]:=",
 CellID->487856212,ExpressionUUID->"7ef9e5bc-4c88-422c-ab6e-67e1011ba440"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{3, -1}, {4, -1}}, {{3, -2}, {4, -2}}, {{3, -3}, {4, -3}}}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     CircleBox[{3, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     CircleBox[{3, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     CircleBox[{3, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -3.2}, {3.24, -2.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[383]=",
 CellID->590399788,ExpressionUUID->"e20ae4c9-af5f-4436-91df-2d53bf907453"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ExpressionFor", "@", "qc"}], ")"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ccc", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"S", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"KetFactor", "[", 
  RowBox[{"ccc", ",", 
   RowBox[{"S", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[384]:=",
 CellID->125377819,ExpressionUUID->"a8c4ca8e-6e13-43b2-ad25-01ddca4af0a8"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[385]=",
 CellID->46150232,ExpressionUUID->"d23408b3-3997-4bb3-abfc-9c122360999e"],

Cell[BoxData[
 RowBox[{
  TagBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"],
   HoldForm], "\[CircleTimes]", 
  TagBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"],
   HoldForm]}]], "Output",
 CellLabel->"Out[386]=",
 CellID->405352657,ExpressionUUID->"3319cfa9-b330-44e1-860b-2801baebe5cb"]
}, Open  ]],

Cell["Take another example", "MathCaption",
 CellID->690642678,ExpressionUUID->"d56f238b-6784-4212-99da-092cdf4a037c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "6"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "6"}], "]"}]}], "}"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[387]:=",
 CellID->482377111,ExpressionUUID->"6906b4e7-fc70-4df0-b9b3-72100817254b"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{2, -1}, {3, -1}}, {{2, -2}, {3, -2}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     CircleBox[{2, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -2.2}, {2.24, -1.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[387]=",
 CellID->162208938,ExpressionUUID->"dd826a4b-5c54-4d6f-8fea-eb09b4edfd3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ExpressionFor", "[", "qc", "]"}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", "200", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram3D", "[", 
  RowBox[{"data", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ","}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ","}], "]"}], ",", "\"\<Counts\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[388]:=",
 CellID->497852393,ExpressionUUID->"3f21bceb-2914-44bf-9e7e-cf66d6e673c6"],

Cell[BoxData[
 Graphics3DBox[
  {RGBColor[0.9045776, 0.6888327999999999, 0.31364080000000005`], EdgeForm[
   RGBColor[0.880722, 0.611041, 0.142051]], 
   StyleBox[{{}, 
     {RGBColor[0.9045776, 0.6888327999999999, 0.31364080000000005`], EdgeForm[
      RGBColor[0.880722, 0.611041, 0.142051]], 
      StyleBox[{
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{-0.5, -0.5, 0.}, {0.5, 0.5, 63.}]},
              
              ImageSizeCache->{{48.88994297251373, 
               142.78726065924246`}, {-53.42868423116207, 38.90410210996409}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 63]& ,
           TagBoxNote->"63"],
          StyleBox["63", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[63, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{-0.5, 0.5, 0.}, {0.5, 1.5, 40.}]},
              
              ImageSizeCache->{{88.170947709382, 
               170.08764815065882`}, {-66.41181705921556, 
               1.8224301678198174`}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 40]& ,
           TagBoxNote->"40"],
          StyleBox["40", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[40, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{0.5, -0.5, 0.}, {1.5, 0.5, 53.}]},
              
              ImageSizeCache->{{106.85974741784972`, 
               202.3079318196563}, {-30.961164986861668`, 62.53669380696879}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 53]& ,
           TagBoxNote->"53"],
          StyleBox["53", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[53, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{0.5, 0.5, 0.}, {1.5, 1.5, 44.}]},
              
              ImageSizeCache->{{140.78726065924246`, 
               224.86555093006066`}, {-54.87464665539076, 
               20.962273521662397`}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 44]& ,
           TagBoxNote->"44"],
          StyleBox["44", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[44, {"Graphics3DLabel"}], "Tooltip"]& ]},
       FontColor->GrayLevel[0.4]]}, {}, {}},
    FontColor->GrayLevel[0.4]]},
  Axes->{True, True, True},
  AxesLabel->{
    FormBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], TraditionalForm], 
    
    FormBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], TraditionalForm], 
    
    FormBox["\"Counts\"", TraditionalForm]},
  AxesStyle->{},
  BoxRatios->{1, 1, 0.4},
  FaceGridsStyle->Automatic,
  ImageSize->Automatic,
  Lighting->"Neutral",
  Method->{"RotationControl" -> "Globe"},
  PlotRange->{{-0.5, 1.5}, {-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.1]}},
  Ticks->{Automatic, Automatic, Automatic}]], "Output",
 CellLabel->"Out[389]=",
 CellID->1678949611,ExpressionUUID->"8b9f992f-b660-4ce6-94d7-cf272f1b5306"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Measurement", "[", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"Measurement", "[", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[390]:=",
 CellID->1282052763,ExpressionUUID->"f4819f7b-d81f-4a07-9ff7-1e4acc974427"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{3, -1}, {4, -1}}, {{3, -2}, {4, -2}}}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     CircleBox[{3, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     CircleBox[{3, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[390]=",
 CellID->14401368,ExpressionUUID->"9af35d94-d1c2-4ebf-8f82-5274ad13eda6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ExpressionFor", "[", "qc", "]"}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"data", ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellLabel->"In[391]:=",
 CellID->1563056539,ExpressionUUID->"1b39fec1-827a-4688-b54d-78e1026574bf"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 54.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.301282051282044`, 
           301.27564102564105`}, {-177.37484710117133`, 149.75611595314808`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 54]& ,
        TagBoxNote->"54"],
       StyleBox["54", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[54, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 46.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{300.77564102564105`, 558.75}, {-128.9850747968277,
            149.75611595314808`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 46]& ,
        TagBoxNote->"46"],
       StyleBox["46", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[46, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[392]=",
 CellID->1599041117,ExpressionUUID->"e470b003-5cbd-450c-8afa-fd9c9610ef6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], "**", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], "**", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "1"}], "]"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"v", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Measurement", "[", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], "@", 
       RowBox[{
        RowBox[{"Measurement", "[", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "@", "v"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1000"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data", "]"}]}], "Input",
 CellLabel->"In[393]:=",
 CellID->1895739858,ExpressionUUID->"8067d53b-f746-43a0-b11f-ee31616b0aa5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "-", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[394]=",
 CellID->885964264,ExpressionUUID->"cd448bd6-fe7b-47a5-96b9-bc750804fadd"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 491.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{55.9679487179487, 
           307.60897435897436`}, {-161.31418381069506`, 146.51566276981617`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 491]& ,
        TagBoxNote->"491"],
       StyleBox["491", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[491, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 509.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{307.10897435897436`, 
           558.75}, {-172.58085843075452`, 146.51566276981617`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 509]& ,
        TagBoxNote->"509"],
       StyleBox["509", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[509, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[396]=",
 CellID->1897260397,ExpressionUUID->"e4b52388-7a75-4d93-818b-a986d9a1f095"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples with Controlled-U Gates", "Section",
 CellID->580366830,ExpressionUUID->"0f62c5bb-4112-4093-9cce-aeede59fea6f"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[397]:=",
 CellID->1518587760,ExpressionUUID->"f5cd08a5-af70-457c-8796-873f0caa4823"],

Cell["Here are simple examples involving controlled-U gates.", "MathCaption",
 CellID->2037836930,ExpressionUUID->"05789769-fb28-4501-a473-fa822da061fd"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[398]:=",
 CellID->1411053746,ExpressionUUID->"f8a66bfe-bf20-417f-b9cf-84e8aa66f1c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[399]:=",
 CellID->2015591617,ExpressionUUID->"bfe5b7af-49ff-4eda-91b2-b1bd6935205f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Y\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[399]=",
 CellID->541549489,ExpressionUUID->"81cf5802-f206-439b-952e-863d6b5be7dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
     RowBox[{"Rotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<R\>\""}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[400]:=",
 CellID->214937072,ExpressionUUID->"0e359104-a81e-478d-856a-1f23d6f04145"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"R\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[400]=",
 CellID->379034995,ExpressionUUID->"d69807ee-8268-4cc4-b579-4f9f5c450143"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples with Arbitrary Controlled-U Gates", "Section",
 CellID->87721419,ExpressionUUID->"fa59f56c-208d-470d-9549-e112a4ecff58"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[401]:=",
 CellID->1866561420,ExpressionUUID->"3876b9b4-7f50-47a3-9b2a-c93e78df391c"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[402]:=",
 CellID->1133410698,ExpressionUUID->"7f4a3446-5b5f-4788-96f5-04802f98936f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "-", " ", 
   RowBox[{"I", " ", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", "expr"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", "expr", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[403]:=",
 CellID->1053652396,ExpressionUUID->"baa8f673-76ee-41f6-bc27-2115a96c2567"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"3"}, "RowDefault"], 
    TemplateBox[{"\"x\""}, "RowDefault"]},
   "Subsuperscript"], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[403]=",
 CellID->940534724,ExpressionUUID->"c84aa549-77ff-4582-87f2-bf28d6ee52fd"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -2.6}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[404]=",
 CellID->2087464348,ExpressionUUID->"6f54bb06-0d95-4035-b1bc-930d66b98e29"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-7, 2]}, {1, -3.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[405]=",
 CellID->572955797,ExpressionUUID->"ab82b512-7944-4941-9092-d6295b9a2254"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ex1", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc1", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex2", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc2", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", "-", "ex2"}], "//", "Simplify"}]}], "Input",
 CellLabel->"In[406]:=",
 CellID->916671498,ExpressionUUID->"36b8bad3-39ea-4869-a394-5c987dad2704"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}], "-", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[406]=",
 CellID->272682391,ExpressionUUID->"ad801167-e5e5-42d9-a866-e37b5362c2e1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}], "-", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[407]=",
 CellID->242842839,ExpressionUUID->"cd5adc04-5d00-44cb-a7b3-647a7eedbd94"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[408]=",
 CellID->1240665773,ExpressionUUID->"03b3a507-f148-41e0-8072-03444498ce92"]
}, Open  ]],

Cell["\<\
Let us take another example, where the (multi-qubit) gate (operator) is \
expressed in an expression of Pauli operators for labelled qubits.\
\>", "MathCaption",
 CellID->1043555611,ExpressionUUID->"b0ae0c36-e3d5-48aa-bd49-8a02617e49fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "0"}], "]"}], "+", 
   RowBox[{"I", " ", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{"expr", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"expr", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[409]:=",
 CellID->540209028,ExpressionUUID->"47aed5fc-fd80-4cf2-a271-be5888e87e9a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"3"}, "RowDefault"], 
    TemplateBox[{"0"}, "RowDefault"]},
   "Subsuperscript"], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[409]=",
 CellID->893487173,ExpressionUUID->"fbfb49a7-c659-425e-87d6-f66dc5d6a5bd"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, {LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[410]=",
 CellID->1633256787,ExpressionUUID->"71cd258c-c95e-492b-bb84-88052b89a6a7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[411]=",
 CellID->1010843155,ExpressionUUID->"8d351c89-bd35-4d4e-ba01-64b2414a575e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc1", "]"}], "//", "Elaborate"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc2", "]"}], "//", "Elaborate"}], "//", 
  "Simplify"}]}], "Input",
 CellLabel->"In[412]:=",
 CellID->2058230597,ExpressionUUID->"c45b7465-cd8c-42eb-b1ec-a502c68bd30a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[412]=",
 CellID->120348131,ExpressionUUID->"c9c80600-070b-4f56-b8ae-8baf864d5b50"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[413]=",
 CellID->1908925890,ExpressionUUID->"e92a9c70-8079-4b05-b47a-e3aca76abf16"]
}, Open  ]],

Cell["The gate is expressed in a matrix representation.", "MathCaption",
 CellID->854399110,ExpressionUUID->"6d883a1c-7306-4e2b-b51e-4b20a6757ab0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"ThePauli", "[", "1", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"ThePauli", "[", "3", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", " ", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"op", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[414]:=",
 CellID->1810177928,ExpressionUUID->"9c9eb691-273a-43e7-9e42-5fa8e5bd5cd3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[ImaginaryI]", "1"},
     {"1", 
      RowBox[{"-", "\[ImaginaryI]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Complex[0, 1], 1, Complex[0, -1], 1}}]]]]], "Output",
 CellLabel->"Out[415]//MatrixForm=",
 CellID->183515558,ExpressionUUID->"2156cb9f-4e10-4afd-aab7-75d8c7501cde"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, {LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[417]=",
 CellID->559466214,ExpressionUUID->"d2be259e-a280-4dae-9fa5-0416a7a3d9b7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[418]=",
 CellID->1265252132,ExpressionUUID->"ba1dc347-57b6-4ab4-be32-c4dbc5d64d20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ex1", "=", 
  RowBox[{
   RowBox[{"qc1", "//", "Elaborate"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex2", "=", 
  RowBox[{
   RowBox[{"qc2", "//", "Elaborate"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", "-", "ex2"}], "//", "Simplify"}]}], "Input",
 CellLabel->"In[419]:=",
 CellID->1035336409,ExpressionUUID->"30c12c08-e56e-4ff1-8562-3f34af8cfe81"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"\[ImaginaryI]", "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}], "-", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], ")"}]}]], "Output",
 CellLabel->"Out[419]=",
 CellID->2071248708,ExpressionUUID->"b9ba3138-d716-4510-8ebd-2fad715afc2f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"\[ImaginaryI]", "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}], "-", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], ")"}]}]], "Output",
 CellLabel->"Out[420]=",
 CellID->767117486,ExpressionUUID->"932da5c3-706d-44e0-9125-39f993e246c9"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[421]=",
 CellID->1599254261,ExpressionUUID->"00f50ca4-115f-46e7-a6c3-008ad51c98a4"]
}, Open  ]],

Cell["Multi-qubit gate is expressed in a matrix representation.", \
"MathCaption",
 CellID->1230508662,ExpressionUUID->"4561e3c1-c22c-4a9b-9ed5-3628c219e3d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"ThePauli", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq", "=", 
   RowBox[{"S", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "qq"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", " ", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"op", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[422]:=",
 CellID->891561624,ExpressionUUID->"6650df1c-a37a-4ad5-9df1-d573df926233"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"0", "0", "\[ImaginaryI]", "0"},
     {"0", 
      RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
     {"\[ImaginaryI]", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{4}, {3}, {2}, {1}}}, {
      Complex[0, -1], Complex[0, 1], Complex[0, -1], Complex[
       0, 1]}}]]]]], "Output",
 CellLabel->"Out[423]//MatrixForm=",
 CellID->1108503766,ExpressionUUID->"84a31b75-cee6-4517-93c4-5b00ae5fcc31"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{1.6, -3.4}, {2.4, -1.6}]}, {LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[426]=",
 CellID->1202157437,ExpressionUUID->"d1dc8b36-4721-45f1-91f0-d5515ba03441"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-5, 2]}, {2, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[427]=",
 CellID->1133892683,ExpressionUUID->"04976ba5-932f-4155-a332-766786194967"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Elaborate", "[", "qc1", "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Elaborate", "[", "qc2", "]"}], "//", "Simplify"}]}], "Input",
 CellLabel->"In[428]:=",
 CellID->999620760,ExpressionUUID->"090e571f-5d68-4a59-9f44-077b8fb0c936"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[428]=",
 CellID->523519006,ExpressionUUID->"9d1115d6-da4f-4d72-b750-e92f0ce71808"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[429]=",
 CellID->543432083,ExpressionUUID->"9167718d-112d-4a9b-ac7e-c9f4bbf2be9f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix on QuantumCircuit", "Section",
 CellID->462801707,ExpressionUUID->"365b2a37-e0cc-4f51-ac23-58699e73e836"],

Cell[TextData[{
 "Depending on the ratio of the \[OpenCurlyDoubleQuote]size\
\[CloseCurlyDoubleQuote] (the number of qubits) and the \
\[OpenCurlyDoubleQuote]depth\[CloseCurlyDoubleQuote] (the number of \
operations), ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7ea9a5c2-283d-4b24-b8ad-425bf1fdcde2"],
 " is more efficient than the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpressionFor"]], "paclet:Q3/ref/ExpressionFor", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "235d21e5-76a2-4755-84f9-2d193546cff4"],
 "."
}], "MathCaption",
 CellID->122520115,ExpressionUUID->"a162c1ab-b1dc-495f-b9a0-68cc085c3f88"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[430]:=",
 CellID->1179364979,ExpressionUUID->"f9c0191f-627f-4132-be8a-26aa4547f050"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[431]:=",
 CellID->1480097392,ExpressionUUID->"f4e6f80a-7e56-49c5-8123-488c78e95009"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$N", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "[", "$N", "]"}], ",", "None"}], "]"}]}]}], "Input",
 CellLabel->"In[432]:=",
 CellID->1693784143,ExpressionUUID->"bf33e064-6753-4c13-8209-d9ec6b0e4ce0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"3"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"4"},
     "RowDefault"]]}], "}"}]], "Output",
 CellLabel->"Out[433]=",
 CellID->1859793306,ExpressionUUID->"a9938569-b95a-4720-aac0-d24a527744a8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"S", "[", 
   RowBox[{"j", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<R\>\"", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", ">", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<R\>\"", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", "<", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SW", "[", "j_", "]"}], ":=", 
  RowBox[{"SWAP", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"$N", "-", "j", "+", "1"}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[434]:=",
 CellID->1636787114,ExpressionUUID->"8fd58481-86c4-4649-99c5-e79574cf385d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SW", "[", "j", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$N", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4a", "=", 
   RowBox[{"Catenate", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "$N"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4a", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4a", ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4a", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", "qft4a"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "Input",
 CellLabel->"In[438]:=",
 CellID->215506928,ExpressionUUID->"8e643892-f4a3-4da3-889d-f5a62263817b"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -4}, {4, -1}}], DiskBox[{4, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -3}, {6, -2}}], DiskBox[{6, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -4}, {7, -2}}], DiskBox[{7, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -4}, {9, -3}}], DiskBox[{9, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->Large,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[441]=",
 CellID->783381962,ExpressionUUID->"b630e8a1-3530-4e7f-9dcb-fd4448690682"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SW", "[", "j", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$N", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4b", "=", 
   RowBox[{"Catenate", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4b", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4b", ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4b", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", "qft4b"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "Input",
 CellLabel->"In[442]:=",
 CellID->1371487384,ExpressionUUID->"56bc9246-355a-4cb3-94af-9791eb7838b7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -4}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->Large,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[445]=",
 CellID->1574674439,ExpressionUUID->"82d676dd-f909-4f2f-b73f-68afa3bdab75"]
}, Open  ]],

Cell["The above two circuits are actually equivalent.", "MathCaption",
 CellID->1421446148,ExpressionUUID->"78a133f9-2b4c-4c05-a44d-b17c83859254"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4a", "=", 
    RowBox[{"Matrix", "[", "qc4a", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4b", "=", 
    RowBox[{"Matrix", "[", "qc4b", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mat4a", "-", "mat4b"}], "//", "N"}], "//", "Chop"}], "//", 
     "Simplify"}], "//", "Normal"}], "//", "Flatten"}], "//", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], "Input",
 CellLabel->"In[446]:=",
 CellID->2056467464,ExpressionUUID->"de24b6ee-ecb5-4cc0-b33d-fb621c5240f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0569`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[446]=",
 CellID->1665338355,ExpressionUUID->"406fb2e6-282b-4c67-879e-2745b0582e7b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.018084`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[447]=",
 CellID->1187361134,ExpressionUUID->"dbede5d0-415f-47ff-a7c1-f9fcc06477af"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[448]=",
 CellID->1560531214,ExpressionUUID->"f938b58a-c34b-4230-ae20-3992d9074226"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix on QuantumCircuit: With Measure", "Section",
 CellID->991141748,ExpressionUUID->"be7c647f-2e0b-482c-80c5-17f695b63be4"],

Cell[TextData[{
 "Here we illustrate how ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "45e550ae-d41e-462d-aacd-4bbc148f5321"],
 " works on a ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3f9fdcd0-ccb5-4dd5-9d86-02a3426e7f64"],
 " when it involves ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Measurement"]], "paclet:Q3/ref/Measurement", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "11d006d5-91cf-47fd-a21f-92a851b425ca"],
 "."
}], "MathCaption",
 CellID->623127415,ExpressionUUID->"191c48e0-e03a-4622-bb4b-cdf8975f4768"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[449]:=",
 CellID->1624724280,ExpressionUUID->"2edfd8bb-d552-4f7b-af29-b5b01deaff89"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[450]:=",
 CellID->1455738726,ExpressionUUID->"21e3bb53-4f2b-46a5-acab-858528d8fe8b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"ss", "\[Rule]", "1"}], "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"jj", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"EulerRotation", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Pi", "/", "3"}], ",", 
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"Pi", "/", "3"}]}], "}"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "gg"}], "]"}]}]}], "Input",
 CellLabel->"In[451]:=",
 CellID->319577611,ExpressionUUID->"46416092-14b4-4f0c-845b-4be1682d5430"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{6, -2}, {8, -2}}}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {8, -3}}}], {
    LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -1.}, {-0.1, -1}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"1", "1", "1"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"0", "0", "1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -2.}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
        4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"E\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
    CircleBox[{6, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{6, -2.2}, {6.24, -1.76}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->334.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[454]=",
 CellID->1329875132,ExpressionUUID->"7f27fcdb-95d9-4fa8-914c-817309abc91e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat1", "=", 
   RowBox[{
    RowBox[{"Matrix", "@", "qc"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat1", "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat2", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"ExpressionFor", "@", "qc"}], ",", "ss"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat2", "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat3", "=", 
   RowBox[{
    RowBox[{"Matrix", "@", "qc"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat3", "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat1", "-", "mat2"}], "//", "Simplify"}], "//", 
  "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat2", "-", "mat3"}], "//", "Simplify"}], "//", 
  "Normal"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Readout", "[", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Readout", "[", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}]}], "Input",
 CellLabel->"In[455]:=",
 CellID->195457935,ExpressionUUID->"c3bb46d0-ecc4-4f87-8391-62af0e6f3e08"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "+", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "+", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "+", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox[
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]], ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[456]=",
 CellID->383935460,ExpressionUUID->"a71204da-8a93-4ef2-99e3-2129f0872bf2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
       SqrtBox["3"]}], ")"}]}], 
    SqrtBox[
     RowBox[{"2", "+", 
      SqrtBox["3"]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["3"]}], ")"}]}], 
     SqrtBox[
      RowBox[{"2", "+", 
       SqrtBox["3"]}]]]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[458]=",
 CellID->1762400632,ExpressionUUID->"8314fff5-300a-45aa-b0c6-2011039a8328"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "+", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "+", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "+", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox[
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           SqrtBox[
            FractionBox["3", "2"]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["2"]}]]}], 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"]}], "-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SqrtBox[
               FractionBox["3", "2"]], "2"], "+", 
             FractionBox["3", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]], ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[460]=",
 CellID->425478953,ExpressionUUID->"e19c9546-05b7-48f4-9247-e249265cb367"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "-", 
         FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
         SqrtBox["3"]}], ")"}]}], 
      SqrtBox[
       RowBox[{"2", "+", 
        SqrtBox["3"]}]]]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "+", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "+", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "+", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["3"]}], ")"}]}], 
     SqrtBox[
      RowBox[{"2", "+", 
       SqrtBox["3"]}]]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]]}], ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[461]=",
 CellID->2051702208,ExpressionUUID->"747562d7-8696-418e-9ef4-3d13b9005060"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["3"]}], ")"}]}], 
     SqrtBox[
      RowBox[{"2", "+", 
       SqrtBox["3"]}]]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "+", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "+", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "+", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "-", 
         FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
         SqrtBox["3"]}], ")"}]}], 
      SqrtBox[
       RowBox[{"2", "+", 
        SqrtBox["3"]}]]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "4"], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            SqrtBox[
             FractionBox["3", "2"]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SqrtBox["2"]}]]}], 
          RowBox[{"2", " ", 
           SqrtBox["2"]}]]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 FractionBox["3", "2"]], "2"]}], "-", 
              FractionBox["1", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SqrtBox[
                FractionBox["3", "2"]], "2"], "+", 
              FractionBox["3", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], ")"}], "2"]}], ")"}]}]}]]}]]}], ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[462]=",
 CellID->814089977,ExpressionUUID->"3f6fd2e9-1431-4f7b-99f1-ad77e8674202"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[463]=",
 CellID->791928402,ExpressionUUID->"610b7d27-d348-410c-948d-a6d731d25eb0"]
}, Open  ]],

Cell["\<\
Let us collect the measurement readouts to get the statistics.\
\>", "MathCaption",
 CellID->1155670419,ExpressionUUID->"1e7627a1-95ff-4cb5-8809-0b6d54020b20"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Matrix", "[", "qc", "]"}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "100"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data1", "]"}]}], "Input",
 CellLabel->"In[464]:=",
 CellID->1510628665,ExpressionUUID->"036ad411-5bcf-409b-b4dd-3ab18443b792"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6789999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6789999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0., 0}, {1., 100.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{55.96794871794872, 558.75}, {-170.75000000000003`,
            148.34652120057078`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 100]& ,
        TagBoxNote->"100"],
       StyleBox["100", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[100, {}], "Tooltip"]& ]}, {}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.02, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{0., 1.}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[465]=",
 CellID->340444347,ExpressionUUID->"9d1af556-4bdb-4875-a432-5a656275b499"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ExpressionFor", "[", "qc", "]"}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "100"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data2", "]"}]}], "Input",
 CellLabel->"In[466]:=",
 CellID->643738394,ExpressionUUID->"dfc616f3-8cac-4067-b7cc-c1d82424e990"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 90.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.301282051282044`, 
           301.27564102564105`}, {-177.37484710117135`, 149.7561159531481}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 90]& ,
        TagBoxNote->"90"],
       StyleBox["90", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[90, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 10.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{300.77564102564105`, 558.75}, {
           112.96378672489038`, 149.7561159531481}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 10]& ,
        TagBoxNote->"10"],
       StyleBox["10", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[10, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[467]=",
 CellID->928326472,ExpressionUUID->"a5f1c6fa-63d7-4840-ba6c-e40e24d1e19a"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Information",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumComputationAndInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "139cf7b9-ef9a-4263-8957-a6dcd56b8f57"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"1236bb32-fa31-4795-8b73-\
8e373a1854ce"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Information: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndInformationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "e07a94f3-9752-43d3-9896-63057d8dcf26"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "10114bb0-6461-4e1e-9290-0d1f9045849d"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Algorithms",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumAlgorithms"]], 
         "RelatedTutorials",ExpressionUUID->
         "88610ec6-4390-4deb-add7-727808bc1e96"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Error-Correction Codes",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumErrorCorrectionCodes"]], 
         "RelatedTutorials",ExpressionUUID->
         "510f5fb1-dbb5-470d-8d94-26ed1a3c5ee8"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Teleportation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], 
         "RelatedTutorials",ExpressionUUID->
         "5769b067-85c4-4ad8-9fe0-ad91d6b7ca1f"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Fourier Transform",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumFourierTransform"]], 
         "RelatedTutorials",ExpressionUUID->
         "8f6dd8ee-c89f-4e4f-b4df-d87174f3d634"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Fourier Transform: Semiclassical Implementation",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumFourierTransformSemiclassical"]], 
         "RelatedTutorials",ExpressionUUID->
         "2c43e8c4-c7bd-4327-8d26-4c2159a408f5"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"3b21d8a2-fd7d-49e6-bc0d-\
1c97a8ea22c8"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{
         "Related", " ", "Wolfram", " ", "Education", " ", "Group", " ", 
          "Courses"}], "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "69f66b3c-398d-44dc-9f1d-09074b718a7d"]}]],ExpressionUUID->
         "5ec389ab-74de-4d97-b639-a61babe37070"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "7282a9ac-1b74-4ae5-9b4f-c6ff7a6ced12"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-EIWL.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "An Elementary Introduction to the Wolfram Language"}]]]], 
          "https://www.wolfram.com/language/elementary-introduction/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "764d3d6b-6f39-4a94-a7c2-1c1b0d6dd757"]], "TutorialRelatedLinks",
        ExpressionUUID->"be0c9527-46f8-47d6-bcf4-3fe3e386951b"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-FastIntro.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "The Wolfram Language: Fast Introduction for Programmers"}]]]],
           "https://www.wolfram.com/language/fast-introduction-for-\
programmers/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "18bb5c74-9543-474d-90ae-3614639c6766"]], "TutorialRelatedLinks",
        ExpressionUUID->"07492a6d-a28c-49c9-9f75-b783eed6d3a9"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"fc1348a5-f823-4fbc-b1ed-\
cd6d3a19ca94"],

Cell[" ", "FooterCell",ExpressionUUID->"6ebdce87-f341-4dd6-9eb1-c6c5aca1cfbf"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QuantumCircuit Usage Examples",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", "2021"}, 
  "ShowCitation" -> False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 7, 21, 2, 32, 45.781412}", 
    "history" -> {"12", "13", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation", "quantum circuit model"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "QuantumCircuit provides the graphical representation of the quantum \
circuits. Frequently used quantum circuit elements. Make sure that the Q3 \
package is loaded to use the demonstrations in this document.", 
    "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$304752, "title" -> 
    "QuantumCircuit Usage Examples", "titlemodifier" -> "", "windowtitle" -> 
    "QuantumCircuit Usage Examples", "type" -> "Tutorial", "uri" -> 
    "Q3/tutorial/QuantumCircuitUsage"}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.1 for Mac OS X ARM (64-bit) (June 16, 2022)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"0efd96ce-2cd2-4449-8c5c-15ecb5e1bc1c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[601, 21, 8169, 188, 57, "AnchorBarGrid",ExpressionUUID->"08f1d732-161e-405a-ab6b-9d140407a013",
 CellID->1],
Cell[CellGroupData[{
Cell[8795, 213, 1185, 31, 59, "ObjectNameGrid",ExpressionUUID->"010b10dd-7a84-4999-acd9-ad6197086bc0"],
Cell[9983, 246, 12102, 261, 173, "TutorialJumpBox",ExpressionUUID->"b0087466-3b87-448b-a4a5-d5c654191b8d"],
Cell[22088, 509, 464, 12, 38, "Text",ExpressionUUID->"9602d068-1fe2-473a-a422-f53619f1866b",
 CellID->1534169418],
Cell[22555, 523, 2898, 77, 297, "DefinitionBox",ExpressionUUID->"36a1a65f-f972-4904-bb2e-3bc83879888a",
 CellID->2096742444],
Cell[25456, 602, 136, 1, 36, "Caption",ExpressionUUID->"7af12226-fca3-4243-a536-9da44513326a",
 CellID->1891092685],
Cell[25595, 605, 275, 7, 36, "MathCaption",ExpressionUUID->"d6f630f5-8586-4173-862a-1d1f3721c406",
 CellID->1428640008],
Cell[25873, 614, 145, 3, 29, "Input",ExpressionUUID->"48a051d0-72b3-4fba-b484-48e37124b148",
 CellID->853967906],
Cell[26021, 619, 310, 6, 57, "MathCaption",ExpressionUUID->"e45f07e4-5de3-4c63-9849-f3c870b9290b",
 CellID->1937193009],
Cell[26334, 627, 269, 6, 48, "Input",ExpressionUUID->"17a296a6-558b-4ae1-9180-fb0a1b764956",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[26640, 638, 111, 1, 71, "Section",ExpressionUUID->"13de1dd1-88f4-44a7-8d53-d680f62dcf38",
 CellID->1868432623],
Cell[26754, 641, 154, 1, 70, "MathCaption",ExpressionUUID->"c60fb0a3-b3ed-4171-b14f-f9133f7dd6f7",
 CellID->836781195],
Cell[26911, 644, 147, 3, 70, "Input",ExpressionUUID->"a5877577-04b7-4065-afe5-89c89d2cd216",
 CellID->841456058],
Cell[27061, 649, 477, 15, 70, "MathCaption",ExpressionUUID->"b1199825-0657-4881-8ff3-000daf354b58",
 CellID->1561112771],
Cell[27541, 666, 183, 4, 70, "Input",ExpressionUUID->"2cb154ae-075a-4491-bd38-b9a9d8aea2ff",
 CellID->644371895],
Cell[27727, 672, 495, 13, 70, "MathCaption",ExpressionUUID->"bdc5272d-86dc-4fab-b312-1f0742da0425",
 CellID->121218086],
Cell[CellGroupData[{
Cell[28247, 689, 298, 8, 70, "Input",ExpressionUUID->"2f25afb4-f718-4f2d-8eb0-c192c01d2b9f",
 CellID->359983136],
Cell[28548, 699, 1034, 25, 60, "Output",ExpressionUUID->"f7140b4b-e29e-4bb8-9bd5-90e1c20559be",
 CellID->1362067654]
}, Open  ]],
Cell[29597, 727, 197, 4, 70, "MathCaption",ExpressionUUID->"46aaa030-5c36-402e-b406-7db694dd4fba",
 CellID->648571534],
Cell[CellGroupData[{
Cell[29819, 735, 312, 8, 70, "Input",ExpressionUUID->"fc755324-77e4-4aee-b90c-1e2b4ddc9631",
 CellID->1027099769],
Cell[30134, 745, 1075, 26, 60, "Output",ExpressionUUID->"f8763e7c-915b-4ae0-ab3a-9dca4adcb4dc",
 CellID->2127595982]
}, Open  ]],
Cell[CellGroupData[{
Cell[31246, 776, 335, 9, 70, "Input",ExpressionUUID->"bc30cf25-7366-4283-ba65-98cd0a2a972f",
 CellID->1753671624],
Cell[31584, 787, 1062, 26, 96, "Output",ExpressionUUID->"3a5caadc-536e-424b-a069-aa65dccbfe1b",
 CellID->1415989109]
}, Open  ]],
Cell[32661, 816, 176, 3, 70, "MathCaption",ExpressionUUID->"cc7e3dbc-f969-46f3-9659-771d457d3ad0",
 CellID->1179582981],
Cell[CellGroupData[{
Cell[32862, 823, 633, 19, 70, "Input",ExpressionUUID->"5f40e815-6320-4bf4-94a3-7976ddd43780",
 CellID->1498964105],
Cell[33498, 844, 2352, 59, 240, "Output",ExpressionUUID->"46477ff8-ad81-4256-8053-554753851661",
 CellID->960970743]
}, Open  ]],
Cell[35865, 906, 461, 7, 70, "MathCaption",ExpressionUUID->"7467563a-5cd7-4698-9185-2c0e3a847116",
 CellID->1884848111],
Cell[CellGroupData[{
Cell[36351, 917, 748, 20, 70, "Input",ExpressionUUID->"6cdb51b7-39b5-45fd-bcd1-fae70b511ccc",
 CellID->1110924680],
Cell[37102, 939, 1057, 26, 96, "Output",ExpressionUUID->"a6d049b0-de23-4559-97ea-abc8f9fe373e",
 CellID->130678814],
Cell[38162, 967, 1024, 26, 96, "Output",ExpressionUUID->"37711f86-a393-4b5a-8ff7-0d308dffc48b",
 CellID->1590539664],
Cell[39189, 995, 1150, 29, 103, "Output",ExpressionUUID->"11851643-c64d-412e-91d0-b9e5ce4ffe04",
 CellID->323694992]
}, Open  ]],
Cell[40354, 1027, 1066, 31, 70, "MathCaption",ExpressionUUID->"44165402-0818-4498-8dde-7dd1be71fa23",
 CellID->1581832416],
Cell[CellGroupData[{
Cell[41445, 1062, 478, 11, 70, "Input",ExpressionUUID->"8447a023-8a48-4510-a52e-686c1fa6f97a",
 CellID->9865852],
Cell[41926, 1075, 669, 14, 80, "Output",ExpressionUUID->"667b1686-eefe-4333-a34b-40555448ce5c",
 CellID->1943608933],
Cell[42598, 1091, 1063, 35, 55, "Output",ExpressionUUID->"592dc5e0-fac2-4af7-94bb-6ddf325a5f23",
 CellID->861582414],
Cell[43664, 1128, 1063, 35, 55, "Output",ExpressionUUID->"08f69b36-3cb3-4241-8564-1f8df8ae928e",
 CellID->133400377]
}, Open  ]],
Cell[44742, 1166, 123, 1, 70, "MathCaption",ExpressionUUID->"e61ac71c-fc0b-47b4-8174-d58fd2b69a56",
 CellID->1800711653],
Cell[CellGroupData[{
Cell[44890, 1171, 1027, 27, 70, "Input",ExpressionUUID->"22cfa0d1-160f-4240-b293-4b7c081f8b0b",
 CellID->599552766],
Cell[45920, 1200, 2439, 55, 139, "Output",ExpressionUUID->"fb625911-2827-463c-989d-b3b3d39f63e7",
 CellID->1360106759]
}, Open  ]],
Cell[CellGroupData[{
Cell[48396, 1260, 719, 21, 70, "Input",ExpressionUUID->"c9510582-772f-4dcc-b1d4-2cab326d9f73",
 CellID->1534929666],
Cell[49118, 1283, 4054, 142, 61, "Output",ExpressionUUID->"3832991a-837e-43ac-b435-5e9d1a0cf114",
 CellID->2024611653]
}, Open  ]],
Cell[CellGroupData[{
Cell[53209, 1430, 278, 6, 70, "Input",ExpressionUUID->"2da94d43-d4a8-4b2c-afcc-56b8a6cc7c36",
 CellID->474527143],
Cell[53490, 1438, 4053, 142, 61, "Output",ExpressionUUID->"96e791d1-d065-4c41-a57a-3c4d0624a9dd",
 CellID->432278511],
Cell[57546, 1582, 128, 2, 37, "Output",ExpressionUUID->"bbdfdf0f-5551-4c53-8ac6-0515cc2c7ae9",
 CellID->367756576]
}, Open  ]],
Cell[57689, 1587, 159, 2, 70, "MathCaption",ExpressionUUID->"3477fbe9-6e1a-4edf-acc9-65ae61788b1c",
 CellID->1618406437],
Cell[CellGroupData[{
Cell[57873, 1593, 515, 15, 70, "Input",ExpressionUUID->"48a6acd7-5afb-48bb-a1e6-4621c541ac36",
 CellID->529113757],
Cell[58391, 1610, 1027, 26, 96, "Output",ExpressionUUID->"46336ae1-0964-4e1d-b7a0-26b9d40ff432",
 CellID->643340808],
Cell[59421, 1638, 1320, 30, 96, "Output",ExpressionUUID->"c5a9b9b2-1109-408c-8cf9-af7d6357e386",
 CellID->48797411]
}, Open  ]],
Cell[CellGroupData[{
Cell[60778, 1673, 765, 20, 70, "Input",ExpressionUUID->"dcfcf789-7f33-49ce-ac28-b3eab9cd73b2",
 CellID->1274883332],
Cell[61546, 1695, 2851, 85, 123, "Output",ExpressionUUID->"059bb615-d07b-4b13-9bcd-359f17670118",
 CellID->310436422]
}, Open  ]],
Cell[CellGroupData[{
Cell[64434, 1785, 273, 6, 70, "Input",ExpressionUUID->"6fee91c6-c567-47f4-86db-1a38f41e897b",
 CellID->81528505],
Cell[64710, 1793, 4795, 155, 62, "Output",ExpressionUUID->"0d84f759-0c75-4b49-9eba-c300360fe946",
 CellID->2020907422]
}, Open  ]],
Cell[69520, 1951, 125, 1, 70, "MathCaption",ExpressionUUID->"367b75e9-bb01-44a8-906f-40c87518a7ed",
 CellID->468836632],
Cell[CellGroupData[{
Cell[69670, 1956, 889, 25, 70, "Input",ExpressionUUID->"e800c3da-d3e9-4c3f-bd2c-c282f59cf196",
 CellID->619773181],
Cell[70562, 1983, 2830, 79, 123, "Output",ExpressionUUID->"5eabdcfb-0f05-4ec1-bd16-17f7a498bb03",
 CellID->823083979],
Cell[73395, 2064, 4795, 155, 62, "Output",ExpressionUUID->"9fe742cc-d1d9-4106-9ce7-23ccad260f3f",
 CellID->1630264726]
}, Open  ]],
Cell[78205, 2222, 167, 3, 70, "MathCaption",ExpressionUUID->"1220155c-c48f-44e5-b3d3-aa705fc7a5c6",
 CellID->251997855],
Cell[CellGroupData[{
Cell[78397, 2229, 1159, 30, 70, "Input",ExpressionUUID->"63ab1b3c-d78c-4dc4-875d-fefcbdf9ce02",
 CellID->490197101],
Cell[79559, 2261, 2960, 82, 123, "Output",ExpressionUUID->"dd5512ba-0fce-4f6a-81be-2e26ae01156d",
 CellID->1411003542],
Cell[82522, 2345, 4793, 155, 62, "Output",ExpressionUUID->"6b235cff-0102-4495-b04b-a2ed0cbe54aa",
 CellID->74616573]
}, Open  ]],
Cell[87330, 2503, 123, 1, 70, "MathCaption",ExpressionUUID->"38b7ef06-48dd-4e1b-bf90-0282b5a0f9bd",
 CellID->1043674246],
Cell[CellGroupData[{
Cell[87478, 2508, 1065, 27, 70, "Input",ExpressionUUID->"85c8a557-cdcb-40f6-b3b1-0bd03e26086a",
 CellID->386623826],
Cell[88546, 2537, 1174, 28, 132, "Output",ExpressionUUID->"db5052e8-df66-4ac2-acac-9d1d294dfe3b",
 CellID->1835551336],
Cell[89723, 2567, 4533, 159, 52, "Output",ExpressionUUID->"e5953693-758c-443c-b88b-e9bd2812efbe",
 CellID->1508714997],
Cell[94259, 2728, 5718, 178, 232, "Output",ExpressionUUID->"cd0d719c-4504-433c-b754-3de4d980c6d3",
 CellID->1633534450]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100026, 2912, 128, 1, 70, "Section",ExpressionUUID->"2a4ef891-fa4e-468a-828b-97388e892f5e",
 CellID->188399535],
Cell[100157, 2915, 147, 3, 70, "Input",ExpressionUUID->"e215ca84-3b82-4f6c-8f92-6b82105c7f1d",
 CellID->284388437],
Cell[100307, 2920, 184, 4, 70, "Input",ExpressionUUID->"2cd70ce4-ee25-4c7f-992e-5428c29af9c8",
 CellID->1565346084],
Cell[100494, 2926, 1025, 30, 70, "MathCaption",ExpressionUUID->"6713f97b-f8e0-4402-99f4-71e683ae786f",
 CellID->92524695],
Cell[CellGroupData[{
Cell[101544, 2960, 167, 3, 70, "Subsection",ExpressionUUID->"57c2b702-44db-4a1c-beda-b5c7c8de6af5",
 CellID->2096958038],
Cell[101714, 2965, 210, 4, 70, "MathCaption",ExpressionUUID->"56f2873b-feb0-41c0-a2d9-063055e50c10",
 CellID->1219613749],
Cell[CellGroupData[{
Cell[101949, 2973, 427, 12, 70, "Input",ExpressionUUID->"ad739872-f043-4114-a22c-d0b396269bdd",
 CellID->316868828],
Cell[102379, 2987, 1226, 30, 96, "Output",ExpressionUUID->"f7c4840f-f068-4265-946c-17adbfbe4c3a",
 CellID->2135567985]
}, Open  ]],
Cell[103620, 3020, 235, 4, 70, "MathCaption",ExpressionUUID->"c0bd4c15-1637-40fa-b255-99cd0f757114",
 CellID->1646341244],
Cell[CellGroupData[{
Cell[103880, 3028, 475, 14, 70, "Input",ExpressionUUID->"5a122140-b02c-4578-96a0-2bf27a86f635",
 CellID->1877979960],
Cell[104358, 3044, 1278, 30, 96, "Output",ExpressionUUID->"2c13256a-3810-48f9-bfe1-eb49720904ca",
 CellID->1864730974]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105685, 3080, 177, 3, 70, "Subsection",ExpressionUUID->"8761acad-4459-44e3-9c91-90ca60ab9b7a",
 CellID->1162686366],
Cell[105865, 3085, 133, 1, 70, "MathCaption",ExpressionUUID->"a031824a-36b6-41c6-a018-46ab2052107e",
 CellID->1316049309],
Cell[CellGroupData[{
Cell[106023, 3090, 363, 10, 70, "Input",ExpressionUUID->"e27432ed-92d2-4cbd-9dfd-2f76acdf2f2a",
 CellID->1906655910],
Cell[106389, 3102, 1345, 34, 132, "Output",ExpressionUUID->"b3205e7c-2de1-4db1-88f3-0ea1d7df80ec",
 CellID->464626315]
}, Open  ]],
Cell[107749, 3139, 181, 3, 70, "MathCaption",ExpressionUUID->"4c49afc5-0566-4a1a-98cb-8aa893a7b42b",
 CellID->325334843],
Cell[CellGroupData[{
Cell[107955, 3146, 417, 12, 70, "Input",ExpressionUUID->"930cb2e2-7e35-45cd-abc9-af063f98af9f",
 CellID->409341039],
Cell[108375, 3160, 1369, 35, 132, "Output",ExpressionUUID->"eb667fac-3748-4758-a97b-a11a2be72848",
 CellID->1796605450]
}, Open  ]],
Cell[109759, 3198, 169, 3, 70, "MathCaption",ExpressionUUID->"6f077d63-e705-48e7-a861-81d03a77daee",
 CellID->1860334053],
Cell[CellGroupData[{
Cell[109953, 3205, 375, 10, 70, "Input",ExpressionUUID->"5ac9df08-1957-4830-8585-466b9cc1e3fb",
 CellID->1420012098],
Cell[110331, 3217, 1395, 35, 132, "Output",ExpressionUUID->"2f5b4f42-3748-4b95-8f0c-484518b58399",
 CellID->1259740157]
}, Open  ]],
Cell[111741, 3255, 293, 5, 70, "MathCaption",ExpressionUUID->"ec179609-e4e0-48ea-b642-92dd4713b348",
 CellID->1089755652],
Cell[CellGroupData[{
Cell[112059, 3264, 468, 13, 70, "Input",ExpressionUUID->"a49ba6b4-f873-430e-b787-346bc5f333c1",
 CellID->1782701548],
Cell[112530, 3279, 1345, 34, 132, "Output",ExpressionUUID->"f31ec59c-96b5-49b6-9e68-99d55dd6f4fa",
 CellID->659066431]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113936, 3320, 138, 1, 70, "Section",ExpressionUUID->"d94ab3cd-1b62-4e93-9739-d8f6ff9282d3",
 CellID->729173090],
Cell[114077, 3323, 148, 3, 70, "Input",ExpressionUUID->"253fea1e-6654-4895-9f34-dae0a7c7fdf4",
 CellID->2103953529],
Cell[114228, 3328, 184, 4, 70, "Input",ExpressionUUID->"77ea4e26-f0d1-4981-aa6d-a60ced4ca375",
 CellID->1154931458],
Cell[114415, 3334, 149, 1, 70, "MathCaption",ExpressionUUID->"c6eba4d6-7470-40d1-bd37-586988ed954e",
 CellID->898557820],
Cell[CellGroupData[{
Cell[114589, 3339, 581, 15, 70, "Input",ExpressionUUID->"fec90679-a206-473f-a180-cab500e95891",
 CellID->1173319708],
Cell[115173, 3356, 683, 17, 60, "Output",ExpressionUUID->"cabca94e-27cd-437c-a092-3848b20a5513",
 CellID->706284785],
Cell[115859, 3375, 651, 14, 80, "Output",ExpressionUUID->"41a9d7f6-468c-4c73-99cd-7958f7850e05",
 CellID->1386264526],
Cell[116513, 3391, 984, 22, 91, "Output",ExpressionUUID->"15f68244-4079-453f-a2dc-6bcb30ceeff2",
 CellID->897802179]
}, Open  ]],
Cell[117512, 3416, 191, 4, 70, "MathCaption",ExpressionUUID->"b3ad9356-38df-430f-9961-6ed6d0af0a5a",
 CellID->1246009635],
Cell[CellGroupData[{
Cell[117728, 3424, 369, 8, 70, "Input",ExpressionUUID->"dc7cfa65-3b15-4d47-9a9a-b6901b6bdd8b",
 CellID->417857018],
Cell[118100, 3434, 539, 17, 59, "Output",ExpressionUUID->"b79949cd-3073-4624-9fe1-d9a94a7c3472",
 CellID->1763991760],
Cell[118642, 3453, 1064, 35, 55, "Output",ExpressionUUID->"0a0467f1-8ec6-40dd-81f0-abd1149d9829",
 CellID->1397763485],
Cell[119709, 3490, 2811, 100, 61, "Output",ExpressionUUID->"af39c773-3fc1-4d12-86f4-c31934661a2b",
 CellID->887277862]
}, Open  ]],
Cell[CellGroupData[{
Cell[122557, 3595, 179, 4, 70, "Input",ExpressionUUID->"7290f97f-f84f-4fae-a095-234c0c193862",
 CellID->1403589449],
Cell[122739, 3601, 129, 2, 37, "Output",ExpressionUUID->"5307b98b-6049-4694-ab14-38f0d8c71cdb",
 CellID->1491791819]
}, Open  ]],
Cell[122883, 3606, 198, 4, 70, "MathCaption",ExpressionUUID->"49ffead8-818f-457b-a662-11347d9a23ed",
 CellID->1276498133],
Cell[CellGroupData[{
Cell[123106, 3614, 292, 7, 70, "Input",ExpressionUUID->"711b5acd-a1d1-41a6-a56f-772660cc8d0b",
 CellID->438798576],
Cell[123401, 3623, 2811, 100, 61, "Output",ExpressionUUID->"d9580b99-3f23-49b8-8d40-b0c99683d85e",
 CellID->435789613]
}, Open  ]],
Cell[CellGroupData[{
Cell[126249, 3728, 153, 3, 70, "Input",ExpressionUUID->"575585e4-4614-487d-9011-dc858e65c780",
 CellID->1266974318],
Cell[126405, 3733, 128, 2, 37, "Output",ExpressionUUID->"1cc890df-7b6f-451f-b696-8221130f6dc9",
 CellID->452965174]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[126582, 3741, 117, 1, 70, "Section",ExpressionUUID->"76c6ebfa-38e5-408d-9328-020c68b88295",
 CellID->2136908654],
Cell[126702, 3744, 147, 3, 70, "Input",ExpressionUUID->"64e35b69-b2ce-41e4-9c55-916130a0cf6e",
 CellID->335909506],
Cell[126852, 3749, 183, 4, 70, "Input",ExpressionUUID->"ff52af69-9040-4dd9-8a99-554fa26f089d",
 CellID->210689171],
Cell[CellGroupData[{
Cell[127060, 3757, 1119, 30, 70, "Input",ExpressionUUID->"72c3a911-9ea6-43a6-a083-b918e0fab9f7",
 CellID->2079061645],
Cell[128182, 3789, 1545, 37, 132, "Output",ExpressionUUID->"23948b38-c7d3-4ef2-8189-24a9b513d939",
 CellID->1156507739],
Cell[129730, 3828, 19079, 684, 145, "Output",ExpressionUUID->"99685c03-7ada-452a-afa5-7dfa6a7ecd5f",
 CellID->551080376],
Cell[148812, 4514, 185, 4, 37, "Output",ExpressionUUID->"96444293-d3e6-46d7-ab4a-5ecd97603bdb",
 CellID->2058393568],
Cell[149000, 4520, 185, 4, 37, "Output",ExpressionUUID->"63fa157c-972c-42c6-8396-34494af5c837",
 CellID->1606627853],
Cell[149188, 4526, 9092, 284, 248, "Output",ExpressionUUID->"7948dab2-77be-4171-af91-5756c1169678",
 CellID->134947993],
Cell[158283, 4812, 1594, 34, 168, "Output",ExpressionUUID->"45642c8a-8c89-4189-a2e9-587b642be543",
 CellID->328187119]
}, Open  ]],
Cell[CellGroupData[{
Cell[159914, 4851, 529, 14, 70, "Input",ExpressionUUID->"501e0497-9e58-4de4-b852-13c904bf2c97",
 CellID->408544247],
Cell[160446, 4867, 1060, 23, 121, "Output",ExpressionUUID->"a9cf6964-4bd8-465a-9f42-c6d2c8f9eb0c",
 CellID->1597489102]
}, Open  ]],
Cell[CellGroupData[{
Cell[161543, 4895, 611, 17, 70, "Input",ExpressionUUID->"a8820569-b013-4541-a8eb-900c4e472b19",
 CellID->1307807621],
Cell[162157, 4914, 7588, 273, 103, "Output",ExpressionUUID->"26fa73b5-1b25-4974-abe6-d01c2c50194d",
 CellID->755392711],
Cell[169748, 5189, 7589, 273, 103, "Output",ExpressionUUID->"a1591625-86b5-45ca-86d6-d39e8ecfae09",
 CellID->2109456360],
Cell[177340, 5464, 128, 2, 37, "Output",ExpressionUUID->"2a48ed34-18e2-4714-92b2-b445280a9451",
 CellID->825514197]
}, Open  ]],
Cell[177483, 5469, 191, 4, 70, "MathCaption",ExpressionUUID->"1360eadd-7686-4a8f-b9d3-146a04d7c56b",
 CellID->319766691],
Cell[CellGroupData[{
Cell[177699, 5477, 168, 3, 70, "Input",ExpressionUUID->"b2e59a80-658a-4758-8580-ac2037977de6",
 CellID->1718025104],
Cell[177870, 5482, 7589, 273, 103, "Output",ExpressionUUID->"36152c93-95e9-448a-a8b4-48b145aa5f45",
 CellID->2124284409]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185508, 5761, 116, 1, 70, "Section",ExpressionUUID->"0e21c495-97b3-4b82-8414-72cf53bab05b",
 CellID->94058740],
Cell[185627, 5764, 141, 1, 70, "MathCaption",ExpressionUUID->"30bba93e-d4c5-4691-af35-a543f2c67e1b",
 CellID->1881403532],
Cell[185771, 5767, 147, 3, 70, "Input",ExpressionUUID->"0dd176e1-e99c-4888-a8db-2270287f7c4e",
 CellID->938466843],
Cell[185921, 5772, 288, 6, 70, "Input",ExpressionUUID->"0c8e1f2a-db9d-4a8b-bfb3-450d17bfccd9",
 CellID->393774061],
Cell[CellGroupData[{
Cell[186234, 5782, 931, 29, 70, "Input",ExpressionUUID->"94c7d5c7-70e0-490c-b88b-c01189ccd2d1",
 CellID->1763526820],
Cell[187168, 5813, 1380, 38, 93, "Output",ExpressionUUID->"cba46d6f-92b5-40d4-a77c-5228c8987632",
 CellID->852793164]
}, Open  ]],
Cell[CellGroupData[{
Cell[188585, 5856, 1512, 45, 70, "Input",ExpressionUUID->"dfb92a69-5a53-4b72-b107-d9aeec783dd8",
 CellID->502407381],
Cell[190100, 5903, 2836, 78, 121, "Output",ExpressionUUID->"15021521-09c5-489a-961a-c8051872e614",
 CellID->1472141486]
}, Open  ]],
Cell[CellGroupData[{
Cell[192973, 5986, 2454, 76, 70, "Input",ExpressionUUID->"c214c71a-4602-4278-8c63-0a4248b99744",
 CellID->1381993784],
Cell[195430, 6064, 2469, 62, 153, "Output",ExpressionUUID->"3393cb33-7f23-4c96-a765-9e578bf78702",
 CellID->1237091436]
}, Open  ]],
Cell[CellGroupData[{
Cell[197936, 6131, 636, 16, 70, "Input",ExpressionUUID->"bcfdac63-25ca-4bd8-afbb-11e17dbe6867",
 CellID->217392067],
Cell[198575, 6149, 3311, 83, 158, "Output",ExpressionUUID->"79ce0658-7382-4fba-8929-c1d5965ad0cf",
 CellID->1683569938]
}, Open  ]],
Cell[CellGroupData[{
Cell[201923, 6237, 1700, 46, 70, "Input",ExpressionUUID->"e70d8aa1-8e71-4280-8b45-4b172880b065",
 CellID->772534362],
Cell[203626, 6285, 2248, 53, 132, "Output",ExpressionUUID->"4300c584-57b8-43f8-a3fa-393261ed8aca",
 CellID->1843479452],
Cell[205877, 6340, 9134, 310, 251, "Output",ExpressionUUID->"897e0e6f-879c-4c6e-97a7-a694c8125f08",
 CellID->619298401],
Cell[215014, 6652, 123885, 3220, 248, "Output",ExpressionUUID->"d616294e-92c5-4ebf-aea1-71fdfa49b272",
 CellID->1842472245]
}, Open  ]],
Cell[CellGroupData[{
Cell[338936, 9877, 1641, 46, 70, "Input",ExpressionUUID->"794ab1c3-513f-404f-a604-4ed697600dd1",
 CellID->100282607],
Cell[340580, 9925, 2521, 59, 102, "Output",ExpressionUUID->"cff7d046-2f15-493d-833b-6c1a65bd6fc0",
 CellID->2098622841]
}, Open  ]],
Cell[CellGroupData[{
Cell[343138, 9989, 1777, 48, 70, "Input",ExpressionUUID->"dfad103d-869b-4d84-8f72-6936cde510ce",
 CellID->504240607],
Cell[344918, 10039, 3313, 88, 130, "Output",ExpressionUUID->"a4422398-528b-4872-bc48-58937abe2b15",
 CellID->793813159],
Cell[348234, 10129, 3192, 100, 83, "Output",ExpressionUUID->"4441e7bc-6e6f-4eb6-a301-411d1b0501c0",
 CellID->1449348149],
Cell[351429, 10231, 1027, 33, 56, "Output",ExpressionUUID->"b4397d65-b1ad-413a-9ceb-35a04937eb32",
 CellID->287332322]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[352505, 10270, 118, 1, 70, "Section",ExpressionUUID->"d0c2c477-3d6b-46f4-9564-d084758d6d63",
 CellID->175892259],
Cell[352626, 10273, 148, 3, 70, "Input",ExpressionUUID->"a6266dd5-fc6d-407e-b12c-22d2d985eceb",
 CellID->1240983965],
Cell[352777, 10278, 184, 4, 70, "Input",ExpressionUUID->"83353182-14d7-4779-8f46-3fb04b15f813",
 CellID->1651869782],
Cell[352964, 10284, 132, 1, 70, "MathCaption",ExpressionUUID->"222e22e4-f607-4af0-b6dd-1159d4de3d2f",
 CellID->1551054522],
Cell[CellGroupData[{
Cell[353121, 10289, 1028, 29, 70, "Input",ExpressionUUID->"187250a2-8826-4d61-bbbb-1a982c9d9183",
 CellID->306837658],
Cell[354152, 10320, 1254, 30, 70, "Output",ExpressionUUID->"5d153547-e946-4ffe-8716-99390fdb337b",
 CellID->183346348],
Cell[355409, 10352, 2337, 56, 168, "Output",ExpressionUUID->"03350d66-125f-435a-a9d4-0a8b0cee1b98",
 CellID->2010521038],
Cell[357749, 10410, 2533, 59, 168, "Output",ExpressionUUID->"8095941f-f67f-4940-8e88-406c52bd806a",
 CellID->171900121],
Cell[360285, 10471, 47144, 1645, 248, "Output",ExpressionUUID->"2cf7134a-266f-478f-a2e2-66f78f3da505",
 CellID->759828432]
}, Open  ]],
Cell[CellGroupData[{
Cell[407466, 12121, 728, 19, 70, "Input",ExpressionUUID->"5882deee-91fc-4b45-b503-e84e2fd8f8c6",
 CellID->830388943],
Cell[408197, 12142, 1302, 31, 70, "Output",ExpressionUUID->"acbd523c-5c23-48b0-8443-f1b347128c3c",
 CellID->2087987116],
Cell[409502, 12175, 2102, 49, 168, "Output",ExpressionUUID->"28d29bd5-3018-4f41-9357-e04c9eb8a238",
 CellID->769182985]
}, Open  ]],
Cell[CellGroupData[{
Cell[411641, 12229, 1086, 31, 70, "Input",ExpressionUUID->"4e78e2fe-d568-4189-ac6e-cb8d9695af40",
 CellID->1766752151],
Cell[412730, 12262, 745, 22, 41, "Output",ExpressionUUID->"857361c3-54fd-4142-9c3b-2ba7c8acff79",
 CellID->2110753079],
Cell[413478, 12286, 2974, 77, 166, "Output",ExpressionUUID->"3571023c-5b76-47cc-a073-f1a35ab0e2db",
 CellID->1144633960],
Cell[416455, 12365, 6804, 220, 96, "Output",ExpressionUUID->"046ecab1-6aac-4e73-b248-d60b64e70032",
 CellID->704455894],
Cell[423262, 12587, 785, 26, 52, "Output",ExpressionUUID->"01111949-bcb1-4895-88a0-504bcd4c7fc2",
 CellID->712864547],
Cell[424050, 12615, 6804, 220, 96, "Output",ExpressionUUID->"55b7fec0-e290-4f73-bb6f-df3dcacf9fe2",
 CellID->303174816],
Cell[430857, 12837, 129, 2, 37, "Output",ExpressionUUID->"24a50212-aee2-4374-b45f-c917abd8f915",
 CellID->1627921828]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[431035, 12845, 121, 1, 70, "Section",ExpressionUUID->"6ceec501-85ff-4abe-b085-29d790c2c283",
 CellID->1921589536],
Cell[431159, 12848, 142, 1, 70, "MathCaption",ExpressionUUID->"a0af3d47-dbb8-4bfd-8ff6-c3b441dd9191",
 CellID->1840143414],
Cell[431304, 12851, 148, 3, 70, "Input",ExpressionUUID->"407860a2-85a0-4b30-97fb-017f17ce15fa",
 CellID->1718903328],
Cell[431455, 12856, 184, 4, 70, "Input",ExpressionUUID->"9bd19736-28fb-40cc-8280-11bb16320f4a",
 CellID->1263298518],
Cell[CellGroupData[{
Cell[431664, 12864, 457, 12, 70, "Input",ExpressionUUID->"6ece6ced-a29f-418c-9c9a-317aa489a82d",
 CellID->87374137],
Cell[432124, 12878, 1037, 25, 60, "Output",ExpressionUUID->"8bf62f2c-2fcf-4e7f-9221-aeeda6f6faee",
 CellID->130391091],
Cell[433164, 12905, 368, 11, 41, "Output",ExpressionUUID->"4405d354-021e-42d6-a0f2-bc8d9e172d56",
 CellID->1049746497]
}, Open  ]],
Cell[CellGroupData[{
Cell[433569, 12921, 567, 15, 70, "Input",ExpressionUUID->"55ec63bf-68b7-4cd1-8ff6-ed5845cc7660",
 CellID->2017341787],
Cell[434139, 12938, 1291, 31, 60, "Output",ExpressionUUID->"63cd1788-0de6-4d2e-9ded-14cf41261773",
 CellID->407575183],
Cell[435433, 12971, 368, 11, 41, "Output",ExpressionUUID->"5d6d45d5-7fd6-4511-ab0a-68fd66242e6d",
 CellID->1790750398]
}, Open  ]],
Cell[CellGroupData[{
Cell[435838, 12987, 501, 13, 70, "Input",ExpressionUUID->"72d7acee-6855-4b57-813f-bb49e333dc25",
 CellID->2026449521],
Cell[436342, 13002, 1006, 23, 60, "Output",ExpressionUUID->"a101ec41-af28-45e9-87ea-00fa30a8d1fb",
 CellID->938885266],
Cell[437351, 13027, 174, 4, 41, "Output",ExpressionUUID->"c9056635-7399-4290-9fcd-2c45b7282408",
 CellID->134827506]
}, Open  ]],
Cell[CellGroupData[{
Cell[437562, 13036, 725, 18, 70, "Input",ExpressionUUID->"7ef9e5bc-4c88-422c-ab6e-67e1011ba440",
 CellID->487856212],
Cell[438290, 13056, 1869, 38, 132, "Output",ExpressionUUID->"e20ae4c9-af5f-4436-91df-2d53bf907453",
 CellID->590399788]
}, Open  ]],
Cell[CellGroupData[{
Cell[440196, 13099, 659, 20, 70, "Input",ExpressionUUID->"a8c4ca8e-6e13-43b2-ad25-01ddca4af0a8",
 CellID->125377819],
Cell[440858, 13121, 743, 22, 41, "Output",ExpressionUUID->"d23408b3-3997-4bb3-abfc-9c122360999e",
 CellID->46150232],
Cell[441604, 13145, 955, 31, 41, "Output",ExpressionUUID->"3319cfa9-b330-44e1-860b-2801baebe5cb",
 CellID->405352657]
}, Open  ]],
Cell[442574, 13179, 118, 1, 70, "MathCaption",ExpressionUUID->"d56f238b-6784-4212-99da-092cdf4a037c",
 CellID->690642678],
Cell[CellGroupData[{
Cell[442717, 13184, 582, 18, 70, "Input",ExpressionUUID->"6906b4e7-fc70-4df0-b9b3-72100817254b",
 CellID->482377111],
Cell[443302, 13204, 1666, 37, 96, "Output",ExpressionUUID->"dd826a4b-5c54-4d6f-8fea-eb09b4edfd3d",
 CellID->162208938]
}, Open  ]],
Cell[CellGroupData[{
Cell[445005, 13246, 806, 24, 70, "Input",ExpressionUUID->"3f21bceb-2914-44bf-9e7e-cf66d6e673c6",
 CellID->497852393],
Cell[445814, 13272, 4712, 127, 70, "Output",ExpressionUUID->"8b9f992f-b660-4ce6-94d7-cf272f1b5306",
 CellID->1678949611]
}, Open  ]],
Cell[CellGroupData[{
Cell[450563, 13404, 928, 26, 70, "Input",ExpressionUUID->"f4819f7b-d81f-4a07-9ff7-1e4acc974427",
 CellID->1282052763],
Cell[451494, 13432, 1984, 46, 94, "Output",ExpressionUUID->"9af35d94-d1c2-4ebf-8f82-5274ad13eda6",
 CellID->14401368]
}, Open  ]],
Cell[CellGroupData[{
Cell[453515, 13483, 603, 16, 70, "Input",ExpressionUUID->"1b39fec1-827a-4688-b54d-78e1026574bf",
 CellID->1563056539],
Cell[454121, 13501, 2393, 68, 70, "Output",ExpressionUUID->"e470b003-5cbd-450c-8afa-fd9c9610ef6f",
 CellID->1599041117]
}, Open  ]],
Cell[CellGroupData[{
Cell[456551, 13574, 1399, 40, 70, "Input",ExpressionUUID->"8067d53b-f746-43a0-b11f-ee31616b0aa5",
 CellID->1895739858],
Cell[457953, 13616, 927, 29, 62, "Output",ExpressionUUID->"cd448bd6-fe7b-47a5-96b9-bc750804fadd",
 CellID->885964264],
Cell[458883, 13647, 2402, 68, 70, "Output",ExpressionUUID->"e4b52388-7a75-4d93-818b-a986d9a1f095",
 CellID->1897260397]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[461334, 13721, 126, 1, 70, "Section",ExpressionUUID->"0f62c5bb-4112-4093-9cce-aeede59fea6f",
 CellID->580366830],
Cell[461463, 13724, 148, 3, 70, "Input",ExpressionUUID->"f5cd08a5-af70-457c-8796-873f0caa4823",
 CellID->1518587760],
Cell[461614, 13729, 153, 1, 70, "MathCaption",ExpressionUUID->"05789769-fb28-4501-a473-fa822da061fd",
 CellID->2037836930],
Cell[461770, 13732, 184, 4, 70, "Input",ExpressionUUID->"f8a66bfe-bf20-417f-b9cf-84e8aa66f1c9",
 CellID->1411053746],
Cell[CellGroupData[{
Cell[461979, 13740, 711, 19, 70, "Input",ExpressionUUID->"bfe5b7af-49ff-4eda-91b2-b1bd6935205f",
 CellID->2015591617],
Cell[462693, 13761, 1499, 37, 132, "Output",ExpressionUUID->"81cf5802-f206-439b-952e-863d6b5be7dd",
 CellID->541549489]
}, Open  ]],
Cell[CellGroupData[{
Cell[464229, 13803, 874, 24, 70, "Input",ExpressionUUID->"0e359104-a81e-478d-856a-1f23d6f04145",
 CellID->214937072],
Cell[465106, 13829, 1499, 37, 132, "Output",ExpressionUUID->"d69807ee-8268-4cc4-b579-4f9f5c450143",
 CellID->379034995]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[466654, 13872, 135, 1, 70, "Section",ExpressionUUID->"fa59f56c-208d-470d-9549-e112a4ecff58",
 CellID->87721419],
Cell[466792, 13875, 148, 3, 70, "Input",ExpressionUUID->"3876b9b4-7f50-47a3-9b2a-c93e78df391c",
 CellID->1866561420],
Cell[466943, 13880, 184, 4, 70, "Input",ExpressionUUID->"7f4a3446-5b5f-4788-96f5-04802f98936f",
 CellID->1133410698],
Cell[CellGroupData[{
Cell[467152, 13888, 1142, 33, 70, "Input",ExpressionUUID->"baa8f673-76ee-41f6-bc27-2115a96c2567",
 CellID->1053652396],
Cell[468297, 13923, 691, 20, 55, "Output",ExpressionUUID->"c84aa549-77ff-4582-87f2-bf28d6ee52fd",
 CellID->940534724],
Cell[468991, 13945, 977, 22, 157, "Output",ExpressionUUID->"6f54bb06-0d95-4035-b1bc-930d66b98e29",
 CellID->2087464348],
Cell[469971, 13969, 1234, 28, 157, "Output",ExpressionUUID->"ab82b512-7944-4941-9092-d6295b9a2254",
 CellID->572955797]
}, Open  ]],
Cell[CellGroupData[{
Cell[471242, 14002, 446, 12, 70, "Input",ExpressionUUID->"36b8bad3-39ea-4869-a394-5c987dad2704",
 CellID->916671498],
Cell[471691, 14016, 11361, 339, 71, "Output",ExpressionUUID->"ad801167-e5e5-42d9-a866-e37b5362c2e1",
 CellID->272682391],
Cell[483055, 14357, 11361, 339, 71, "Output",ExpressionUUID->"cd5adc04-5d00-44cb-a7b3-647a7eedbd94",
 CellID->242842839],
Cell[494419, 14698, 129, 2, 37, "Output",ExpressionUUID->"03b3a507-f148-41e0-8072-03444498ce92",
 CellID->1240665773]
}, Open  ]],
Cell[494563, 14703, 247, 4, 70, "MathCaption",ExpressionUUID->"b0ae0c36-e3d5-48aa-bd49-8a02617e49fe",
 CellID->1043555611],
Cell[CellGroupData[{
Cell[494835, 14711, 911, 26, 70, "Input",ExpressionUUID->"47aed5fc-fd80-4cf2-a271-be5888e87e9a",
 CellID->540209028],
Cell[495749, 14739, 496, 14, 39, "Output",ExpressionUUID->"fbfb49a7-c659-425e-87d6-f66dc5d6a5bd",
 CellID->893487173],
Cell[496248, 14755, 770, 15, 121, "Output",ExpressionUUID->"71cd258c-c95e-492b-bb84-88052b89a6a7",
 CellID->1633256787],
Cell[497021, 14772, 1037, 22, 121, "Output",ExpressionUUID->"8d351c89-bd35-4d4e-ba01-64b2414a575e",
 CellID->1010843155]
}, Open  ]],
Cell[CellGroupData[{
Cell[498095, 14799, 374, 10, 70, "Input",ExpressionUUID->"c45b7465-cd8c-42eb-b1ec-a502c68bd30a",
 CellID->2058230597],
Cell[498472, 14811, 3132, 100, 52, "Output",ExpressionUUID->"c9c80600-070b-4f56-b8ae-8baf864d5b50",
 CellID->120348131],
Cell[501607, 14913, 3133, 100, 52, "Output",ExpressionUUID->"e92a9c70-8079-4b05-b47a-e3aca76abf16",
 CellID->1908925890]
}, Open  ]],
Cell[504755, 15016, 147, 1, 70, "MathCaption",ExpressionUUID->"6d883a1c-7306-4e2b-b51e-4b20a6757ab0",
 CellID->854399110],
Cell[CellGroupData[{
Cell[504927, 15021, 1257, 36, 70, "Input",ExpressionUUID->"9c9eb691-273a-43e7-9e42-5fa8e5bd5cd3",
 CellID->1810177928],
Cell[506187, 15059, 764, 22, 66, "Output",ExpressionUUID->"2156cb9f-4e10-4afd-aab7-75d8c7501cde",
 CellID->183515558],
Cell[506954, 15083, 1051, 23, 91, "Output",ExpressionUUID->"d2be259e-a280-4dae-9fa5-0416a7a3d9b7",
 CellID->559466214],
Cell[508008, 15108, 1270, 30, 91, "Output",ExpressionUUID->"ba1dc347-57b6-4ab4-be32-c4dbc5d64d20",
 CellID->1265252132]
}, Open  ]],
Cell[CellGroupData[{
Cell[509315, 15143, 431, 12, 70, "Input",ExpressionUUID->"30c12c08-e56e-4ff1-8562-3f34af8cfe81",
 CellID->1035336409],
Cell[509749, 15157, 2535, 80, 52, "Output",ExpressionUUID->"b9ba3138-d716-4510-8ebd-2fad715afc2f",
 CellID->2071248708],
Cell[512287, 15239, 2534, 80, 52, "Output",ExpressionUUID->"932da5c3-706d-44e0-9125-39f993e246c9",
 CellID->767117486],
Cell[514824, 15321, 129, 2, 37, "Output",ExpressionUUID->"00f50ca4-115f-46e7-a6c3-008ad51c98a4",
 CellID->1599254261]
}, Open  ]],
Cell[514968, 15326, 158, 2, 70, "MathCaption",ExpressionUUID->"4561e3c1-c22c-4a9b-9ed5-3628c219e3d5",
 CellID->1230508662],
Cell[CellGroupData[{
Cell[515151, 15332, 1309, 37, 70, "Input",ExpressionUUID->"6650df1c-a37a-4ad5-9df1-d573df926233",
 CellID->891561624],
Cell[516463, 15371, 924, 26, 100, "Output",ExpressionUUID->"84a31b75-cee6-4517-93c4-5b00ae5fcc31",
 CellID->1108503766],
Cell[517390, 15399, 1072, 23, 132, "Output",ExpressionUUID->"d1dc8b36-4721-45f1-91f0-d5515ba03441",
 CellID->1202157437],
Cell[518465, 15424, 1322, 30, 132, "Output",ExpressionUUID->"04976ba5-932f-4155-a332-766786194967",
 CellID->1133892683]
}, Open  ]],
Cell[CellGroupData[{
Cell[519824, 15459, 296, 7, 70, "Input",ExpressionUUID->"090e571f-5d68-4a59-9f44-077b8fb0c936",
 CellID->999620760],
Cell[520123, 15468, 2186, 72, 52, "Output",ExpressionUUID->"9d1115d6-da4f-4d72-b750-e92f0ce71808",
 CellID->523519006],
Cell[522312, 15542, 2186, 72, 52, "Output",ExpressionUUID->"9167718d-112d-4a9b-ac7e-c9f4bbf2be9f",
 CellID->543432083]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[524547, 15620, 118, 1, 70, "Section",ExpressionUUID->"365b2a37-e0cc-4f51-ac23-58699e73e836",
 CellID->462801707],
Cell[524668, 15623, 917, 25, 70, "MathCaption",ExpressionUUID->"a162c1ab-b1dc-495f-b9a0-68cc085c3f88",
 CellID->122520115],
Cell[525588, 15650, 148, 3, 70, "Input",ExpressionUUID->"f9c0191f-627f-4132-be8a-26aa4547f050",
 CellID->1179364979],
Cell[525739, 15655, 184, 4, 70, "Input",ExpressionUUID->"f4e6f80a-7e56-49c5-8123-488c78e95009",
 CellID->1480097392],
Cell[CellGroupData[{
Cell[525948, 15663, 312, 8, 70, "Input",ExpressionUUID->"bf33e064-6753-4c13-8209-d9ec6b0e4ce0",
 CellID->1693784143],
Cell[526263, 15673, 598, 24, 37, "Output",ExpressionUUID->"a9938569-b95a-4720-aac0-d24a527744a8",
 CellID->1859793306]
}, Open  ]],
Cell[526876, 15700, 1873, 54, 70, "Input",ExpressionUUID->"8fd58481-86c4-4649-99c5-e79574cf385d",
 CellID->1636787114],
Cell[CellGroupData[{
Cell[528774, 15758, 1069, 33, 70, "Input",ExpressionUUID->"8e643892-f4a3-4da3-889d-f5a62263817b",
 CellID->215506928],
Cell[529846, 15793, 4571, 112, 186, "Output",ExpressionUUID->"b630e8a1-3530-4e7f-9dcb-fd4448690682",
 CellID->783381962]
}, Open  ]],
Cell[CellGroupData[{
Cell[534454, 15910, 1069, 33, 70, "Input",ExpressionUUID->"56bc9246-355a-4cb3-94af-9791eb7838b7",
 CellID->1371487384],
Cell[535526, 15945, 4572, 112, 186, "Output",ExpressionUUID->"82d676dd-f909-4f2f-b73f-68afa3bdab75",
 CellID->1574674439]
}, Open  ]],
Cell[540113, 16060, 146, 1, 70, "MathCaption",ExpressionUUID->"78a133f9-2b4c-4c05-a44d-b17c83859254",
 CellID->1421446148],
Cell[CellGroupData[{
Cell[540284, 16065, 722, 23, 70, "Input",ExpressionUUID->"de24b6ee-ecb5-4cc0-b33d-fb621c5240f6",
 CellID->2056467464],
Cell[541009, 16090, 183, 4, 37, "Output",ExpressionUUID->"406fb2e6-282b-4c67-879e-2745b0582e7b",
 CellID->1665338355],
Cell[541195, 16096, 185, 4, 37, "Output",ExpressionUUID->"dbede5d0-415f-47ff-a7c1-f9fcc06477af",
 CellID->1187361134],
Cell[541383, 16102, 146, 3, 37, "Output",ExpressionUUID->"f938b58a-c34b-4230-ae20-3992d9074226",
 CellID->1560531214]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[541578, 16111, 132, 1, 70, "Section",ExpressionUUID->"be7c647f-2e0b-482c-80c5-17f695b63be4",
 CellID->991141748],
Cell[541713, 16114, 1037, 32, 70, "MathCaption",ExpressionUUID->"191c48e0-e03a-4622-bb4b-cdf8975f4768",
 CellID->623127415],
Cell[542753, 16148, 148, 3, 70, "Input",ExpressionUUID->"2edfd8bb-d552-4f7b-af29-b5b01deaff89",
 CellID->1624724280],
Cell[542904, 16153, 184, 4, 70, "Input",ExpressionUUID->"21e3bb53-4f2b-46a5-acab-858528d8fe8b",
 CellID->1455738726],
Cell[CellGroupData[{
Cell[543113, 16161, 1797, 49, 70, "Input",ExpressionUUID->"46416092-14b4-4f0c-845b-4be1682d5430",
 CellID->319577611],
Cell[544913, 16212, 3589, 86, 128, "Output",ExpressionUUID->"7f27fcdb-95d9-4fa8-914c-817309abc91e",
 CellID->1329875132]
}, Open  ]],
Cell[CellGroupData[{
Cell[548539, 16303, 1243, 37, 70, "Input",ExpressionUUID->"c3bb46d0-ecc4-4f87-8391-62af0e6f3e08",
 CellID->195457935],
Cell[549785, 16342, 6264, 211, 234, "Output",ExpressionUUID->"a71204da-8a93-4ef2-99e3-2129f0872bf2",
 CellID->383935460],
Cell[556052, 16555, 989, 34, 68, "Output",ExpressionUUID->"8314fff5-300a-45aa-b0c6-2011039a8328",
 CellID->1762400632],
Cell[557044, 16591, 6264, 211, 234, "Output",ExpressionUUID->"e19c9546-05b7-48f4-9247-e249265cb367",
 CellID->425478953],
Cell[563311, 16804, 7299, 242, 260, "Output",ExpressionUUID->"747562d7-8696-418e-9ef4-3d13b9005060",
 CellID->2051702208],
Cell[570613, 17048, 7298, 242, 260, "Output",ExpressionUUID->"3f6fd2e9-1431-4f7b-99f1-ad77e8674202",
 CellID->814089977],
Cell[577914, 17292, 173, 4, 37, "Output",ExpressionUUID->"610b7d27-d348-410c-948d-a6d731d25eb0",
 CellID->791928402]
}, Open  ]],
Cell[578102, 17299, 169, 3, 70, "MathCaption",ExpressionUUID->"1e7627a1-95ff-4cb5-8809-0b6d54020b20",
 CellID->1155670419],
Cell[CellGroupData[{
Cell[578296, 17306, 468, 13, 70, "Input",ExpressionUUID->"036ad411-5bcf-409b-b4dd-3ab18443b792",
 CellID->1510628665],
Cell[578767, 17321, 1687, 47, 70, "Output",ExpressionUUID->"9d1af556-4bdb-4875-a432-5a656275b499",
 CellID->340444347]
}, Open  ]],
Cell[CellGroupData[{
Cell[580491, 17373, 474, 13, 70, "Input",ExpressionUUID->"dfc616f3-8cac-4067-b7cc-c1d82424e990",
 CellID->643738394],
Cell[580968, 17388, 2389, 68, 70, "Output",ExpressionUUID->"a5f1c6fa-63d7-4840-ba6c-e40e24d1e19a",
 CellID->928326472]
}, Open  ]]
}, Open  ]],
Cell[583384, 17460, 729, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"1236bb32-fa31-4795-8b73-8e373a1854ce"],
Cell[584116, 17480, 2742, 70, 70, "RelatedTutorialsSection",ExpressionUUID->"3b21d8a2-fd7d-49e6-bc0d-1c97a8ea22c8"],
Cell[586861, 17552, 3019, 81, 70, "TutorialRelatedLinksSection",ExpressionUUID->"fc1348a5-f823-4fbc-b1ed-cd6d3a19ca94"],
Cell[589883, 17635, 78, 0, 70, "FooterCell",ExpressionUUID->"6ebdce87-f341-4dd6-9eb1-c6c5aca1cfbf"]
}
]
*)

(* End of internal cache information *)

