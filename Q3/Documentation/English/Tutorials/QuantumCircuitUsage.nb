(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    658751,      19405]
NotebookOptionsPosition[    611764,      18462]
NotebookOutlinePosition[    614177,      18521]
CellTagsIndexPosition[    614134,      18518]
WindowTitle->QuantumCircuit Usage Examples
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 TUTORIAL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumTeleportation"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum Fourier \
Transform: Semiclassical Implementation\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuantumFourierTransformSemiclassical"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"RelatedTutorialsSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/QuissoPackageGuide"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialMoreAboutSection"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Functions",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Functions", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"CNOT\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/CNOT"], "\<\"ControlledU\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/ControlledU"], "\<\"CZ\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/CZ"], "\<\"EulerRotation\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/EulerRotation"], "\<\"Phase\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/Phase"], "\<\"QuantumCircuit\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/QuantumCircuit"], "\<\"Rotation\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/Rotation"], "\<\"SWAP\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/SWAP"], "\<\"Toffoli\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/Toffoli"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"TutorialFunction"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/tutorial/QuantumCircuitUsage\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/tutorial/QuantumCircuitUsage"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/tutorial/\
QuantumCircuitUsage.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$195904], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/tutorial/QuantumCircuitUsage", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell["QuantumCircuit Usage Examples", "Title",
 CellID->509267359],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Elementary usage"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#1868432623", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples with Measurements"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#1921589536", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Grouping Circuit Elements With { }"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#188399535", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples with Controlled-U Gates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#580366830", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Automatic Conversion to Operator Expressions"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#729173090", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples with Arbitrary Controlled-U Gates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#87721419", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["More Complicated Gates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#2136908654", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Matrix on QuantumCircuit"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#462801707", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["With Inputs and Outputs"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#94058740", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Matrix on QuantumCircuit: With Measure"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#991141748", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Example with GraphStates"], 
      "paclet:Q3/tutorial/QuantumCircuitUsage#175892259", 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{128, 128, 128, 32}, {128, 128, 128, 
          16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 
          128, 128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 
          128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 16}, {128, 128, 
          128, 143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 
          128, 64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 
          128, 32}}, {{128, 128, 128, 32}, {128, 128, 128, 16}, {128, 128, 
          128, 16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 
          128, 127}, {128, 128, 128, 0}, {128, 128, 128, 48}}, {{128, 128, 
          128, 48}, {128, 128, 128, 239}, {128, 128, 128, 112}, {128, 128, 
          128, 0}, {128, 128, 128, 16}, {128, 128, 128, 16}, {128, 128, 128, 
          143}, {128, 128, 128, 239}}, {{128, 128, 128, 0}, {128, 128, 128, 
          64}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          112}, {128, 128, 128, 223}, {128, 128, 128, 191}, {128, 128, 128, 
          32}}, {{128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 
          16}, {128, 128, 128, 175}, {128, 128, 128, 255}, {128, 128, 128, 
          127}, {128, 128, 128, 0}, {128, 128, 128, 0}}, {{128, 128, 128, 
          0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 128, 128, 0}, {
          128, 128, 128, 16}, {128, 128, 128, 0}, {128, 128, 128, 0}, {128, 
          128, 128, 0}}}], {{0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> 
         RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}], 
      GraphicsBox[
       TagBox[
        RasterBox[
        RawArray["UnsignedInteger8",{{{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 48}, {229, 
          95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 239}}, {{
          229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {229, 95, 
          28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95, 28, 
          191}, {229, 95, 28, 32}}, {{229, 95, 28, 32}, {229, 95, 28, 16}, {
          229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229, 95, 
          28, 127}, {229, 95, 28, 0}, {229, 95, 28, 48}}, {{229, 95, 28, 
          48}, {229, 95, 28, 239}, {229, 95, 28, 112}, {229, 95, 28, 0}, {229,
           95, 28, 16}, {229, 95, 28, 16}, {229, 95, 28, 143}, {229, 95, 28, 
          239}}, {{229, 95, 28, 0}, {229, 95, 28, 64}, {229, 95, 28, 223}, {
          229, 95, 28, 191}, {229, 95, 28, 112}, {229, 95, 28, 223}, {229, 95,
           28, 191}, {229, 95, 28, 32}}, {{229, 95, 28, 0}, {229, 95, 28, 
          0}, {229, 95, 28, 16}, {229, 95, 28, 175}, {229, 95, 28, 255}, {229,
           95, 28, 127}, {229, 95, 28, 0}, {229, 95, 28, 0}}, {{229, 95, 28, 
          0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 
          28, 16}, {229, 95, 28, 0}, {229, 95, 28, 0}, {229, 95, 28, 0}}}], {{
          0, 8.}, {8., 0}}, {0, 255}, ColorFunction -> RGBColor], 
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
         Automatic, MetaInformation -> 
         Association[{
           "XMP" -> Association[{
              "XMPBasicSchema" -> 
               Association[{
                 "CreatorTool" -> "Adobe Photoshop CS5 Macintosh"}], 
               "XMPMediaManagementSchema" -> 
               Association[{
                 "InstanceID" -> "xmp.iid:AA75CDBA059711E28ADB8BB95CCA5C5A", 
                  "DocumentID" -> "xmp.did:AA75CDBB059711E28ADB8BB95CCA5C5A", 
                  "DerivedFrom" -> 
                  Association[{
                    "Reference" -> 
                    Association[{
                    "InstanceID" -> 
                    "xmp.iid:AA75CDB8059711E28ADB8BB95CCA5C5A", "DocumentID" -> 
                    "xmp.did:AA75CDB9059711E28ADB8BB95CCA5C5A"}]}]}]}], 
            "Comments" -> Association[{"Software" -> "Adobe ImageReady"}]}]], 
        Selectable -> False], DefaultBaseStyle -> "ImageGraphics", 
       ImageSizeRaw -> {8., 8.}, PlotRange -> {{0, 8.}, {0, 8.}}, 
       ImageSize -> {8, 9}]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TutorialJumpBox"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " provides the graphical representation of the quantum circuits."
}], "Text",
 CellID->1534169418],

Cell[BoxData[GridBox[{
   {
    ButtonBox["QuantumCircuit",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/QuantumCircuit"], Cell[
    "Graphical representation of quantum circuit", "TableText"]},
   {
    ButtonBox["Phase",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/Phase"], Cell[
    "Single-qubit phase gate (relative phase)", "TableText"]},
   {
    ButtonBox["Rotation",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/Rotation"], Cell[
    "Single-qubit rotation gate", "TableText"]},
   {
    ButtonBox["EulerRotation",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/EulerRotation"], Cell[
    "Single-qubit rotation gate specified by Euler angles", "TableText"]},
   {
    ButtonBox["CNOT",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/CNOT"], Cell[
    "Two-qubit controlled NOT gate", "TableText"]},
   {
    ButtonBox["CZ",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/CZ"], Cell[
    "Two-qubit controlled Z gate", "TableText"]},
   {
    ButtonBox["SWAP",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/SWAP"], Cell[
    "Two-qubit SWAP gate", "TableText"]},
   {
    ButtonBox["Toffoli",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/Toffoli"], Cell[
    "Three-qubit Toffoli gate", "TableText"]},
   {
    ButtonBox["ControlledU",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/ControlledU"], Cell[
    "Multi-qubit controlled-U gate", "TableText"]}
  }]], "DefinitionBox",
 CellID->2096742444],

Cell["Elements in the quantum circuit representation.", "Caption",
 CellID->1891092685],

Cell[CellGroupData[{

Cell["Elementary usage", "Section",
 CellID->1868432623],

Cell["First load the application (the collection of packages).", "MathCaption",
 CellID->836781195],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[190]:=",
 CellID->841456058],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " works for ",
 StyleBox["labeled",
  FontSlant->"Italic"],
 " qubits."
}], "MathCaption",
 CellID->1561112771],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[191]:=",
 CellID->644371895],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " is a collection of quantum logic gates. Usually, it is displayed in a \
graphical form."
}], "MathCaption",
 CellID->121218086],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[192]:=",
 CellID->359983136],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[192]=",
 CellID->1725400398]
}, Open  ]],

Cell["\<\
Graphics directives can be used to change the style of labels of the quantum \
logic gates.\
\>", "MathCaption",
 CellID->648571534],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"Blue", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[193]:=",
 CellID->1027099769],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[193]=",
 CellID->1739871705]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vec", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[194]:=",
 CellID->1753671624],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[194]=",
 CellID->182906733],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[195]=",
 CellID->1064362674]
}, Open  ]],

Cell["\<\
Here are all single-qubit gates displayed in a quantum circuit model.\
\>", "MathCaption",
 CellID->1179582981],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"5", ",", "7"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"6", ",", "8"}], "]"}]}], "}"}], ",", "Null"}], "]"}]], "Input",\

 CellLabel->"In[198]:=",
 CellID->1498964105],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
    0, -4}, {2, -4}}, {{0, -5}, {2, -5}}, {{0, -6}, {2, -6}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"Y\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox["\<\"S\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
      StyleBox["\<\"T\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -6}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[198]=",
 CellID->1195477909]
}, Open  ]],

Cell[TextData[{
 StyleBox["\[OpenCurlyDoubleQuote]Spacer\[CloseCurlyDoubleQuote]", "Input"],
 " is a special form to represent a time slice for no operation. It is useful \
for graphically extend certain time span. ",
 StyleBox["\[OpenCurlyDoubleQuote]Separator\[CloseCurlyDoubleQuote]", "Input"],
 " puts a vertical dotted line to indicate a particular time slice."
}], "MathCaption",
 CellID->1884848111],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", "\"\<Separator\>\"", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[199]:=",
 CellID->1110924680],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[199]=",
 CellID->493010259],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[200]=",
 CellID->1031512887],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{2, -2.5}, {
       2, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[201]=",
 CellID->1609578]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpressionFor"]], "paclet:Q3/ref/ExpressionFor"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Elaborate"]], "paclet:Q3/ref/Elaborate"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " converts ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " to usual operator expressions in terms of the Pauli operators."
}], "MathCaption",
 CellID->1581832416],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Blue", ",", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExpressionFor", "[", "qc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "qc", "]"}]}], "Input",
 CellLabel->"In[206]:=",
 CellID->9865852],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], 
   {RGBColor[0, 0, 1], LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[206]=",
 CellID->1538359658],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[207]=",
 CellID->1655145773],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[208]=",
 CellID->1679327220]
}, Open  ]],

Cell["Here is another example.", "MathCaption",
 CellID->1800711653],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"Blue", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "\"\<Separator\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "2"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", " ", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[210]:=",
 CellID->599552766],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}, {{
    0, -4}, {7, -4}}}], 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-9, 2]}, {2, Rational[-1, 2]}}, {{
        2, -4.5}, {2, -0.5}}]]}, 
    {RGBColor[1, 0, 0], {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
       StyleBox["\<\"Y\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3, -3}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3, -4}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
    {RGBColor[0, 0, 1], LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[210]=",
 CellID->1056297237]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], "**", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], "**", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "//", "Garner"}]}]], "Input",
 CellLabel->"In[216]:=",
 CellID->1534929666],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[216]=",
 CellID->438566987]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "expr"}], "//", "Garner"}]}], "Input",
 CellLabel->"In[223]:=",
 CellID->474527143],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[223]=",
 CellID->806876755],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[224]=",
 CellID->1965874127]
}, Open  ]],

Cell["You can extend existing QuantumCircuit in a simple manner.", \
"MathCaption",
 CellID->1618406437],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "6"}], "]"}], ",", "qc"}], "]"}]}], "Input",
 CellLabel->"In[225]:=",
 CellID->529113757],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[225]=",
 CellID->764288206],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[226]=",
 CellID->1292185535]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "v", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "6"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[227]:=",
 CellID->1794887271],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], 
   InsetBox[
    StyleBox[
     TemplateBox[{"1"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.16000000000000003`],
     FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[230]=",
 CellID->1515942851]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "1", "]"}], "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", "nn", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", 
   RowBox[{"2", ",", "2"}], "]"}], "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", 
   RowBox[{"2", ",", "3"}], "]"}], "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"nn", ",", "6"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "2"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[231]:=",
 CellID->1274883332],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[232]=",
 CellID->1722276882],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[233]=",
 CellID->375477861],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[234]=",
 CellID->1349454941],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[235]=",
 CellID->714397420],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[236]=",
 CellID->296367563]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[237]:=",
 CellID->81528505],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[238]=",
 CellID->1713878821]
}, Open  ]],

Cell["You can give custom labels.", "MathCaption",
 CellID->468836632],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{
      "\"\<Label\>\"", "\[Rule]", "\"\<|m\[RightAngleBracket]\>\""}]}], "}"}],
     ",", 
    RowBox[{"S", "[", 
     RowBox[{"nn", ",", "6"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "2"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Elaborate", "@", "qc"}]}], ";", 
  RowBox[{"LogicalForm", "@", "expr"}]}]}], "Input",
 CellLabel->"In[239]:=",
 CellID->619773181],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox["\<\"|m\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|m\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|m\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[239]=",
 CellID->310935002],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[240]=",
 CellID->1056865463]
}, Open  ]],

Cell["\<\
If the custom label is a list, then its elements are rotated.\
\>", "MathCaption",
 CellID->251997855],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<|\!\(\*SubscriptBox[\(m\), \(0\)]\)\[RightAngleBracket]\>\"", 
         ",", "\"\<|\!\(\*SubscriptBox[\(m\), \
\(1\)]\)\[RightAngleBracket]\>\""}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"nn", ",", "6"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "2"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Elaborate", "@", "qc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "@", "expr"}]}], "Input",
 CellLabel->"In[241]:=",
 CellID->490197101],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(m\\), \\(0\\)]\\)\
\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)\
\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(m\\), \\(0\\)]\\)\
\[RightAngleBracket]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[241]=",
 CellID->1006626579],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[243]=",
 CellID->496742187]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "1", "]"}], "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", "nn", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "2", "]"}], "=", 
  RowBox[{"ProductState", "[", 
   RowBox[{
    RowBox[{"S", "[", "nn", "]"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"v", "[", "1", "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "6"}], "]"}], ",", 
   RowBox[{"v", "[", "2", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.65", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[244]:=",
 CellID->945271287],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[245]=",
 CellID->550868847],

Cell[BoxData[
 RowBox[{
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      TemplateBox[{"1"},
       "Ket"]}], ")"}], 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]]],
   DisplayForm], "\[CircleTimes]", 
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      TemplateBox[{"1"},
       "Ket"]}], ")"}], 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]]],
   DisplayForm], "\[CircleTimes]", 
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      TemplateBox[{"1"},
       "Ket"]}], ")"}], 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]]],
   DisplayForm]}]], "Output",
 CellLabel->"Out[246]=",
 CellID->650709312],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -3}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 72}, {5, 5}},
  ImageSize->167.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[247]=",
 CellID->1484676260]
}, Open  ]],

Cell["Controlled-unitary gates", "MathCaption",
 CellID->1043674246],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "3"}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<R\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[248]:=",
 CellID->386623826],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[248]=",
 CellID->549138186],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "16"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox["3"]}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "-", 
       RowBox[{"3", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      SqrtBox["3"]}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "-", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "-", 
       RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"6", "+", "\[ImaginaryI]"}], ")"}], " ", 
      SqrtBox["3"]}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      SqrtBox["3"]}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[249]=",
 CellID->1628260943],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "-", 
         SqrtBox["3"]}], ")"}]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{5}, {6}, {5}, {6}, {7}, {8}, {
       7}, {8}, {1}, {2}, {1}, {2}, {3}, {4}, {3}, {4}}}, {
      Rational[1, 2] (Complex[0, -1] + 3^Rational[1, 2]), 0, 0, 
       Rational[1, 2] (Complex[0, -1] + 3^Rational[1, 2]), 
       Rational[1, 4] (3 + Complex[0, 1] 3^Rational[1, 2]), 
       Rational[1, 4] (Complex[0, -1] - 3^Rational[1, 2]), 
       Rational[1, 4] (Complex[0, 1] + 3^Rational[1, 2]), 
       Rational[1, 4] (3 + Complex[0, 1] 3^Rational[1, 2]), 
       Rational[1, 2] (Complex[0, -1] + 3^Rational[1, 2]), 0, 0, 
       Rational[1, 2] (Complex[0, -1] + 3^Rational[1, 2]), 
       Rational[1, 2] (Complex[0, 1] + 3^Rational[1, 2]), 0, 0, 
       Rational[1, 2] (Complex[0, 1] + 3^Rational[1, 2])}}]]]]], "Output",
 CellLabel->"Out[251]//MatrixForm=",
 CellID->797555280]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grouping Circuit Elements With { }", "Section",
 CellID->188399535],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[276]:=",
 CellID->284388437],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[277]:=",
 CellID->1565346084],

Cell[TextData[{
 "In ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 ", ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["List"]], "paclet:ref/List"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " (",
 Cell[BoxData[
  RowBox[{"{", 
   StyleBox["\[Ellipsis]", "TR"], "}"}]], "InlineFormula"],
 ") can carry  two special meanings. First, it can put different quantum \
gates at the same time slice. Second, it can give options to particular \
quantum circuit elements."
}], "MathCaption",
 CellID->92524695],

Cell[CellGroupData[{

Cell["\<\
Putting different quantum logic gates at the same time slice.\
\>", "Subsection",
 CellID->2096958038],

Cell["\<\
Here all quantum logic gates are displayed at different time slices (along \
the horizontal direction).\
\>", "MathCaption",
 CellID->1219613749],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "6"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "6"}], "]"}], ",", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "6"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[252]:=",
 CellID->316868828],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    LineBox[{{{2.91, -1.09}, {3.09, -0.91}}, {{2.91, -0.91}, {3.09, -1.09}}}],
     LineBox[{{{2.91, -2.09}, {3.09, -1.91}}, {{2.91, -1.91}, {
     3.09, -2.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[252]=",
 CellID->402818101]
}, Open  ]],

Cell["\<\
Here the first two gates are displayed at the same time slice while others \
are separated long the time (horizontal) direction.\
\>", "MathCaption",
 CellID->1646341244],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}]}], "}"}], ",", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[253]:=",
 CellID->1877979960],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], 
    LineBox[{{{1.91, -1.09}, {2.09, -0.91}}, {{1.91, -0.91}, {2.09, -1.09}}}],
     LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {
     2.09, -2.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[253]=",
 CellID->1254173474]
}, Open  ]],

Cell[TextData[{
 StyleBox["WRONG USAGE",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 ": Here the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Hadamard"]], "paclet:Q3/ref/Hadamard"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " gate and the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:Q3/ref/SWAP"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " gate are displayed at the same time slice. First of all, it results in a \
bad graphical representation. But, more importantly, it is physically wrong \
because the Hadamard gate and ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:Q3/ref/SWAP"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " do not commute with each other. Only mutually commuting quantum logic \
gates are allowed to be grouped together in ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->248231530],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", "Red", ",", 
     RowBox[{"SWAP", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[254]:=",
 CellID->1614082236],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {RGBColor[1, 0, 0], LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {
      1.09, -1.09}}}], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[254]=",
 CellID->1290885160]
}, Open  ]],

Cell[TextData[{
 StyleBox["WRONG USAGE",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 ": It is not allowed to group vectors with operators as they are completely \
different in character. For example, while the circuit model ",
 StyleBox["qc1", "Input"],
 " is okay, ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 " complains about ",
 StyleBox["qc2", "Input"],
 "."
}], "MathCaption",
 CellID->439409635],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vec", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"vec", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vec", ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[255]:=",
 CellID->2108957059],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[255]=",
 CellID->662098263],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[256]=",
 CellID->1772731134],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.1, -2}, 
      ImageScaled[{1, Rational[1, 2]}]]}, $CellContext`S[1, 3]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[257]=",
 CellID->104050660]
}, Open  ]],

Cell["\<\
Here you can see grouping two vectors is allowed and generates an expected \
result.\
\>", "MathCaption",
 CellID->711331671],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "w"}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[258]:=",
 CellID->309931648],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[260]=",
 CellID->588820732]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "w", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", 
      RowBox[{"Ket", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[261]:=",
 CellID->973854571],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"\[Alpha]"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"\[Alpha]"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[261]=",
 CellID->782793063]
}, Open  ]],

Cell[TextData[{
 StyleBox["KNOWN ISSUE",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 ": This grouping feature does not work as expected when there is only a \
single grouping. For example, here two gates are supposed to be displayed at \
the same time slice, but apparently not. The bug will be fixed in a later \
release of ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/guide/Q3"],
 "."
}], "MathCaption",
 CellID->520661807],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "}"}], "]"}]], "Input",
 CellLabel->"In[262]:=",
 CellID->1914612371],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[262]=",
 CellID->1138496520]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[263]:=",
 CellID->929609607],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[263]=",
 CellID->1640180285]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Giving options to particular quantum logic gates or input/output states\
\>", "Subsection",
 CellID->1162686366],

Cell["This is one of the simplest cases.", "MathCaption",
 CellID->1316049309],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[264]:=",
 CellID->1906655910],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[264]=",
 CellID->454629454]
}, Open  ]],

Cell["\<\
In this example, the second and only the second gate is shown in red color.\
\>", "MathCaption",
 CellID->325334843],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"Red", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[265]:=",
 CellID->409341039],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {RGBColor[1, 0, 0], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[265]=",
 CellID->192546404]
}, Open  ]],

Cell["\<\
Unlike the example above, here all gates are displayed in red.\
\>", "MathCaption",
 CellID->1860334053],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"Red", ",", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[266]:=",
 CellID->1420012098],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], 
   {RGBColor[1, 0, 0], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[266]=",
 CellID->416535132]
}, Open  ]],

Cell["\<\
Here the second gate takes an option and it is labeled with \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] (not the default label \
\[OpenCurlyDoubleQuote]Z\[CloseCurlyDoubleQuote]).\
\>", "MathCaption",
 CellID->1089755652],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[267]:=",
 CellID->1782701548],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[267]=",
 CellID->1008271144]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Automatic Conversion to Operator Expressions", "Section",
 CellID->729173090],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[278]:=",
 CellID->2103953529],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[279]:=",
 CellID->1154931458],

Cell["Consider an example of the entangler circuit model.", "MathCaption",
 CellID->898557820],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "6"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc1", ",", "qc2"}], "]"}]}]}], "Input",
 CellLabel->"In[280]:=",
 CellID->1173319708],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[280]=",
 CellID->692202459],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[281]=",
 CellID->927812614],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[282]=",
 CellID->867842631]
}, Open  ]],

Cell["\<\
This is the usual way to convert quantum circuit models into operator \
expressions.\
\>", "MathCaption",
 CellID->1246009635],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op1", "=", 
  RowBox[{"Elaborate", "[", "qc1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op2", "=", 
  RowBox[{"Elaborate", "[", "qc2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[283]:=",
 CellID->417857018],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[283]=",
 CellID->150515553],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[284]=",
 CellID->2126646752],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[285]=",
 CellID->1981623843]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "-", 
  RowBox[{"op2", "**", "op1"}]}]], "Input",
 CellLabel->"In[286]:=",
 CellID->1403589449],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[286]=",
 CellID->913101770]
}, Open  ]],

Cell["\<\
The above can also be achieve directly regarding the quantum circuit models \
as operators.\
\>", "MathCaption",
 CellID->1276498133],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"qc2", "**", "qc1", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Notice", " ", "the", " ", 
     RowBox[{"order", "."}]}], " ", "*)"}]}]}]], "Input",
 CellLabel->"In[287]:=",
 CellID->438798576],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[287]=",
 CellID->1620636825]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "-", "new"}]], "Input",
 CellLabel->"In[288]:=",
 CellID->1266974318],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[288]=",
 CellID->835282285]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["More Complicated Gates", "Section",
 CellID->2136908654],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[68]:=",
 CellID->335909506],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[69]:=",
 CellID->210689171],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat1", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat2", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mat2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat1", "-", "mat2"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[289]:=",
 CellID->2079061645],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {LineBox[{{3, -2}, {3, -3}}], 
    DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {4, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[289]=",
 CellID->232747618],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[290]=",
 CellID->1221494539],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.008853`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[291]=",
 CellID->1862535300],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.008944`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[292]=",
 CellID->1909148428],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {
       5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {
       1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}}}, {
      Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[293]//MatrixForm=",
 CellID->1504459569],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {
       5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {
       1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[294]//MatrixForm=",
 CellID->979516405]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "Red", ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[295]:=",
 CellID->408544247],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, 
   {RGBColor[1, 0, 0], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[295]=",
 CellID->197030547]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], "**", 
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "//", 
   "Elaborate"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "expr"}], "//", "Garner"}]}], "Input",
 CellLabel->"In[296]:=",
 CellID->1307807621],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[296]=",
 CellID->453115970],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[297]=",
 CellID->543095528],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[298]=",
 CellID->1001039346]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Blue", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Spacer\>\"", ",", "\"\<Spacer\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "2"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", " ", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"5", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Opts", "\[Rule]", "\"\<A\>\""}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[299]:=",
 CellID->1937335979],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {9, -4}}, {{0, -5}, {9, -5}}}], 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {RGBColor[1, 0, 0], {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {4, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
       StyleBox["\<\"Y\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {4, -3}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {4, -4}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
    {RGBColor[0, 0, 1], LineBox[{{5, -1}, {5, -2}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -2}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -2}, {5.266666666666667, -2}}, {{
         5, -2.2666666666666666`}, {5, -1.7333333333333334`}}}]}}, {
     LineBox[{{6, -1}, {6, -3}}], 
     DiskBox[{6, -1}, 0.09], {CircleBox[{6, -3}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -3}, {6.266666666666667, -3}}, {{
         6, -3.2666666666666666`}, {6, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -5.4}, {7.4, -4.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->370.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[299]=",
 CellID->241172493]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Multiply", "@@", 
    RowBox[{"Reverse", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "1"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"4", ",", "1"}], "]"}], ",", 
       RowBox[{"CNOT", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"CNOT", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"5", ",", "1"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "6"}], "]"}]}], "}"}]}]}], "//", 
   "Elaborate"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "expr"}], "//", "Garner"}]}], "Input",
 CellLabel->"In[300]:=",
 CellID->1219417588],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"5"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"5"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[300]=",
 CellID->1463629310],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"5"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"5"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"5"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[301]=",
 CellID->1940120432],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[302]=",
 CellID->212404576]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With Inputs and Outputs", "Section",
 CellID->94058740],

Cell["You can specifies input and output states.", "MathCaption",
 CellID->1881403532],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[303]:=",
 CellID->938466843],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "a", ",", "b", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[304]:=",
 CellID->393774061],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v1", ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "1"}], "]"}], ",", "v2", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "]"}]}]}], "Input",
 CellLabel->"In[306]:=",
 CellID->1763526820],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], InsetBox[
    StyleBox[
     RowBox[{
      TemplateBox[{
        TemplateBox[{"0"}, "RowDefault"]},
       "Ket"], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}]}],
     StripOnInput->False,
     FontSize->Scaled[0.16000000000000003`],
     FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, InsetBox[
    StyleBox[
     RowBox[{
      TemplateBox[{
        TemplateBox[{"0"}, "RowDefault"]},
       "Ket"], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       TemplateBox[{
         TemplateBox[{"1"}, "RowDefault"]},
        "Ket"]}]}],
     StripOnInput->False,
     FontSize->Scaled[0.16000000000000003`],
     FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]]},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->216,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[308]=",
 CellID->1296461367]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v3", "=", 
   RowBox[{"LogicalForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "+", 
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v4", "=", 
   RowBox[{"LogicalForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"v1", ",", "v4", ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1"}], "]"}], ",", "v3",
     ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<UnitLength\>\"", "\[Rule]", "42"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[309]:=",
 CellID->502407381],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], {
     LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -2.}, {-0.1, -2}}], InsetBox[
      StyleBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"0", "0"}, "RowDefault"]},
         "Ket"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"1", "0"}, "RowDefault"]},
          "Ket"]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.30000000000000004, -2.5}, 
      ImageScaled[{1, Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2.1, -2}, {2.2, -2.}, {2.2, -1.}, {2.1, -1}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0", "0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"0", "1"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.3000000000000003, -1.5}, 
     ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{84, 84}, {5, 5}},
  ImageSize->252,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[311]=",
 CellID->1950332730]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"expr", ",", "vec", ",", "mat"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "3"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}], "+", " ", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "[", "0", "]"}], "=", 
   RowBox[{"ThePauli", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "2", "]"}], "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{
     RowBox[{"mat", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"v1", ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"S", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "[", "1", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"expr", "[", "1", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}], ",", "v1"}], 
     "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "[", "2", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", "qc", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "1", "]"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec", "[", "0", "]"}], "=", 
   RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "0", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[386]:=",
 CellID->1381993784],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
    0, -4}, {5, -4}}}], {
    LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -2.}, {-0.1, -2}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"1", "0"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"0", "1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.30000000000000004, -2.5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -3}, {1, -4}, {1, -1}, {1, -2}}], DiskBox[{1, -3}, 0.09], 
    DiskBox[{1, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}}, {
    LineBox[{{2, -1}, {2, -3}, {2, -4}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -2.6}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"A\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{3.6, -4.4}, {4.4, -1.6}]}, {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {5.1, -1}, ImageScaled[{0, Rational[1, 2]}]], {
     LineBox[{{5.1, -3}, {5.199999999999999, -3.}, {5.199999999999999, -2.}, {
       5.1, -2}}], InsetBox[
      StyleBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"0", "1"}, "RowDefault"]},
          "Ket"]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {5.3, -2.5}, ImageScaled[{0, Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[391]=",
 CellID->1102932664],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{6, -1}, {8, -1}}}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}}], {
    LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -2.}, {-0.1, -2}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"1", "0"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"0", "1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -2.5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"B\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -3}, {2, -4}, {2, -1}, {2, -2}}], DiskBox[{2, -3}, 0.09], 
    DiskBox[{2, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -0.6}]}}, {
    LineBox[{{3, -1}, {3, -3}, {3, -4}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -2.6}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"A\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{4.6, -4.4}, {5.4, -1.6}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
    CircleBox[{6, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{6, -1.2}, {6.24, -0.76}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {8.1, -1}, ImageScaled[{0, Rational[1, 2]}]], {
     LineBox[{{8.1, -3}, {8.2, -3.}, {8.2, -2.}, {8.1, -2}}], InsetBox[
      StyleBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"0", "1"}, "RowDefault"]},
          "Ket"]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {8.299999999999999, -2.5}, 
      ImageScaled[{0, Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->432,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[392]=",
 CellID->2057926591],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[393]=",
 CellID->200596355],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]},
      {
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}]},
      {
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}]},
      {
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}]},
      {
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]},
      {
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]},
      {
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]},
      {
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    SparseArray[
    Automatic, {16}, 0, {
     1, {{0, 8}, {{9}, {10}, {11}, {12}, {13}, {14}, {15}, {16}}}, {
      Rational[1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], 
       Complex[0, 
         Rational[1, 2]] 2^Rational[-1, 2], Complex[0, 
         Rational[1, 2]] 2^Rational[-1, 2], Complex[0, 
         Rational[1, 2]] 2^Rational[-1, 2], Complex[0, 
         Rational[-1, 2]] 2^Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[395]//MatrixForm=",
 CellID->2021096342]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "3"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"S", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<V\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"S", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "[", "0", "]"}], "=", 
   RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", "0", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[396]:=",
 CellID->907247650],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {LineBox[{{1, -1}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-7, 2]}, {1, -3.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -3}, {2, -4}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-7, 2]}, {2, -3.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[397]=",
 CellID->1441349702],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], "2"]}]], "Output",
 CellLabel->"Out[398]=",
 CellID->1148903354],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "\[ImaginaryI]", 
      RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "\[ImaginaryI]", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "\[ImaginaryI]", "0", "0", "\[ImaginaryI]", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "\[ImaginaryI]", "\[ImaginaryI]", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "\[ImaginaryI]", 
      RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "\[ImaginaryI]", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "\[ImaginaryI]", "0", "0", 
      "\[ImaginaryI]", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "\[ImaginaryI]", 
      "\[ImaginaryI]", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "2"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "2", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "2"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "2"}], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64}, {{
       1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {5}, {6}, {7}, {8}, {5}, {6}, {7}, {8}, {
       5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {9}, {10}, {11}, {12}, {9}, {
       10}, {11}, {12}, {9}, {10}, {11}, {12}, {13}, {14}, {15}, {16}, {13}, {
       14}, {15}, {16}, {13}, {14}, {15}, {16}, {13}, {14}, {15}, {16}}}, {
      1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, Complex[0, 1], 
       Complex[0, -1], 0, Complex[0, 1], 0, 0, Complex[0, -1], Complex[0, 1], 
       0, 0, Complex[0, 1], 0, Complex[0, 1], Complex[0, 1], 0, 0, Complex[
       0, 1], Complex[0, -1], 0, Complex[0, 1], 0, 0, Complex[0, -1], Complex[
       0, 1], 0, 0, Complex[0, 1], 0, Complex[0, 1], Complex[0, 1], 0, 0, 0, 
       0, 2, 0, 0, 2, 0, 0, -2, 0, 0, -2, 0, 0, 0}}]]]]], "Output",
 CellLabel->"Out[400]//MatrixForm=",
 CellID->1593200501]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{"Red", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "[", "1", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<O\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Phase", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rotation", "[", 
       RowBox[{"\[Phi]", ",", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"expr", "[", "1", "]"}], ",", 
        RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"EulerRotation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "[", "0", "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", "0", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[401]:=",
 CellID->772534362],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}}], 
   {RGBColor[1, 0, 0], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -3.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{3, Rational[-5, 2]}, {3, -2.5}], 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"E\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[402]=",
 CellID->1205713167],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox["3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox["3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox["3"]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "-", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"5", "/", "6"}]]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
        SqrtBox["3"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", "+", "c"}], "2"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["b", "2"], "]"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}]], "Output",
 CellLabel->"Out[403]=",
 CellID->55467149],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}], ")"}]}],
       "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}], ")"}]}],
       "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}], ")"}]}],
       "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "c", "-", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
         SqrtBox["3"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox["b", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
        ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {3}, {5}, {7}, {2}, {4}, {
       6}, {8}, {1}, {3}, {5}, {7}, {2}, {4}, {6}, {8}, {1}, {3}, {5}, {7}, {
       2}, {4}, {6}, {8}, {1}, {3}, {5}, {7}, {2}, {4}, {6}, {8}}}, {
      Rational[1, 2] (Complex[0, 1] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Complex[0, 1] 
         Cos[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Sin[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, 1] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Complex[0, 1] 
         Cos[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Sin[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, 1] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Complex[0, 1] 
         Cos[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Sin[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, 1] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Complex[0, 1] 
         Cos[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Sin[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Complex[0, Rational[1, 2]] (Complex[0, 1] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Complex[0, Rational[1, 2]] (Complex[0, 1] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Complex[0, Rational[1, 2]] (Complex[0, 1] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Complex[0, Rational[1, 2]] (Complex[0, 1] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[-1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Sin[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c - $CellContext`\[Phi])]), 
       Rational[1, 2] (Complex[0, -3] + 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])]), 
       Rational[1, 2] (1 + Complex[0, -1] 3^Rational[1, 2]) 
       Cos[Rational[1, 2] $CellContext`b] (
        Cos[Rational[
           1, 2] ($CellContext`a + $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, 1] 
         Sin[Rational[
            1, 2] ($CellContext`a + $CellContext`c + \
$CellContext`\[Phi])])}}]]]]], "Output",
 CellLabel->"Out[405]//MatrixForm=",
 CellID->228470445]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]", ",", "a", ",", "b", ",", "c"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "Red", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<V\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"EulerRotation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[406]:=",
 CellID->100282607],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{5, -1}, {6, -1}}, {{5, -2}, {6, -2}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, 
   {RGBColor[1, 0, 0], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"E\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{4, Rational[-5, 2]}, {4, Rational[-1, 2]}}, {{
        4, -2.5}, {4, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
      CircleBox[{5, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
      CircleBox[{5, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[408]=",
 CellID->442956337]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec", "[", "0", "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "0", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[409]:=",
 CellID->674332199],

Cell[BoxData[
 TemplateBox[{
  "Measurement", "nonum", 
   "\"Cannot perform a measurement on a nonnumeric state vector. Probability \
half is assumed.\"", 2, 409, 6, 21901233758588411858, "Local", 
   "Q3`Quisso`Measurement"},
  "MessageTemplate2"]], "Message", "MSG",
 CellLabel->"During evaluation of In[409]:=",
 CellID->2056653329],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    TemplateBox[{"\"\[SpaceIndicator]\""},
     "Ket"], " ", 
    RowBox[{"Sin", "[", 
     FractionBox["b", "2"], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "-", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], ")"}]}], 
   SqrtBox[
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox["b", "2"], "]"}], "2"]]]}]], "Output",
 CellLabel->"Out[409]=",
 CellID->275718391],

Cell[BoxData[
 TemplateBox[{
  "Measurement", "nonum", 
   "\"Cannot perform a measurement on a nonnumeric state vector. Probability \
half is assumed.\"", 2, 410, 7, 21901233758588411858, "Local", 
   "Q3`Quisso`Measurement"},
  "MessageTemplate2"]], "Message", "MSG",
 CellLabel->"During evaluation of In[409]:=",
 CellID->1876770958],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["b", "2"], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"a", "-", "c", "+", "\[Phi]"}], ")"}]}], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"a", "-", "c", "+", "\[Phi]"}], ")"}]}], "]"}]}]}], 
           ")"}]}], 
         SqrtBox[
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            FractionBox["b", "2"], "]"}], "2"]]]}]},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    SparseArray[
    Automatic, {4}, 0, {
     1, {{0, 1}, {{
       1}}}, {(-
        Sin[Rational[1, 2] $CellContext`b]) (
         Sin[Rational[1, 2] $CellContext`b]^2)^Rational[-1, 2] (
        Cos[Rational[
           1, 2] ($CellContext`a - $CellContext`c + $CellContext`\[Phi])] + 
        Complex[0, -1] 
         Sin[Rational[
            1, 2] ($CellContext`a - $CellContext`c + \
$CellContext`\[Phi])])}}]]]]], "Output",
 CellLabel->"Out[411]//MatrixForm=",
 CellID->649683970]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1.5", ",", "0.65"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec", "[", "0", "]"}], "=", 
   RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "0", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[412]:=",
 CellID->1630591076],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       RowBox[{"2", " ", 
        TemplateBox[{"1"},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       TemplateBox[{"1"},
        "Ket"]}],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{54., 23.400000000000002`}, {5, 5}},
  ImageSize->185.4,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[412]=",
 CellID->1906687649],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\"\[SpaceIndicator]\""},
   "Ket"], "+", 
  RowBox[{"2", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"2", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[413]=",
 CellID->948336209],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"1"},
      {"2"},
      {"2"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    SparseArray[
    Automatic, {4}, 0, {
     1, {{0, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 2, 2}}]]]]], "Output",
 CellLabel->"Out[415]//MatrixForm=",
 CellID->63036629]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Blue", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "2"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", " ", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"5", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Opts", "\[Rule]", "\"\<A\>\""}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[416]:=",
 CellID->258984644],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}, {{
    0, -4}, {7, -4}}, {{0, -5}, {7, -5}}}], 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {RGBColor[1, 0, 0], {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {2, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
       StyleBox["\<\"Y\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {2, -3}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {2, -4}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
    {RGBColor[0, 0, 1], LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}, {
     LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -5.4}, {5.4, -4.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[416]=",
 CellID->545536296]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], "]"}], 
      "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], "/", "5"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "Blue", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "2"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", " ", 
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"5", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "[", "0", "]"}], "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec", "[", "0", "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Matrix", "[", "qc", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "0", "]"}], "//", "Normal"}]}], "Input",
 CellLabel->"In[417]:=",
 CellID->504240607],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}, {{
    0, -4}, {7, -4}}, {{0, -5}, {7, -5}}}], {InsetBox[
     StyleBox[
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          TemplateBox[{"0"},
           "Ket"]}], "+", 
         RowBox[{"4", " ", 
          TemplateBox[{"1"},
           "Ket"]}]}], ")"}]}],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          TemplateBox[{"0"},
           "Ket"]}], "+", 
         RowBox[{"4", " ", 
          TemplateBox[{"1"},
           "Ket"]}]}], ")"}]}],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          TemplateBox[{"0"},
           "Ket"]}], "+", 
         RowBox[{"4", " ", 
          TemplateBox[{"1"},
           "Ket"]}]}], ")"}]}],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          TemplateBox[{"0"},
           "Ket"]}], "+", 
         RowBox[{"4", " ", 
          TemplateBox[{"1"},
           "Ket"]}]}], ")"}]}],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          TemplateBox[{"0"},
           "Ket"]}], "+", 
         RowBox[{"4", " ", 
          TemplateBox[{"1"},
           "Ket"]}]}], ")"}]}],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -5}, ImageScaled[{1, Rational[1, 2]}]]}, 
   {RGBColor[0, 0, 1], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
    {RGBColor[1, 0, 0], {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {2, -2}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
       StyleBox["\<\"Y\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {2, -3}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
       StyleBox["\<\"X\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {2, -4}, 
       ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
    {RGBColor[0, 0, 1], LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}, {
     LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -5.4}, {5.4, -4.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -5}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->396,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[417]=",
 CellID->1197074815],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"96", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"], " ", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"]}], "3125"]}], "+", 
  FractionBox[
   RowBox[{"96", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"128", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"672", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"504", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"672", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"896", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"72", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"96", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"96", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"672", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"378", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"504", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"504", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"72", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"54", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "+", 
  FractionBox[
   RowBox[{"72", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"504", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"567", " ", "\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"3125", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"54", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"81", " ", "\[ImaginaryI]", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"3125", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"54", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"72", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"378", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"378", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"504", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"378", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"504", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"672", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"54", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"72", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"], "-", 
  FractionBox[
   RowBox[{"72", " ", "\[ImaginaryI]", " ", 
    SqrtBox["2"], " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], "3125"]}]], "Output",
 CellLabel->"Out[418]=",
 CellID->1207350597],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"96", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"72", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"72", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"54", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"672", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"504", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"504", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"378", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"72", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"54", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"54", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"81", " ", "\[ImaginaryI]"}], 
     RowBox[{"3125", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"504", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"378", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"378", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"567", " ", "\[ImaginaryI]"}], 
     RowBox[{"3125", " ", 
      SqrtBox["2"]}]]}], ",", 
   FractionBox[
    RowBox[{"96", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   FractionBox[
    RowBox[{"72", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   FractionBox[
    RowBox[{"72", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   FractionBox[
    RowBox[{"54", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"672", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"504", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"504", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"378", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   FractionBox[
    RowBox[{"128", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   FractionBox[
    RowBox[{"96", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   FractionBox[
    RowBox[{"96", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   FractionBox[
    RowBox[{"72", " ", "\[ImaginaryI]", " ", 
     SqrtBox["2"]}], "3125"], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"896", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"672", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"672", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"504", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"]}], "3125"]}]}], "}"}]], "Output",
 CellLabel->"Out[420]=",
 CellID->1092206981]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example with GraphStates", "Section",
 CellID->175892259],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[421]:=",
 CellID->1240983965],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[422]:=",
 CellID->1651869782],

Cell["Let us consider the graph states.", "MathCaption",
 CellID->1551054522],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "4", "]"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "g"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc", ",", 
    RowBox[{"SWAP", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "qc", "]"}]}], "Input",
 CellLabel->"In[423]:=",
 CellID->306837658],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
       $CellContext`S[1], 
       $CellContext`S[2], 
       $CellContext`S[3], 
       $CellContext`S[4]}, {Null, {{1, 2}, {1, 3}, {1, 4}}}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{0.7745966692414834, 0.7745966692414834}, {0., 
       0.}, {0.7745966692414834, 0.}, {1.5491933384829668`, 0.}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
         ArrowBox[{{1, 2}, {1, 3}, {1, 4}}, 0.018845521490452433`]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.018845521490452433], DiskBox[2, 0.018845521490452433], 
         DiskBox[3, 0.018845521490452433], 
         DiskBox[4, 0.018845521490452433]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  AxesStyle->{},
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->{},
  FrameTicks->None,
  ImageSize->Automatic,
  PlotRangePadding->Automatic]], "Output",
 CellLabel->"Out[423]=",
 CellID->926138891],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09]}, {LineBox[{{4, -1}, {4, -3}}], 
    DiskBox[{4, -1}, 0.09], DiskBox[{4, -3}, 0.09]}, {
    LineBox[{{5, -1}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -4}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[424]=",
 CellID->831640991],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}, {{
    0, -4}, {7, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09]}, {LineBox[{{4, -1}, {4, -3}}], 
    DiskBox[{4, -1}, 0.09], DiskBox[{4, -3}, 0.09]}, {
    LineBox[{{5, -1}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -4}, 0.09]}, {LineBox[{{6, -1}, {6, -4}}], 
    LineBox[{{{5.91, -1.09}, {6.09, -0.91}}, {{5.91, -0.91}, {6.09, -1.09}}}],
     LineBox[{{{5.91, -4.09}, {6.09, -3.91}}, {{5.91, -3.91}, {
     6.09, -4.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[425]=",
 CellID->1566561061],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], "8"], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], "8"]}]], "Output",
 CellLabel->"Out[426]=",
 CellID->504869328]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[TwoWayRule]", 
      RowBox[{"S", "[", "4", "]"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "g", "]"}]}], "Input",
 CellLabel->"In[427]:=",
 CellID->830388943],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
       $CellContext`S[1], 
       $CellContext`S[2], 
       $CellContext`S[3], 
       $CellContext`S[4]}, {Null, {{1, 2}, {2, 3}, {1, 3}, {1, 4}}}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{1.1140931545487447`, 0.4234377531712424}, {
       2.0313384837607686`, 0.}, {2.0312611838059835`, 0.8470577415943887}, {
       0., 0.423516252473954}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
         ArrowBox[{{1, 2}, {1, 3}, {1, 4}, {2, 3}}, 0.02286523635197532]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.02286523635197532], DiskBox[2, 0.02286523635197532], 
         DiskBox[3, 0.02286523635197532], DiskBox[4, 0.02286523635197532]}}]],
     
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  AxesStyle->{},
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->{},
  FrameTicks->None,
  ImageSize->Automatic,
  PlotRangePadding->Automatic]], "Output",
 CellLabel->"Out[427]=",
 CellID->536505647],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {LineBox[{{3, -2}, {3, -3}}], 
    DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    DiskBox[{4, -3}, 0.09]}, {LineBox[{{5, -1}, {5, -4}}], 
    DiskBox[{5, -1}, 0.09], DiskBox[{5, -4}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[428]=",
 CellID->1914059023]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"in", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"in", ",", "g"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "1", "]"}], "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "2", "]"}], "=", 
   RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "2", "]"}], "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", "3", "]"}], "=", 
  RowBox[{"GraphState", "[", "g", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "-", 
    RowBox[{"v", "[", "3", "]"}]}], "//", "Simplify"}], "//", 
  "Normal"}]}], "Input",
 CellLabel->"In[429]:=",
 CellID->1766752151],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[429]=",
 CellID->1991889151],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09]}, {LineBox[{{3, -2}, {3, -3}}], 
    DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    DiskBox[{4, -3}, 0.09]}, {LineBox[{{5, -1}, {5, -4}}], 
    DiskBox[{5, -1}, 0.09], DiskBox[{5, -4}, 0.09]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[430]=",
 CellID->558387774],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "4"]}]], "Output",
 CellLabel->"Out[431]=",
 CellID->319780228],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   FractionBox["1", "4"]}], "}"}]], "Output",
 CellLabel->"Out[433]=",
 CellID->1542207202],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    TemplateBox[{"\"\[SpaceIndicator]\""},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], ")"}]}]], "Output",
 CellLabel->"Out[434]=",
 CellID->1629318803],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[435]=",
 CellID->1397139124]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples with Measurements", "Section",
 CellID->1921589536],

Cell["Here are simple examples with measurements.", "MathCaption",
 CellID->1840143414],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[436]:=",
 CellID->1718903328],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[437]:=",
 CellID->1263298518],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[438]:=",
 CellID->87374137],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[438]=",
 CellID->909639278],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[439]=",
 CellID->371262353]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[440]:=",
 CellID->2017341787],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{3, -1}, {4, -1}}}]}, 
   LineBox[{{{0, -1}, {3, -1}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
    CircleBox[{3, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[440]=",
 CellID->349935844],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellLabel->"Out[441]=",
 CellID->1561504622]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[442]:=",
 CellID->2026449521],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{2, -1}, {3, -1}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[442]=",
 CellID->1437254019],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->"Out[443]=",
 CellID->1032235877]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[444]:=",
 CellID->487856212],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{5, -1}, {6, -1}}, {{5, -2}, {6, -2}}, {{3, -3}, {6, -3}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {6, -4}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
    CircleBox[{3, -3.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{3, -3.2}, {3.24, -2.76}}]}, {
    LineBox[{{4, -1}, {4, -2}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
        4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
     CircleBox[{5, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     CircleBox[{5, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[444]=",
 CellID->1174711578]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ExpressionFor", "@", "qc"}], ")"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ccc", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"S", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"QuissoFactor", "[", 
  RowBox[{"ccc", ",", 
   RowBox[{"S", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[445]:=",
 CellID->125377819],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "+", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[446]=",
 CellID->358951766],

Cell[BoxData[
 TagBox[
  RowBox[{
   TagBox[
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"],
    HoldForm], "\[CircleTimes]", 
   RowBox[{"(", 
    FractionBox[
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], 
     SqrtBox["2"]], ")"}]}],
  DisplayForm]], "Output",
 CellLabel->"Out[447]=",
 CellID->620766739]
}, Open  ]],

Cell["Take another example", "MathCaption",
 CellID->690642678],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "6"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "6"}], "]"}]}], "}"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[448]:=",
 CellID->482377111],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{2, -1}, {3, -1}}, {{2, -2}, {3, -2}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     CircleBox[{2, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -2.2}, {2.24, -1.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[448]=",
 CellID->1429395839]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"ExpressionFor", "[", "qc", "]"}]}], ";", 
       RowBox[{"Readout", "[", 
        RowBox[{"result", ",", 
         RowBox[{"S", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], ")"}], ",", 
     RowBox[{"{", "200", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram3D", "[", 
  RowBox[{"data", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ","}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ","}], "]"}], ",", "\"\<Counts\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[449]:=",
 CellID->497852393],

Cell[BoxData[
 Graphics3DBox[
  {RGBColor[0.9045776, 0.6888327999999999, 0.31364080000000005`], EdgeForm[
   RGBColor[0.880722, 0.611041, 0.142051]], 
   StyleBox[{{}, 
     {RGBColor[0.9045776, 0.6888327999999999, 0.31364080000000005`], EdgeForm[
      RGBColor[0.880722, 0.611041, 0.142051]], 
      StyleBox[{
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{-0.5, -0.5, 0.}, {0.5, 0.5, 50.}]},
              
              ImageSizeCache->{{48.118296924868766`, 
               142.36349866370324`}, {-53.51622067943276, 38.52490039137953}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 50]& ,
           TagBoxNote->"50"],
          StyleBox["50", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[50, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{-0.5, 0.5, 0.}, {0.5, 1.5, 49.}]},
              
              ImageSizeCache->{{86.44948950988261, 
               170.31428845715715`}, {-78.91489816917527, 
               1.2543895355707377`}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 49]& ,
           TagBoxNote->"49"],
          StyleBox["49", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[49, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{0.5, -0.5, 0.}, {1.5, 0.5, 50.}]},
              
              ImageSizeCache->{{105.92894971096854`, 
               202.74425460149183`}, {-37.119537625830375`, 
               62.27784137981054}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 50]& ,
           TagBoxNote->"50"],
          StyleBox["50", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[50, {"Graphics3DLabel"}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          TagBox[{{}, 
            TagBox[
             DynamicBox[{
               FEPrivate`If[
                CurrentValue["MouseOver"], 
                EdgeForm[{
                  RGBColor[
                  0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
                  AbsoluteThickness[1.5]}], {}, {}], 
               CuboidBox[{0.5, 0.5, 0.}, {1.5, 1.5, 51.}]},
              
              ImageSizeCache->{{140.36349866370324`, 
               226.36220979468692`}, {-66.82396800788345, 
               20.491702799407875`}}],
             "DelayedMouseEffectStyle"]},
           StatusArea[#, 51]& ,
           TagBoxNote->"51"],
          StyleBox["51", {"Graphics3DLabel"}, StripOnInput -> False]],
         Annotation[#, 
          Style[51, {"Graphics3DLabel"}], "Tooltip"]& ]},
       FontColor->GrayLevel[0.4]]}, {}, {}},
    FontColor->GrayLevel[0.4]]},
  Axes->{True, True, True},
  AxesLabel->{
    FormBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], TraditionalForm], 
    
    FormBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], TraditionalForm], 
    
    FormBox["\"Counts\"", TraditionalForm]},
  AxesStyle->{},
  BoxRatios->{1, 1, 0.4},
  FaceGridsStyle->Automatic,
  ImageSize->Automatic,
  Lighting->"Neutral",
  Method->{"RotationControl" -> "Globe"},
  PlotRange->{{-0.5, 1.5}, {-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.1]}},
  Ticks->{Automatic, Automatic, Automatic}]], "Output",
 CellLabel->"Out[450]=",
 CellID->1426655850]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Measurement", "[", 
       RowBox[{"S", "[", "1", "]"}], "]"}], ",", 
      RowBox[{"Measurement", "[", 
       RowBox[{"S", "[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[451]:=",
 CellID->1282052763],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{3, -1}, {4, -1}}, {{3, -2}, {4, -2}}}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     CircleBox[{3, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     CircleBox[{3, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[451]=",
 CellID->430954859]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"ExpressionFor", "[", "qc", "]"}]}], ";", 
       RowBox[{"Readout", "[", 
        RowBox[{"result", ",", 
         RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ")"}], ",", 
     RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"data", ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Large"}]}], "]"}]}], "Input",
 CellLabel->"In[454]:=",
 CellID->1563056539],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 48.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.301282051282016`, 
           301.275641025641}, {-152.24938840468516`, 149.75611595314805`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 48]& ,
        TagBoxNote->"48"],
       StyleBox["48", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[48, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 52.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{300.775641025641, 558.75}, {-177.3748471011713, 
           149.75611595314805`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 52]& ,
        TagBoxNote->"52"],
       StyleBox["52", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[52, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[455]=",
 CellID->902727232]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"QuissoCNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], "**", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], "**", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", "1"}], "]"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"v", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "=", 
       RowBox[{"Measurement", "[", 
        RowBox[{
         RowBox[{"Measurement", "[", 
          RowBox[{"v", ",", 
           RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
         RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Readout", "[", 
       RowBox[{"u", ",", 
        RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1000"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data", "]"}]}], "Input",
 CellLabel->"In[456]:=",
 CellID->1895739858],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "-", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[457]=",
 CellID->377539176],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 488.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{55.9679487179487, 
           307.60897435897436`}, {-157.64664649947784`, 146.51566276981615`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 488]& ,
        TagBoxNote->"488"],
       StyleBox["488", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[488, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 512.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{307.10897435897436`, 558.75}, {-172.5808584307546,
            146.51566276981615`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 512]& ,
        TagBoxNote->"512"],
       StyleBox["512", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[512, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[459]=",
 CellID->1552045178]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples with Controlled-U Gates", "Section",
 CellID->580366830],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[139]:=",
 CellID->1518587760],

Cell["Here are simple examples involving controlled-U gates.", "MathCaption",
 CellID->2037836930],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[460]:=",
 CellID->1411053746],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[461]:=",
 CellID->2015591617],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Y\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[461]=",
 CellID->1983988603]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
     RowBox[{"Rotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<R\>\""}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[462]:=",
 CellID->214937072],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"R\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[462]=",
 CellID->166513621]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples with Arbitrary Controlled-U Gates", "Section",
 CellID->87721419],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[184]:=",
 CellID->1866561420],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[185]:=",
 CellID->1133410698],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "-", " ", 
   RowBox[{"I", " ", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", "expr"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", "expr", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[463]:=",
 CellID->1053652396],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"3"}, "RowDefault"], 
    TemplateBox[{"\"x\""}, "RowDefault"]},
   "Subsuperscript"], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellLabel->"Out[463]=",
 CellID->374996509],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -2.6}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[464]=",
 CellID->1849306465],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-7, 2]}, {1, -3.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[465]=",
 CellID->762934224]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ex1", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc1", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex2", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc2", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", "-", "ex2"}], "//", "Simplify"}]}], "Input",
 CellLabel->"In[466]:=",
 CellID->916671498],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}], "-", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[466]=",
 CellID->1820372694],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       TagBox[
        RowBox[{
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm], 
         TagBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          DisplayForm]}],
        DisplayForm], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "+", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"2", " ", 
        TagBox[
         RowBox[{
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm], 
          TagBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Subsuperscript"],
           DisplayForm]}],
         DisplayForm]}], "-", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}], "-", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[467]=",
 CellID->1951832896],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[468]=",
 CellID->1642775147]
}, Open  ]],

Cell["\<\
Let us take another example, where the (multi-qubit) gate (operator) is \
expressed in an expression of Pauli operators for labelled qubits.\
\>", "MathCaption",
 CellID->1043555611],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[469]:=",
 CellID->110969201],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"3", ",", "0"}], "]"}], "+", 
   RowBox[{"I", " ", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{"expr", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"expr", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[470]:=",
 CellID->540209028],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"3"}, "RowDefault"], 
    TemplateBox[{"0"}, "RowDefault"]},
   "Subsuperscript"], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[470]=",
 CellID->792701174],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, {LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[471]=",
 CellID->2087569077],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[472]=",
 CellID->185652453]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc1", "]"}], "//", "Elaborate"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc2", "]"}], "//", "Elaborate"}], "//", 
  "Simplify"}]}], "Input",
 CellLabel->"In[473]:=",
 CellID->2058230597],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[473]=",
 CellID->1081478322],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[474]=",
 CellID->104569646]
}, Open  ]],

Cell["The gate is expressed in a matrix representation.", "MathCaption",
 CellID->854399110],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"ThePauli", "[", "1", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"ThePauli", "[", "3", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", " ", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"op", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[475]:=",
 CellID->1810177928],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[ImaginaryI]", "1"},
     {"1", 
      RowBox[{"-", "\[ImaginaryI]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Complex[0, 1], 1, Complex[0, -1], 1}}]]]]], "Output",
 CellLabel->"Out[476]//MatrixForm=",
 CellID->1476195010],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, {LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[478]=",
 CellID->530959279],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[479]=",
 CellID->1038048868]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ex1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"qc1", "//", "ExpressionFor"}], "//", "Elaborate"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"ex2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"qc2", "//", "ExpressionFor"}], "//", "Elaborate"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", "-", "ex2"}], "//", "Simplify"}]}], "Input",
 CellLabel->"In[480]:=",
 CellID->1035336409],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"\[ImaginaryI]", "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}], "-", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], ")"}]}]], "Output",
 CellLabel->"Out[480]=",
 CellID->1510087971],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"\[ImaginaryI]", "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "-", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}], "-", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], "+", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], ")"}]}]], "Output",
 CellLabel->"Out[481]=",
 CellID->1086788351],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[482]=",
 CellID->1303397522]
}, Open  ]],

Cell["Multi-qubit gate is expressed in a matrix representation.", \
"MathCaption",
 CellID->1230508662],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"ThePauli", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq", "=", 
   RowBox[{"S", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "qq"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", " ", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "7"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"op", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[483]:=",
 CellID->891561624],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"0", "0", "\[ImaginaryI]", "0"},
     {"0", 
      RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
     {"\[ImaginaryI]", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{4}, {3}, {2}, {1}}}, {
      Complex[0, -1], Complex[0, 1], Complex[0, -1], Complex[
       0, 1]}}]]]]], "Output",
 CellLabel->"Out[484]//MatrixForm=",
 CellID->152356762],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {GrayLevel[1], EdgeForm[GrayLevel[0]], 
    RectangleBox[{1.6, -3.4}, {2.4, -1.6}]}, {LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[487]=",
 CellID->859591710],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"S\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-5, 2]}, {2, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[488]=",
 CellID->1035376601]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Elaborate", "[", "qc1", "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Elaborate", "[", "qc2", "]"}], "//", "Simplify"}]}], "Input",
 CellLabel->"In[489]:=",
 CellID->999620760],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[489]=",
 CellID->850342973],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm]}], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"]}]}], ")"}]}]], "Output",
 CellLabel->"Out[490]=",
 CellID->210676426]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix on QuantumCircuit", "Section",
 CellID->462801707],

Cell[TextData[{
 "Depending on the ratio of the \[OpenCurlyDoubleQuote]size\
\[CloseCurlyDoubleQuote] (the number of qubits) and the \
\[OpenCurlyDoubleQuote]depth\[CloseCurlyDoubleQuote] (the number of \
operations), ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " is more efficient than the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpressionFor"]], "paclet:Q3/ref/ExpressionFor"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->122520115],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[215]:=",
 CellID->1179364979],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[216]:=",
 CellID->1480097392],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$N", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "[", "$N", "]"}], ",", "None"}], "]"}]}]}], "Input",
 CellLabel->"In[491]:=",
 CellID->1693784143],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"3"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"4"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"5"},
     "RowDefault"]]}], "}"}]], "Output",
 CellLabel->"Out[492]=",
 CellID->1078644576]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"S", "[", 
   RowBox[{"j", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<R\>\"", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", ">", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<R\>\"", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", "<", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SW", "[", "j_", "]"}], ":=", 
  RowBox[{"SWAP", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"$N", "-", "j", "+", "1"}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[493]:=",
 CellID->1636787114],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SW", "[", "j", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$N", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4a", "=", 
   RowBox[{"Catenate", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "$N"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4a", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4a", ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4a", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", "qft4a"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "Input",
 CellLabel->"In[497]:=",
 CellID->215506928],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {18, -1}}, {{0, -2}, {18, -2}}, {{0, -3}, {18, -3}}, {{
    0, -4}, {18, -4}}, {{0, -5}, {18, -5}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -4}, {4, -1}}], DiskBox[{4, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -5}, {5, -1}}], DiskBox[{5, -5}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "4"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -3}, {7, -2}}], DiskBox[{7, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {7, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -4}, {8, -2}}], DiskBox[{8, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -5}, {9, -2}}], DiskBox[{9, -5}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {9, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -3.4}, {10.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {10, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -4}, {11, -3}}], DiskBox[{11, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -3.4}, {11.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {11, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -5}, {12, -3}}], DiskBox[{12, -5}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {12, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {13, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{14, -5}, {14, -4}}], DiskBox[{14, -5}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {14, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14.6, -5.4}, {15.4, -4.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {15, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{16, -1}, {16, -5}}], 
    LineBox[{{{15.91, -1.09}, {16.09, -0.91}}, {{15.91, -0.91}, {
     16.09, -1.09}}}], 
    LineBox[{{{15.91, -5.09}, {16.09, -4.91}}, {{15.91, -4.91}, {
     16.09, -5.09}}}]}, {LineBox[{{17, -2}, {17, -4}}], 
    LineBox[{{{16.91, -2.09}, {17.09, -1.91}}, {{16.91, -1.91}, {
     17.09, -2.09}}}], 
    LineBox[{{{16.91, -4.09}, {17.09, -3.91}}, {{16.91, -3.91}, {
     17.09, -4.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->Large,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[500]=",
 CellID->1400065847]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SW", "[", "j", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$N", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4b", "=", 
   RowBox[{"Catenate", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4b", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4b", ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4b", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", "qft4b"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "Input",
 CellLabel->"In[501]:=",
 CellID->1371487384],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {18, -1}}, {{0, -2}, {18, -2}}, {{0, -3}, {18, -3}}, {{
    0, -4}, {18, -4}}, {{0, -5}, {18, -5}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -4}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {8, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -5}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -5.4}, {11.4, -4.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "4"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {11, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -2}, {12, -5}}], DiskBox[{12, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -5.4}, {12.4, -4.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {12, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{13, -3}, {13, -5}}], DiskBox[{13, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -5.4}, {13.4, -4.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {13, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{14, -4}, {14, -5}}], DiskBox[{14, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13.6, -5.4}, {14.4, -4.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {14, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14.6, -5.4}, {15.4, -4.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {15, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{16, -1}, {16, -5}}], 
    LineBox[{{{15.91, -1.09}, {16.09, -0.91}}, {{15.91, -0.91}, {
     16.09, -1.09}}}], 
    LineBox[{{{15.91, -5.09}, {16.09, -4.91}}, {{15.91, -4.91}, {
     16.09, -5.09}}}]}, {LineBox[{{17, -2}, {17, -4}}], 
    LineBox[{{{16.91, -2.09}, {17.09, -1.91}}, {{16.91, -1.91}, {
     17.09, -2.09}}}], 
    LineBox[{{{16.91, -4.09}, {17.09, -3.91}}, {{16.91, -3.91}, {
     17.09, -4.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->Large,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[504]=",
 CellID->1076573899]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4a", "=", 
    RowBox[{"Matrix", "[", "qc4a", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4b", "=", 
    RowBox[{"Matrix", "[", "qc4b", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mat4a", "-", "mat4b"}], "//", "Simplify"}], "//", "Normal"}], "//",
    "Flatten"}], "//", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4a", "=", 
    RowBox[{"Matrix", "[", "qc4a", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4b", "=", 
    RowBox[{"Matrix", "[", "qc4b", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mat4a", "-", "mat4b"}], "//", "Simplify"}], "//", "Normal"}], "//",
    "Flatten"}], "//", 
  RowBox[{
   RowBox[{"DeleteCases", "[", 
    RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], "Input",
 CellLabel->"In[505]:=",
 CellID->2056467464],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.705524`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[505]=",
 CellID->1943446821],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.652132`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[506]=",
 CellID->284449677],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[507]=",
 CellID->447123117],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.242793`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[508]=",
 CellID->752946566],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.661554`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[509]=",
 CellID->1799286638],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[510]=",
 CellID->1893291459]
}, Open  ]],

Cell["\<\
WARNING: The following takes quite long, sometime even fails, as the circuit \
is pretty deep compared with the size.\
\>", "MathCaption",
 FontWeight->"Regular",
 FontColor->RGBColor[0.9688410772869459, 0., 0.04487678339818418],
 CellID->1291620282],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"op4a", "=", 
    RowBox[{"ExpressionFor", "[", "qc4a", "]"}]}], ";"}], "]"}]], "Input",
 FontFamily->"Source Sans Pro",
 FontSize->15,
 FontWeight->"Regular",
 FontColor->RGBColor[0.9688410772869459, 0., 0.04487678339818418],
 CellLabel->"In[120]:=",
 CellID->1497375698],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"743.309974`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[120]=",
 CellID->32497093]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"mat4c", "=", 
    RowBox[{"Matrix", "[", "op4a", "]"}]}], ";"}], "]"}]], "Input",
 CellLabel->"In[121]:=",
 CellID->717795713],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.371457`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[121]=",
 CellID->1576903192]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mat4a", "-", "mat4c"}], "//", "N"}], "//", "Chop"}], "//", 
  "Normal"}]], "Input",
 CellLabel->"In[125]:=",
 CellID->916260317],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[125]=",
 CellID->2129398829]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix on QuantumCircuit: With Measure", "Section",
 CellID->991141748],

Cell[TextData[{
 "Here we illustrate how ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " works on a ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " when it involves ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Measurement"]], "paclet:Q3/ref/Measurement"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "MathCaption",
 CellID->623127415],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[237]:=",
 CellID->1624724280],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[238]:=",
 CellID->1455738726],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"ss", "\[Rule]", "1"}], "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"jj", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"EulerRotation", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Pi", "/", "3"}], ",", 
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"Pi", "/", "3"}]}], "}"}], ",", 
       RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Measurement", "[", 
      RowBox[{"S", "[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "gg"}], "]"}]}]}], "Input",
 CellLabel->"In[511]:=",
 CellID->319577611],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{6, -2}, {8, -2}}}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {8, -3}}}], {
    LineBox[{{-0.1, -3}, {-0.2, -3.}, {-0.2, -1.}, {-0.1, -1}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"1", "1", "1"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"0", "0", "1"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -2.}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
        4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"E\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
    CircleBox[{6, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{6, -2.2}, {6.24, -1.76}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->334.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[514]=",
 CellID->1012169222]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat1", "=", 
   RowBox[{
    RowBox[{"Matrix", "@", "qc"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat1", "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat2", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"ExpressionFor", "@", "qc"}], ",", "ss"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat2", "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat3", "=", 
   RowBox[{
    RowBox[{"Matrix", "@", "qc"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat3", "//", "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat1", "-", "mat2"}], "//", "Simplify"}], "//", 
  "Normal"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat2", "-", "mat3"}], "//", "Simplify"}], "//", 
  "Normal"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Readout", "[", 
    RowBox[{
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat1", ",", "ss"}], "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Readout", "[", 
    RowBox[{
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat2", ",", "ss"}], "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "}"}]}], "Input",
 CellLabel->"In[515]:=",
 CellID->195457935],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
       SqrtBox["3"]}], ")"}]}], 
    SqrtBox[
     RowBox[{"2", "+", 
      SqrtBox["3"]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["3"]}], ")"}]}], 
     SqrtBox[
      RowBox[{"2", "+", 
       SqrtBox["3"]}]]]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[516]=",
 CellID->426414260],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
       SqrtBox["3"]}], ")"}]}], 
    SqrtBox[
     RowBox[{"2", "+", 
      SqrtBox["3"]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["3"]}], ")"}]}], 
     SqrtBox[
      RowBox[{"2", "+", 
       SqrtBox["3"]}]]]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[518]=",
 CellID->591537781],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
       SqrtBox["3"]}], ")"}]}], 
    SqrtBox[
     RowBox[{"2", "+", 
      SqrtBox["3"]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], "-", 
        FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["3"]}], ")"}]}], 
     SqrtBox[
      RowBox[{"2", "+", 
       SqrtBox["3"]}]]]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[520]=",
 CellID->1273683304],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellLabel->"Out[521]=",
 CellID->678297032],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellLabel->"Out[522]=",
 CellID->1295018548],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[523]=",
 CellID->629973891]
}, Open  ]],

Cell["\<\
Let us collect the measurement readouts to get the statistics.\
\>", "MathCaption",
 CellID->1155670419],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"Matrix", "[", "qc", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Readout", "[", 
        RowBox[{
         RowBox[{"ExpressionFor", "[", 
          RowBox[{"result", ",", "ss"}], "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
      ")"}], ",", "100"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data1", "]"}]}], "Input",
 CellLabel->"In[524]:=",
 CellID->1510628665],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 92.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.301282051282044`, 
           301.27564102564105`}, {-177.3748471011713, 149.75611595314805`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 92]& ,
        TagBoxNote->"92"],
       StyleBox["92", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[92, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 8.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{300.77564102564105`, 558.75}, {
           120.85342351364203`, 149.75611595314805`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 8]& ,
        TagBoxNote->"8"],
       StyleBox["8", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[8, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[525]=",
 CellID->533051619]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"ExpressionFor", "[", "qc", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Readout", "[", 
        RowBox[{"result", ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ")"}], ",", "100"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data2", "]"}]}], "Input",
 CellLabel->"In[526]:=",
 CellID->643738394],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 90.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.301282051282044`, 
           301.27564102564105`}, {-177.37484710117135`, 149.7561159531481}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 90]& ,
        TagBoxNote->"90"],
       StyleBox["90", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[90, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 10.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{300.77564102564105`, 558.75}, {
           112.96378672489038`, 149.7561159531481}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 10]& ,
        TagBoxNote->"10"],
       StyleBox["10", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[10, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[527]=",
 CellID->689512107]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "TutorialMoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->23220180],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso Package Guide",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/guide/QuissoPackageGuide"]], "TutorialMoreAbout",
 CellID->495491210],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Tutorials"
}], "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellID->415694126],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[ButtonBox["Quisso: Quick Start",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuissoQuickStart"]], "RelatedTutorials",
 CellID->2025894544],

Cell[TextData[ButtonBox["Quantum Teleportation",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], "RelatedTutorials",
 CellID->1648188840],

Cell[TextData[ButtonBox["Quantum Fourier Transform",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumFourierTransform"]], "RelatedTutorials",
 CellID->2091818538],

Cell[TextData[ButtonBox["Quantum Fourier Transform: Semiclassical \
Implementation",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumFourierTransformSemiclassical"]], \
"RelatedTutorials",
 CellID->981314606],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Wolfram Education Group Courses"
}], "TutorialRelatedLinksSection",
 WholeCellGroupOpener->True,
 CellID->415694148],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["An Elementary Introduction to the Wolfram Language"]], 
   "https://www.wolfram.com/language/elementary-introduction/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->454917981],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["The Wolfram Language: Fast Introduction for Programmers"]], 
   "https://www.wolfram.com/language/fast-introduction-for-programmers/"},
  "WebLink",
  BaseStyle->{"TutorialRelatedLinks"}]]]], "TutorialRelatedLinks",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QuantumCircuit Usage Examples",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "TutorialColor", 
  "LinkTrails" -> GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "ExampleCounter" -> 1, "NeedPlatMsgIn" -> None, "RootCaptions" -> 
  "", "Metadata" -> {
   "built" -> "{2021, 5, 24, 9, 45, 23.950486}", 
    "history" -> {"1.0", "", "", ""}, "context" -> "Q3`Quisso`", 
    "keywords" -> {"quantum computation", "quantum circuit model"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "QuantumCircuit provides the graphical representation of the quantum \
circuits. Elements in the quantum circuit representation. First load the \
application (the collection of packages).", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$195715, "title" -> 
    "QuantumCircuit Usage Examples", "titlemodifier" -> "", "windowtitle" -> 
    "QuantumCircuit Usage Examples", "type" -> "Tutorial", "uri" -> 
    "Q3/tutorial/QuantumCircuitUsage", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> ""},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[601, 21, 5370, 125, 70, "AnchorBarGrid",ExpressionUUID->"8f298b8b-3cd6-445e-9c54-da24c3fd6d0f",
 CellID->1],
Cell[CellGroupData[{
Cell[5996, 150, 66, 1, 70, "Title",ExpressionUUID->"5aad8838-9c56-40b5-9dbe-6e0d4b8502da",
 CellID->509267359],
Cell[6065, 153, 56045, 942, 70, "TutorialJumpBox",ExpressionUUID->"f33714dd-f756-4837-ba20-b9a805143b8a"],
Cell[62113, 1097, 290, 9, 70, "Text",ExpressionUUID->"c278c332-3dc7-48d4-83dd-6f4478b16767",
 CellID->1534169418],
Cell[62406, 1108, 1499, 47, 70, "DefinitionBox",ExpressionUUID->"6507e153-9091-4dbc-9508-0c5f96637efd",
 CellID->2096742444],
Cell[63908, 1157, 87, 1, 70, "Caption",ExpressionUUID->"04ce695d-a9f5-4ee2-a469-fa156586af06",
 CellID->1891092685],
Cell[CellGroupData[{
Cell[64020, 1162, 56, 1, 70, "Section",ExpressionUUID->"3782b374-d2c0-4eb8-9b56-ffedf30ac5fa",
 CellID->1868432623],
Cell[64079, 1165, 99, 1, 70, "MathCaption",ExpressionUUID->"9cafa937-81ab-4960-ac9c-4656a06e236d",
 CellID->836781195],
Cell[64181, 1168, 92, 3, 70, "Input",ExpressionUUID->"f8823852-b2d8-470a-94e2-5c25b950e328",
 CellID->841456058],
Cell[64276, 1173, 303, 12, 70, "MathCaption",ExpressionUUID->"a5b7eded-8a22-4923-874e-ddf4a848d9f6",
 CellID->1561112771],
Cell[64582, 1187, 128, 4, 70, "Input",ExpressionUUID->"e4b039e1-5943-4630-92fc-6f37e69ad227",
 CellID->644371895],
Cell[64713, 1193, 321, 10, 70, "MathCaption",ExpressionUUID->"be0993c9-e428-430f-83d7-0d9746f67c69",
 CellID->121218086],
Cell[CellGroupData[{
Cell[65059, 1207, 243, 8, 70, "Input",ExpressionUUID->"4196ceee-933a-4667-937b-bbffb7270f6d",
 CellID->359983136],
Cell[65305, 1217, 979, 25, 70, "Output",ExpressionUUID->"29880a37-cce8-49b2-903a-870df5afe96f",
 CellID->1725400398]
}, Open  ]],
Cell[66299, 1245, 142, 4, 70, "MathCaption",ExpressionUUID->"bce6a761-8149-4320-b404-e708f865463c",
 CellID->648571534],
Cell[CellGroupData[{
Cell[66466, 1253, 257, 8, 70, "Input",ExpressionUUID->"e9acf3b3-2ca7-4084-a3c0-1a5ba4b823ee",
 CellID->1027099769],
Cell[66726, 1263, 1020, 26, 70, "Output",ExpressionUUID->"3d7e3b04-e9a5-43a6-8b6e-531ae738d6e2",
 CellID->1739871705]
}, Open  ]],
Cell[CellGroupData[{
Cell[67783, 1294, 477, 15, 70, "Input",ExpressionUUID->"1511cc46-44bb-428a-ac07-157c81bd1ef6",
 CellID->1753671624],
Cell[68263, 1311, 421, 14, 70, "Output",ExpressionUUID->"ebc73242-ec22-443c-8756-e02fb76bab79",
 CellID->182906733],
Cell[68687, 1327, 1436, 39, 70, "Output",ExpressionUUID->"40aa188c-fc37-45f2-b438-0989bda20abe",
 CellID->1064362674]
}, Open  ]],
Cell[70138, 1369, 121, 3, 70, "MathCaption",ExpressionUUID->"8d11f9d8-b5be-4fdd-afad-dad6c7bec8e7",
 CellID->1179582981],
Cell[CellGroupData[{
Cell[70284, 1376, 578, 19, 70, "Input",ExpressionUUID->"d972099c-03a0-4355-9c2e-ee55aa190e2a",
 CellID->1498964105],
Cell[70865, 1397, 2298, 59, 70, "Output",ExpressionUUID->"2d86b4f3-eae8-47dd-96e1-09ef8b6dfbb6",
 CellID->1195477909]
}, Open  ]],
Cell[73178, 1459, 406, 7, 70, "MathCaption",ExpressionUUID->"d915f4b9-6e46-4ad3-b821-d92f6379061a",
 CellID->1884848111],
Cell[CellGroupData[{
Cell[73609, 1470, 693, 20, 70, "Input",ExpressionUUID->"4bad42f1-9e73-4f56-9df5-f83ad267877b",
 CellID->1110924680],
Cell[74305, 1492, 1002, 26, 70, "Output",ExpressionUUID->"7541c444-fc5a-4603-b777-393ed3b8ec13",
 CellID->493010259],
Cell[75310, 1520, 969, 26, 70, "Output",ExpressionUUID->"cd981f5d-cc5d-4414-a473-083ada803708",
 CellID->1031512887],
Cell[76282, 1548, 1093, 29, 70, "Output",ExpressionUUID->"aa42a3e5-5b1e-4436-bdaa-7d8a98012724",
 CellID->1609578]
}, Open  ]],
Cell[77390, 1580, 659, 23, 70, "MathCaption",ExpressionUUID->"05625f8a-3c61-4fcb-a1de-829d4fbd24ac",
 CellID->1581832416],
Cell[CellGroupData[{
Cell[78074, 1607, 423, 11, 70, "Input",ExpressionUUID->"7e8909ad-8235-446c-8399-cdfd5a5d022c",
 CellID->9865852],
Cell[78500, 1620, 614, 14, 70, "Output",ExpressionUUID->"9fe87159-ea27-4612-82ea-f1c9dbad0e34",
 CellID->1538359658],
Cell[79117, 1636, 1009, 35, 70, "Output",ExpressionUUID->"ff55d216-d3dd-400e-84c6-90ffac2698f0",
 CellID->1655145773],
Cell[80129, 1673, 1009, 35, 70, "Output",ExpressionUUID->"4f858c4d-db70-41c6-bc75-6ace978fd03b",
 CellID->1679327220]
}, Open  ]],
Cell[81153, 1711, 68, 1, 70, "MathCaption",ExpressionUUID->"b3c0951a-83e7-40a9-a08b-60faa43a608d",
 CellID->1800711653],
Cell[CellGroupData[{
Cell[81246, 1716, 1042, 29, 70, "Input",ExpressionUUID->"83662ce2-ec57-415a-adcc-1fd1657ebf92",
 CellID->599552766],
Cell[82291, 1747, 2743, 64, 70, "Output",ExpressionUUID->"d3ad2c67-0b06-49f7-9d52-f8687469e11a",
 CellID->1056297237]
}, Open  ]],
Cell[CellGroupData[{
Cell[85071, 1816, 731, 23, 70, "Input",ExpressionUUID->"3d8f262f-bf80-4654-af61-931bb275b81a",
 CellID->1534929666],
Cell[85805, 1841, 5881, 206, 70, "Output",ExpressionUUID->"79708751-df2d-4f88-87aa-de47c13e5314",
 CellID->438566987]
}, Open  ]],
Cell[CellGroupData[{
Cell[91723, 2052, 223, 6, 70, "Input",ExpressionUUID->"7442e565-617e-4fb8-8aee-b6f34293d29d",
 CellID->474527143],
Cell[91949, 2060, 5881, 206, 70, "Output",ExpressionUUID->"ff44e3f7-ec6e-4664-9060-8ed05b84ca8b",
 CellID->806876755],
Cell[97833, 2268, 74, 2, 70, "Output",ExpressionUUID->"74b6afaf-b313-4e7f-9696-3843aae2fc70",
 CellID->1965874127]
}, Open  ]],
Cell[97922, 2273, 104, 2, 70, "MathCaption",ExpressionUUID->"e3703696-db4d-4f46-8ead-c9087b986c0c",
 CellID->1618406437],
Cell[CellGroupData[{
Cell[98051, 2279, 535, 17, 70, "Input",ExpressionUUID->"f2bc1596-7fd0-4378-9fdd-d2fa18c57b04",
 CellID->529113757],
Cell[98589, 2298, 1359, 34, 70, "Output",ExpressionUUID->"049bed50-08c8-4b1e-a57c-faa409704865",
 CellID->764288206],
Cell[99951, 2334, 1611, 42, 70, "Output",ExpressionUUID->"dbe791a7-88ce-4c84-8097-e46bbe924c32",
 CellID->1292185535]
}, Open  ]],
Cell[CellGroupData[{
Cell[101599, 2381, 547, 17, 70, "Input",ExpressionUUID->"ccdb1d4c-0817-4039-b8cd-ed6e382e78cb",
 CellID->1794887271],
Cell[102149, 2400, 1514, 41, 70, "Output",ExpressionUUID->"5ee0f524-cd29-486a-9d0c-00bc86ea8e1a",
 CellID->1515942851]
}, Open  ]],
Cell[CellGroupData[{
Cell[103700, 2446, 1756, 56, 70, "Input",ExpressionUUID->"e3acfe6a-48fb-4c91-bb36-580f7d879a43",
 CellID->1274883332],
Cell[105459, 2504, 556, 18, 70, "Output",ExpressionUUID->"b37f7f70-ef48-44f6-9f05-a96c42d0d9db",
 CellID->1722276882],
Cell[106018, 2524, 539, 19, 70, "Output",ExpressionUUID->"9df82234-c440-427b-9813-2596810cae72",
 CellID->375477861],
Cell[106560, 2545, 540, 19, 70, "Output",ExpressionUUID->"de8acae3-af0a-4826-bac4-97ed2a0684f8",
 CellID->1349454941],
Cell[107103, 2566, 539, 19, 70, "Output",ExpressionUUID->"b6364a55-d468-4f2d-b791-53be4a94e59b",
 CellID->714397420],
Cell[107645, 2587, 3030, 91, 70, "Output",ExpressionUUID->"8562a395-c55d-4f0d-b1ba-3a20d9efa625",
 CellID->296367563]
}, Open  ]],
Cell[CellGroupData[{
Cell[110712, 2683, 218, 6, 70, "Input",ExpressionUUID->"6079638a-32b4-4bd3-8b9c-523436e36ecc",
 CellID->81528505],
Cell[110933, 2691, 4740, 155, 70, "Output",ExpressionUUID->"0997f4c6-2560-41c9-867a-2d8715a668b1",
 CellID->1713878821]
}, Open  ]],
Cell[115688, 2849, 70, 1, 70, "MathCaption",ExpressionUUID->"99d6d40c-17d8-4002-8fc7-d2c74294efc8",
 CellID->468836632],
Cell[CellGroupData[{
Cell[115783, 2854, 866, 26, 70, "Input",ExpressionUUID->"827300f2-1999-49cf-bb23-adb9f6dde0f8",
 CellID->619773181],
Cell[116652, 2882, 3009, 85, 70, "Output",ExpressionUUID->"607cb127-713d-4c23-a236-72f252963c8b",
 CellID->310935002],
Cell[119664, 2969, 4740, 155, 70, "Output",ExpressionUUID->"29aed2d7-10ca-49f5-895d-cfe9fb46de6e",
 CellID->1056865463]
}, Open  ]],
Cell[124419, 3127, 112, 3, 70, "MathCaption",ExpressionUUID->"49087c48-3cbd-4f43-b3ca-32aa0165049d",
 CellID->251997855],
Cell[CellGroupData[{
Cell[124556, 3134, 1100, 30, 70, "Input",ExpressionUUID->"18613c4e-56b3-411a-bcf8-b341d5af8a32",
 CellID->490197101],
Cell[125659, 3166, 3139, 88, 70, "Output",ExpressionUUID->"cc1847a0-d133-4eb5-9eff-d117eeaec75f",
 CellID->1006626579],
Cell[128801, 3256, 4739, 155, 70, "Output",ExpressionUUID->"e3c60b34-79d8-4214-a256-1014cb9e02aa",
 CellID->496742187]
}, Open  ]],
Cell[CellGroupData[{
Cell[133577, 3416, 921, 27, 70, "Input",ExpressionUUID->"f5ee18cd-532a-44ac-b19a-d0798fb3a9df",
 CellID->945271287],
Cell[134501, 3445, 555, 18, 70, "Output",ExpressionUUID->"1974dc22-eae3-4105-97a8-37038cd8c863",
 CellID->550868847],
Cell[135059, 3465, 968, 45, 70, "Output",ExpressionUUID->"00434719-4f34-4cf0-9794-da40b1cff3f0",
 CellID->650709312],
Cell[136030, 3512, 2797, 85, 70, "Output",ExpressionUUID->"df232297-e085-461b-9b0c-a130d2773c0a",
 CellID->1484676260]
}, Open  ]],
Cell[138842, 3600, 68, 1, 70, "MathCaption",ExpressionUUID->"cb3655d5-c0a8-4b70-9246-cd8e163ced38",
 CellID->1043674246],
Cell[CellGroupData[{
Cell[138935, 3605, 1194, 32, 70, "Input",ExpressionUUID->"649894cc-1fc4-4de7-8d5f-b8edc47d83dd",
 CellID->386623826],
Cell[140132, 3639, 1420, 37, 70, "Output",ExpressionUUID->"999e1309-2de2-4e80-8142-248a6a927384",
 CellID->549138186],
Cell[141555, 3678, 5559, 197, 70, "Output",ExpressionUUID->"c1bd6049-d604-4fe6-a947-beeb88c0284a",
 CellID->1628260943],
Cell[147117, 3877, 3264, 94, 70, "Output",ExpressionUUID->"21beffa4-c725-4d4b-97ce-c5ea86e49115",
 CellID->797555280]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150430, 3977, 73, 1, 70, "Section",ExpressionUUID->"7a766138-5e35-482a-b8d3-21423bb5c8ac",
 CellID->188399535],
Cell[150506, 3980, 92, 3, 70, "Input",ExpressionUUID->"5907b77d-b330-4328-8c7e-eeb3aca5c45d",
 CellID->284388437],
Cell[150601, 3985, 129, 4, 70, "Input",ExpressionUUID->"760a0147-1f3e-48a0-8a6f-a1b8263a368b",
 CellID->1565346084],
Cell[150733, 3991, 669, 23, 70, "MathCaption",ExpressionUUID->"676d29ab-b0bb-4f42-b424-6a110fbbc05a",
 CellID->92524695],
Cell[CellGroupData[{
Cell[151427, 4018, 112, 3, 70, "Subsection",ExpressionUUID->"2c7d0b4e-d981-4b5a-96f1-0008f0488f30",
 CellID->2096958038],
Cell[151542, 4023, 155, 4, 70, "MathCaption",ExpressionUUID->"25b64824-8bad-49aa-9d06-b510c73353c7",
 CellID->1219613749],
Cell[CellGroupData[{
Cell[151722, 4031, 436, 14, 70, "Input",ExpressionUUID->"80d716a5-c816-44f1-830f-a15126ec470c",
 CellID->316868828],
Cell[152161, 4047, 1540, 38, 70, "Output",ExpressionUUID->"72cd87ce-5816-4f38-ac5c-e16ab528a866",
 CellID->402818101]
}, Open  ]],
Cell[153716, 4088, 180, 4, 70, "MathCaption",ExpressionUUID->"ba32d04b-9694-45e4-b7b0-47a1e0476452",
 CellID->1646341244],
Cell[CellGroupData[{
Cell[153921, 4096, 484, 16, 70, "Input",ExpressionUUID->"1eac235a-966d-45fd-b37b-ddb780c92879",
 CellID->1877979960],
Cell[154408, 4114, 1511, 38, 70, "Output",ExpressionUUID->"54e1eaa1-38a7-491a-977d-b1f1f4117fb5",
 CellID->1254173474]
}, Open  ]],
Cell[155934, 4155, 1133, 37, 70, "MathCaption",ExpressionUUID->"8f36bd0e-eeb6-45ff-a5b7-661c1c410966",
 CellID->248231530],
Cell[CellGroupData[{
Cell[157092, 4196, 436, 14, 70, "Input",ExpressionUUID->"0cd6061d-c834-4f58-8773-e8b222b84cf9",
 CellID->1614082236],
Cell[157531, 4212, 1264, 31, 70, "Output",ExpressionUUID->"cb6b5992-e76b-4dce-904a-8ab74b7a7afb",
 CellID->1290885160]
}, Open  ]],
Cell[158810, 4246, 448, 15, 70, "MathCaption",ExpressionUUID->"01272737-a9ce-4d8c-993b-f612aa68ae94",
 CellID->439409635],
Cell[CellGroupData[{
Cell[159283, 4265, 793, 25, 70, "Input",ExpressionUUID->"0e581d76-c2d9-4302-a6b2-6c921cede318",
 CellID->2108957059],
Cell[160079, 4292, 421, 14, 70, "Output",ExpressionUUID->"52dfa820-3d0a-4aa6-985c-29b17c2621fa",
 CellID->662098263],
Cell[160503, 4308, 1436, 39, 70, "Output",ExpressionUUID->"15c7cd5d-b923-42ce-be0d-6c46758e85f5",
 CellID->1772731134],
Cell[161942, 4349, 1129, 32, 70, "Output",ExpressionUUID->"e08bf77d-887f-4b38-9cc6-66f3f6413c90",
 CellID->104050660]
}, Open  ]],
Cell[163086, 4384, 135, 4, 70, "MathCaption",ExpressionUUID->"db874fee-af81-419c-8776-875a71f2a40b",
 CellID->711331671],
Cell[CellGroupData[{
Cell[163246, 4392, 568, 20, 70, "Input",ExpressionUUID->"134a74c5-e7e0-4d02-b80e-53ef98c55ed3",
 CellID->309931648],
Cell[163817, 4414, 1085, 31, 70, "Output",ExpressionUUID->"f0b8b25b-fbb4-42d3-b069-6e5f01af2e6e",
 CellID->588820732]
}, Open  ]],
Cell[CellGroupData[{
Cell[164939, 4450, 333, 10, 70, "Input",ExpressionUUID->"2e2dc376-cd1f-4ddc-8ad4-d07f3124e402",
 CellID->973854571],
Cell[165275, 4462, 1099, 31, 70, "Output",ExpressionUUID->"eb3459ad-4c58-4faa-be90-acb17c1ac99c",
 CellID->782793063]
}, Open  ]],
Cell[166389, 4496, 458, 13, 70, "MathCaption",ExpressionUUID->"81e5ef0d-f69e-4d0b-a515-ddeb2722c093",
 CellID->520661807],
Cell[CellGroupData[{
Cell[166872, 4513, 272, 9, 70, "Input",ExpressionUUID->"395cc76a-9215-46c2-bc53-22703fd8784f",
 CellID->1914612371],
Cell[167147, 4524, 1003, 26, 70, "Output",ExpressionUUID->"5b05e2a7-5d66-4cef-9508-3f28541caeeb",
 CellID->1138496520]
}, Open  ]],
Cell[CellGroupData[{
Cell[168187, 4555, 354, 12, 70, "Input",ExpressionUUID->"6a53b4cd-ee6b-4fb7-90d7-ed560eb63fdb",
 CellID->929609607],
Cell[168544, 4569, 1340, 34, 70, "Output",ExpressionUUID->"b225626c-aea3-4ca0-8140-8946ea0b7114",
 CellID->1640180285]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169933, 4609, 122, 3, 70, "Subsection",ExpressionUUID->"9a19e33e-b55f-4aea-957c-2d210bf3245e",
 CellID->1162686366],
Cell[170058, 4614, 78, 1, 70, "MathCaption",ExpressionUUID->"00cfea99-2000-48a1-a1fd-79c5a78a83ea",
 CellID->1316049309],
Cell[CellGroupData[{
Cell[170161, 4619, 308, 10, 70, "Input",ExpressionUUID->"6a827141-d5dd-4c2c-acc0-0b8451a48459",
 CellID->1906655910],
Cell[170472, 4631, 1290, 34, 70, "Output",ExpressionUUID->"958c13c2-7704-4d82-9ebf-2ad5c8cc7b2a",
 CellID->454629454]
}, Open  ]],
Cell[171777, 4668, 126, 3, 70, "MathCaption",ExpressionUUID->"0ded68e1-3d7a-4b76-892b-29dcd44d114d",
 CellID->325334843],
Cell[CellGroupData[{
Cell[171928, 4675, 362, 12, 70, "Input",ExpressionUUID->"a9d51057-8fbd-4418-9f8b-3eed72e1e5e2",
 CellID->409341039],
Cell[172293, 4689, 1313, 35, 70, "Output",ExpressionUUID->"025a56d9-b5b3-426d-b6ad-d16535eadcc8",
 CellID->192546404]
}, Open  ]],
Cell[173621, 4727, 114, 3, 70, "MathCaption",ExpressionUUID->"34b78dc7-2cfd-4f69-8a9a-2784893fd546",
 CellID->1860334053],
Cell[CellGroupData[{
Cell[173760, 4734, 320, 10, 70, "Input",ExpressionUUID->"7892ba09-3d62-4ee9-af09-fdec6c754f31",
 CellID->1420012098],
Cell[174083, 4746, 1339, 35, 70, "Output",ExpressionUUID->"96561703-1e48-4cb1-80c9-bdc7a3a6a983",
 CellID->416535132]
}, Open  ]],
Cell[175437, 4784, 238, 5, 70, "MathCaption",ExpressionUUID->"7021f8e4-b068-4f86-a15d-d4b6072a0717",
 CellID->1089755652],
Cell[CellGroupData[{
Cell[175700, 4793, 413, 13, 70, "Input",ExpressionUUID->"48aeb8f3-f677-441f-80a9-4967e57dfb17",
 CellID->1782701548],
Cell[176116, 4808, 1291, 34, 70, "Output",ExpressionUUID->"2b8abc2f-75a8-4b30-84a7-ba19413bb3d1",
 CellID->1008271144]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177468, 4849, 83, 1, 70, "Section",ExpressionUUID->"dd2ea027-4354-4131-844c-e45eeb774d64",
 CellID->729173090],
Cell[177554, 4852, 93, 3, 70, "Input",ExpressionUUID->"bad73acf-f710-4e1c-98e5-cda036ebaccd",
 CellID->2103953529],
Cell[177650, 4857, 129, 4, 70, "Input",ExpressionUUID->"18ce71f1-a4df-4e0d-a5a2-e2f3ee451189",
 CellID->1154931458],
Cell[177782, 4863, 94, 1, 70, "MathCaption",ExpressionUUID->"840be0c3-57f2-4c49-9414-e8a6cb9fff4c",
 CellID->898557820],
Cell[CellGroupData[{
Cell[177901, 4868, 526, 15, 70, "Input",ExpressionUUID->"efbbfefc-6fca-4e02-8de2-37ef10612193",
 CellID->1173319708],
Cell[178430, 4885, 628, 17, 70, "Output",ExpressionUUID->"fe97b702-9d6b-4729-9bb1-04b4da82af39",
 CellID->692202459],
Cell[179061, 4904, 595, 14, 70, "Output",ExpressionUUID->"fb46e315-7c47-4af8-b6d7-413593cee632",
 CellID->927812614],
Cell[179659, 4920, 929, 22, 70, "Output",ExpressionUUID->"7a2a7db2-372b-43d2-a5e2-0280320354ba",
 CellID->867842631]
}, Open  ]],
Cell[180603, 4945, 136, 4, 70, "MathCaption",ExpressionUUID->"a78f80b3-9ea7-4b5b-a54c-fa7b18be597e",
 CellID->1246009635],
Cell[CellGroupData[{
Cell[180764, 4953, 314, 8, 70, "Input",ExpressionUUID->"33b36234-ee91-4bb8-99bd-fcef0c986e6f",
 CellID->417857018],
Cell[181081, 4963, 483, 17, 70, "Output",ExpressionUUID->"0a257ed7-d715-403b-9a5e-23102d7b2018",
 CellID->150515553],
Cell[181567, 4982, 1009, 35, 70, "Output",ExpressionUUID->"c09d2ca5-b86e-4ee8-a572-fb3075bf6371",
 CellID->2126646752],
Cell[182579, 5019, 2757, 100, 70, "Output",ExpressionUUID->"a9391ab5-f917-4207-ae6a-b5b2753813e3",
 CellID->1981623843]
}, Open  ]],
Cell[CellGroupData[{
Cell[185373, 5124, 124, 4, 70, "Input",ExpressionUUID->"555563b3-8a75-41e9-973b-7d0026cca41e",
 CellID->1403589449],
Cell[185500, 5130, 73, 2, 70, "Output",ExpressionUUID->"16459ff1-f8cd-4e75-aa08-559952115391",
 CellID->913101770]
}, Open  ]],
Cell[185588, 5135, 143, 4, 70, "MathCaption",ExpressionUUID->"0f140162-d05f-4fd7-9ee7-147bc5a16459",
 CellID->1276498133],
Cell[CellGroupData[{
Cell[185756, 5143, 237, 7, 70, "Input",ExpressionUUID->"83b8c082-7d46-477a-97c0-f8e97eddf622",
 CellID->438798576],
Cell[185996, 5152, 2757, 100, 70, "Output",ExpressionUUID->"b55ca986-faad-47d2-80f6-5302f09ee1af",
 CellID->1620636825]
}, Open  ]],
Cell[CellGroupData[{
Cell[188790, 5257, 98, 3, 70, "Input",ExpressionUUID->"be9202d4-7d8e-47f0-b402-2bb14138be74",
 CellID->1266974318],
Cell[188891, 5262, 73, 2, 70, "Output",ExpressionUUID->"241a6b2f-4d7d-4493-be82-edb0be416d51",
 CellID->835282285]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[189013, 5270, 62, 1, 70, "Section",ExpressionUUID->"9f8c4f09-a87f-42cc-8155-fec7e5713c93",
 CellID->2136908654],
Cell[189078, 5273, 91, 3, 70, "Input",ExpressionUUID->"7f27658d-b315-46eb-b3ea-39440c7c19b2",
 CellID->335909506],
Cell[189172, 5278, 127, 4, 70, "Input",ExpressionUUID->"62b220c4-dfb7-40b6-8cbf-9ac25bc95298",
 CellID->210689171],
Cell[CellGroupData[{
Cell[189324, 5286, 1254, 34, 70, "Input",ExpressionUUID->"19411a30-849a-482c-8f3b-4d6b71afc155",
 CellID->2079061645],
Cell[190581, 5322, 1855, 45, 70, "Output",ExpressionUUID->"c9a66b77-316f-47a3-8fb2-8a97d600cf0e",
 CellID->232747618],
Cell[192439, 5369, 19004, 683, 70, "Output",ExpressionUUID->"595b4671-02f6-4827-a5ab-83f97a161e02",
 CellID->1221494539],
Cell[211446, 6054, 130, 4, 70, "Output",ExpressionUUID->"877e64ba-4e0b-4373-a9fa-0214709d9a83",
 CellID->1862535300],
Cell[211579, 6060, 130, 4, 70, "Output",ExpressionUUID->"7b292a9e-01d3-4a95-b89a-8e096842f8d7",
 CellID->1909148428],
Cell[211712, 6066, 9038, 284, 70, "Output",ExpressionUUID->"49a3a989-cd1d-4513-b381-7adbea441132",
 CellID->1504459569],
Cell[220753, 6352, 1539, 34, 70, "Output",ExpressionUUID->"887ed0d9-0c0a-496c-9db2-cde8989ae1ee",
 CellID->979516405]
}, Open  ]],
Cell[CellGroupData[{
Cell[222329, 6391, 474, 14, 70, "Input",ExpressionUUID->"49f83175-1cf0-48d9-8d80-3b1bb8cf68b5",
 CellID->408544247],
Cell[222806, 6407, 1004, 23, 70, "Output",ExpressionUUID->"21b91051-c985-4e96-8a79-f340329f75f6",
 CellID->197030547]
}, Open  ]],
Cell[CellGroupData[{
Cell[223847, 6435, 556, 17, 70, "Input",ExpressionUUID->"66827bb5-1469-403a-a55f-71cadf3c2a2b",
 CellID->1307807621],
Cell[224406, 6454, 7533, 273, 70, "Output",ExpressionUUID->"b9e50857-7b83-4798-aef5-95f661ca8609",
 CellID->453115970],
Cell[231942, 6729, 7533, 273, 70, "Output",ExpressionUUID->"95a17842-497c-463a-b8e1-4461f57f0639",
 CellID->543095528],
Cell[239478, 7004, 74, 2, 70, "Output",ExpressionUUID->"8b16e812-b083-4e6b-bed3-dc98b4ba237c",
 CellID->1001039346]
}, Open  ]],
Cell[CellGroupData[{
Cell[239589, 7011, 1254, 33, 70, "Input",ExpressionUUID->"564b4a86-2a02-483c-8f52-976747633777",
 CellID->1937335979],
Cell[240846, 7046, 2968, 69, 70, "Output",ExpressionUUID->"7b8bdb33-cd94-4956-9e2d-4002ac0353c5",
 CellID->241172493]
}, Open  ]],
Cell[CellGroupData[{
Cell[243851, 7120, 1148, 33, 70, "Input",ExpressionUUID->"7dcce5c3-d37b-40b3-80e0-4bc19ea228d4",
 CellID->1219417588],
Cell[245002, 7155, 7764, 268, 70, "Output",ExpressionUUID->"d160afa7-37d0-4a58-be24-574c420b8068",
 CellID->1463629310],
Cell[252769, 7425, 7764, 268, 70, "Output",ExpressionUUID->"21b80314-d877-4eb6-b304-18cfd7d7f665",
 CellID->1940120432],
Cell[260536, 7695, 73, 2, 70, "Output",ExpressionUUID->"62c0139b-9345-4476-afc0-069636a537b5",
 CellID->212404576]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[260658, 7703, 61, 1, 70, "Section",ExpressionUUID->"7f835073-913a-42fa-b48d-e28765d11782",
 CellID->94058740],
Cell[260722, 7706, 86, 1, 70, "MathCaption",ExpressionUUID->"05b0576d-536e-43ba-a5cc-54cc26a4573e",
 CellID->1881403532],
Cell[260811, 7709, 92, 3, 70, "Input",ExpressionUUID->"dd0b8d5b-18af-4425-b51b-3497a57cb942",
 CellID->938466843],
Cell[260906, 7714, 233, 6, 70, "Input",ExpressionUUID->"26ee8beb-33e6-44dc-80ed-e8af1539a964",
 CellID->393774061],
Cell[CellGroupData[{
Cell[261164, 7724, 887, 29, 70, "Input",ExpressionUUID->"df80ba93-7367-4811-a542-8ffb20914849",
 CellID->1763526820],
Cell[262054, 7755, 1714, 50, 70, "Output",ExpressionUUID->"00a2181b-89af-4833-8593-a521b30aaea2",
 CellID->1296461367]
}, Open  ]],
Cell[CellGroupData[{
Cell[263805, 7810, 1457, 45, 70, "Input",ExpressionUUID->"9c9823cf-6a19-404a-b929-5213f487cb40",
 CellID->502407381],
Cell[265265, 7857, 2781, 78, 70, "Output",ExpressionUUID->"31668325-3cbb-422f-a134-497cf76dc3e6",
 CellID->1950332730]
}, Open  ]],
Cell[CellGroupData[{
Cell[268083, 7940, 3259, 99, 70, "Input",ExpressionUUID->"7a002669-1882-4aaf-a260-d2ebc21d59ff",
 CellID->1381993784],
Cell[271345, 8041, 2414, 62, 70, "Output",ExpressionUUID->"4a52c86c-9bdc-4d03-873c-e20df3225544",
 CellID->1102932664],
Cell[273762, 8105, 3256, 83, 70, "Output",ExpressionUUID->"8c675db1-b8bc-4222-adb8-bd81af827b73",
 CellID->2057926591],
Cell[277021, 8190, 4379, 143, 70, "Output",ExpressionUUID->"34edc5d1-2275-4bc9-8e1e-0e6e1daa39fc",
 CellID->200596355],
Cell[281403, 8335, 1996, 71, 70, "Output",ExpressionUUID->"a95a36f5-797d-4470-8734-263c42c1d9ce",
 CellID->2021096342]
}, Open  ]],
Cell[CellGroupData[{
Cell[283436, 8411, 1533, 45, 70, "Input",ExpressionUUID->"65834e46-c1f5-466e-b0ce-5ba78fed1d27",
 CellID->907247650],
Cell[284972, 8458, 1246, 29, 70, "Output",ExpressionUUID->"3d16e7a6-98e3-4ba4-87a5-324e105964f5",
 CellID->1441349702],
Cell[286221, 8489, 5940, 204, 70, "Output",ExpressionUUID->"d6119f5a-01a1-499a-90a6-5e0996aca03a",
 CellID->1148903354],
Cell[292164, 8695, 3249, 63, 70, "Output",ExpressionUUID->"6bfd6ad1-32b1-4439-9ce2-67c014a64863",
 CellID->1593200501]
}, Open  ]],
Cell[CellGroupData[{
Cell[295450, 8763, 1645, 46, 70, "Input",ExpressionUUID->"3edca9b7-4eae-419e-9879-7ac0378a8515",
 CellID->772534362],
Cell[297098, 8811, 2193, 53, 70, "Output",ExpressionUUID->"dd63d511-beef-44df-a099-1e93588a2cfb",
 CellID->1205713167],
Cell[299294, 8866, 9078, 310, 70, "Output",ExpressionUUID->"fc8024c0-0036-4fd6-ab2b-1dd4761d0890",
 CellID->55467149],
Cell[308375, 9178, 35203, 972, 70, "Output",ExpressionUUID->"74a7dee8-a697-4e2a-8d21-acdf44f9ad60",
 CellID->228470445]
}, Open  ]],
Cell[CellGroupData[{
Cell[343615, 10155, 1557, 45, 70, "Input",ExpressionUUID->"a992aafb-f825-44e6-9b6d-86a9d429ec81",
 CellID->100282607],
Cell[345175, 10202, 2465, 59, 70, "Output",ExpressionUUID->"eb590c21-50e9-4cc9-b3b9-626c0589e143",
 CellID->442956337]
}, Open  ]],
Cell[CellGroupData[{
Cell[347677, 10266, 424, 12, 70, "Input",ExpressionUUID->"c3ff0ed5-6714-4a0a-af6a-a9a430b0ee59",
 CellID->674332199],
Cell[348104, 10280, 336, 8, 70, "Message",ExpressionUUID->"fe6a054f-84dd-49a8-8276-1d257e0ca49a",
 CellID->2056653329],
Cell[348443, 10290, 771, 26, 70, "Output",ExpressionUUID->"6a030f91-21a4-4ec1-9473-233dc3fa924d",
 CellID->275718391],
Cell[349217, 10318, 336, 8, 70, "Message",ExpressionUUID->"70bc0fdb-659f-49c7-9d79-22fadde3deca",
 CellID->1876770958],
Cell[349556, 10328, 1792, 56, 70, "Output",ExpressionUUID->"fab0f0ae-31c7-4dea-a2c9-ddfe32695760",
 CellID->649683970]
}, Open  ]],
Cell[CellGroupData[{
Cell[351385, 10389, 1244, 34, 70, "Input",ExpressionUUID->"1002aad0-738d-4b22-bfa1-1d6e13ee4d87",
 CellID->1630591076],
Cell[352632, 10425, 1496, 42, 70, "Output",ExpressionUUID->"9be330aa-93fd-498d-aff0-f8ce2f070b27",
 CellID->1906687649],
Cell[354131, 10469, 1033, 35, 70, "Output",ExpressionUUID->"d9b975fe-5989-4723-afee-d14ba5c82fb5",
 CellID->948336209],
Cell[355167, 10506, 691, 24, 70, "Output",ExpressionUUID->"0cad4cd2-62b5-4fdf-9bf2-2ae7b7d34bc5",
 CellID->63036629]
}, Open  ]],
Cell[CellGroupData[{
Cell[355895, 10535, 1179, 32, 70, "Input",ExpressionUUID->"81edff59-88d7-4fe1-9daa-992dc456a5e9",
 CellID->258984644],
Cell[357077, 10569, 2962, 69, 70, "Output",ExpressionUUID->"5b9ec233-bbee-4b40-98c2-9a2173f3f218",
 CellID->545536296]
}, Open  ]],
Cell[CellGroupData[{
Cell[360076, 10643, 1880, 52, 70, "Input",ExpressionUUID->"330e5ec6-f751-49e9-b828-3ae58144cadb",
 CellID->504240607],
Cell[361959, 10697, 5129, 143, 70, "Output",ExpressionUUID->"3c21b3a7-69ed-43bc-9867-e8b3492a0876",
 CellID->1197074815],
Cell[367091, 10842, 18088, 548, 70, "Output",ExpressionUUID->"0217f8de-a717-42e1-9af0-f4338c16b471",
 CellID->1207350597],
Cell[385182, 11392, 3812, 126, 70, "Output",ExpressionUUID->"594eda2a-9c99-49af-8785-1f4a0b50a826",
 CellID->1092206981]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[389043, 11524, 63, 1, 70, "Section",ExpressionUUID->"361df13c-7a88-4b5f-bd7f-ff5f0d001e0e",
 CellID->175892259],
Cell[389109, 11527, 93, 3, 70, "Input",ExpressionUUID->"580e75f9-d695-4525-847d-34239489c86e",
 CellID->1240983965],
Cell[389205, 11532, 129, 4, 70, "Input",ExpressionUUID->"b3cc23c8-4718-4245-8c8c-a8c022d7e0d0",
 CellID->1651869782],
Cell[389337, 11538, 77, 1, 70, "MathCaption",ExpressionUUID->"2a23f47d-ab7f-478b-9e22-47a6b61232e9",
 CellID->1551054522],
Cell[CellGroupData[{
Cell[389439, 11543, 973, 29, 70, "Input",ExpressionUUID->"60e6de6b-7d3d-4226-ae92-3386bec823d0",
 CellID->306837658],
Cell[390415, 11574, 1199, 30, 70, "Output",ExpressionUUID->"13e3461d-7648-4798-bd33-1bcb34d10520",
 CellID->926138891],
Cell[391617, 11606, 2281, 56, 70, "Output",ExpressionUUID->"eee1b43b-87c3-4434-822b-0b06a0db7a2e",
 CellID->831640991],
Cell[393901, 11664, 2479, 59, 70, "Output",ExpressionUUID->"30211c13-7dce-4a02-a802-04b6479b5a81",
 CellID->1566561061],
Cell[396383, 11725, 47089, 1645, 70, "Output",ExpressionUUID->"be5653e0-4c66-44ad-9814-596fde5490a0",
 CellID->504869328]
}, Open  ]],
Cell[CellGroupData[{
Cell[443509, 13375, 673, 19, 70, "Input",ExpressionUUID->"c7915e06-05c3-4b1f-bc74-8aaf65c9767d",
 CellID->830388943],
Cell[444185, 13396, 1246, 31, 70, "Output",ExpressionUUID->"686cc388-6898-420d-b24a-f300765a07af",
 CellID->536505647],
Cell[445434, 13429, 2048, 49, 70, "Output",ExpressionUUID->"3a447ae2-359a-438f-a4f7-dc19203ad67a",
 CellID->1914059023]
}, Open  ]],
Cell[CellGroupData[{
Cell[447519, 13483, 1031, 31, 70, "Input",ExpressionUUID->"32458b16-4f96-4d70-a443-fbd9452e07af",
 CellID->1766752151],
Cell[448553, 13516, 690, 22, 70, "Output",ExpressionUUID->"39df8175-68c3-4649-a815-0c76e475a97c",
 CellID->1991889151],
Cell[449246, 13540, 2918, 77, 70, "Output",ExpressionUUID->"49b9c658-1647-4839-b4a6-52a62c0f4ada",
 CellID->558387774],
Cell[452167, 13619, 6749, 220, 70, "Output",ExpressionUUID->"4e7420c4-b604-427e-88f8-d29182d6da13",
 CellID->319780228],
Cell[458919, 13841, 731, 26, 70, "Output",ExpressionUUID->"7af3e2e0-d135-4dfa-b997-41eac7b1ba75",
 CellID->1542207202],
Cell[459653, 13869, 6408, 196, 70, "Output",ExpressionUUID->"f43f46ca-c25e-4e56-9ed9-cd13e5e93af0",
 CellID->1629318803],
Cell[466064, 14067, 74, 2, 70, "Output",ExpressionUUID->"6c351203-3c7a-4ad3-bdcc-597c1ee14c2b",
 CellID->1397139124]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[466187, 14075, 66, 1, 70, "Section",ExpressionUUID->"3a8b6b81-c373-4f21-b407-5aafc2bfe00c",
 CellID->1921589536],
Cell[466256, 14078, 87, 1, 70, "MathCaption",ExpressionUUID->"26f0fec3-8aca-46ee-8a81-c19567a49c10",
 CellID->1840143414],
Cell[466346, 14081, 93, 3, 70, "Input",ExpressionUUID->"051c6c15-bbb7-43f3-80de-caa035a62f72",
 CellID->1718903328],
Cell[466442, 14086, 129, 4, 70, "Input",ExpressionUUID->"69068db9-5e83-449a-abad-c7feace9083c",
 CellID->1263298518],
Cell[CellGroupData[{
Cell[466596, 14094, 402, 12, 70, "Input",ExpressionUUID->"2cbc2c47-c843-451d-b62d-051777ab7ddc",
 CellID->87374137],
Cell[467001, 14108, 982, 25, 70, "Output",ExpressionUUID->"1201ed4a-100f-4300-877e-a9cc3b75ae50",
 CellID->909639278],
Cell[467986, 14135, 312, 11, 70, "Output",ExpressionUUID->"b569e93d-de14-4028-a469-9a9ce5f2f72f",
 CellID->371262353]
}, Open  ]],
Cell[CellGroupData[{
Cell[468335, 14151, 485, 14, 70, "Input",ExpressionUUID->"40cd287a-58f8-4da0-bd1d-58a214d299d0",
 CellID->2017341787],
Cell[468823, 14167, 1236, 31, 70, "Output",ExpressionUUID->"eaed082e-f512-4bb1-8ef0-9070b139a3ef",
 CellID->349935844],
Cell[470062, 14200, 313, 11, 70, "Output",ExpressionUUID->"7f5c11e3-4e6f-4790-89c4-9b3b8653f2e1",
 CellID->1561504622]
}, Open  ]],
Cell[CellGroupData[{
Cell[470412, 14216, 419, 12, 70, "Input",ExpressionUUID->"ee2bf6f1-48a8-4ee0-9e4b-a56274242831",
 CellID->2026449521],
Cell[470834, 14230, 952, 23, 70, "Output",ExpressionUUID->"7bf1eaf6-acfd-4d7c-8f3c-fd3d3120e845",
 CellID->1437254019],
Cell[471789, 14255, 288, 10, 70, "Output",ExpressionUUID->"a7e983dc-5ea3-4146-8417-545084e212c7",
 CellID->1032235877]
}, Open  ]],
Cell[CellGroupData[{
Cell[472114, 14270, 796, 21, 70, "Input",ExpressionUUID->"3254d8ad-5a82-40e8-a08b-d528b82ac4e3",
 CellID->487856212],
Cell[472913, 14293, 2153, 47, 70, "Output",ExpressionUUID->"6820c751-d1b6-440b-b888-349b0466d9ca",
 CellID->1174711578]
}, Open  ]],
Cell[CellGroupData[{
Cell[475103, 14345, 607, 20, 70, "Input",ExpressionUUID->"9e5b0be4-b83d-44c9-ad8c-c24ef47a6622",
 CellID->125377819],
Cell[475713, 14367, 1440, 45, 70, "Output",ExpressionUUID->"232895c4-18dd-4e4d-80a6-20ed2f7b9c68",
 CellID->358951766],
Cell[477156, 14414, 1448, 47, 70, "Output",ExpressionUUID->"2f75a617-039a-43cf-9374-90cbf07b4d75",
 CellID->620766739]
}, Open  ]],
Cell[478619, 14464, 63, 1, 70, "MathCaption",ExpressionUUID->"4937f584-e3bd-4372-9956-eed9ac3ddfc6",
 CellID->690642678],
Cell[CellGroupData[{
Cell[478707, 14469, 494, 16, 70, "Input",ExpressionUUID->"c6c0756d-3c32-4c0d-8cca-f1a1d97e8766",
 CellID->482377111],
Cell[479204, 14487, 1612, 37, 70, "Output",ExpressionUUID->"89a864fd-6b3b-46db-862a-7a969c07b069",
 CellID->1429395839]
}, Open  ]],
Cell[CellGroupData[{
Cell[480853, 14529, 823, 26, 70, "Input",ExpressionUUID->"60843d8d-9e16-4f9b-a777-3f3c424e64ce",
 CellID->497852393],
Cell[481679, 14557, 4679, 128, 70, "Output",ExpressionUUID->"6d659ecf-a3ee-4087-aba4-0f600bfa7da3",
 CellID->1426655850]
}, Open  ]],
Cell[CellGroupData[{
Cell[486395, 14690, 815, 24, 70, "Input",ExpressionUUID->"eb3fd4b9-36e7-42c6-abfa-66164e92f56c",
 CellID->1282052763],
Cell[487213, 14716, 1930, 46, 70, "Output",ExpressionUUID->"92390bfb-541c-4628-89ee-e4442c388cde",
 CellID->430954859]
}, Open  ]],
Cell[CellGroupData[{
Cell[489180, 14767, 671, 19, 70, "Input",ExpressionUUID->"672eb30b-54b5-4c29-a382-3ed912def5e1",
 CellID->1563056539],
Cell[489854, 14788, 2331, 68, 70, "Output",ExpressionUUID->"eab3d082-4f70-4afc-974d-47d47bf378ad",
 CellID->902727232]
}, Open  ]],
Cell[CellGroupData[{
Cell[492222, 14861, 1325, 39, 70, "Input",ExpressionUUID->"2825c785-229f-4787-b120-2f41018e78d1",
 CellID->1895739858],
Cell[493550, 14902, 872, 29, 70, "Output",ExpressionUUID->"20140449-baa4-4018-946d-302ff51c2e04",
 CellID->377539176],
Cell[494425, 14933, 2345, 68, 70, "Output",ExpressionUUID->"5532b521-5c4b-48c9-8ce3-c9e47593ce12",
 CellID->1552045178]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[496819, 15007, 71, 1, 70, "Section",ExpressionUUID->"19aeadbb-d371-4de2-a0b7-edce9b48f5e5",
 CellID->580366830],
Cell[496893, 15010, 93, 3, 70, "Input",ExpressionUUID->"87623246-f2fb-4e93-b98e-ee8e7c53496b",
 CellID->1518587760],
Cell[496989, 15015, 98, 1, 70, "MathCaption",ExpressionUUID->"ea782ebf-d2b9-43f2-bf03-efade47f03f1",
 CellID->2037836930],
Cell[497090, 15018, 129, 4, 70, "Input",ExpressionUUID->"88b98180-5853-4a8d-8748-2760510a4756",
 CellID->1411053746],
Cell[CellGroupData[{
Cell[497244, 15026, 656, 19, 70, "Input",ExpressionUUID->"be0236ee-cdd4-4eca-8c60-d4ca25679c94",
 CellID->2015591617],
Cell[497903, 15047, 1445, 37, 70, "Output",ExpressionUUID->"45695b60-a396-4e86-a5e0-23ce3df9d7b1",
 CellID->1983988603]
}, Open  ]],
Cell[CellGroupData[{
Cell[499385, 15089, 819, 24, 70, "Input",ExpressionUUID->"f70d68e3-649d-47c8-b1e6-066280cef31e",
 CellID->214937072],
Cell[500207, 15115, 1444, 37, 70, "Output",ExpressionUUID->"43da7480-749e-4b49-9a92-fcb03cfe402c",
 CellID->166513621]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[501700, 15158, 80, 1, 70, "Section",ExpressionUUID->"0872107b-91fc-4fdb-ba11-cf2ac6b22fb6",
 CellID->87721419],
Cell[501783, 15161, 93, 3, 70, "Input",ExpressionUUID->"c07aa67a-6532-4080-9c5e-9facbd2bd95e",
 CellID->1866561420],
Cell[501879, 15166, 129, 4, 70, "Input",ExpressionUUID->"d4df89f9-2bca-45ae-a559-20b6f772dc1c",
 CellID->1133410698],
Cell[CellGroupData[{
Cell[502033, 15174, 1087, 33, 70, "Input",ExpressionUUID->"c845a038-5078-43ce-a4a2-20274e6b10df",
 CellID->1053652396],
Cell[503123, 15209, 636, 20, 70, "Output",ExpressionUUID->"a7caef3d-7dfb-4ad3-9d8e-783122357907",
 CellID->374996509],
Cell[503762, 15231, 922, 22, 70, "Output",ExpressionUUID->"00062e7a-031d-45d0-9162-c958d29fe36e",
 CellID->1849306465],
Cell[504687, 15255, 1179, 28, 70, "Output",ExpressionUUID->"d85ba044-45ad-4219-8d9b-e54dc4b763d7",
 CellID->762934224]
}, Open  ]],
Cell[CellGroupData[{
Cell[505903, 15288, 391, 12, 70, "Input",ExpressionUUID->"2ffeaa99-9435-4c0a-82fd-fbcbcd5a80b1",
 CellID->916671498],
Cell[506297, 15302, 11307, 339, 70, "Output",ExpressionUUID->"275eced5-0942-4932-a6f7-93037d335a90",
 CellID->1820372694],
Cell[517607, 15643, 11307, 339, 70, "Output",ExpressionUUID->"c9596ce6-62e6-4c10-861c-6bd909a34937",
 CellID->1951832896],
Cell[528917, 15984, 74, 2, 70, "Output",ExpressionUUID->"9796b300-2c3d-428b-9ca4-4eb9f5acf652",
 CellID->1642775147]
}, Open  ]],
Cell[529006, 15989, 192, 4, 70, "MathCaption",ExpressionUUID->"471a7875-16e6-452c-aae1-9598905e65f3",
 CellID->1043555611],
Cell[529201, 15995, 128, 4, 70, "Input",ExpressionUUID->"cbf2528b-9ee2-4c95-8b2b-23b09db2981a",
 CellID->110969201],
Cell[CellGroupData[{
Cell[529354, 16003, 856, 26, 70, "Input",ExpressionUUID->"6a697059-f233-46c8-912d-a7370bf55333",
 CellID->540209028],
Cell[530213, 16031, 441, 14, 70, "Output",ExpressionUUID->"85a22ff1-1166-4da3-88e1-2c5f101f541d",
 CellID->792701174],
Cell[530657, 16047, 715, 15, 70, "Output",ExpressionUUID->"cdcd9c3a-6a53-445b-91fd-664c3d913b50",
 CellID->2087569077],
Cell[531375, 16064, 981, 22, 70, "Output",ExpressionUUID->"d224a0b9-edab-4100-9fd2-b3fc2beeee34",
 CellID->185652453]
}, Open  ]],
Cell[CellGroupData[{
Cell[532393, 16091, 319, 10, 70, "Input",ExpressionUUID->"b9ea8c49-5771-4ae5-b65d-0ef2634d7b0a",
 CellID->2058230597],
Cell[532715, 16103, 3078, 100, 70, "Output",ExpressionUUID->"692c7eb2-4526-4278-855e-4925aedc63d5",
 CellID->1081478322],
Cell[535796, 16205, 3077, 100, 70, "Output",ExpressionUUID->"7a229d7c-d886-492c-a024-4d3bfe3f7183",
 CellID->104569646]
}, Open  ]],
Cell[538888, 16308, 92, 1, 70, "MathCaption",ExpressionUUID->"eac1d0bd-6555-4eab-81f6-8d8c434fb89c",
 CellID->854399110],
Cell[CellGroupData[{
Cell[539005, 16313, 1202, 36, 70, "Input",ExpressionUUID->"11716258-eca4-4e70-b02d-1961bb43ed5e",
 CellID->1810177928],
Cell[540210, 16351, 710, 22, 70, "Output",ExpressionUUID->"cbb12f60-ce40-43cf-b106-97ce6fc9a26c",
 CellID->1476195010],
Cell[540923, 16375, 996, 23, 70, "Output",ExpressionUUID->"6412bacc-fb72-4754-8d51-50a758967728",
 CellID->530959279],
Cell[541922, 16400, 1215, 30, 70, "Output",ExpressionUUID->"6dcbd640-4640-4d14-ae67-d50c9795517c",
 CellID->1038048868]
}, Open  ]],
Cell[CellGroupData[{
Cell[543174, 16435, 452, 14, 70, "Input",ExpressionUUID->"40a66991-c39e-42ae-93bb-6c19860436c4",
 CellID->1035336409],
Cell[543629, 16451, 2480, 80, 70, "Output",ExpressionUUID->"3ce1f28c-ea4e-42e4-b562-9bf34fe2c9d4",
 CellID->1510087971],
Cell[546112, 16533, 2480, 80, 70, "Output",ExpressionUUID->"8a955c00-f569-48fe-bf20-24be5273fc5f",
 CellID->1086788351],
Cell[548595, 16615, 74, 2, 70, "Output",ExpressionUUID->"22e504b8-9f05-4361-a518-0ef522589905",
 CellID->1303397522]
}, Open  ]],
Cell[548684, 16620, 103, 2, 70, "MathCaption",ExpressionUUID->"715554d0-9e69-4ffa-b729-2654b39bf3a2",
 CellID->1230508662],
Cell[CellGroupData[{
Cell[548812, 16626, 1254, 37, 70, "Input",ExpressionUUID->"a0758be7-0e4d-45bb-877e-96022d538eb4",
 CellID->891561624],
Cell[550069, 16665, 868, 26, 70, "Output",ExpressionUUID->"915b8826-445a-4b36-9a10-159c59b45d12",
 CellID->152356762],
Cell[550940, 16693, 1016, 23, 70, "Output",ExpressionUUID->"47f9c880-34ec-4152-ae40-3249979d0186",
 CellID->859591710],
Cell[551959, 16718, 1267, 30, 70, "Output",ExpressionUUID->"9e7b8388-1fad-43a2-887a-f08e441b031a",
 CellID->1035376601]
}, Open  ]],
Cell[CellGroupData[{
Cell[553263, 16753, 241, 7, 70, "Input",ExpressionUUID->"eed487a7-eb59-449e-b0c6-fe4cd5bd3e5b",
 CellID->999620760],
Cell[553507, 16762, 2131, 72, 70, "Output",ExpressionUUID->"20c46110-18b6-4df8-9c22-540053db3b7a",
 CellID->850342973],
Cell[555641, 16836, 2131, 72, 70, "Output",ExpressionUUID->"31c9284b-5a9f-44fa-aa1f-2f9440a7352c",
 CellID->210676426]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[557821, 16914, 63, 1, 70, "Section",ExpressionUUID->"0ce86582-31d8-4942-9b0a-f495bc185dbf",
 CellID->462801707],
Cell[557887, 16917, 629, 20, 70, "MathCaption",ExpressionUUID->"b304d359-e7bf-4e59-a1bb-054000141312",
 CellID->122520115],
Cell[558519, 16939, 93, 3, 70, "Input",ExpressionUUID->"b28cef9c-c41d-4ccd-9d87-715c4221c209",
 CellID->1179364979],
Cell[558615, 16944, 129, 4, 70, "Input",ExpressionUUID->"0a788d03-ef32-4fb4-806e-927c065c1f68",
 CellID->1480097392],
Cell[CellGroupData[{
Cell[558769, 16952, 257, 8, 70, "Input",ExpressionUUID->"9f8c8101-fc9c-417c-9095-3ea1945f072f",
 CellID->1693784143],
Cell[559029, 16962, 654, 29, 70, "Output",ExpressionUUID->"32649de3-7e3b-4b60-8793-94b787124955",
 CellID->1078644576]
}, Open  ]],
Cell[559698, 16994, 1818, 54, 70, "Input",ExpressionUUID->"2e403921-3c96-4cf7-ac60-4fac44ae66b4",
 CellID->1636787114],
Cell[CellGroupData[{
Cell[561541, 17052, 1014, 33, 70, "Input",ExpressionUUID->"692c7048-1a95-4d6e-bd37-3600297a648f",
 CellID->215506928],
Cell[562558, 17087, 6518, 160, 70, "Output",ExpressionUUID->"3ed3fecc-6507-4b43-b65b-3277135f0d15",
 CellID->1400065847]
}, Open  ]],
Cell[CellGroupData[{
Cell[569113, 17252, 1014, 33, 70, "Input",ExpressionUUID->"fb2a9e33-df53-43f8-8211-71ffbb650e8a",
 CellID->1371487384],
Cell[570130, 17287, 6521, 160, 70, "Output",ExpressionUUID->"312e4c04-e87a-4430-b346-3db3f9b5239b",
 CellID->1076573899]
}, Open  ]],
Cell[CellGroupData[{
Cell[576688, 17452, 1163, 40, 70, "Input",ExpressionUUID->"1dbefcc7-33d9-4d20-9edc-3f6cd249cd8d",
 CellID->2056467464],
Cell[577854, 17494, 130, 4, 70, "Output",ExpressionUUID->"d326bd0b-b4c1-4775-81b0-b9347f8f5cb8",
 CellID->1943446821],
Cell[577987, 17500, 129, 4, 70, "Output",ExpressionUUID->"51b2da7a-18e9-44e8-9b83-aa4e0f776bb8",
 CellID->284449677],
Cell[578119, 17506, 90, 3, 70, "Output",ExpressionUUID->"28da5ab1-dae9-49fb-81da-d4b689450867",
 CellID->447123117],
Cell[578212, 17511, 129, 4, 70, "Output",ExpressionUUID->"d128ff47-3db0-4ec8-9e7d-f1cf49303891",
 CellID->752946566],
Cell[578344, 17517, 130, 4, 70, "Output",ExpressionUUID->"d1fa663a-b75a-4d8b-9194-e2e74c338776",
 CellID->1799286638],
Cell[578477, 17523, 91, 3, 70, "Output",ExpressionUUID->"61d22524-f75f-4f25-8b64-675c49fc0223",
 CellID->1893291459]
}, Open  ]],
Cell[578583, 17529, 260, 6, 70, "MathCaption",ExpressionUUID->"ceced1ed-b635-4cda-ad12-a6103dfcf6b8",
 CellID->1291620282],
Cell[CellGroupData[{
Cell[578868, 17539, 333, 10, 70, "Input",ExpressionUUID->"ece446e4-e675-4ad2-a12d-2a1d1580685f",
 CellID->1497375698],
Cell[579204, 17551, 130, 4, 70, "Output",ExpressionUUID->"ae0ba493-0e51-4c03-b460-363346c95580",
 CellID->32497093]
}, Open  ]],
Cell[CellGroupData[{
Cell[579371, 17560, 188, 6, 70, "Input",ExpressionUUID->"770e9863-93f1-4471-bfa5-ab6057649fba",
 CellID->717795713],
Cell[579562, 17568, 130, 4, 70, "Output",ExpressionUUID->"bc65db65-096a-4563-abd4-db7ac5953f7b",
 CellID->1576903192]
}, Open  ]],
Cell[CellGroupData[{
Cell[579729, 17577, 188, 7, 70, "Input",ExpressionUUID->"e2dc1706-4e8a-4091-967d-388cb99611c0",
 CellID->916260317],
Cell[579920, 17586, 12515, 228, 70, "Output",ExpressionUUID->"ddc22f1f-1869-456d-b87a-5f8557091b33",
 CellID->2129398829]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[592484, 17820, 77, 1, 70, "Section",ExpressionUUID->"e7a86481-301e-4a46-ae11-eca7b1684751",
 CellID->991141748],
Cell[592564, 17823, 630, 24, 70, "MathCaption",ExpressionUUID->"2cb63b69-aa81-41e8-8da9-0f99d85344c0",
 CellID->623127415],
Cell[593197, 17849, 93, 3, 70, "Input",ExpressionUUID->"fccc2eaa-c1f2-49dd-8b7c-f8b2e813111b",
 CellID->1624724280],
Cell[593293, 17854, 129, 4, 70, "Input",ExpressionUUID->"df0127f6-86de-460e-8aec-b78da566ff6f",
 CellID->1455738726],
Cell[CellGroupData[{
Cell[593447, 17862, 1714, 48, 70, "Input",ExpressionUUID->"2e30ef55-3668-4cca-a54d-63a9b024a6db",
 CellID->319577611],
Cell[595164, 17912, 3534, 86, 70, "Output",ExpressionUUID->"be19979b-b2bf-45df-ada7-448f8b9a4b3a",
 CellID->1012169222]
}, Open  ]],
Cell[CellGroupData[{
Cell[598735, 18003, 1336, 41, 70, "Input",ExpressionUUID->"29685182-d007-4797-a040-f2f86aa58d8b",
 CellID->195457935],
Cell[600074, 18046, 933, 34, 70, "Output",ExpressionUUID->"bf3f92e4-9874-48cc-9274-5d5afffd0183",
 CellID->426414260],
Cell[601010, 18082, 933, 34, 70, "Output",ExpressionUUID->"221f96b3-795c-4bd2-9633-2182ef874113",
 CellID->591537781],
Cell[601946, 18118, 934, 34, 70, "Output",ExpressionUUID->"6e8449cf-16a8-4d55-b4e9-11571dce459e",
 CellID->1273683304],
Cell[602883, 18154, 184, 6, 70, "Output",ExpressionUUID->"6474d700-a9a9-4488-a72a-e00dc5885a4a",
 CellID->678297032],
Cell[603070, 18162, 185, 6, 70, "Output",ExpressionUUID->"5729fb46-d757-468e-a03f-14505c5b3b20",
 CellID->1295018548],
Cell[603258, 18170, 118, 4, 70, "Output",ExpressionUUID->"587d56a6-e0cd-48e4-a5eb-864e03308ac4",
 CellID->629973891]
}, Open  ]],
Cell[603391, 18177, 114, 3, 70, "MathCaption",ExpressionUUID->"55a86f5b-b7a9-43d9-88e7-f79f0e9e7b3a",
 CellID->1155670419],
Cell[CellGroupData[{
Cell[603530, 18184, 635, 17, 70, "Input",ExpressionUUID->"27208b6f-9fda-4a97-89db-0afe6bc0636c",
 CellID->1510628665],
Cell[604168, 18203, 2331, 68, 70, "Output",ExpressionUUID->"28d72248-3413-409c-9020-14b3492d3bd1",
 CellID->533051619]
}, Open  ]],
Cell[CellGroupData[{
Cell[606536, 18276, 522, 16, 70, "Input",ExpressionUUID->"3d5c991c-aeb2-4618-b8cf-a50f04ad36b9",
 CellID->643738394],
Cell[607061, 18294, 2334, 68, 70, "Output",ExpressionUUID->"482cb6a8-a75c-4031-b039-c50f65af26f6",
 CellID->689512107]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[609444, 18368, 164, 7, 70, "TutorialMoreAboutSection",ExpressionUUID->"99dec6b9-6493-451c-abf5-9b95f4eea3e9",
 CellID->23220180],
Cell[609611, 18377, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"9ac6756f-9af2-43c8-b8f1-00f0e71ecb54"],
Cell[609645, 18379, 161, 3, 70, "TutorialMoreAbout",ExpressionUUID->"87a06fc9-15ac-4de9-9a55-594cf2cb3308",
 CellID->495491210],
Cell[609809, 18384, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"4007c803-efa2-4772-906b-3c1138676632"]
}, Open  ]],
Cell[CellGroupData[{
Cell[609877, 18389, 167, 7, 70, "RelatedTutorialsSection",ExpressionUUID->"3c90dbe9-abaf-4207-b423-08baa638db99",
 CellID->415694126],
Cell[610047, 18398, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"bc3de8ee-260b-4059-ae6d-24f0ab4a8041"],
Cell[610081, 18400, 161, 3, 70, "RelatedTutorials",ExpressionUUID->"50749c48-6fe5-4530-8367-ece87ec26d1a",
 CellID->2025894544],
Cell[610245, 18405, 167, 3, 70, "RelatedTutorials",ExpressionUUID->"1d5565b4-bbe4-494b-9b02-df3d8392a2f1",
 CellID->1648188840],
Cell[610415, 18410, 177, 4, 70, "RelatedTutorials",ExpressionUUID->"2cc59e63-ff7d-496a-80f1-f5366e5f44dc",
 CellID->2091818538],
Cell[610595, 18416, 223, 6, 70, "RelatedTutorials",ExpressionUUID->"468bc192-ecfd-4ff1-8c69-d697d948072f",
 CellID->981314606],
Cell[610821, 18424, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"d42d1fe9-72b1-4df5-9b46-3b567fcd7b74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[610889, 18429, 193, 7, 70, "TutorialRelatedLinksSection",ExpressionUUID->"4d632015-e6b4-4b71-8f46-09239bd3321c",
 CellID->415694148],
Cell[611085, 18438, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"130eccd1-5d52-4b60-b9f0-fcbd1ed7469d"],
Cell[611119, 18440, 286, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"bbec50c3-9888-4584-9bd1-1376bbaea64e",
 CellID->454917981],
Cell[611408, 18449, 302, 7, 70, "TutorialRelatedLinks",ExpressionUUID->"985a9fe1-8353-4570-9219-0d2a5670d176",
 CellID->1480169507]
}, Open  ]]
}, Open  ]],
Cell[611737, 18460, 23, 0, 70, "FooterCell",ExpressionUUID->"c8fce1e9-0ab5-40a0-92e7-b018beb0e2c0"]
}
]
*)

(* End of internal cache information *)
