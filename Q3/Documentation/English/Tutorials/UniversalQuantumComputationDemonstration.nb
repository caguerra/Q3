(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80382,       2202]
NotebookOptionsPosition[     72546,       2036]
NotebookOutlinePosition[     75349,       2101]
CellTagsIndexPosition[     75306,       2098]
WindowTitle->Universal Quantum Computation: Demonstration
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TUTORIAL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "03e8e804-f4d9-4848-87c8-649cc43f4355"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "c9fa75d9-16bd-4f24-aa86-edbd0c0228d8"],
        Background->RGBColor[
         0.7450980392156863, 0.3254901960784314, 0.1411764705882353],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tutorials",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "888575f6-3067-42e2-88b1-41fadd88f98f"]
         }],ExpressionUUID->"834312bb-b192-4639-b859-ba929102a9ca"],
         StripOnInput->
          False], {"\<\"Quantum Computation and Quantum Information with Q3\"\
\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"], \
"\<\"Universal Quantum Computation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/UniversalQuantumComputation"], \
"\<\"QuantumCircuit Usage Examples\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumCircuitUsage"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumTeleportation"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b827b179-7f18-4a1d-9f99-2cb749a651c0"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "29ef2c59-c91d-4eb3-bf30-597a9e2d59a8"]
         }],ExpressionUUID->"7576ed82-9e56-411d-80f4-fb7e706b187f"],
         StripOnInput->
          False], {"\<\"Quantum Computation and Quantum Information\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/guide/QuantumComputationAndQuantumInformation"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "27588054-7747-4af9-a1a3-4c68e2e64b94"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "48521063-6e91-4289-8eea-5b4951efd253"]
         }],ExpressionUUID->"4bfa1183-4e07-48f5-bc29-39eceaef1ac2"],
         StripOnInput->False], {"\<\"GrayTwoLevelU\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/GrayTwoLevelU"], "\<\"TwoLevelDecomposition\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/TwoLevelDecomposition"], "\<\"TwoLevelU\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/TwoLevelU"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4ea0cf9b-f141-4ea0-9b29-c0e6abb73fa6"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "517db4b9-d7d7-41f8-abba-beabb6614f94"]
         }],ExpressionUUID->"0c7eeec3-07ae-443c-8bf8-67f65403bcbc"],
         StripOnInput->
          False], {"\<\"Q3/tutorial/UniversalQuantumComputationDemonstration\"\
\>":>None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell["Q3/tutorial/UniversalQuantumComputationDemonstration"]}, 
             Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        Delimiter, "\<\"Copy web URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell[
               BoxData[
                MakeBoxes[
                 Hyperlink[
                 "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputationDemonstration.html"], StandardForm]], "Input", 
               TextClipboardType -> "PlainText"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; 
         Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
          NotebookLocate[{
            URL[If[
               TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$252463], 
               "http://reference.wolfram.com/system-modeler/", 
               "http://reference.wolfram.com/language/"] <> 
             "Q3/tutorial/UniversalQuantumComputationDemonstration" <> 
             ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "991ee21a-be78-45e6-908a-41a8a0e18597"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "cbada0fa-4a28-46ef-87d1-a0b292f50186"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"53c807ec-bf06-4e60-9cc2-f1f4ed9d3465"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Universal Quantum Computation: Demonstration", "Title",ExpressionUUID->
      "70e66afa-f869-4e8c-960e-803d02bcb0b4"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"4ca7f9c0-ecc9-4c47-8515-1cc56c12a46f"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "29477ee3-c3c5-4da5-8590-08e90ce47402"]
    }],ExpressionUUID->"29b94829-6015-4383-98f5-a930f98fa920"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 13\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
        Right, Center}],
       AxesStyle->Large,
       FrameStyle->Large,
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "edd7b22f-164c-4ceb-a5d3-e156bdad1b08"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,
 CellID->310927883,ExpressionUUID->"e173124a-22b7-4900-af0b-26400dc5c23f"],

Cell["\<\
Here we provide a simple demonstration that any arbitrary unitary operation \
can be implemented by combining CNOT gate and single-qubit rotations.\
\>", "Text",
 CellID->1534169418,ExpressionUUID->"506d7408-6da2-475b-9311-598376415d41"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelDecomposition"]], 
      "paclet:Q3/ref/TwoLevelDecomposition", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TableText",ExpressionUUID->"3f3d6552-cde8-4823-be4e-1a91c685a34b"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TableText",ExpressionUUID->
     "32852631-861b-4f52-9d69-b712a6bd9cd8"]},
   {
    TemplateBox[{
      Cell[
       TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrites a two-level unitary operators in terms of CNOT and \
controlled-unitary gates\
\>", "TableText",ExpressionUUID->"0829c041-3040-4e26-bf89-b39900f19d3e"]}
  }]], "DefinitionBox",
 CellID->2096742444,ExpressionUUID->"59882110-ac7d-4355-a41b-a42ab0012cdc"],

Cell["\<\
Some functions conveniently used for the demonstration of universal quantum \
computation.\
\>", "Caption",
 CellID->1891092685,ExpressionUUID->"0d9f366d-25df-49bf-97e6-9c7595a754b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 1. Decomposition into two-Level unitary operations", "Subsection",
 CellID->1707128225,ExpressionUUID->"3605fb2f-7659-4560-a0cb-fceca6101338"],

Cell["\<\
We first decompose the unitary operation into two-level unitary operations, \
that is, unitary operators acting only on a two-dimensional subspace.\
\>", "Text",
 CellID->915265898,ExpressionUUID->"941b01a3-81af-43ca-85ea-c2542b02d15a"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2058623809,ExpressionUUID->"6d7d77eb-4269-4eb3-9f57-a74437be6dd8"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->526990913,ExpressionUUID->"cee55c33-44fe-4cbb-aeec-2b8485e3a23f"],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "20529acc-b109-4f68-84a0-19e9e4074eb8"],
 " unitary matrix."
}], "MathCaption",
 CellID->679432361,ExpressionUUID->"48191f37-cbba-4c0a-9fe3-4e0725a35dd6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1893084922,ExpressionUUID->"0e05b597-dcaa-4643-bedb-b5529de54e9f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.04290064431651064`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4896643062756701`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2297947064735421`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2730924419504529`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2657577234002205`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.21517238065223648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0964375576410251`"}], "-", 
       RowBox[{"0.7104764524154807`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.3140825159274006`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.04359073346229306`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0684689094862267`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.27205416456509457`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.755415771056892`"}], "+", 
       RowBox[{"0.43877220072980144`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.23292055376777474`"}], "+", 
       RowBox[{"0.05765887147048508`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35213019935361217`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.30708011817998004`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7192609505574507`"}], "-", 
       RowBox[{"0.21982834752585173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07245592364382512`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.18180083599787208`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.047064073871935945`"}], "-", 
       RowBox[{"0.4189616622782714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2778559954950203`"}], "+", 
       RowBox[{"0.601948994941394`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4391845306615894`"}], "-", 
       RowBox[{"0.188068024016943`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10314955034390082`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2663802041933207`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35653568098847865`"}], "+", 
       RowBox[{"0.3514041617373028`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1799526331,ExpressionUUID->"65ec1201-469f-4015-973c-e3bc383cd8e4"]
}, Open  ]],

Cell["\<\
This is an explicit operator expression of the unitary transformation.\
\>", "MathCaption",
 CellID->535905292,ExpressionUUID->"007e8f0e-361e-4251-8742-32a85a07916a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1603109497,ExpressionUUID->"4dc4f1cc-37b9-4122-ae85-ee39a028e4fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.043177550885479046`"}], "+", 
    RowBox[{"0.3237308671439849`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11363996745050496`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.09680336686250157`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13842939017273903`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.34602705211436213`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10546648279174989`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11139473536551382`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24933913858399764`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0787567545908757`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0964375576410251`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.7104764524154807`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.755415771056892`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.43877220072980144`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3956573650076008`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05950604708151852`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.7192609505574507`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.21982834752585173`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2778559954950203`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.601948994941394`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09886232778684773`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.057128368276397445`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.016418584816222895`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1364156260613608`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04352716565398862`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.24757407109846152`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10085583486564692`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.012001703992786189`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09136531630080308`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07293461016390926`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.20861603313565072`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1549854688278069`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->936741998,ExpressionUUID->"6d56440f-1d47-455f-856b-7b48798c5dab"]
}, Open  ]],

Cell[TextData[{
 "\[LineSeparator]Here is a two-level decomposition, where the results are in \
terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "05bc6098-3a7b-4ab4-b33b-2b88a01f6ed2"],
 "."
}], "MathCaption",
 CellID->445690626,ExpressionUUID->"045ec128-2a57-498c-9345-b63a80abb1e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[9]:=",
 CellID->874151237,ExpressionUUID->"3c778605-2782-4839-94e7-86d78fd378fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.9845057518669844`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.17535228695635405`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.20713001626198127`"}], "+", 
          RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3606599513847742`"}], "-", 
          RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9313532554349825`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9313532554349825`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.3606599513847742`"}], "+", 
          RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.15741059565731794`"}], "-", 
          RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.6202730057309884`"}], "-", 
          RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.15741059565731794`"}], "+", 
          RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8708549832646049`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8708549832646049`"}], ",", 
         RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.912157804537438`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.912157804537438`"}], ",", 
         RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.12140326962613521`"}], "-", 
          RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->957276195,ExpressionUUID->"90a25ef3-691d-4abd-a81e-ec5864ee6188"]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "17a764cc-7477-4efb-9189-2f0f6d6cd43d"],
 "."
}], "MathCaption",
 CellID->1307945734,ExpressionUUID->"fd3e690a-b0b8-4735-a0c5-932dab862fbe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->344948808,ExpressionUUID->"120b2da9-03bd-48aa-8584-1d4c9a806adc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.9845057518669844`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.17535228695635405`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.9845057518669844, 0.17535228695635405`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.20713001626198127`"}], "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.4341531879165092, -0.378609424861444], Complex[
         0.20713001626198127`, 0.7907357771034078], Complex[
         0.4341531879165092, 0.378609424861444], 
         Complex[-0.20713001626198127`, 0.7907357771034078]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.3606599513847742`"}], "-", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], 
        "0.9313532554349825`", "0"},
       {"0", 
        RowBox[{"-", "0.9313532554349825`"}], 
        RowBox[{
         RowBox[{"-", "0.3606599513847742`"}], "+", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.3606599513847742, -0.05005510021758498], 
         0.9313532554349825, 
         Complex[-0.3606599513847742, 
          0.05005510021758498], -0.9313532554349825, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.15741059565731794`"}], "-", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6202730057309884`"}], "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.15741059565731794`"}], "+", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.15741059565731794`, -0.2808086976564618], 
         Complex[-0.6202730057309884, -0.7152830055696386], 
         Complex[-0.15741059565731794`, 0.2808086976564618], Complex[
         0.6202730057309884, -0.7152830055696386]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], 
        "0.8708549832646049`", "0", "0"},
       {
        RowBox[{"-", "0.8708549832646049`"}], 
        RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[0.042900644316510646`, 0.4896643062756702], 
         0.8708549832646049, Complex[
         0.042900644316510646`, -0.4896643062756702], -0.8708549832646049, 1, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], 
        "0.912157804537438`", "0"},
       {"0", 
        RowBox[{"-", "0.912157804537438`"}], 
        RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.2638725285949477, 0.3135911801603312], 0.912157804537438,
          Complex[
         0.2638725285949477, -0.3135911801603312], -0.912157804537438, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.12140326962613521`"}], "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.33455696451046996`, 0.2708761107540548], 
         Complex[-0.12140326962613521`, -0.8944042800905982], Complex[
         0.33455696451046996`, -0.2708761107540548], Complex[
         0.12140326962613521`, -0.8944042800905982]}}]]]]}], "}"}]], "Output",\

 CellLabel->"Out[10]=",
 CellID->1103995177,ExpressionUUID->"bc3330c6-74b0-4ce5-b0bf-8bf6143fb2f5"]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "MathCaption",
 CellID->732431213,ExpressionUUID->"af5ce418-7ece-43ee-bf0c-4fd0dcfd7113"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[11]:=",
 CellID->367426686,ExpressionUUID->"8c04bb88-d92f-4eef-9eba-2776a43f6dfe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->1972002259,ExpressionUUID->"135c22cf-92c7-4fc5-a304-943c740f3552"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2. Rewriting two-level unitary operators to elementary gates.\
\>", "Subsection",
 CellID->1577472075,ExpressionUUID->"ae65a0e9-769b-4235-932a-140f7b1ff150"],

Cell["\<\
Now we rewrite each two-level unitary operator in terms of elementary gates, \
that is, in a combination of CNOT gates and one controlled-U gate.\
\>", "Text",
 CellID->485925136,ExpressionUUID->"cf9ff1e6-74cf-41c8-a13c-cc75db233056"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "12cc2cec-c10f-468a-92a2-194b88ec6130"],
 " does the job."
}], "MathCaption",
 CellID->441254417,ExpressionUUID->"35f3bd62-9a3f-40e8-ab1d-e26d1159044a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Catenate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"GrayTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", "nn"}]}], "]"}], "&"}], "/@", "mm"}], 
   "]"}]}]], "Input",
 CellLabel->"In[13]:=",
 CellID->268246946,ExpressionUUID->"b7c156e1-8cc0-48c4-a7bb-f67f1e771a3d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.9922528759334922`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.08767614347817702`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.007747124066507793`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.08767614347817702`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.4341531879165092`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.378609424861444`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.20713001626198127`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7907357771034078`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.3606599513847742`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9313532554349825`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05005510021758498`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.15741059565731794`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2808086976564618`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6202730057309884`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7152830055696386`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.042900644316510646`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4896643062756702`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{"0.8708549832646049`", " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{"0.8708549832646049`", " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.2638725285949477`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.912157804537438`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3135911801603312`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.33455696451046996`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2708761107540548`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"+\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.12140326962613521`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8944042800905982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"-\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[13]=",
 CellID->799215880,ExpressionUUID->"90f44909-cbca-45fc-8fe2-be71df1da7e4"]
}, Open  ]],

Cell["\<\
Here is a quantum circuit model of the decomposition. Here controlled-U gates \
are all labeled by the same character \"U\" but in fact they are different \
operators. Also do not forget to reverse the order of the elementary gates in \
the quantum circuit model.\
\>", "MathCaption",
 CellID->342917987,ExpressionUUID->"a5773fd3-bc3e-4a97-b28b-a6f2607e0c73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Reverse", "@", "gates"}], "]"}]}]], "Input",
 CellLabel->"In[14]:=",
 CellID->970727010,ExpressionUUID->"ac2f2a0c-ef79-48ba-8fd5-2ebf3f30dbf7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{13, -1}, {13, -2}}], DiskBox[{13, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {13, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[14]=",
 CellID->1942160583,ExpressionUUID->"a9d7f768-a41f-418d-b647-fd6a92bb3da6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->1356294199,ExpressionUUID->"7270f73f-98e4-4bb6-bea6-fb3cfad338d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.043177550885479046`"}], "+", 
    RowBox[{"0.3237308671439848`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.46224256868759717`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.02760409893246564`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4927564989031319`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05439331458835906`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3224982517957991`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.00962535375467856`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.16345622477530533`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.036315904338638405`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2750957921195744`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.08186782766950922`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06913140083619713`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.07315911321180145`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12194793648224461`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.11731615837442422`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.22871089373993797`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.01648145369049455`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11363996745050495`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.09680336686250163`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.013554290418882849`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05557922251855029`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1919948485799111`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.029972875235105775`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09886232778684781`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05712836827639746`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1499906747182267`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.04102542933194875`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11396003949585798`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05862535841742376`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10085583486564692`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.01200170399278608`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[15]=",
 CellID->125388609,ExpressionUUID->"5de41de1-be82-4d0c-b0cd-58c3bea0399e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "opU"}], "//", "Elaborate"}], "//", "Chop"}]], "Input",\

 CellLabel->"In[16]:=",
 CellID->1665455186,ExpressionUUID->"4f89a65f-338f-4f28-bde3-8eff0ba4b088"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[16]=",
 CellID->1760688896,ExpressionUUID->"1ae468de-26a2-419b-b489-7e7e4fd49042"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/guide/QuantumComputationAndQuantumInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "3cbdb991-e08b-4cf1-bc54-82a43178ab92"]}]}
     }]}
  }]], "TutorialMoreAboutSection",
 CellID->937216430,ExpressionUUID->"38bdfdfc-586a-42d8-bfd8-8c70727a6b4c"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tutorials"}], "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"]], 
         "RelatedTutorials",ExpressionUUID->
         "15160600-da45-487c-ad1e-441ebf7eff43"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Universal Quantum Computation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/UniversalQuantumComputation"]], 
         "RelatedTutorials",ExpressionUUID->
         "287e2688-0beb-41a7-b682-2d9ab3d3624c"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "QuantumCircuit Usage Examples",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumCircuitUsage"]], 
         "RelatedTutorials",ExpressionUUID->
         "13b0721b-464d-4dbf-a09b-705df51f97ae"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Fourier Transform",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumFourierTransform"]], 
         "RelatedTutorials",ExpressionUUID->
         "4c7814bc-80f0-4504-b9b0-7dd4c8e4b442"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Teleportation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], 
         "RelatedTutorials",ExpressionUUID->
         "87faadc6-d82d-4934-89c0-e1821411a729"]}]}
     }]}
  }]], "RelatedTutorialsSection",
 CellID->3988265,ExpressionUUID->"18396f7e-aa46-4348-bb7f-81d863c7d65c"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{
         "Related", " ", "Wolfram", " ", "Education", " ", "Group", " ", 
          "Courses"}], "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-EIWL.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "An Elementary Introduction to the Wolfram Language"}]]]], 
          "https://www.wolfram.com/language/elementary-introduction/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "4457ea76-e96e-48b9-a242-4a3287f4582c"]], "TutorialRelatedLinks",
        ExpressionUUID->"1baf245c-0778-4387-9b04-2a0d7dd2076a"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-FastIntro.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "The Wolfram Language: Fast Introduction for Programmers"}]]]],
           "https://www.wolfram.com/language/fast-introduction-for-\
programmers/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "76fbac60-548b-4070-978d-8ea873215b8a"]], "TutorialRelatedLinks",
        ExpressionUUID->"46ba1b9e-dcc8-4f5c-bca4-3c524b4f4404"]}
     }]}
  }]], "TutorialRelatedLinksSection",
 CellID->458776798,ExpressionUUID->"9b7d6db6-3b02-4705-b44f-8e9fc5e47fa9"],

Cell[" ", "FooterCell",
 CellID->1195351256,ExpressionUUID->"0062b6f6-db9f-4ae1-8586-1eacaf5ef11b"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation: Demonstration",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", "2021"}, 
  "ShowCitation" -> False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 4, 4, 12, 52, 47.603212}", 
    "history" -> {"12", "13", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "Here we provide a simple demonstration that any arbitrary unitary \
operation can be implemented by combining CNOT gate and single-qubit \
rotations. Some functions conveniently used for the demonstration of \
universal quantum computation. We first decompose the unitary operation into \
two-level unitary operations, that is, unitary operators acting only on a \
two-dimensional subspace.", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$252409, "title" -> 
    "Universal Quantum Computation: Demonstration", "titlemodifier" -> "", 
    "windowtitle" -> "Universal Quantum Computation: Demonstration", "type" -> 
    "Tutorial", "uri" -> 
    "Q3/tutorial/UniversalQuantumComputationDemonstration", 
    "WorkflowDockedCell" -> ""}, "SearchTextTranslated" -> ""},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]], 
    CellID -> 1988822498], 
   Cell[
    StyleData["Input"], CellContext -> Notebook, CellID -> 556758331], 
   Cell[
    StyleData["Output"], CellContext -> Notebook, CellID -> 851019138], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 837563346], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 171850137], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 2067230991]}, 
  Visible -> False, FrontEndVersion -> 
  "13.0 for Mac OS X ARM (64-bit) (February 4, 2022)", StyleDefinitions -> 
  "Default.nb"],
ExpressionUUID->"2bcffb90-72e7-4439-be2a-a1d660eeba4d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[616, 21, 7581, 181, 57, "AnchorBarGrid",ExpressionUUID->"53c807ec-bf06-4e60-9cc2-f1f4ed9d3465",
 CellID->1],
Cell[CellGroupData[{
Cell[8222, 206, 1220, 32, 105, "ObjectNameGrid",ExpressionUUID->"e173124a-22b7-4900-af0b-26400dc5c23f",
 CellID->310927883],
Cell[9445, 240, 247, 4, 60, "Text",ExpressionUUID->"506d7408-6da2-475b-9311-598376415d41",
 CellID->1534169418],
Cell[9695, 246, 1189, 29, 141, "DefinitionBox",ExpressionUUID->"59882110-ac7d-4355-a41b-a42ab0012cdc",
 CellID->2096742444],
Cell[10887, 277, 193, 4, 36, "Caption",ExpressionUUID->"0d9f366d-25df-49bf-97e6-9c7595a754b1",
 CellID->1891092685]
}, Open  ]],
Cell[CellGroupData[{
Cell[11117, 286, 153, 1, 59, "Subsection",ExpressionUUID->"3605fb2f-7659-4560-a0cb-fceca6101338",
 CellID->1707128225],
Cell[11273, 289, 246, 4, 60, "Text",ExpressionUUID->"941b01a3-81af-43ca-85ea-c2542b02d15a",
 CellID->915265898],
Cell[11522, 295, 146, 3, 29, "Input",ExpressionUUID->"6d7d77eb-4269-4eb3-9f57-a74437be6dd8",
 CellID->2058623809],
Cell[11671, 300, 181, 4, 29, "Input",ExpressionUUID->"cee55c33-44fe-4cbb-aeec-2b8485e3a23f",
 CellID->526990913],
Cell[11855, 306, 396, 12, 37, "MathCaption",ExpressionUUID->"48191f37-cbba-4c0a-9fe3-4e0725a35dd6",
 CellID->679432361],
Cell[CellGroupData[{
Cell[12276, 322, 366, 9, 66, "Input",ExpressionUUID->"0e05b597-dcaa-4643-bedb-b5529de54e9f",
 CellID->1893084922],
Cell[12645, 333, 2672, 59, 100, "Output",ExpressionUUID->"65ec1201-469f-4015-973c-e3bc383cd8e4",
 CellID->1799526331]
}, Open  ]],
Cell[15332, 395, 176, 3, 36, "MathCaption",ExpressionUUID->"007e8f0e-361e-4251-8742-32a85a07916a",
 CellID->535905292],
Cell[CellGroupData[{
Cell[15533, 402, 448, 12, 66, "Input",ExpressionUUID->"4dc4f1cc-37b9-4122-ae85-ee39a028e4fd",
 CellID->1603109497],
Cell[15984, 416, 8086, 250, 111, "Output",ExpressionUUID->"6d56440f-1d47-455f-856b-7b48798c5dab",
 CellID->936741998]
}, Open  ]],
Cell[24085, 669, 485, 13, 70, "MathCaption",ExpressionUUID->"045ec128-2a57-498c-9345-b63a80abb1e0",
 CellID->445690626],
Cell[CellGroupData[{
Cell[24595, 686, 198, 4, 70, "Input",ExpressionUUID->"3c778605-2782-4839-94e7-86d78fd378fd",
 CellID->874151237],
Cell[24796, 692, 5346, 141, 140, "Output",ExpressionUUID->"90a25ef3-691d-4abd-a81e-ec5864ee6188",
 CellID->957276195]
}, Open  ]],
Cell[30157, 836, 481, 13, 70, "MathCaption",ExpressionUUID->"fd3e690a-b0b8-4735-a0c5-932dab862fbe",
 CellID->1307945734],
Cell[CellGroupData[{
Cell[30663, 853, 188, 4, 70, "Input",ExpressionUUID->"120b2da9-03bd-48aa-8584-1d4c9a806adc",
 CellID->344948808],
Cell[30854, 859, 9030, 224, 294, "Output",ExpressionUUID->"bc3330c6-74b0-4ce5-b0bf-8bf6143fb2f5",
 CellID->1103995177]
}, Open  ]],
Cell[39899, 1086, 147, 1, 70, "MathCaption",ExpressionUUID->"af5ce418-7ece-43ee-bf0c-4fd0dcfd7113",
 CellID->732431213],
Cell[CellGroupData[{
Cell[40071, 1091, 347, 10, 70, "Input",ExpressionUUID->"8c04bb88-d92f-4eef-9eba-2776a43f6dfe",
 CellID->367426686],
Cell[40421, 1103, 668, 19, 100, "Output",ExpressionUUID->"135c22cf-92c7-4fc5-a304-943c740f3552",
 CellID->1972002259]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41138, 1128, 172, 3, 70, "Subsection",ExpressionUUID->"ae65a0e9-769b-4235-932a-140f7b1ff150",
 CellID->1577472075],
Cell[41313, 1133, 244, 4, 70, "Text",ExpressionUUID->"cf9ff1e6-74cf-41c8-a13c-cc75db233056",
 CellID->485925136],
Cell[41560, 1139, 419, 12, 70, "MathCaption",ExpressionUUID->"35f3bd62-9a3f-40e8-ab1d-e26d1159044a",
 CellID->441254417],
Cell[CellGroupData[{
Cell[42004, 1155, 336, 10, 70, "Input",ExpressionUUID->"b7c156e1-8cc0-48c4-a7bb-f67f1e771a3d",
 CellID->268246946],
Cell[42343, 1167, 11019, 325, 187, "Output",ExpressionUUID->"90f44909-cbca-45fc-8fe2-be71df1da7e4",
 CellID->799215880]
}, Open  ]],
Cell[53377, 1495, 369, 6, 70, "MathCaption",ExpressionUUID->"a5773fd3-bc3e-4a97-b28b-a6f2607e0c73",
 CellID->342917987],
Cell[CellGroupData[{
Cell[53771, 1505, 224, 5, 70, "Input",ExpressionUUID->"ac2f2a0c-ef79-48ba-8fd5-2ebf3f30dbf7",
 CellID->970727010],
Cell[53998, 1512, 4684, 105, 96, "Output",ExpressionUUID->"a9d7f768-a41f-418d-b647-fd6a92bb3da6",
 CellID->1942160583]
}, Open  ]],
Cell[CellGroupData[{
Cell[58719, 1622, 192, 4, 70, "Input",ExpressionUUID->"7270f73f-98e4-4bb6-bea6-fb3cfad338d5",
 CellID->1356294199],
Cell[58914, 1628, 8094, 250, 111, "Output",ExpressionUUID->"5de41de1-be82-4d0c-b0cd-58c3bea0399e",
 CellID->125388609]
}, Open  ]],
Cell[CellGroupData[{
Cell[67045, 1883, 215, 6, 70, "Input",ExpressionUUID->"4f89a65f-338f-4f28-bde3-8eff0ba4b088",
 CellID->1665455186],
Cell[67263, 1891, 128, 2, 37, "Output",ExpressionUUID->"1ae468de-26a2-419b-b489-7e7e4fd49042",
 CellID->1760688896]
}, Open  ]]
}, Open  ]],
Cell[67418, 1897, 773, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"38bdfdfc-586a-42d8-bfd8-8c70727a6b4c",
 CellID->937216430],
Cell[68194, 1918, 2062, 52, 70, "RelatedTutorialsSection",ExpressionUUID->"18396f7e-aa46-4348-bb7f-81d863c7d65c",
 CellID->3988265],
Cell[70259, 1972, 2181, 59, 70, "TutorialRelatedLinksSection",ExpressionUUID->"9b7d6db6-3b02-4705-b44f-8e9fc5e47fa9",
 CellID->458776798],
Cell[72443, 2033, 99, 1, 70, "FooterCell",ExpressionUUID->"0062b6f6-db9f-4ae1-8586-1eacaf5ef11b",
 CellID->1195351256]
}
]
*)

(* End of internal cache information *)

