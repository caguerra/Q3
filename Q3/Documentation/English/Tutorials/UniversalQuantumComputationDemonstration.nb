(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80519,       2199]
NotebookOptionsPosition[     72745,       2034]
NotebookOutlinePosition[     75481,       2098]
CellTagsIndexPosition[     75438,       2095]
WindowTitle->Universal Quantum Computation: Demonstration
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TUTORIAL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "ab3ff239-322a-4cd3-a296-f4accfa2c503"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "5108e2d6-c223-4198-b680-834642e3ed0b"],
        Background->RGBColor[
         0.7450980392156863, 0.3254901960784314, 0.1411764705882353],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "58d00072-7379-4c74-a6f3-2b4775c45eb9"]
         }],ExpressionUUID->"4d8659ab-fbad-4f04-8fa8-685105f9880c"],
         StripOnInput->
          False], {"\<\"Quantum Computation and Information: Overview\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumComputationAndInformationOverview"], \
"\<\"Universal Quantum Computation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/UniversalQuantumComputation"], \
"\<\"QuantumCircuit Usage Examples\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumCircuitUsage"], "\<\"Quantum Fourier \
Transform\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumFourierTransform"], "\<\"Quantum \
Teleportation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumTeleportation"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "57db7b7d-850f-40f5-8b28-ae0f364862be"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "27915bf9-b3c6-400b-8d3a-523fc4a461d8"]
         }],ExpressionUUID->"11571a89-dd54-49da-87f9-1f299fd814a5"],
         StripOnInput->False], {"\<\"Quantum Computation and Information\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/guide/QuantumComputationAndInformation"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b812cbde-1b73-4c16-9c75-85f504189276"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f80f07c8-1909-480a-900e-6f3c811c89e2"]
         }],ExpressionUUID->"a9a072ad-43b5-468d-8f6f-0a1b1f7af3ad"],
         StripOnInput->False], {"\<\"FromTwoLevelU\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/FromTwoLevelU"], "\<\"TwoLevelDecomposition\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/TwoLevelDecomposition"], "\<\"TwoLevelU\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/TwoLevelU"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b8b9b7c9-9eec-4ea9-a1f8-d1d90de4b25b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "aeee9ab6-783b-4c00-9f57-35c77727ab86"]
         }],ExpressionUUID->"672dff01-12dd-436d-bdc2-fda6d89db015"],
         StripOnInput->
          False], {"\<\"Q3/tutorial/UniversalQuantumComputationDemonstration\"\
\>":>None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell["Q3/tutorial/UniversalQuantumComputationDemonstration"]}, 
             Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        Delimiter, "\<\"Copy web URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell[
               BoxData[
                MakeBoxes[
                 Hyperlink[
                 "http://reference.wolfram.com/language/Q3/tutorial/\
UniversalQuantumComputationDemonstration.html"], StandardForm]], "Input", 
               TextClipboardType -> "PlainText"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; 
         Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
          NotebookLocate[{
            URL[If[
               TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$313439], 
               "http://reference.wolfram.com/system-modeler/", 
               "http://reference.wolfram.com/language/"] <> 
             "Q3/tutorial/UniversalQuantumComputationDemonstration" <> 
             ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "cf73b6a6-665a-430b-8976-b6796909e865"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "1e36a7c0-86d4-4bc1-a040-daf2db921698"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"1032f3a8-b45c-4c37-9d5b-baaada1eeaae"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Universal Quantum Computation: Demonstration", "Title",ExpressionUUID->
      "b157a54c-644d-4ce1-8a61-79f2f8ee0919"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"1b3098c3-7c1a-4620-b7ab-e6310e2488aa"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "f61f5605-a18c-43d2-ae59-1d15c833a993"]
    }],ExpressionUUID->"137bf330-f4cb-4f15-a6a3-419988cb5bd2"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 13\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
        Right, Center}],
       AxesStyle->Large,
       FrameStyle->Large,
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "9bfde415-8dd7-4b0c-a76a-d744afd94e07"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,
 CellID->1420411552,ExpressionUUID->"d8c4df6c-4f95-4eeb-b691-c68bc764aa7b"],

Cell["\<\
Here we provide a simple demonstration that any arbitrary unitary operation \
can be implemented by combining CNOT gate and single-qubit rotations.\
\>", "Text",
 CellID->1534169418,ExpressionUUID->"506d7408-6da2-475b-9311-598376415d41"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelDecomposition"]], 
      "paclet:Q3/ref/TwoLevelDecomposition", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TableText",ExpressionUUID->"3f3d6552-cde8-4823-be4e-1a91c685a34b"]},
   {
    TemplateBox[{
      Cell[
       TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TableText",ExpressionUUID->
     "32852631-861b-4f52-9d69-b712a6bd9cd8"]},
   {
    TemplateBox[{
      Cell[
       TextData["FromTwoLevelU"]], "paclet:Q3/ref/FromTwoLevelU", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Rewrites a two-level unitary operators in terms of CNOT and \
controlled-unitary gates\
\>", "TableText",ExpressionUUID->"0829c041-3040-4e26-bf89-b39900f19d3e"]}
  }]], "DefinitionBox",
 CellID->2096742444,ExpressionUUID->"59882110-ac7d-4355-a41b-a42ab0012cdc"],

Cell["\<\
Some functions conveniently used for the demonstration of universal quantum \
computation.\
\>", "Caption",
 CellID->1891092685,ExpressionUUID->"0d9f366d-25df-49bf-97e6-9c7595a754b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 1. Decomposition into two-Level unitary operations", "Subsection",
 CellID->1707128225,ExpressionUUID->"3605fb2f-7659-4560-a0cb-fceca6101338"],

Cell["\<\
We first decompose the unitary operation into two-level unitary operations, \
that is, unitary operators acting only on a two-dimensional subspace.\
\>", "Text",
 CellID->915265898,ExpressionUUID->"941b01a3-81af-43ca-85ea-c2542b02d15a"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2058623809,ExpressionUUID->"6d7d77eb-4269-4eb3-9f57-a74437be6dd8"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->526990913,ExpressionUUID->"cee55c33-44fe-4cbb-aeec-2b8485e3a23f"],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "20529acc-b109-4f68-84a0-19e9e4074eb8"],
 " unitary matrix."
}], "MathCaption",
 CellID->679432361,ExpressionUUID->"48191f37-cbba-4c0a-9fe3-4e0725a35dd6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1893084922,ExpressionUUID->"0e05b597-dcaa-4643-bedb-b5529de54e9f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.0801212537839394`"}], "-", 
       RowBox[{"0.38478123847133716`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.39261523920436325`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6608797801137795`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.43563581254576306`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.11653589757716883`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.05692774654279957`"}], "+", 
       RowBox[{"0.21912377431682695`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.3531579803338201`"}], "-", 
       RowBox[{"0.5624729727857112`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.01879478207981465`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4631243487869316`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.27051646580756117`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.44225689259839585`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24658294477056292`"}], "-", 
       RowBox[{"0.12038572823997498`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.45886798189131717`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.41153540868957283`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2494732839481074`"}], "-", 
       RowBox[{"0.3204023782779211`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2692875136168007`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6165266511016954`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04996276557266353`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00818686310105427`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.15638243093855436`"}], "-", 
       RowBox[{"0.0071342069032884325`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.09917222814149598`"}], "+", 
       RowBox[{"0.1397284855137482`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2737304521476738`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.01792398220579478`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6360791387699756`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6828529545499948`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1792307039,ExpressionUUID->"e16fea47-dddd-4218-a4ca-1f581e76d7d2"]
}, Open  ]],

Cell["\<\
This is an explicit operator expression of the unitary transformation.\
\>", "MathCaption",
 CellID->535905292,ExpressionUUID->"007e8f0e-361e-4251-8742-32a85a07916a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{"nn", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1603109497,ExpressionUUID->"4dc4f1cc-37b9-4122-ae85-ee39a028e4fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.21101004517066288`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.5368212982274898`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0669688973223552`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.003004201716823751`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17132623681584985`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.32634645850636257`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3134442162407469`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.290198477495753`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.341109378658163`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0019249153314030779`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.05692774654279957`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.21912377431682695`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.27051646580756117`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.44225689259839585`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.27902010501640656`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.2756319471016605`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2494732839481074`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.3204023782779211`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"+\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.15638243093855436`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0071342069032884325`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"-\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24167328102272526`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11286850459835536`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09452643388760007`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11846081290857191`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1798478768749106`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.13590346158791233`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11642691525423224`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.03616735344097349`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2212890023885134`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.3345333216074169`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"+\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.03971376409307317`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.2722744952899582`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"-\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1607092334,ExpressionUUID->"0f1a9286-2828-4677-bccb-febd773ebb66"]
}, Open  ]],

Cell[TextData[{
 "\[LineSeparator]Here is a two-level decomposition, where the results are in \
terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "05bc6098-3a7b-4ab4-b33b-2b88a01f6ed2"],
 "."
}], "MathCaption",
 CellID->445690626,ExpressionUUID->"045ec128-2a57-498c-9345-b63a80abb1e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[9]:=",
 CellID->874151237,ExpressionUUID->"3c778605-2782-4839-94e7-86d78fd378fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.9612078627021521`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.27582502547731425`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.7215515657948587`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6471229857792068`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.2394602140488487`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.05704371186092415`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.2394602140488487`"}], "+", 
          RowBox[{"0.05704371186092415`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.7215515657948587`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6471229857792068`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.3840661739901499`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6117003003202021`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.691603872592355`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.691603872592355`"}], ",", 
         RowBox[{"0.3840661739901499`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6117003003202021`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.5359913675773293`"}], "+", 
          RowBox[{"0.8273978547059709`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.02619275812314076`"}], "-", 
          RowBox[{"0.16565018361729528`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.02619275812314076`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.16565018361729528`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.5359913675773293`"}], "-", 
          RowBox[{"0.8273978547059709`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.0801212537839394`"}], "-", 
          RowBox[{"0.38478123847133716`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9195237806672286`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9195237806672286`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.0801212537839394`"}], "+", 
          RowBox[{"0.38478123847133716`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.42697671061804643`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.7187196177071453`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.5487558653105111`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5487558653105111`"}], ",", 
         RowBox[{"0.42697671061804643`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7187196177071453`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.8633391477028942`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.23094979704060886`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.11281889772490646`"}], "+", 
          RowBox[{"0.4342575314334557`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.11281889772490646`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4342575314334557`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.8633391477028942`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.23094979704060886`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1733077504,ExpressionUUID->"95d03b76-899a-461f-acb2-72d570ecbb96"]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "17a764cc-7477-4efb-9189-2f0f6d6cd43d"],
 "."
}], "MathCaption",
 CellID->1307945734,ExpressionUUID->"fd3e690a-b0b8-4735-a0c5-932dab862fbe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->344948808,ExpressionUUID->"120b2da9-03bd-48aa-8584-1d4c9a806adc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.9612078627021521`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.27582502547731425`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.9612078627021521, 0.27582502547731425`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.7215515657948587`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6471229857792068`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.2394602140488487`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05704371186092415`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.2394602140488487`"}], "+", 
         RowBox[{"0.05704371186092415`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.7215515657948587`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6471229857792068`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.7215515657948587, -0.6471229857792068], Complex[
         0.2394602140488487, 0.05704371186092415], Complex[
         0.7215515657948587, 0.6471229857792068], 
         Complex[-0.2394602140488487, 0.05704371186092415]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.3840661739901499`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6117003003202021`", " ", "\[ImaginaryI]"}]}], 
        "0.691603872592355`", "0"},
       {"0", 
        RowBox[{"-", "0.691603872592355`"}], 
        RowBox[{"0.3840661739901499`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6117003003202021`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.3840661739901499, 0.6117003003202021], 0.691603872592355,
          Complex[
         0.3840661739901499, -0.6117003003202021], -0.691603872592355, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.5359913675773293`"}], "+", 
         RowBox[{"0.8273978547059709`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.02619275812314076`"}], "-", 
         RowBox[{"0.16565018361729528`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.02619275812314076`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.16565018361729528`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.5359913675773293`"}], "-", 
         RowBox[{"0.8273978547059709`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.5359913675773293, 0.8273978547059709], 
         Complex[-0.02619275812314076, -0.16565018361729528`], 
         Complex[-0.5359913675773293, -0.8273978547059709], Complex[
         0.02619275812314076, -0.16565018361729528`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.0801212537839394`"}], "-", 
         RowBox[{"0.38478123847133716`", " ", "\[ImaginaryI]"}]}], 
        "0.9195237806672286`", "0", "0"},
       {
        RowBox[{"-", "0.9195237806672286`"}], 
        RowBox[{
         RowBox[{"-", "0.0801212537839394`"}], "+", 
         RowBox[{"0.38478123847133716`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.0801212537839394, -0.38478123847133716`], 
         0.9195237806672286, 
         Complex[-0.0801212537839394, 
          0.38478123847133716`], -0.9195237806672286, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.42697671061804643`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7187196177071453`", " ", "\[ImaginaryI]"}]}], 
        "0.5487558653105111`", "0"},
       {"0", 
        RowBox[{"-", "0.5487558653105111`"}], 
        RowBox[{"0.42697671061804643`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7187196177071453`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.42697671061804643`, 0.7187196177071453], 
         0.5487558653105111, Complex[
         0.42697671061804643`, -0.7187196177071453], -0.5487558653105111, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.8633391477028942`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.23094979704060886`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.11281889772490646`"}], "+", 
         RowBox[{"0.4342575314334557`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.11281889772490646`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4342575314334557`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.8633391477028942`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.23094979704060886`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.8633391477028942, -0.23094979704060886`], 
         Complex[-0.11281889772490646`, 0.4342575314334557], Complex[
         0.8633391477028942, 0.23094979704060886`], Complex[
         0.11281889772490646`, 0.4342575314334557]}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->504530279,ExpressionUUID->"ec9046c2-da3c-47cc-920c-9dc7c5ab7db8"]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "MathCaption",
 CellID->732431213,ExpressionUUID->"af5ce418-7ece-43ee-bf0c-4fd0dcfd7113"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[11]:=",
 CellID->367426686,ExpressionUUID->"8c04bb88-d92f-4eef-9eba-2776a43f6dfe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->344549082,ExpressionUUID->"41a74fd0-ba90-4149-8f4e-35548b20109e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2. Rewriting two-level unitary operators to elementary gates.\
\>", "Subsection",
 CellID->1577472075,ExpressionUUID->"ae65a0e9-769b-4235-932a-140f7b1ff150"],

Cell["\<\
Now we rewrite each two-level unitary operator in terms of elementary gates, \
that is, in a combination of CNOT gates and one controlled-U gate.\
\>", "Text",
 CellID->485925136,ExpressionUUID->"cf9ff1e6-74cf-41c8-a13c-cc75db233056"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["FromTwoLevelU"]], "paclet:Q3/ref/FromTwoLevelU", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "12cc2cec-c10f-468a-92a2-194b88ec6130"],
 " does the job."
}], "MathCaption",
 CellID->441254417,ExpressionUUID->"35f3bd62-9a3f-40e8-ab1d-e26d1159044a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Catenate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FromTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", "nn"}]}], "]"}], "&"}], "/@", "mm"}], 
   "]"}]}]], "Input",
 CellLabel->"In[13]:=",
 CellID->268246946,ExpressionUUID->"b7c156e1-8cc0-48c4-a7bb-f67f1e771a3d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.980603931351076`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.13791251273865712`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.01939606864892396`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13791251273865712`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.7215515657948587`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05704371186092415`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2394602140488487`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6471229857792068`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.3840661739901499`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.691603872592355`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6117003003202021`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.5359913675773293`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.16565018361729528`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.02619275812314076`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8273978547059709`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.0801212537839394`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9195237806672286`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.38478123847133716`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"{", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"], "}"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.42697671061804643`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5487558653105111`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.7187196177071453`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.8633391477028942`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4342575314334557`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"x\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.11281889772490646`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.23094979704060886`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"]}]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[13]=",
 CellID->1056629910,ExpressionUUID->"5f7088ba-bb82-4516-9b7a-86a46bedeef4"]
}, Open  ]],

Cell["\<\
Here is a quantum circuit model of the decomposition. Here controlled-U gates \
are all labeled by the same character \"U\" but in fact they are different \
operators. Also do not forget to reverse the order of the elementary gates in \
the quantum circuit model.\
\>", "MathCaption",
 CellID->342917987,ExpressionUUID->"a5773fd3-bc3e-4a97-b28b-a6f2607e0c73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Reverse", "@", "gates"}]}], "]"}]}]], "Input",
 CellLabel->"In[14]:=",
 CellID->970727010,ExpressionUUID->"ac2f2a0c-ef79-48ba-8fd5-2ebf3f30dbf7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -2}}], 
    DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -1}, {8, -2}}], 
    DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{13, -1}, {13, -2}}], 
    DiskBox[{13, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {13, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->550.8000000000001,
  PlotRange->NCache[{
     Rational[-5, 2], 
     Rational[-1, 2]}, {-2.5, -0.5}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[14]=",
 CellID->603726882,ExpressionUUID->"fcf140f5-d0bd-4cc1-8c0f-dc87a2bba875"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->1356294199,ExpressionUUID->"7270f73f-98e4-4bb6-bea6-fb3cfad338d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.21101004517066294`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.5368212982274898`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.048066748905475146`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.08346102043350333`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13410032241405043`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10513376633997842`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.31006474183728494`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.13685351588512873`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24722931302410817`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.15486110853785598`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.05858833983520199`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.022533763273266047`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13877843121653177`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0310446368208781`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.07105898971244866`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.018073990505304772`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3082724680010579`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.2423852265282986`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06696889732235523`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0030042017168236713`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.13718715538125548`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.1271821372482422`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.008721324339670251`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.042660721493655414`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24167328102272534`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11286850459835539`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09078761914772021`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.031129413158729396`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3034039084486877`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.13050138324079327`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.11642691525423228`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.03616735344097352`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[15]=",
 CellID->160208019,ExpressionUUID->"a465e5db-878c-4da2-a557-639461555a10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "opU"}], "//", "Elaborate"}], "//", "Chop"}]], "Input",\

 CellLabel->"In[16]:=",
 CellID->1665455186,ExpressionUUID->"4f89a65f-338f-4f28-bde3-8eff0ba4b088"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[16]=",
 CellID->1490152469,ExpressionUUID->"91a27245-db0c-407d-8c20-583522070e96"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Information",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/QuantumComputationAndInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "3cbdb991-e08b-4cf1-bc54-82a43178ab92"]}]}
     }]}
  }]], "TutorialMoreAboutSection",
 CellID->1428734412,ExpressionUUID->"5feae1ea-0743-4e6b-91ca-ef0040da8507"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Information: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndInformationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "15160600-da45-487c-ad1e-441ebf7eff43"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Universal Quantum Computation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/UniversalQuantumComputation"]], 
         "RelatedTutorials",ExpressionUUID->
         "287e2688-0beb-41a7-b682-2d9ab3d3624c"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "QuantumCircuit Usage Examples",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumCircuitUsage"]], 
         "RelatedTutorials",ExpressionUUID->
         "13b0721b-464d-4dbf-a09b-705df51f97ae"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Fourier Transform",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumFourierTransform"]], 
         "RelatedTutorials",ExpressionUUID->
         "4c7814bc-80f0-4504-b9b0-7dd4c8e4b442"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Teleportation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumTeleportation"]], 
         "RelatedTutorials",ExpressionUUID->
         "87faadc6-d82d-4934-89c0-e1821411a729"]}]}
     }]}
  }]], "RelatedTutorialsSection",
 CellID->1724605377,ExpressionUUID->"abfd3956-b766-42d9-b265-6688e765fe53"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{
         "Related", " ", "Wolfram", " ", "Education", " ", "Group", " ", 
          "Courses"}], "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-EIWL.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "An Elementary Introduction to the Wolfram Language"}]]]], 
          "https://www.wolfram.com/language/elementary-introduction/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "8fd7639d-6766-4924-a80e-381f4b101e49"]], "TutorialRelatedLinks",
        ExpressionUUID->"1baf245c-0778-4387-9b04-2a0d7dd2076a"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-FastIntro.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "The Wolfram Language: Fast Introduction for Programmers"}]]]],
           "https://www.wolfram.com/language/fast-introduction-for-\
programmers/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "a6c5287e-41c6-438b-af3d-24237f0b2e8a"]], "TutorialRelatedLinks",
        ExpressionUUID->"46ba1b9e-dcc8-4f5c-bca4-3c524b4f4404"]}
     }]}
  }]], "TutorialRelatedLinksSection",
 CellID->855787680,ExpressionUUID->"55d264f0-b93f-4b32-89c4-90089531268b"],

Cell[" ", "FooterCell",
 CellID->1525553801,ExpressionUUID->"e0d6c4ca-0f5f-4eab-807c-d4f4bb6b74a8"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation: Demonstration",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", "2021"}, 
  "ShowCitation" -> False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 8, 14, 14, 40, 21.274828}", 
    "history" -> {"12", "13", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> "None", 
    "summary" -> 
    "Here we provide a simple demonstration that any arbitrary unitary \
operation can be implemented by combining CNOT gate and single-qubit \
rotations. Some functions conveniently used for the demonstration of \
universal quantum computation. We first decompose the unitary operation into \
two-level unitary operations, that is, unitary operators acting only on a \
two-dimensional subspace.", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$313384, "title" -> 
    "Universal Quantum Computation: Demonstration", "titlemodifier" -> "", 
    "windowtitle" -> "Universal Quantum Computation: Demonstration", "type" -> 
    "Tutorial", "uri" -> 
    "Q3/tutorial/UniversalQuantumComputationDemonstration"}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]], 
    CellID -> 1175471874], 
   Cell[
    StyleData["Input"], CellContext -> Notebook, CellID -> 1453717565], 
   Cell[
    StyleData["Output"], CellContext -> Notebook, CellID -> 709663036], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 182470614], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 176961582], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}, CellID -> 2075941226]}, 
  Visible -> False, FrontEndVersion -> 
  "13.1 for Mac OS X ARM (64-bit) (June 16, 2022)", StyleDefinitions -> 
  "Default.nb"],
ExpressionUUID->"f77a906b-993b-45c7-a9be-6eb244cd181e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[616, 21, 7558, 180, 57, "AnchorBarGrid",ExpressionUUID->"1032f3a8-b45c-4c37-9d5b-baaada1eeaae",
 CellID->1],
Cell[CellGroupData[{
Cell[8199, 205, 1221, 32, 105, "ObjectNameGrid",ExpressionUUID->"d8c4df6c-4f95-4eeb-b691-c68bc764aa7b",
 CellID->1420411552],
Cell[9423, 239, 247, 4, 60, "Text",ExpressionUUID->"506d7408-6da2-475b-9311-598376415d41",
 CellID->1534169418],
Cell[9673, 245, 1189, 29, 141, "DefinitionBox",ExpressionUUID->"59882110-ac7d-4355-a41b-a42ab0012cdc",
 CellID->2096742444],
Cell[10865, 276, 193, 4, 36, "Caption",ExpressionUUID->"0d9f366d-25df-49bf-97e6-9c7595a754b1",
 CellID->1891092685]
}, Open  ]],
Cell[CellGroupData[{
Cell[11095, 285, 153, 1, 59, "Subsection",ExpressionUUID->"3605fb2f-7659-4560-a0cb-fceca6101338",
 CellID->1707128225],
Cell[11251, 288, 246, 4, 60, "Text",ExpressionUUID->"941b01a3-81af-43ca-85ea-c2542b02d15a",
 CellID->915265898],
Cell[11500, 294, 146, 3, 29, "Input",ExpressionUUID->"6d7d77eb-4269-4eb3-9f57-a74437be6dd8",
 CellID->2058623809],
Cell[11649, 299, 181, 4, 29, "Input",ExpressionUUID->"cee55c33-44fe-4cbb-aeec-2b8485e3a23f",
 CellID->526990913],
Cell[11833, 305, 396, 12, 37, "MathCaption",ExpressionUUID->"48191f37-cbba-4c0a-9fe3-4e0725a35dd6",
 CellID->679432361],
Cell[CellGroupData[{
Cell[12254, 321, 366, 9, 66, "Input",ExpressionUUID->"0e05b597-dcaa-4643-bedb-b5529de54e9f",
 CellID->1893084922],
Cell[12623, 332, 2677, 58, 100, "Output",ExpressionUUID->"e16fea47-dddd-4218-a4ca-1f581e76d7d2",
 CellID->1792307039]
}, Open  ]],
Cell[15315, 393, 176, 3, 36, "MathCaption",ExpressionUUID->"007e8f0e-361e-4251-8742-32a85a07916a",
 CellID->535905292],
Cell[CellGroupData[{
Cell[15516, 400, 448, 12, 66, "Input",ExpressionUUID->"4dc4f1cc-37b9-4122-ae85-ee39a028e4fd",
 CellID->1603109497],
Cell[15967, 414, 8087, 249, 111, "Output",ExpressionUUID->"0f1a9286-2828-4677-bccb-febd773ebb66",
 CellID->1607092334]
}, Open  ]],
Cell[24069, 666, 485, 13, 70, "MathCaption",ExpressionUUID->"045ec128-2a57-498c-9345-b63a80abb1e0",
 CellID->445690626],
Cell[CellGroupData[{
Cell[24579, 683, 198, 4, 70, "Input",ExpressionUUID->"3c778605-2782-4839-94e7-86d78fd378fd",
 CellID->874151237],
Cell[24780, 689, 5349, 141, 140, "Output",ExpressionUUID->"95d03b76-899a-461f-acb2-72d570ecbb96",
 CellID->1733077504]
}, Open  ]],
Cell[30144, 833, 481, 13, 70, "MathCaption",ExpressionUUID->"fd3e690a-b0b8-4735-a0c5-932dab862fbe",
 CellID->1307945734],
Cell[CellGroupData[{
Cell[30650, 850, 188, 4, 70, "Input",ExpressionUUID->"120b2da9-03bd-48aa-8584-1d4c9a806adc",
 CellID->344948808],
Cell[30841, 856, 9029, 223, 294, "Output",ExpressionUUID->"ec9046c2-da3c-47cc-920c-9dc7c5ab7db8",
 CellID->504530279]
}, Open  ]],
Cell[39885, 1082, 147, 1, 70, "MathCaption",ExpressionUUID->"af5ce418-7ece-43ee-bf0c-4fd0dcfd7113",
 CellID->732431213],
Cell[CellGroupData[{
Cell[40057, 1087, 347, 10, 70, "Input",ExpressionUUID->"8c04bb88-d92f-4eef-9eba-2776a43f6dfe",
 CellID->367426686],
Cell[40407, 1099, 667, 19, 100, "Output",ExpressionUUID->"41a74fd0-ba90-4149-8f4e-35548b20109e",
 CellID->344549082]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41123, 1124, 172, 3, 70, "Subsection",ExpressionUUID->"ae65a0e9-769b-4235-932a-140f7b1ff150",
 CellID->1577472075],
Cell[41298, 1129, 244, 4, 70, "Text",ExpressionUUID->"cf9ff1e6-74cf-41c8-a13c-cc75db233056",
 CellID->485925136],
Cell[41545, 1135, 419, 12, 70, "MathCaption",ExpressionUUID->"35f3bd62-9a3f-40e8-ab1d-e26d1159044a",
 CellID->441254417],
Cell[CellGroupData[{
Cell[41989, 1151, 336, 10, 70, "Input",ExpressionUUID->"b7c156e1-8cc0-48c4-a7bb-f67f1e771a3d",
 CellID->268246946],
Cell[42328, 1163, 10783, 319, 169, "Output",ExpressionUUID->"5f7088ba-bb82-4516-9b7a-86a46bedeef4",
 CellID->1056629910]
}, Open  ]],
Cell[53126, 1485, 369, 6, 70, "MathCaption",ExpressionUUID->"a5773fd3-bc3e-4a97-b28b-a6f2607e0c73",
 CellID->342917987],
Cell[CellGroupData[{
Cell[53520, 1495, 257, 6, 70, "Input",ExpressionUUID->"ac2f2a0c-ef79-48ba-8fd5-2ebf3f30dbf7",
 CellID->970727010],
Cell[53780, 1503, 5106, 113, 95, "Output",ExpressionUUID->"fcf140f5-d0bd-4cc1-8c0f-dc87a2bba875",
 CellID->603726882]
}, Open  ]],
Cell[CellGroupData[{
Cell[58923, 1621, 192, 4, 70, "Input",ExpressionUUID->"7270f73f-98e4-4bb6-bea6-fb3cfad338d5",
 CellID->1356294199],
Cell[59118, 1627, 8098, 249, 111, "Output",ExpressionUUID->"a465e5db-878c-4da2-a557-639461555a10",
 CellID->160208019]
}, Open  ]],
Cell[CellGroupData[{
Cell[67253, 1881, 215, 6, 70, "Input",ExpressionUUID->"4f89a65f-338f-4f28-bde3-8eff0ba4b088",
 CellID->1665455186],
Cell[67471, 1889, 128, 2, 37, "Output",ExpressionUUID->"91a27245-db0c-407d-8c20-583522070e96",
 CellID->1490152469]
}, Open  ]]
}, Open  ]],
Cell[67626, 1895, 748, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"5feae1ea-0743-4e6b-91ca-ef0040da8507",
 CellID->1428734412],
Cell[68377, 1915, 2078, 53, 70, "RelatedTutorialsSection",ExpressionUUID->"abfd3956-b766-42d9-b265-6688e765fe53",
 CellID->1724605377],
Cell[70458, 1970, 2181, 59, 70, "TutorialRelatedLinksSection",ExpressionUUID->"55d264f0-b93f-4b32-89c4-90089531268b",
 CellID->855787680],
Cell[72642, 2031, 99, 1, 70, "FooterCell",ExpressionUUID->"e0d6c4ca-0f5f-4eab-807c-d4f4bb6b74a8",
 CellID->1525553801]
}
]
*)

(* End of internal cache information *)

