(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    137379,       3644]
NotebookOptionsPosition[    121077,       3337]
NotebookOutlinePosition[    124081,       3404]
CellTagsIndexPosition[    124038,       3401]
WindowTitle->Quantum Fourier Transform
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 TUTORIAL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "a937f8e1-1412-4fa0-b9bc-87791d36742d"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "34af1b5c-c465-43ad-b76c-8f62626b3f44"],
        Background->RGBColor[
         0.7450980392156863, 0.3254901960784314, 0.1411764705882353],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tutorials",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "e1f63bbb-d65c-4405-a218-74bdcba5c582"]
         }],ExpressionUUID->"47c0ad93-96a8-4a0a-9e55-fd03fe7dd5bc"],
         StripOnInput->
          False], {"\<\"Quantum Fourier Transform: Semiclassical \
Implementation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumFourierTransformSemiclassical"], \
"\<\"Quantum Phase Estimation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumPhaseEstimation"], "\<\"Quantum Algorithms\
\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumAlgorithms"], "\<\"QuantumCircuit Usage \
Examples\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumCircuitUsage"], "\<\"Quantum Computation \
and Quantum Information with Q3\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "e3725252-9d5c-4665-b2f7-92e13a510f33"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "ee5aa744-90f8-4384-842e-2988c98424f8"]
         }],ExpressionUUID->"d3a35dde-fb7f-4a71-907b-8cc2e6283bd5"],
         StripOnInput->
          False], {"\<\"Quantum Computation and Quantum Information\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/guide/QuantumComputationAndQuantumInformation"], "\<\"Q3\"\
\>":>Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "7a6f95e1-9a38-4c1e-8670-6d546476a7a0"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f88d863b-8258-4ed7-80b8-faecbc716b32"]
         }],ExpressionUUID->"00afcded-bb60-44c0-aded-a3e06a6aaf1e"],
         StripOnInput->False], {"\<\"Q3/tutorial/QuantumFourierTransform\"\>":>
        None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell["Q3/tutorial/QuantumFourierTransform"]}, Visible -> 
             False]]; SelectionMove[
          DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        Delimiter, "\<\"Copy web URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell[
               BoxData[
                MakeBoxes[
                 Hyperlink[
                 "http://reference.wolfram.com/language/Q3/tutorial/\
QuantumFourierTransform.html"], StandardForm]], "Input", TextClipboardType -> 
               "PlainText"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; 
         Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
          NotebookLocate[{
            URL[If[
               TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$241716], 
               "http://reference.wolfram.com/system-modeler/", 
               "http://reference.wolfram.com/language/"] <> 
             "Q3/tutorial/QuantumFourierTransform" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "6005d43c-f539-47a3-95be-48b0d9e8930f"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "5d372b14-0a9c-42ee-97b3-e54b44aeaf7b"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"e411c953-54b7-4810-a6c6-649a04e4389b"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Quantum Fourier Transform", "Title",ExpressionUUID->
      "685f12ab-9a26-40a9-be74-0c4fa14314f7"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"096bbb1b-ea6c-463d-af52-8add0955b554"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "ccb0a2e4-eabd-420f-9e1c-f7b53254ab75"]
    }],ExpressionUUID->"0bfb620a-ae24-406f-a8a9-d6639fd091c9"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 13\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
        Right, Center}],
       AxesStyle->Large,
       FrameStyle->Large,
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "185022bc-6df1-4b89-87e1-813e7cb19047"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"3efa51f5-e76b-4d2f-b644-2b803efa5f4a"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Definition"], 
      "paclet:Q3/tutorial/QuantumFourierTransform#1875748448", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Quantum Implementation"], 
      "paclet:Q3/tutorial/QuantumFourierTransform#727891409", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Physical Meaning"], 
      "paclet:Q3/tutorial/QuantumFourierTransform#1970601676", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Semiclassical Implementation"], 
      "paclet:Q3/tutorial/QuantumFourierTransform#1845626348", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, AxesStyle -> Large, 
        FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TutorialJumpBox",ExpressionUUID->"7da89246-a699-49cf-8560-\
f48655096547"],

Cell[TextData[{
 "See also Section 4.3 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://github.com/quantum-mob/QuantumWorkbook"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "5f071724-0dd3-476b-a1d9-833147f623b8"],
 "."
}], "Text",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"ab227918-b61e-46da-a398-95b487931509"],

Cell["\<\
The quantum Fourier transform is a unitary transformation of quantum states. \
It is analogous to the discrete Fourier transform of a finite set of numbers. \
In the case of the quantum Fourier transform, the numbers are replaced with \
quantum states.\
\>", "Text",
 CellID->1636777126,ExpressionUUID->"59a29ca2-12bb-42a4-bc4d-10edc5f31cc3"],

Cell[TextData[{
 "The quantum Fourier transform can be performed efficiently on a quantum \
computer consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "8c396038-bb56-46db-b541-a6246cfde599"],
 " qubits with only ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["n", "2"], ")"}], TraditionalForm]],ExpressionUUID->
  "d3241d69-5af3-4b16-a22c-a73fb223b942"],
 " elementary quantum gate operations, compared to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    RowBox[{"n", " ", 
     SuperscriptBox["2", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "590a74f4-8ae7-47b1-b6e5-61ce5fb7b8d2"],
 ") gates for the best known classical algorithm for a discrete Fourier \
transform. This exponential speedup in the quantum Fourier transform \
algorithm relative to the classical counterpart enabled the celebrated \
quantum factorization algorithm to achieve a similar efficiency."
}], "Text",
 CellID->47638612,ExpressionUUID->"826227d5-7d9b-4bcd-8087-4b105222cbd6"],

Cell["\<\
Apart from the above mentioned quantum factorization algorithm, the quantum \
Fourier transformation is a key part of many other quantum algorithms, such \
as the quantum phase estimation, the order-finding problem, the discrete \
logarithm, and most importantly the hidden subgroup problem. Such a wide \
range of applications of the quantum Fourier transform stems from the fact \
that all known quantum algorithms featuring an exponential speedup over \
classical algorithms are variations of the hidden subgroup problem and, as \
first realized by Kitaev (1996), the key step to solve the latter problem is \
the quantum Fourier transform.\
\>", "Text",
 CellID->1798235200,ExpressionUUID->"1ca70f57-ecfe-4252-a5c2-a4d44bd3fcf3"],

Cell["\<\
Make sure that the Q3 package is loaded to use the demonstrations in this \
document.\
\>", "MathCaption",
 CellID->1428640008,ExpressionUUID->"f841e68d-7ec5-4d86-9a4c-3c63a8bdcbfd"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"3d6d4927-0294-4af7-a7ea-20c6afa3bd32"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "MathCaption",
 CellID->1937193009,ExpressionUUID->"6083d8f6-cc45-4525-8d8e-274094b470d2"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->403330096,ExpressionUUID->"dfc8f58f-c26a-4af5-9ff4-6762cc2f47b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition", "Section",
 CellID->1875748448,ExpressionUUID->"c1d3d316-d3d3-431f-809b-e901e7bcb40b"],

Cell["\<\
To make the physical meaning underlying the quantum Fourier transform \
clearer, in this document, we use a slightly different notation for the \
computational basis states, and denote them by\
\>", "Text",
 CellID->644227576,ExpressionUUID->"ce8d7de7-7e85-4e80-9100-c7eb4402e224"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   TemplateBox[{
     SubscriptBox["X", "x"]},
    "Ket"], ":=", 
   RowBox[{
    TemplateBox[{
      SubscriptBox["x", "1"]},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{
      SubscriptBox["x", "2"]},
     "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
    TemplateBox[{
      SubscriptBox["x", "n"]},
     "Ket"]}]}], 
  TraditionalForm]],ExpressionUUID->"7efb3495-592d-4406-bad2-0370ddad09fc"]], \
"DisplayMath",
 CellID->2067805305,ExpressionUUID->"50940291-3f1f-41d6-b926-2e57a6f86b57"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "6b784f49-1f90-484e-a424-6dc2b295ac0a"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "k"], TraditionalForm]],ExpressionUUID->
  "fb774c82-5646-4aeb-8a50-6b5703c8d5a2"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", "n"}], 
   TraditionalForm]],ExpressionUUID->"0bd230ce-e4af-42a8-a78b-98f579fdba25"],
 " are the binary digits of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], 
       SubscriptBox["\[CenterEllipsis]x", "n"]}], ")"}], "2"]}], 
   TraditionalForm]],ExpressionUUID->"c18f9dd9-9b15-4c4e-802e-77ce6ca55a86"],
 "."
}], "Text",
 CellID->875901734,ExpressionUUID->"80d83813-d970-482b-8ad5-dd93e1389007"],

Cell["\<\
The quantum Fourier transform, QFT for short, is a unitary transformation \
defined by the association\
\>", "Text",
 CellID->280043153,ExpressionUUID->"f9ad5f06-008b-4de0-91cf-6c1f365a6b7b"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["U", "QFT"], 
    TemplateBox[{
      SubscriptBox["X", "y"]},
     "Ket"]}], ":=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"n", "/", "2"}]]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     RowBox[{
      TemplateBox[{
        SubscriptBox["X", "x"]},
       "Ket"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "x", " ", 
        SubscriptBox["p", "y"]}]]}]}]}]}], 
  TraditionalForm]],ExpressionUUID->"6dc87948-89d7-4524-ba7e-0d10b852ddbc"]], \
"DisplayMath",
 CellID->1548601894,ExpressionUUID->"9958b59b-6473-46d5-a406-85b48433a44a"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "7e6edd58-4751-4546-b283-09f83c7fa3f8"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "y"], TraditionalForm]],ExpressionUUID->
  "57e64655-dfba-443f-a9a3-b892e201e16a"],
 " is the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["y", "th"], TraditionalForm]],ExpressionUUID->
  "e1ac2b7b-ebad-4917-92ce-77def60f4191"],
 " \[OpenCurlyDoubleQuote]wave number\[CloseCurlyDoubleQuote] defined by"
}], "Text",
 CellID->1997714465,ExpressionUUID->"ef924c33-06b8-4029-b89f-654d4ef65330"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "y"], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "y"}], 
      SuperscriptBox["2", "n"]], "=", 
     RowBox[{"2", 
      SubscriptBox[
       RowBox[{"\[Pi]", "(", 
        RowBox[{"0.", 
         SubscriptBox["y", "1"], 
         SubscriptBox["y", "2"], 
         SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"ad029d30-86e6-4863-907e-73da997f94a6"],
 "."
}], "DisplayMath",
 CellID->1827676057,ExpressionUUID->"9bdd9950-4e74-4ea1-8d9e-2d68b53879c4"],

Cell[TextData[{
 "Like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "k"], TraditionalForm]],ExpressionUUID->
  "ec7170a0-6661-48c7-8a85-0db6421c165c"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "k"], TraditionalForm]],ExpressionUUID->
  "389139c0-cc14-40b2-bbd4-ca693ae764b6"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", "n"}], 
   TraditionalForm]],ExpressionUUID->"7cb38cb8-a34f-4047-991c-bc83ab319234"],
 " are the binary digits of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", "1"], 
       SubscriptBox["y", "2"], 
       SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"]}], 
   TraditionalForm]],ExpressionUUID->"5f61193c-17a7-471b-ad29-80a13ec2ea30"],
 "."
}], "Text",
 CellID->145403311,ExpressionUUID->"8798a58a-161a-4db5-bc9c-0f7c1f7201bd"],

Cell[TextData[{
 "The expression on the right-hand side of the above definition is of a \
familiar form of the ",
 StyleBox["discrete Fourier transform",
  FontSlant->"Italic"],
 " except that instead of numerical coefficients for the exponential factor \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "47f156f6-5198-47f3-9dec-6070415e597d"],
 ", there appear state vectors. Therefore, one may think of the quantum \
Fourier transform as a ",
 StyleBox["vector-valued",
  FontSlant->"Italic"],
 " discrete Fourier transformation."
}], "Text",
 CellID->2104541338,ExpressionUUID->"e425cb34-df2b-4fc2-93a5-9a36143e2cd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Physical Meaning", "Section",
 CellID->1970601676,ExpressionUUID->"0108b28e-7bae-4b1a-a62d-769970d7ac23"],

Cell["\<\
In many physical applications, there is a more important aspect of the \
quantum Fourier transform than its formal similarity to the discrete Fourier \
transform. It is useful and inspiring to regard the QFT as a basis change, a \
unitary transformation from the computational basis\
\>", "Text",
 CellID->1409564498,ExpressionUUID->"a6083d02-f569-4aa9-b6e2-c9a4f627c972"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["X", "x"]},
       "Ket"], ":", "x"}], "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]",
     ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], "}"}], 
  TraditionalForm]],ExpressionUUID->"47d7ae5a-020c-4b54-8951-b5dc8ff7431e"]], \
"DisplayMath",
 CellID->1658407829,ExpressionUUID->"e539ecd4-61fd-4fc0-9021-0aa4b37df486"],

Cell["to the so-called \[OpenCurlyDoubleQuote]conjugate basis\
\[CloseCurlyDoubleQuote]", "Text",
 CellID->670127590,ExpressionUUID->"7328f45e-1f8c-4a11-9bea-4ab9b6c182c5"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["P", "y"]},
       "Ket"], ":=", 
      RowBox[{
       RowBox[{
        SubscriptBox["U", "QFT"], 
        RowBox[{
         TemplateBox[{
           SubscriptBox["X", "y"]},
          "Ket"], ":", "y"}]}], "=", "0"}]}], ",", "1", ",", "2", ",", 
     "\[Ellipsis]", ",", 
     RowBox[{
      SuperscriptBox["2", "n"], "-", "1"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"4738dd8e-19f1-4da8-b208-9ad0850e0698"],
 "."
}], "DisplayMath",
 CellID->1430160262,ExpressionUUID->"aea74edf-7948-456a-9994-35247a7ba411"],

Cell[TextData[{
 "The key observation is that in the \[OpenCurlyDoubleQuote]continuum\
\[CloseCurlyDoubleQuote] limit (",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", " ", ":=", " ", 
    RowBox[{
     SuperscriptBox["2", "n"], "\[RightArrow]", " ", "\[Infinity]"}]}], 
   TraditionalForm]],ExpressionUUID->"7555ddaa-3405-4778-92b2-84dbb13b911a"],
 "), the computational basis corresponds to the eigenbasis of the \
\[OpenCurlyDoubleQuote]position\[CloseCurlyDoubleQuote] and the conjugate \
basis to that of the \[OpenCurlyDoubleQuote]momentum\[CloseCurlyDoubleQuote]. \
Indeed, one can see that the following two observables"
}], "Text",
 CellID->2066546210,ExpressionUUID->"4794b373-5c4d-4a69-b531-218ef84797ae"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "x"], 
     RowBox[{
      TemplateBox[{
        SubscriptBox["X", "x"]},
       "Ket"], "x", 
      TemplateBox[{
        SubscriptBox["X", "x"]},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "9aab31ff-f0a2-4019-81a5-8926ce8ceccb"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "y"], 
     RowBox[{
      TemplateBox[{
        SubscriptBox["P", "y"]},
       "Ket"], 
      SubscriptBox["p", "y"], 
      TemplateBox[{
        SubscriptBox["P", "y"]},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "95102b3b-880e-4eb7-82d1-b7eab42fbc32"]
}], "DisplayMath",
 CellID->1189128539,ExpressionUUID->"29436a5b-84e2-4923-bba5-a940bd916f91"],

Cell[TextData[{
 "bearing eigenvalues ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "5fbaa791-94d0-401e-9cae-8e8e4bd63eeb"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "y"], TraditionalForm]],ExpressionUUID->
  "487049c0-87d5-4dab-bece-083c18cd7da7"],
 ", respectively, satisfy the relation"
}], "Text",
 CellID->1200535991,ExpressionUUID->"a6f648d3-9b3a-45ba-9748-99ba50b2a448"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "P"}]], "X", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"+", "\[ImaginaryI]"}], " ", "a", " ", "P"}]]}], "=", 
    RowBox[{"X", " ", "-", " ", 
     RowBox[{"a", " ", "I"}]}]}], TraditionalForm]],ExpressionUUID->
  "2e535da2-64dd-4fe3-b7a8-19e472f510fc"],
 "."
}], "DisplayMath",
 CellID->1799537172,ExpressionUUID->"ebde6447-18a7-4e62-832f-f9d3775963f5"],

Cell[TextData[{
 "This implies that ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "P"}]], TraditionalForm]],
  ExpressionUUID->"84b8381a-4f72-40a1-8ce6-7cd77178a30d"],
 "is a translation operator, and ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "a944f4bb-8135-4388-ac88-69a911307272"],
 " is the generator of the translation, i.e., the momentum."
}], "Text",
 CellID->1809049103,ExpressionUUID->"c06bd4bd-5737-4250-acdf-4260dc50a7d6"],

Cell[TextData[{
 "This notion can be made rigorous even in a finite dimensional Hilbert space \
using the unitary operators ",
 Cell[BoxData[
  FormBox[
   RowBox[{"exp", "(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "p", " ", "X"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"f67c0b23-7b83-47dc-b7a9-aa1b3e78194a"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"exp", "(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "P"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"b427bb39-5001-40cc-8b74-cbf06e23f364"],
 ", which generate the so-called Weyl-Heisenberg group;  see Weyl (1931, \
Section IV.14) for example."
}], "Text",
 CellID->614799895,ExpressionUUID->"35980900-8abf-4abb-9c76-5d4d5a95246b"],

Cell["\<\
The quantum Fourier transform appears frequently in many quantum algorithms \
(notably the quantum phase estimation algorithm), either in an explicit or in \
a disguised form. The relation between the computational and conjugate basis \
defined above is useful to understand the principle behind the particular \
algorithms.\
\>", "Text",
 CellID->1398009548,ExpressionUUID->"b94dcfd0-1a60-453b-8f02-7b6529f88549"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Implementation", "Section",
 CellID->727891409,ExpressionUUID->"3b71ee5e-6eed-446a-ad3f-f53a4c2af1c7"],

Cell["\<\
The quantum Fourier transform algorithm is to efficiently implement the \
unitary operator (4.37) in terms of the elementary gates.\
\>", "Text",
 CellID->1604057751,ExpressionUUID->"f084fa28-263a-4940-a991-0289f46d7ef0"],

Cell["\<\
Getting back to the definition, the quantum Fourier transform maps the
quantum states by\
\>", "Text",
 CellID->2036400266,ExpressionUUID->"382ebe22-5461-41da-b89a-3a5d18c7b416"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["U", "QFT"], 
    TemplateBox[{
      SubscriptBox["X", "y"]},
     "Ket"]}], ":=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["2", 
      RowBox[{"n", "/", "2"}]]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     RowBox[{
      TemplateBox[{
        SubscriptBox["X", "x"]},
       "Ket"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "x", " ", 
        SubscriptBox["p", "y"]}]]}]}]}]}], 
  TraditionalForm]],ExpressionUUID->"e9efb766-2c03-4abc-979c-3a99fd2077ec"]], \
"DisplayMath",
 CellID->1332388423,ExpressionUUID->"e7eebf3a-7622-4354-af7f-9979953faec8"],

Cell["with wave number", "Text",
 CellID->1640238092,ExpressionUUID->"8e0eaa71-7cb2-4609-ae5f-1e58fb74577f"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["p", "y"], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]", " ", "y"}], 
     SuperscriptBox["2", "n"]], "=", 
    RowBox[{"2", 
     SubscriptBox[
      RowBox[{"\[Pi]", "(", 
       RowBox[{"0.", 
        SubscriptBox["y", "1"], 
        SubscriptBox["y", "2"], 
        SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"]}]}]}], 
  TraditionalForm]],ExpressionUUID->"fe8fc48e-b426-4348-ba54-92a5e29bfdbe"]], \
"DisplayMath",
 CellID->234035705,ExpressionUUID->"bf4a3a8d-4fa8-423a-9305-025f3a65ac0f"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "bd719cc8-d93c-45f7-b6e6-cbacfb0a84fb"],
 "."
}], "Text",
 CellID->1395536278,ExpressionUUID->"75e89778-13fc-4135-b91c-9e7f791120b8"],

Cell[TextData[{
 "Since the characteristic properties of the Fourier transform of any kind \
are attributed to an oscillatory phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "d49b2458-10d2-44a6-9152-7a49ab855ad3"],
 ", we start by elaborating it. The product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", 
    SubscriptBox["p", "y"]}], TraditionalForm]],ExpressionUUID->
  "e43098de-5e36-4b51-947c-334a27b87bf7"],
 " in the exponent is given by"
}], "Text",
 CellID->2109315459,ExpressionUUID->"404596d8-aab7-4847-a8a2-4dff227eac25"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", " ", 
     SubscriptBox["p", "y"]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "x", " ", "y"}], 
      SuperscriptBox["2", "n"]], "=", 
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        RowBox[{"\[Pi]", "(", 
         RowBox[{"0.", 
          SubscriptBox["x", "1"], 
          SubscriptBox["x", "2"], 
          SubscriptBox["\[CenterEllipsis]x", "n"]}], ")"}], "2"], "y"}], "=", 
      
      RowBox[{"2", "\[Pi]", " ", "y", 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"k", "=", "1"}], "n"], 
        RowBox[{
         SubscriptBox["x", "k"], 
         SuperscriptBox["2", 
          RowBox[{"-", "k"}]]}]}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "f1a427d9-b3c6-49d9-9bee-2838c11aab7c"],
 ","
}], "DisplayMath",
 CellID->604874737,ExpressionUUID->"e024b0ad-837b-4a72-b828-a02714c0f3c5"],

Cell["which recasts the phase factor into the form", "Text",
 CellID->2089603508,ExpressionUUID->"437bf422-b641-41c5-b2b5-278cf329dfc9"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "x", " ", 
      SubscriptBox["p", "y"]}]], "=", 
    RowBox[{
     SubsuperscriptBox["\[Product]", 
      RowBox[{" ", 
       RowBox[{"k", "=", "1"}]}], 
      RowBox[{" ", "n"}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "y", " ", 
       SubscriptBox["x", "k"], 
       SuperscriptBox["2", 
        RowBox[{"-", "k"}]]}]]}]}], TraditionalForm]],ExpressionUUID->
  "38c5e2e6-0989-4925-b1a7-9fcca664e05d"],
 "."
}], "DisplayMath",
 CellID->18595918,ExpressionUUID->"e90c5788-f0dc-4bd7-b891-583e0377cf18"],

Cell[TextData[{
 "We put it back in the defining expression of quantum Fourier transform and \
rewrite the sum over ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "7acf9a76-73d9-44ef-a17f-b10d250b6d8a"],
 " with the sum over bit values ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "k"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "1612e7fa-a7c2-471e-8f97-3e26aa437bbb"],
 ", which lead to"
}], "Text",
 CellID->1156465011,ExpressionUUID->"d65438b5-68c0-4de2-84be-b317e1375acd"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{
        SubscriptBox["x", "k"], "=", "0"}], "1"], 
      RowBox[{
       TemplateBox[{
         SubscriptBox["x", "k"]},
        "Ket"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", 
         SubscriptBox["x", "k"], 
         RowBox[{"y", "/", 
          SuperscriptBox["2", "k"]}]}]]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"eed90928-1aab-4b32-934d-05fbb633a10d"],
 "."
}], "DisplayMath",
 CellID->1980434527,ExpressionUUID->"1343ba8c-11a1-46f7-8f6b-7967ed1e73c2"],

Cell[TextData[{
 "For a fixed ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "a3b36643-e7a4-43f3-be29-029ce11a80b2"],
 ", the ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "/", 
    SuperscriptBox["2", "k"]}], TraditionalForm]],ExpressionUUID->
  "54902e97-e0d6-4b4e-8b4f-cbbec5f762dc"],
 " is represented in the binary digits as"
}], "Text",
 CellID->1314050436,ExpressionUUID->"bed12125-549f-470b-95c6-0815c41a7c91"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "/", 
     SuperscriptBox["2", "k"]}], "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", "1"], 
       SubscriptBox["y", "2"], 
       RowBox[{
        SubscriptBox["\[CenterEllipsis]y", 
         RowBox[{"n", "-", "k"}]], ".", 
        SubscriptBox["y", 
         RowBox[{"n", "-", "k", "+", "1"}]]}], 
       SubscriptBox["\[CenterEllipsis]y", 
        RowBox[{"n", "-", "1"}]], 
       SubscriptBox["y", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"4d553fb3-e437-46b6-818e-d026a747355f"],
 "."
}], "DisplayMath",
 CellID->523852104,ExpressionUUID->"fa1c6526-557b-4c4f-9cd0-f8ef673f41d3"],

Cell[TextData[{
 "The integer part does not affect the sum because ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "m"}]], "=", "1"}], 
   TraditionalForm]],ExpressionUUID->"7eb3402c-43e1-49e8-883d-c9731998820f"],
 " for any integer ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "1936ca65-8df5-47a6-90a6-716b7d135fd4"],
 ", and only the fractional part ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"0.", 
      SubscriptBox["y", 
       RowBox[{"n", "-", "k", "+", "1"}]], 
      SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"], 
   TraditionalForm]],ExpressionUUID->"2873a9ca-76b7-43a1-aae2-f35c05f0216a"],
 " does. Depriving the phase factors ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["x", "k"], 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "fd76884c-a5ac-49a5-b1fa-e3bdd7e386fc"],
 " of the integer parts, we arrive at the expression for the result of the \
transformation"
}], "Text",
 CellID->1846842875,ExpressionUUID->"b671ba75-c2e4-4c5f-ae40-f130945b75ac"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{
        SubscriptBox["x", "k"], "=", "0"}], "1"], 
      RowBox[{
       TemplateBox[{
         SubscriptBox["x", "k"]},
        "Ket"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", 
         SubscriptBox[
          RowBox[{
           SubscriptBox["x", "k"], "(", 
           RowBox[{"0.", 
            SubscriptBox["y", 
             RowBox[{"n", "-", "k", "+", "1"}]], 
            SubscriptBox["\[CenterEllipsis]y", 
             RowBox[{"n", "-", "1"}]], 
            SubscriptBox["y", "n"]}], ")"}], "2"]}]]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"c2870890-aac2-4b33-9cde-1e11ecdf0085"],
 "."
}], "DisplayMath",
 CellID->159566387,ExpressionUUID->"466767ee-c88e-4632-97e6-b04be1c63564"],

Cell[TextData[{
 "Explicitly writing the sums over bit values ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "k"], TraditionalForm]],ExpressionUUID->
  "54a71252-fc72-459f-9cc0-b5574fdf20f4"],
 ", it reads as"
}], "Text",
 CellID->1772674853,ExpressionUUID->"3d689d8c-31fd-49e1-bb21-620e1d9611fe"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", 
            RowBox[{"n", "-", "1"}]], 
           SubscriptBox["y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", "\[CenterEllipsis]", 
     "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "1"], 
           SubscriptBox["y", "2"], 
           SubscriptBox["\[CenterEllipsis]y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "ec9d227d-0883-41e6-b3f5-e65cf60a6f9b"],
 "."
}], "DisplayMath",
 CellID->1305619540,ExpressionUUID->"74e42737-cd26-4bc0-8921-6e3a74543225"],

Cell["\<\
Interestingly, the state resulting from the quantum Fourier transform is \
clearly a product state. The first factor is stored in the first qubit of the \
quantum register, and consecutive factors are stored in the corresponding \
qubits in the same order. For later analysis, it is useful to reverse the \
order. This is equivalent to perform the qubit-reversing unitary \
transformation\
\>", "Text",
 CellID->559703734,ExpressionUUID->"8ccae872-d773-4e26-9fe5-6a74aeca7926"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QBR"], 
     RowBox[{
      TemplateBox[{
        SubscriptBox["y", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["y", "2"]},
       "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["y", "n"]},
       "Ket"]}]}], "=", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["y", "n"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "2"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "1"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "92f8f624-9175-4fbd-9f37-c82bd00dc34f"],
 " ."
}], "DisplayMath",
 CellID->962283478,ExpressionUUID->"87202d93-c6ea-4872-a62f-fd387b036536"],

Cell[TextData[{
 "Applying first the qubit-reversing transformation ",
 StyleBox["before",
  FontSlant->"Italic"],
 " the quantum Fourier\ntransform, we arrive at the final expression that we \
analyze subsequently"
}], "Text",
 CellID->399069189,ExpressionUUID->"4a3aa893-1e8e-4d4a-9e4f-fc52c276a579"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "1"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "2"], 
           SubscriptBox["y", "1"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", "\[CenterEllipsis]", 
     "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "n"], 
           SubscriptBox["\[CenterEllipsis]y", "2"], 
           SubscriptBox["y", "1"]}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "7f675b11-fddc-4389-8ae7-d834ca33ee59"],
 "."
}], "DisplayMath",
 CellID->564429942,ExpressionUUID->"2c706183-e799-4630-a52a-e22d1f75effe"],

Cell[TextData[{
 "So far, we have done nothing but re-express the defining equation of the \
quantum Fourier transform. Now, we identify the elementary quantum logic \
gates that compose the transform. The product in the above is particularly \
useful to analyze. Let us examine the state stored on the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "1c7f34df-6a20-4708-910f-af5394b81674"],
 "qubit,"
}], "Text",
 CellID->938766395,ExpressionUUID->"59a48e6a-374e-4a2b-a2fa-ee6a4c74d3da"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", "\[Pi]", " ", 
        SubscriptBox[
         RowBox[{"\[ImaginaryI]", "(", 
          RowBox[{"0.", 
           SubscriptBox["y", "k"], 
           SubscriptBox["\[CenterEllipsis]y", "2"], 
           SubscriptBox["y", "1"]}], ")"}], "2"]}]]}]}], 
    SqrtBox["2"]], TraditionalForm]],ExpressionUUID->
  "5c6f3ed1-0979-46b0-bfdb-74b7fe27b172"],
 "."
}], "DisplayMath",
 CellID->284446256,ExpressionUUID->"077cf889-4685-46ee-b169-b2775750e198"],

Cell["Noting that", "Text",
 CellID->389626370,ExpressionUUID->"cf7fe0ef-7eb9-4973-808f-a82ce156b0d6"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox[
      RowBox[{"\[Pi]", "(", 
       RowBox[{"0.", 
        SubscriptBox["y", "k"], 
        SubscriptBox["\[CenterEllipsis]y", "2"], 
        SubscriptBox["y", "1"]}], ")"}], "2"]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "k"], 
     RowBox[{
      SubscriptBox["y", "j"], 
      SuperscriptBox["2", 
       RowBox[{"j", "-", "k"}]], "\[Pi]"}]}]}], TraditionalForm]],
  ExpressionUUID->"5f2860c5-0664-477b-942d-3b6526d0e7e4"],
 ","
}], "DisplayMath",
 CellID->772760887,ExpressionUUID->"956c0012-f1e5-4afa-b1de-97b3815b0448"],

Cell[TextData[{
 "we see that qubits ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", ",", "2", ",", "\[Ellipsis]", ",", "k"}], TraditionalForm]],
  ExpressionUUID->"8e78938c-8a56-47ce-a571-807e937288e2"],
 " makes relative phase shifts ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"1", "-", "k"}]], "\[Pi]"}], ",", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"2", "-", "k"}]], "\[Pi]"}], ",", "\[Ellipsis]", ",", "\[Pi]"}],
    TraditionalForm]],ExpressionUUID->
  "abca6945-d496-4993-9597-2cefca1f3530"],
 ", respectively. Among these, the phase shift \[Pi] depends on the state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", "k"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3548e446-098f-464f-8cd5-8cac295c3411"],
 " of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "e6d10ea4-f037-4545-8fcb-3677045fac86"],
 " qubit itself, and it is equivalent to the Hadamard gate. Therefore, we can \
regard that the above state stored on the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "9636a6f5-51b7-4971-8a1c-38aaab8bbfc3"],
 " qubit is a result of the transformation"
}], "Text",
 CellID->1958614400,ExpressionUUID->"77fbda6a-d24d-48bf-8ce5-0e82a25ae79e"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       SubscriptBox["y", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "k"]},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["y", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["y", "2"]},
       "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["y", 
         RowBox[{"k", "-", "1"}]]},
       "Ket"]}], 
     RowBox[{
      SubsuperscriptBox["\[Product]", 
       RowBox[{" ", 
        RowBox[{"j", "=", "1"}]}], 
       RowBox[{" ", 
        RowBox[{"k", "-", "1"}]}]], 
      RowBox[{
       RowBox[{
        SuperscriptBox["T", 
         SubscriptBox["y", "j"]], "(", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"j", "-", "k"}]], "\[Pi]"}], ")"}], "H", 
       TemplateBox[{
         SubscriptBox["y", "k"]},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "583801a7-73fb-4e20-8a2f-8ea3f07a6b13"],
 " ,"
}], "DisplayMath",
 CellID->1802879584,ExpressionUUID->"b8e4286c-1542-4186-bc3f-b411258ff06a"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "(", "\[Phi]", ")"}], TraditionalForm]],ExpressionUUID->
  "bbab0e71-ab9f-4fae-9396-2f21a59d2c91"],
 " denotes the relative phase shift"
}], "Text",
 CellID->2909118,ExpressionUUID->"55c8b239-3791-49c9-aa6e-027eb77b6661"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"T", "(", "\[Phi]", ")"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], 
       TemplateBox[{"0"},
        "Bra"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], 
       TemplateBox[{"1"},
        "Bra"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[DotEqual]", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "a9691eec-496b-4cbe-bef9-2ba71ea5dc9c"],
 " ."
}], "DisplayMath",
 CellID->1648905992,ExpressionUUID->"419b2343-8441-4513-8355-f68c743d856a"],

Cell[TextData[{
 "The actual operation of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["T", 
     SubscriptBox["y", "j"]], "(", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"j", "-", "k"}]], "\[Pi]"}], ")"}], TraditionalForm]],
  ExpressionUUID->"f11889ac-af04-40c9-9c63-c4c98dfeb871"],
 " is determined by the basis state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", "j"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "418bdd87-4219-467c-a7e4-f7f80340dc5e"],
 " of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["j", "th"], TraditionalForm]],ExpressionUUID->
  "52cd8d8c-a713-418b-93d2-490684ce50eb"],
 " qubit, so it is a controlled-unitary gate. For example, the state stored \
on the third qubit is represented in the quantum circuit as"
}], "Text",
 CellID->2034026656,ExpressionUUID->"a7343b63-9b6c-45d7-824c-700167d34b15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PhaseQFT", "[", "k_Integer", "]"}], ":=", 
  RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Reverse", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ControlledU", "[", 
        RowBox[{
         RowBox[{"S", "[", "j", "]"}], ",", 
         RowBox[{"Rotation", "[", 
          RowBox[{
           RowBox[{"Pi", "/", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "k"}], ")"}]}]}], ",", 
           RowBox[{"S", "[", 
            RowBox[{"k", ",", "3"}], "]"}]}], "]"}], ",", 
         RowBox[{"\"\<Label\>\"", "->", 
          RowBox[{"Subscript", "[", 
           RowBox[{"\"\<T\>\"", ",", 
            RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"k", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[22]:=",
 CellID->93830799,ExpressionUUID->"6aa006b6-e001-45bd-b0bd-8268cf9183fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "@@", 
  RowBox[{"PhaseQFT", "[", "3", "]"}]}]], "Input",
 CellLabel->"In[23]:=",
 CellID->761241895,ExpressionUUID->"84773b94-8b83-4008-8403-46d1d6e47e91"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -3}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[23]=",
 CellID->1632444086,ExpressionUUID->"fa4f3043-8efa-4e88-80f3-408e2748c22c"]
}, Open  ]],

Cell[TextData[{
 "where we have used the short-hand notation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "l"], ":=", 
    RowBox[{"T", "(", 
     RowBox[{"\[Pi]", "/", 
      SuperscriptBox["2", "l"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "35ab1f51-3c6c-456a-87db-bbf1eab5ba1c"],
 "."
}], "Text",
 CellID->236679330,ExpressionUUID->"0843823a-4fb9-4d92-8dbc-8a005e634b5b"],

Cell["\<\
Overall, the quantum Fourier transformation can be represented in the quantum \
circuit as\
\>", "Text",
 CellID->729785066,ExpressionUUID->"bcfeedff-70f0-428a-b6dc-3ebe72bbc5fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QBR", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SWAP", "[", 
     RowBox[{
      RowBox[{"S", "[", "j", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"n", "-", "j", "+", "1"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[30]:=",
 CellID->1218496245,ExpressionUUID->"2b81402b-9e15-4dae-a1a4-090dac41c925"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"QBR", "[", "4", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "4", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "3", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "2", "]"}]}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[34]:=",
 CellID->862331923,ExpressionUUID->"3dc10041-a223-4fdd-8235-1d2882725fb1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {LineBox[{{1, -1}, {1, -4}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -4.09}, {1.09, -3.91}}, {{0.91, -3.91}, {
     1.09, -4.09}}}]}, {LineBox[{{2, -2}, {2, -3}}], 
    LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {2.09, -2.09}}}],
     LineBox[{{{1.91, -3.09}, {2.09, -2.91}}, {{1.91, -2.91}, {
     2.09, -3.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -4}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -4}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -3}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -1}, {9, -3}}], DiskBox[{9, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -2}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {11, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {12, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[34]=",
 CellID->1992979905,ExpressionUUID->"235b4abb-842f-4308-8844-a159936daf90"]
}, Open  ]],

Cell[TextData[{
 "where we have implemented the qubit-reversing transformation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "QBR"], TraditionalForm]],ExpressionUUID->
  "ef9b1ea3-ed87-4b75-8c46-44ca193214d6"],
 " by applying SWAP gates on pairs of qubits from the first and second half \
of the quantum register. In the above quantum circuit, we have applied ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "QBR"], TraditionalForm]],ExpressionUUID->
  "efbb8224-6900-4a2f-81ff-96ee11f2e248"],
 " at the beginning. One can apply it at the end as well. Since ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "QBR"], TraditionalForm]],ExpressionUUID->
  "7687a68e-95a1-4ae4-ba59-fa6630054e60"],
 " corresponds to a simple reversal of the order of qubits, the above quantum \
circuit is identical to the following quantum circuit"
}], "Text",
 CellID->1710821076,ExpressionUUID->"31475daf-783c-4f5d-986c-808f9666fe44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReversedPhaseQFT", "[", 
   RowBox[{"n_Integer", ",", "k_Integer"}], "]"}], ":=", 
  RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ControlledU", "[", 
       RowBox[{
        RowBox[{"S", "[", "j", "]"}], ",", 
        RowBox[{"Rotation", "[", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"k", "-", "j"}], ")"}]}]}], ",", 
          RowBox[{"S", "[", 
           RowBox[{"k", ",", "3"}], "]"}]}], "]"}], ",", 
        RowBox[{"\"\<Label\>\"", "->", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<T\>\"", ",", 
           RowBox[{"j", "-", "k"}]}], "]"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"k", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"k", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[61]:=",
 CellID->1111274649,ExpressionUUID->"1242e797-0fd7-420a-8831-e164b82c966f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"ReversedPhaseQFT", "[", 
      RowBox[{"4", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"ReversedPhaseQFT", "[", 
      RowBox[{"4", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"ReversedPhaseQFT", "[", 
      RowBox[{"4", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"QBR", "[", "4", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[62]:=",
 CellID->527747784,ExpressionUUID->"bf86b2a0-3c01-4c41-b47e-6198542017d4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -4}, {4, -1}}], DiskBox[{4, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -3}, {6, -2}}], DiskBox[{6, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -4}, {7, -2}}], DiskBox[{7, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -4}, {9, -3}}], DiskBox[{9, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[62]=",
 CellID->749543578,ExpressionUUID->"ab878799-ed1d-4e5d-9476-b63cd43f0ab0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "-", 
     RowBox[{"Matrix", "[", "new", "]"}]}], "//", "N"}], "//", "Chop"}], "//",
   "MatrixForm"}]], "Input",
 CellLabel->"In[63]:=",
 CellID->439842144,ExpressionUUID->"a4910f44-54db-479d-8008-a06e678c8f8e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]],
  "Output",
 CellLabel->"Out[63]//MatrixForm=",
 CellID->788201234,ExpressionUUID->"71f56326-42b7-436a-a330-6411b98d1d57"]
}, Open  ]],

Cell["\<\
This quantum circuit for the quantum Fourier transformation is found more \
commonly in the literature.\
\>", "Text",
 CellID->1619005142,ExpressionUUID->"c6d3503b-e540-48a6-932b-fb3d1df04130"],

Cell[TextData[{
 "From the quantum circuits discussed above, we see that quantum Fourier \
transform requires an order of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "2"], TraditionalForm]],ExpressionUUID->
  "acf99c27-cc91-4dfa-beb0-dff7943184b7"],
 " elementary gates. For example, consider again the quantum circuit"
}], "Text",
 CellID->2001614104,ExpressionUUID->"3fe97793-6317-487c-abe5-046ce8e6bf8c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"QBR", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "4", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "3", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[87]:=",
 CellID->796915673,ExpressionUUID->"2f1415fd-23dd-4648-aeb8-34d54d1e74a6"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {LineBox[{{1, -1}, {1, -4}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -4.09}, {1.09, -3.91}}, {{0.91, -3.91}, {
     1.09, -4.09}}}]}, {LineBox[{{2, -2}, {2, -3}}], 
    LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {2.09, -2.09}}}],
     LineBox[{{{1.91, -3.09}, {2.09, -2.91}}, {{1.91, -2.91}, {
     2.09, -3.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -4}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -4}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -3}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -1}, {9, -3}}], DiskBox[{9, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -2}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {11, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {12, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[87]=",
 CellID->2053693419,ExpressionUUID->"d3252074-01af-4a9c-95be-238467eb30e2"]
}, Open  ]],

Cell[TextData[{
 "There are ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "c447206a-e83d-49b3-9cc3-8579c130adab"],
 " Hadamard gates, one for each qubit. The number of controlled-unitary gates \
is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"n", "(", 
      RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], TraditionalForm]],
  ExpressionUUID->"8b22dec1-80c5-4c9d-aaa8-11d30aa22d6d"],
 ". There are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "75cd6a05-ce87-48a3-983f-f711b3506151"],
 " SWAP gates as well, each of which requires three CNOT gates. Overall, we \
need ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", "4"}], ")"}], "/", "2"}]}], " ", "\[Tilde]", " ", 
    RowBox[{"O", "(", 
     SuperscriptBox["n", "2"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "050a25ce-809c-404f-ab16-ddfb18ea1ef4"],
 " gates. This computational load is compared to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    RowBox[{"n", " ", 
     SuperscriptBox["2", "n"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "a17b28b1-694b-403c-a0af-731406395b5d"],
 " gates for the fast Fourier transform (FFT), the best classical algorithm \
for the discrete Fourier transform."
}], "Text",
 CellID->2068118549,ExpressionUUID->"3966141a-9667-4fe3-b82f-1c2168a23534"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Semiclassical Implementation", "Section",
 CellID->1845626348,ExpressionUUID->"76814999-978f-491d-b3c0-ae13b6030842"],

Cell["\<\
The semiclassical implementation is not only interesting from a physical \
point of view, but it is also extremely interesting given the current level \
of technology (Griffiths & Niu, 1996). Since it does not require any \
entanglement, a quantum information resource that is the most fragile and \
hence difficult to maintain, many experiments are using this implementation \
whenever the QFT and/or the quantum phase estimation is in need (Chiaverini, \
2005; Higgins et al., 2007).\
\>", "Text",
 CellID->1188233568,ExpressionUUID->"0285979e-58e5-4dbb-a907-c9d4f3f853ed"],

Cell["\<\
The line of argument in the original work (Griffiths & Niu, 1996) to derive \
the semiclassical implementation of the quantum Fourier transformation is \
interesting in its own right, and it offers another physically-motivated \
derivation of the quantum Fourier transform algorithm. Here, Instead, we \
simply make use of the relation between the quantum Fourier transform and its \
inverse.\
\>", "Text",
 CellID->1191143923,ExpressionUUID->"3de5bf9e-85d3-4674-9777-dc5b8f32de1a"],

Cell["The inverse quantum Fourier transform is given by", "Text",
 CellID->713356527,ExpressionUUID->"694187ff-c091-4ec6-8be7-01b3854c5737"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["U", "QFT", "\[Dagger]"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubscriptBox["\[Sum]", "x"], 
      RowBox[{
       TemplateBox[{
         SubscriptBox["X", "x"]},
        "Ket"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "x", " ", 
         SubscriptBox["p", "y"]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "16c00ba5-2004-401a-9648-fe4c87142541"],
 ","
}], "DisplayMath",
 CellID->2129431735,ExpressionUUID->"dfc4c1ba-044c-44ae-89b0-c680abb1d3cd"],

Cell["which follows directly from the orthogonality relation", "Text",
 CellID->1544192890,ExpressionUUID->"4622149d-dadb-49d5-ae2c-06569e493598"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", "n"]], 
     RowBox[{
      SubscriptBox["\[Sum]", "y"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", "(", 
         RowBox[{"x", "-", 
          SuperscriptBox["x", "\[Prime]"]}], ")"}], 
        SubscriptBox["p", "y"]}]]}]}], "=", 
    SubscriptBox["\[Delta]", 
     SuperscriptBox["xx", "\[Prime]"]]}], TraditionalForm]],ExpressionUUID->
  "e71374d8-4fb9-41e5-8b7a-fad7872535e6"],
 "."
}], "DisplayMath",
 CellID->910028235,ExpressionUUID->"a73f8dd7-0e3b-40db-8fff-ddced1c402be"],

Cell["\<\
The expression for the inverse quantum Fourier transform suggests that the \
inverse quantum Fourier transform is just another form of the quantum Fourier \
transform, and indeed, this is a characteristic property common to any kind \
of Fourier transform. This implies that one can recover the original quantum \
Fourier transform from the inverse quantum Fourier transform, and vice versa, \
in several ways.\
\>", "Text",
 CellID->466011711,ExpressionUUID->"2b5e7726-22b3-4715-866c-f858e17461d1"],

Cell[TextData[{
 "For example, note that  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "QFT", "\[Dagger]"], 
    TemplateBox[{
      SubscriptBox["X", "y"]},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "1b748102-9e7c-4ec7-a96f-0764d947bcf7"],
 " is an element of the conjugate basis because ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "x", " ", 
      SubscriptBox["p", "y"]}]], "=", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "\[Pi]"}], "-", 
        SubscriptBox["p", "y"]}], ")"}]}]]}], TraditionalForm]],
  ExpressionUUID->"9c806584-d474-4a7d-bd3a-1bcced1ffed3"],
 " for any ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "59021036-49ee-460b-8a49-81b30a459661"],
 " and ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "35cc39d0-2c8b-4184-9fba-365b342512d8"],
 ". In fact, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["U", "QFT", "\[Dagger]"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    TemplateBox[{
      SubscriptBox["P", 
       RowBox[{
         SuperscriptBox["2", "n"], "-", "y"}]]},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "4b0d1b8a-9ab2-43fe-987d-59c6ea9b48e0"],
 ". More useful in the context of the semiclassical implementation of the \
quantum Fourier transform is to note that the inverse quantum Fourier \
transform ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "QFT", "\[Dagger]"], TraditionalForm]],
  ExpressionUUID->"69ec72f2-ed76-4e58-a1c9-dc81340bcce3"],
 " is nothing but the quantum Fourier transform with the phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "7a74cd9c-373c-436f-b57b-8814bce0e5bd"],
 " replaced by ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "4c8cdb83-12f5-4843-8ceb-65075642bfec"],
 ". It corresponds to replacing the relative phase shifts ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "(", "\[Phi]", ")"}], TraditionalForm]],ExpressionUUID->
  "7675c368-3591-49a0-b348-c75be68d159e"],
 " in the above quantum implementation by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["T", "\[Dagger]"], "(", "\[Phi]", ")"}], TraditionalForm]],
  ExpressionUUID->"d3f06f71-6005-4622-8f46-819b8b5f3fd9"],
 ". Conversely, suppose that we start with the quantum circuit"
}], "Text",
 CellID->385966168,ExpressionUUID->"1eb2c6c3-19c4-4985-beb5-99f64b5ee919"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"QBR", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "4", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "3", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseQFT", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[67]:=",
 CellID->1532771636,ExpressionUUID->"cb9689a0-59ed-4c49-9c33-37fe0d8e95ef"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {LineBox[{{1, -1}, {1, -4}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -4.09}, {1.09, -3.91}}, {{0.91, -3.91}, {
     1.09, -4.09}}}]}, {LineBox[{{2, -2}, {2, -3}}], 
    LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {2.09, -2.09}}}],
     LineBox[{{{1.91, -3.09}, {2.09, -2.91}}, {{1.91, -2.91}, {
     2.09, -3.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -4}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -4}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -3}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -1}, {9, -3}}], DiskBox[{9, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -2}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {11, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {12, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[67]=",
 CellID->79056840,ExpressionUUID->"4ebeb7ed-7491-47f2-8217-0327b39ecdf0"]
}, Open  ]],

Cell[TextData[{
 "Take its Hermitian conjugate (i.e., inverse), and replace ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["T", "\[Dagger]"], "(", "\[Phi]", ")"}], "\[Congruent]", 
    RowBox[{"T", "(", 
     RowBox[{"-", "\[Phi]"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "c93e5bb1-ec8a-4870-b6b0-40e220498cb4"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "(", "\[Phi]", ")"}], TraditionalForm]],ExpressionUUID->
  "b004ef47-a665-4b16-a511-6c76ac7659a8"],
 ", then we should recover the original quantum Fourier transform. Through \
this procedure, we get the following quantum circuit for the quantum Fourier \
transform."
}], "Text",
 CellID->1563416034,ExpressionUUID->"9bf43a8b-0730-4985-8214-80ec076f23b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PhaseSQFT", "[", "k_", "]"}], ":=", 
  RowBox[{"Append", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ControlledU", "[", 
       RowBox[{
        RowBox[{"S", "[", "j", "]"}], ",", 
        RowBox[{"Rotation", "[", 
         RowBox[{
          RowBox[{"Pi", "/", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"k", "-", "j"}], ")"}]}]}], ",", 
          RowBox[{"S", "[", 
           RowBox[{"k", ",", "3"}], "]"}]}], "]"}], ",", 
        RowBox[{"\"\<Label\>\"", "->", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<T\>\"", ",", 
           RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"k", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[71]:=",
 CellID->1870862393,ExpressionUUID->"3936e887-65b8-46fb-a65f-a6621ab5f038"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "2", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "3", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"QBR", "[", "4", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[81]:=",
 CellID->128679777,ExpressionUUID->"efa6b5db-27e2-4a01-b6b9-15c3e94aac56"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -4}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[81]=",
 CellID->204979510,ExpressionUUID->"4f3bd269-53ab-4c36-9d10-b7919d44a657"]
}, Open  ]],

Cell[TextData[{
 "Compared to the previous quantum circuit, ",
 StyleBox["qc", "Input"],
 ", the above quantum circuit has its Hadamard gate on a fixed qubit coming \
before the qubit \[OpenCurlyDoubleQuote]controls\[CloseCurlyDoubleQuote] the \
operation of the relative phase shift ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "(", "\[Phi]", ")"}], TraditionalForm]],ExpressionUUID->
  "e653a65d-141c-44da-b7b8-65dd634b35c6"],
 " on other qubits. This difference brings a significant consequence. To see \
it, we put explicit measurements on the qubits,"
}], "Text",
 CellID->526854782,ExpressionUUID->"699fdc9a-8845-4f2a-a7e0-e9c6e713f5e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "2", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "3", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"QBR", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "3"}], "]"}],
      "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[82]:=",
 CellID->773244493,ExpressionUUID->"2faf8c68-49d7-4bf0-a5b2-e243c85b5e0e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{13, -1}, {14, -1}}, {{13, -2}, {14, -2}}, {{13, -3}, {
     14, -3}}, {{13, -4}, {14, -4}}}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -4}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -1.4}, {13.4, -0.6}]}, 
     CircleBox[{13, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -1.2}, {13.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, 
     CircleBox[{13, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -2.2}, {13.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -3.4}, {13.4, -2.6}]}, 
     CircleBox[{13, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -3.2}, {13.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, 
     CircleBox[{13, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -4.2}, {13.24, -3.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[82]=",
 CellID->1496645854,ExpressionUUID->"b1f7a367-8eed-47de-b793-e4163e9da012"]
}, Open  ]],

Cell[TextData[{
 "According to the ",
 StyleBox["principle of deferred measurement",
  FontSlant->"Italic"],
 ", the measurement can be performed before the controlled unitary gates"
}], "Text",
 CellID->650910867,ExpressionUUID->"b4e38f05-ddff-42f9-861b-9c758c552ed3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "2", "]"}]}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "3", "]"}]}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"PhaseSQFT", "[", "4", "]"}]}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "3"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[84]:=",
 CellID->577243851,ExpressionUUID->"3eb89d54-d295-4d0c-ac32-266ada2130b6"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{2, -1}, {15, -1}}, {{5, -2}, {15, -2}}, {{9, -3}, {15, -3}}, {{
     14, -4}, {15, -4}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {14, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {4, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
    CircleBox[{5, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
    LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -2}, {7, -3}}], DiskBox[{7, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
    CircleBox[{9, -3.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
    LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -4}}], DiskBox[{11, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {11, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -3}, {12, -4}}], DiskBox[{12, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {12, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {13, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
    CircleBox[{14, -4.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->586.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[84]=",
 CellID->1553770258,ExpressionUUID->"a14d29df-b9a1-428c-a593-17411ad25531"]
}, Open  ]],

Cell["\<\
This form is exactly the quantum circuit derived in Griffiths & Niu (1996). \
The important point is that after the measurement, the controlled-unitary \
gates become just classical feedback controls that require no entanglement.\
\>", "Text",
 CellID->815578686,ExpressionUUID->"148040a2-45b7-4548-a92b-7c57d656390b"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/guide/QuantumComputationAndQuantumInformation"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "49275fa8-1786-4026-9e1c-441c9acde8c1"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[TextData[ButtonBox["Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/guide/Q3"]], "TutorialMoreAbout",
         ExpressionUUID->"ce19a995-c08e-4c93-aacc-00be689412e3"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"41677ccf-5e34-473a-906c-\
3985055f78c4"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tutorials"}], "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Fourier Transform: Semiclassical Implementation",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumFourierTransformSemiclassical"]], 
         "RelatedTutorials",ExpressionUUID->
         "bf07b1a2-e79b-44db-a3c2-12fd36024ae7"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Phase Estimation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumPhaseEstimation"]], 
         "RelatedTutorials",ExpressionUUID->
         "9ed47515-c6dc-4974-ad92-085e23b90268"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Algorithms",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumAlgorithms"]], 
         "RelatedTutorials",ExpressionUUID->
         "c81353c6-3c99-4b70-9273-b1047f00a08a"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "QuantumCircuit Usage Examples",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumCircuitUsage"]], 
         "RelatedTutorials",ExpressionUUID->
         "0cdeba52-53b1-4252-b50f-5fa0dcbbbf20"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation and Quantum Information with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:Q3/tutorial/QuantumComputationAndQuantumInformation"]], 
         "RelatedTutorials",ExpressionUUID->
         "f6cb8c89-ea9c-4449-aa12-9fa91238fead"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"deab67a2-48b6-44bb-970a-\
3dd3dcafd6ff"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{
         "Related", " ", "Wolfram", " ", "Education", " ", "Group", " ", 
          "Courses"}], "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-EIWL.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "An Elementary Introduction to the Wolfram Language"}]]]], 
          "https://www.wolfram.com/language/elementary-introduction/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "f8a39e1f-05c3-4933-b26b-e0ea06657a63"]], "TutorialRelatedLinks",
        ExpressionUUID->"7afcad4a-85c4-4359-b873-9f91ac5100ba"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData[
            Cell[
             TextData[{
               Cell[
                BoxData[
                 DynamicBox[
                  FEPrivate`ImportImage[
                   
                   FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
                    "RelatedLinks-FastIntro.png"]]]]], 
               Cell[
                BoxData[
                 TemplateBox[{4}, "Spacer1"]]], 
               "The Wolfram Language: Fast Introduction for Programmers"}]]]],
           "https://www.wolfram.com/language/fast-introduction-for-\
programmers/"},
         "WebLink",
         BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
        "04eaa76b-c7e9-4a3e-98a1-2d66da9033e7"]], "TutorialRelatedLinks",
        ExpressionUUID->"ddb98ebf-d372-45ba-bc46-30ce0927aed7"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"1ef63504-8f98-41e8-aec3-\
ce52f6d67fdf"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Y. Kitaev, Electronic Colloquium on Computational \
Complexity 3, 3 (1996)"}]]]], "http://arxiv.org/abs/quant-ph/9511026"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "f420b780-73a8-467e-ba2e-c065d09598a3"]}]],ExpressionUUID->
         "cd168e0b-a664-4221-ac64-3017f7721fb0"],
        ", \[OpenCurlyDoubleQuote]Quantum Measurements and the Abelian \
Stabilizer Problem.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "95d8191a-34ed-43c9-b8ed-e0b4e566c7dd"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "R. B. Griffiths and C.-S. Niu, Physical Review Letters 76 \
(17), 3228 (1996)"}]]]], "https://doi.org/10.1103/physrevlett.76.3228"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "e83ad3dc-46fe-4f55-94d3-53941bd844ea"]}]],ExpressionUUID->
         "7960692c-ce63-4ce4-a73a-a656595c7348"],
        ", \[OpenCurlyDoubleQuote]Semiclassical Fourier Transform for Quantum \
Computation.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "e6f53c06-b40a-4cfe-8e82-c7b54161e9e4"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Chiaverini "}]]]], 
             "https://doi.org/10.1126%2Fscience.1110335"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "484d3dac-8f44-4a73-808f-d1a94843906e"]}]],ExpressionUUID->
         "1b52e750-6aa7-4acb-b39f-afac3942fdea"],
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData[
             StyleBox[{
               StyleBox["et al", FontSlant -> "Italic"], 
               "., Science 308 (5724), 997 (2005)"}]]], 
           "https://doi.org/10.1126%2Fscience.1110335"},
          "WebLink",
          BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
         "da644345-ef96-40da-bbd6-ba7744b6e4cb"],
        ", \[OpenCurlyDoubleQuote]Implementation of the Semiclassical Quantum \
Fourier Transform in a Scalable System.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "d6b0e241-b305-4289-b23b-05c10213c32c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "B. L. Higgins, D. W. Berry, S. D. Bartlett, H. M. Wiseman, \
& G. J. Pryde, Nature 450 (7168), 393 (2007)"}]]]], 
             "https://doi.org/10.1038/nature06257"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "55fb6f40-0f0a-43f5-a058-9c2280c6d02b"]}]],ExpressionUUID->
         "c5847e0a-5c87-4ede-ace2-e48cb173f233"],
        ", \[OpenCurlyDoubleQuote]Entanglement-free Heisenberg-limited phase \
estimation.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "6e464b0f-fb3c-4904-ab65-f54695aebf3f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang, Quantum computation and \
quantum information (Cambridge University Press, New York, 2011)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "3e324bd6-c0c7-49a3-b813-2e41b45e8e91"]}]],ExpressionUUID->
         "a4dddd9d-182c-4cd7-ba86-6c5a02e23aa4"],
        "."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "431d9fec-fc00-497d-8a8f-24346954e4fe"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi, A Quantum Computation Workbook (Springer, \
2021)"}]]]], "https://github.com/quantum-mob/QuantumWorkbook"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c6d1b3ef-bea8-4c11-acb4-9ce5e5086067"]}]],ExpressionUUID->
         "53e0671d-b6f9-445b-990e-cb428435030e"],
        "."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "d694dab2-7d9f-4984-87eb-9f402e463bdc"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"17be407b-5a8d-41b0-a580-\
301df203f60c"],

Cell[" ", "FooterCell",ExpressionUUID->"d5bcef29-ba1e-4926-839b-6ba39384e779"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Quantum Fourier Transform",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", "2021"}, 
  "ShowCitation" -> False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2022, 2, 14, 17, 20, 13.542804}", 
    "history" -> {"12", "13", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum Fourier transform", "quantum algorithm"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Tutorial", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "See also Section 4.3 of the Quantum Workbook (Springer, 2022). The \
quantum Fourier transform is a unitary transformation of quantum states. It \
is analogous to the discrete Fourier transform of a finite set of numbers. In \
the case of the quantum Fourier transform, the numbers are replaced with \
quantum states. The quantum Fourier transform can be performed efficiently on \
a quantum computer consisting of n qubits with only O(n^2) elementary quantum \
gate operations, compared to O(n 2^n) gates for the best known classical \
algorithm for a discrete Fourier transform. This exponential speedup in the \
quantum Fourier transform algorithm relative to the classical counterpart \
enabled the celebrated quantum factorization algorithm to achieve a similar \
efficiency.", "synonyms" -> {}, "tabletags" -> 
    DocumentationBuild`Make`Private`tabletaggingrules$241667, "title" -> 
    "Quantum Fourier Transform", "titlemodifier" -> "", "windowtitle" -> 
    "Quantum Fourier Transform", "type" -> "Tutorial", "uri" -> 
    "Q3/tutorial/QuantumFourierTransform", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> ""},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "13.0 for Mac OS X ARM (64-bit) (December 2, 2021)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"1d4b230a-559c-42a5-acd1-3e42ab589199"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[597, 21, 6307, 148, 57, "AnchorBarGrid",ExpressionUUID->"e411c953-54b7-4810-a6c6-649a04e4389b",
 CellID->1],
Cell[CellGroupData[{
Cell[6929, 173, 1181, 31, 59, "ObjectNameGrid",ExpressionUUID->"3efa51f5-e76b-4d2f-b644-2b803efa5f4a"],
Cell[8113, 206, 4441, 96, 73, "TutorialJumpBox",ExpressionUUID->"7da89246-a699-49cf-8560-f48655096547"],
Cell[12557, 304, 415, 13, 38, "Text",ExpressionUUID->"ab227918-b61e-46da-a398-95b487931509",
 CellID->1308734266],
Cell[12975, 319, 352, 6, 60, "Text",ExpressionUUID->"59a29ca2-12bb-42a4-bc4d-10edc5f31cc3",
 CellID->1636777126],
Cell[13330, 327, 1019, 24, 110, "Text",ExpressionUUID->"826227d5-7d9b-4bcd-8087-4b105222cbd6",
 CellID->47638612],
Cell[14352, 353, 743, 11, 156, "Text",ExpressionUUID->"1ca70f57-ecfe-4252-a5c2-a4d44bd3fcf3",
 CellID->1798235200],
Cell[15098, 366, 192, 4, 36, "MathCaption",ExpressionUUID->"f841e68d-7ec5-4d86-9a4c-3c63a8bdcbfd",
 CellID->1428640008],
Cell[15293, 372, 145, 3, 29, "Input",ExpressionUUID->"3d6d4927-0294-4af7-a7ea-20c6afa3bd32",
 CellID->853967906],
Cell[15441, 377, 310, 6, 57, "MathCaption",ExpressionUUID->"6083d8f6-cc45-4525-8d8e-274094b470d2",
 CellID->1937193009],
Cell[15754, 385, 269, 6, 48, "Input",ExpressionUUID->"dfc8f58f-c26a-4af5-9ff4-6762cc2f47b2",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[16060, 396, 105, 1, 71, "Section",ExpressionUUID->"c1d3d316-d3d3-431f-809b-e901e7bcb40b",
 CellID->1875748448],
Cell[16168, 399, 291, 5, 60, "Text",ExpressionUUID->"ce8d7de7-7e85-4e80-9100-c7eb4402e224",
 CellID->644227576],
Cell[16462, 406, 565, 18, 70, "DisplayMath",ExpressionUUID->"50940291-3f1f-41d6-b926-2e57a6f86b57",
 CellID->2067805305],
Cell[17030, 426, 1046, 33, 70, "Text",ExpressionUUID->"80d83813-d970-482b-8ad5-dd93e1389007",
 CellID->875901734],
Cell[18079, 461, 201, 4, 70, "Text",ExpressionUUID->"f9ad5f06-008b-4de0-91cf-6c1f365a6b7b",
 CellID->280043153],
Cell[18283, 467, 784, 26, 70, "DisplayMath",ExpressionUUID->"9958b59b-6473-46d5-a406-85b48433a44a",
 CellID->1548601894],
Cell[19070, 495, 726, 21, 70, "Text",ExpressionUUID->"ef924c33-06b8-4029-b89f-654d4ef65330",
 CellID->1997714465],
Cell[19799, 518, 609, 19, 70, "DisplayMath",ExpressionUUID->"9bdd9950-4e74-4ea1-8d9e-2d68b53879c4",
 CellID->1827676057],
Cell[20411, 539, 923, 30, 70, "Text",ExpressionUUID->"8798a58a-161a-4db5-bc9c-0f7c1f7201bd",
 CellID->145403311],
Cell[21337, 571, 753, 19, 70, "Text",ExpressionUUID->"e425cb34-df2b-4fc2-93a5-9a36143e2cd5",
 CellID->2104541338]
}, Open  ]],
Cell[CellGroupData[{
Cell[22127, 595, 111, 1, 70, "Section",ExpressionUUID->"0108b28e-7bae-4b1a-a62d-769970d7ac23",
 CellID->1970601676],
Cell[22241, 598, 382, 6, 70, "Text",ExpressionUUID->"a6083d02-f569-4aa9-b6e2-c9a4f627c972",
 CellID->1409564498],
Cell[22626, 606, 472, 14, 70, "DisplayMath",ExpressionUUID->"e539ecd4-61fd-4fc0-9021-0aa4b37df486",
 CellID->1658407829],
Cell[23101, 622, 172, 2, 70, "Text",ExpressionUUID->"7328f45e-1f8c-4a11-9bea-4ab9b6c182c5",
 CellID->670127590],
Cell[23276, 626, 645, 22, 70, "DisplayMath",ExpressionUUID->"aea74edf-7948-456a-9994-35247a7ba411",
 CellID->1430160262],
Cell[23924, 650, 712, 14, 70, "Text",ExpressionUUID->"4794b373-5c4d-4a69-b531-218ef84797ae",
 CellID->2066546210],
Cell[24639, 666, 816, 30, 70, "DisplayMath",ExpressionUUID->"29436a5b-84e2-4923-bba5-a940bd916f91",
 CellID->1189128539],
Cell[25458, 698, 417, 12, 70, "Text",ExpressionUUID->"a6f648d3-9b3a-45ba-9748-99ba50b2a448",
 CellID->1200535991],
Cell[25878, 712, 564, 16, 70, "DisplayMath",ExpressionUUID->"ebde6447-18a7-4e62-832f-f9d3775963f5",
 CellID->1799537172],
Cell[26445, 730, 546, 14, 70, "Text",ExpressionUUID->"c06bd4bd-5737-4250-acdf-4260dc50a7d6",
 CellID->1809049103],
Cell[26994, 746, 743, 19, 70, "Text",ExpressionUUID->"35980900-8abf-4abb-9c76-5d4d5a95246b",
 CellID->614799895],
Cell[27740, 767, 424, 7, 70, "Text",ExpressionUUID->"b94dcfd0-1a60-453b-8f02-7b6529f88549",
 CellID->1398009548]
}, Open  ]],
Cell[CellGroupData[{
Cell[28201, 779, 116, 1, 70, "Section",ExpressionUUID->"3b71ee5e-6eed-446a-ad3f-f53a4c2af1c7",
 CellID->727891409],
Cell[28320, 782, 231, 4, 70, "Text",ExpressionUUID->"f084fa28-263a-4940-a991-0289f46d7ef0",
 CellID->1604057751],
Cell[28554, 788, 188, 4, 70, "Text",ExpressionUUID->"382ebe22-5461-41da-b89a-3a5d18c7b416",
 CellID->2036400266],
Cell[28745, 794, 784, 26, 70, "DisplayMath",ExpressionUUID->"e7eebf3a-7622-4354-af7f-9979953faec8",
 CellID->1332388423],
Cell[29532, 822, 108, 1, 70, "Text",ExpressionUUID->"8e0eaa71-7cb2-4609-ae5f-1e58fb74577f",
 CellID->1640238092],
Cell[29643, 825, 584, 17, 70, "DisplayMath",ExpressionUUID->"bf4a3a8d-4fa8-423a-9305-025f3a65ac0f",
 CellID->234035705],
Cell[30230, 844, 366, 11, 70, "Text",ExpressionUUID->"75e89778-13fc-4135-b91c-9e7f791120b8",
 CellID->1395536278],
Cell[30599, 857, 683, 17, 70, "Text",ExpressionUUID->"404596d8-aab7-4847-a8a2-4dff227eac25",
 CellID->2109315459],
Cell[31285, 876, 934, 30, 70, "DisplayMath",ExpressionUUID->"e024b0ad-837b-4a72-b828-a02714c0f3c5",
 CellID->604874737],
Cell[32222, 908, 136, 1, 70, "Text",ExpressionUUID->"437bf422-b641-41c5-b2b5-278cf329dfc9",
 CellID->2089603508],
Cell[32361, 911, 689, 20, 70, "DisplayMath",ExpressionUUID->"e90c5788-f0dc-4bd7-b891-583e0377cf18",
 CellID->18595918],
Cell[33053, 933, 584, 16, 70, "Text",ExpressionUUID->"d65438b5-68c0-4de2-84be-b317e1375acd",
 CellID->1156465011],
Cell[33640, 951, 856, 28, 70, "DisplayMath",ExpressionUUID->"1343ba8c-11a1-46f7-8f6b-7967ed1e73c2",
 CellID->1980434527],
Cell[34499, 981, 446, 13, 70, "Text",ExpressionUUID->"bed12125-549f-470b-95c6-0815c41a7c91",
 CellID->1314050436],
Cell[34948, 996, 710, 22, 70, "DisplayMath",ExpressionUUID->"fa1c6526-557b-4c4f-9cd0-f8ef673f41d3",
 CellID->523852104],
Cell[35661, 1020, 1216, 33, 70, "Text",ExpressionUUID->"b671ba75-c2e4-4c5f-ae40-f130945b75ac",
 CellID->1846842875],
Cell[36880, 1055, 1085, 34, 70, "DisplayMath",ExpressionUUID->"466767ee-c88e-4632-97e6-b04be1c63564",
 CellID->159566387],
Cell[37968, 1091, 300, 8, 70, "Text",ExpressionUUID->"3d689d8c-31fd-49e1-bb21-620e1d9611fe",
 CellID->1772674853],
Cell[38271, 1101, 1657, 54, 70, "DisplayMath",ExpressionUUID->"74e42737-cd26-4bc0-8921-6e3a74543225",
 CellID->1305619540],
Cell[39931, 1157, 487, 8, 70, "Text",ExpressionUUID->"8ccae872-d773-4e26-9fe5-6a74aeca7926",
 CellID->559703734],
Cell[40421, 1167, 870, 29, 70, "DisplayMath",ExpressionUUID->"87202d93-c6ea-4872-a62f-fd387b036536",
 CellID->962283478],
Cell[41294, 1198, 302, 7, 70, "Text",ExpressionUUID->"4a3aa893-1e8e-4d4a-9e4f-fc52c276a579",
 CellID->399069189],
Cell[41599, 1207, 1623, 53, 70, "DisplayMath",ExpressionUUID->"2c706183-e799-4630-a52a-e22d1f75effe",
 CellID->564429942],
Cell[43225, 1262, 536, 11, 70, "Text",ExpressionUUID->"59a48e6a-374e-4a2b-a2fa-ee6a4c74d3da",
 CellID->938766395],
Cell[43764, 1275, 675, 22, 70, "DisplayMath",ExpressionUUID->"077cf889-4685-46ee-b169-b2775750e198",
 CellID->284446256],
Cell[44442, 1299, 102, 1, 70, "Text",ExpressionUUID->"cf7fe0ef-7eb9-4973-808f-a82ce156b0d6",
 CellID->389626370],
Cell[44547, 1302, 661, 21, 70, "DisplayMath",ExpressionUUID->"956c0012-f1e5-4afa-b1de-97b3815b0448",
 CellID->772760887],
Cell[45211, 1325, 1339, 38, 70, "Text",ExpressionUUID->"77fbda6a-d24d-48bf-8ce5-0e82a25ae79e",
 CellID->1958614400],
Cell[46553, 1365, 1335, 45, 70, "DisplayMath",ExpressionUUID->"b8e4286c-1542-4186-bc3f-b411258ff06a",
 CellID->1802879584],
Cell[47891, 1412, 290, 8, 70, "Text",ExpressionUUID->"55c8b239-3791-49c9-aa6e-027eb77b6661",
 CellID->2909118],
Cell[48184, 1422, 808, 28, 70, "DisplayMath",ExpressionUUID->"419b2343-8441-4513-8355-f68c743d856a",
 CellID->1648905992],
Cell[48995, 1452, 886, 26, 70, "Text",ExpressionUUID->"a7343b63-9b6c-45d7-824c-700167d34b15",
 CellID->2034026656],
Cell[49884, 1480, 1172, 32, 70, "Input",ExpressionUUID->"6aa006b6-e001-45bd-b0bd-8268cf9183fe",
 CellID->93830799],
Cell[CellGroupData[{
Cell[51081, 1516, 197, 4, 70, "Input",ExpressionUUID->"84773b94-8b83-4008-8403-46d1d6e47e91",
 CellID->761241895],
Cell[51281, 1522, 1513, 38, 121, "Output",ExpressionUUID->"fa4f3043-8efa-4e88-80f3-408e2748c22c",
 CellID->1632444086]
}, Open  ]],
Cell[52809, 1563, 400, 12, 70, "Text",ExpressionUUID->"0843823a-4fb9-4d92-8dbc-8a005e634b5b",
 CellID->236679330],
Cell[53212, 1577, 189, 4, 70, "Text",ExpressionUUID->"bcfeedff-70f0-428a-b6dc-3ebe72bbc5fc",
 CellID->729785066],
Cell[53404, 1583, 483, 14, 70, "Input",ExpressionUUID->"2b81402b-9e15-4dae-a1a4-090dac41c925",
 CellID->1218496245],
Cell[CellGroupData[{
Cell[53912, 1601, 579, 15, 70, "Input",ExpressionUUID->"3dc10041-a223-4fdd-8235-1d2882725fb1",
 CellID->862331923],
Cell[54494, 1618, 4555, 109, 168, "Output",ExpressionUUID->"235b4abb-842f-4308-8844-a159936daf90",
 CellID->1992979905]
}, Open  ]],
Cell[59064, 1730, 922, 20, 70, "Text",ExpressionUUID->"31475daf-783c-4f5d-986c-808f9666fe44",
 CellID->1710821076],
Cell[59989, 1752, 1172, 32, 70, "Input",ExpressionUUID->"1242e797-0fd7-420a-8831-e164b82c966f",
 CellID->1111274649],
Cell[CellGroupData[{
Cell[61186, 1788, 777, 18, 70, "Input",ExpressionUUID->"bf86b2a0-3c01-4c41-b47e-6198542017d4",
 CellID->527747784],
Cell[61966, 1808, 4582, 112, 168, "Output",ExpressionUUID->"ab878799-ed1d-4e5d-9476-b63cd43f0ab0",
 CellID->749543578]
}, Open  ]],
Cell[CellGroupData[{
Cell[66585, 1925, 313, 9, 70, "Input",ExpressionUUID->"a4910f44-54db-479d-8008-a06e678c8f8e",
 CellID->439842144],
Cell[66901, 1936, 2173, 51, 304, "Output",ExpressionUUID->"71f56326-42b7-436a-a330-6411b98d1d57",
 CellID->788201234]
}, Open  ]],
Cell[69089, 1990, 203, 4, 70, "Text",ExpressionUUID->"c6d3503b-e540-48a6-932b-fb3d1df04130",
 CellID->1619005142],
Cell[69295, 1996, 415, 9, 70, "Text",ExpressionUUID->"3fe97793-6317-487c-abe5-046ce8e6bf8c",
 CellID->2001614104],
Cell[CellGroupData[{
Cell[69735, 2009, 625, 15, 70, "Input",ExpressionUUID->"2f1415fd-23dd-4648-aeb8-34d54d1e74a6",
 CellID->796915673],
Cell[70363, 2026, 4555, 109, 168, "Output",ExpressionUUID->"d3252074-01af-4a9c-95be-238467eb30e2",
 CellID->2053693419]
}, Open  ]],
Cell[74933, 2138, 1574, 46, 70, "Text",ExpressionUUID->"3966141a-9667-4fe3-b82f-1c2168a23534",
 CellID->2068118549]
}, Open  ]],
Cell[CellGroupData[{
Cell[76544, 2189, 123, 1, 70, "Section",ExpressionUUID->"76814999-978f-491d-b3c0-ae13b6030842",
 CellID->1845626348],
Cell[76670, 2192, 585, 9, 70, "Text",ExpressionUUID->"0285979e-58e5-4dbb-a907-c9d4f3f853ed",
 CellID->1188233568],
Cell[77258, 2203, 492, 8, 70, "Text",ExpressionUUID->"3de5bf9e-85d3-4674-9777-dc5b8f32de1a",
 CellID->1191143923],
Cell[77753, 2213, 140, 1, 70, "Text",ExpressionUUID->"694187ff-c091-4ec6-8be7-01b3854c5737",
 CellID->713356527],
Cell[77896, 2216, 762, 26, 70, "DisplayMath",ExpressionUUID->"dfc4c1ba-044c-44ae-89b0-c680abb1d3cd",
 CellID->2129431735],
Cell[78661, 2244, 146, 1, 70, "Text",ExpressionUUID->"4622149d-dadb-49d5-ae2c-06569e493598",
 CellID->1544192890],
Cell[78810, 2247, 644, 20, 70, "DisplayMath",ExpressionUUID->"a73f8dd7-0e3b-40db-8fff-ddced1c402be",
 CellID->910028235],
Cell[79457, 2269, 509, 8, 70, "Text",ExpressionUUID->"2b5e7726-22b3-4715-866c-f858e17461d1",
 CellID->466011711],
Cell[79969, 2279, 2859, 83, 70, "Text",ExpressionUUID->"1eb2c6c3-19c4-4985-beb5-99f64b5ee919",
 CellID->385966168],
Cell[CellGroupData[{
Cell[82853, 2366, 626, 15, 70, "Input",ExpressionUUID->"cb9689a0-59ed-4c49-9c33-37fe0d8e95ef",
 CellID->1532771636],
Cell[83482, 2383, 4553, 109, 168, "Output",ExpressionUUID->"4ebeb7ed-7491-47f2-8217-0327b39ecdf0",
 CellID->79056840]
}, Open  ]],
Cell[88050, 2495, 756, 19, 70, "Text",ExpressionUUID->"9bf43a8b-0730-4985-8214-80ec076f23b0",
 CellID->1563416034],
Cell[88809, 2516, 1030, 28, 70, "Input",ExpressionUUID->"3936e887-65b8-46fb-a65f-a6621ab5f038",
 CellID->1870862393],
Cell[CellGroupData[{
Cell[89864, 2548, 629, 15, 70, "Input",ExpressionUUID->"efa6b5db-27e2-4a01-b6b9-15c3e94aac56",
 CellID->128679777],
Cell[90496, 2565, 4582, 112, 168, "Output",ExpressionUUID->"4f3bd269-53ab-4c36-9d10-b7919d44a657",
 CellID->204979510]
}, Open  ]],
Cell[95093, 2680, 643, 13, 70, "Text",ExpressionUUID->"699fdc9a-8845-4f2a-a7e0-e9c6e713f5e0",
 CellID->526854782],
Cell[CellGroupData[{
Cell[95761, 2697, 843, 21, 70, "Input",ExpressionUUID->"2faf8c68-49d7-4bf0-a5b2-e243c85b5e0e",
 CellID->773244493],
Cell[96607, 2720, 5786, 134, 168, "Output",ExpressionUUID->"b1f7a367-8eed-47de-b793-e4163e9da012",
 CellID->1496645854]
}, Open  ]],
Cell[102408, 2857, 269, 6, 70, "Text",ExpressionUUID->"b4e38f05-ddff-42f9-861b-9c758c552ed3",
 CellID->650910867],
Cell[CellGroupData[{
Cell[102702, 2867, 1008, 25, 70, "Input",ExpressionUUID->"3eb89d54-d295-4d0c-ac32-266ada2130b6",
 CellID->577243851],
Cell[103713, 2894, 5330, 125, 168, "Output",ExpressionUUID->"a14d29df-b9a1-428c-a593-17411ad25531",
 CellID->1553770258]
}, Open  ]],
Cell[109058, 3022, 328, 5, 70, "Text",ExpressionUUID->"148040a2-45b7-4548-a92b-7c57d656390b",
 CellID->815578686]
}, Open  ]],
Cell[109401, 3030, 999, 24, 70, "TutorialMoreAboutSection",ExpressionUUID->"41677ccf-5e34-473a-906c-3985055f78c4"],
Cell[110403, 3056, 2084, 53, 70, "RelatedTutorialsSection",ExpressionUUID->"deab67a2-48b6-44bb-970a-3dd3dcafd6ff"],
Cell[112490, 3111, 2163, 59, 70, "TutorialRelatedLinksSection",ExpressionUUID->"1ef63504-8f98-41e8-aec3-ce52f6d67fdf"],
Cell[114656, 3172, 6336, 161, 70, "TutorialRelatedLinksSection",ExpressionUUID->"17be407b-5a8d-41b0-a580-301df203f60c"],
Cell[120995, 3335, 78, 0, 70, "FooterCell",ExpressionUUID->"d5bcef29-ba1e-4926-839b-6ba39384e779"]
}
]
*)

(* End of internal cache information *)

