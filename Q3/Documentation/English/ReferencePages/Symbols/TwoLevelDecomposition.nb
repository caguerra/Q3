(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35394,        998]
NotebookOptionsPosition[     29031,        861]
NotebookOutlinePosition[     31271,        918]
CellTagsIndexPosition[     31186,        913]
WindowTitle->TwoLevelDecomposition
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"Q3: Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"TwoLevelU\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelU"], "\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/GrayTwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/QuissoPackageGuide"], "\<\"Q3\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/TwoLevelDecomposition\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/TwoLevelDecomposition"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/\
TwoLevelDecomposition.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$177987], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/ref/TwoLevelDecomposition", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["TwoLevelDecomposition", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"TwoLevelDecomposition", "[", 
       StyleBox["mat", "TI"], "]"}]], "InlineFormula"],
     " \[LineSeparator]returns a list of two-level unitary matrices ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula"],
     " in terms of TwoLevelU, where ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Dot"]], "paclet:ref/Dot"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "]"}]], "InlineFormula"],
     " is formally equivalent to ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->217532356],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1049140098],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->615462090],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "ExampleText",
 CellID->1918357742],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.3597315457422679`"}], "+", 
       RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2353688634330425`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1780008271204879`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.16674370266807073`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.10871998036786737`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5825186070992953`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.48404162155323316`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.44045981062882933`"}], "+", 
       RowBox[{"0.005013801738560857`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6015460390884834`"}], "+", 
       RowBox[{"0.42292947550155774`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.047334130612255436`"}], "-", 
       RowBox[{"0.021714844212824318`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4088517464284628`"}], "-", 
       RowBox[{"0.3088223335257124`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.34113771925252967`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.20565179155424987`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.025255380194073026`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.38666451118000916`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5311374103010292`"}], "+", 
       RowBox[{"0.5199230245693615`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24112769014450972`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2839289623230144`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.17880701602494153`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5618371445709885`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.23993490839997852`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4055541721840187`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.11348074059868132`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6263861991805739`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00664199201767904`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.15824810294954506`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->660547511]
}, Open  ]],

Cell[TextData[{
 "Here is a two-level decomposition, where the results are in terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->81370039],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.9618758588628745`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2734864386707457`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.45765710916945546`"}], "-", 
          RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.45765710916945546`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8502617974426346`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8502617974426346`"}], ",", 
         RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.09561546505371263`"}], "-", 
          RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.09561546505371263`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3597315457422679`"}], "+", 
          RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8368575218355715`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8368575218355715`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.3597315457422679`"}], "-", 
          RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9357642417227214`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9357642417227214`"}], ",", 
         RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.7438610740510132`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.7438610740510132`"}], "-", 
          RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->228964803]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->1784857577],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[4]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.9618758588628745`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2734864386707457`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.9618758588628745, -0.2734864386707457]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.45765710916945546`"}], "-", 
         RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.45765710916945546`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.47943038065777965`, -0.2890202728793601], 
         Complex[-0.45765710916945546`, -0.690770412216486], Complex[
         0.47943038065777965`, 0.2890202728793601], Complex[
         0.45765710916945546`, -0.690770412216486]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}], 
        "0.8502617974426346`", "0"},
       {"0", 
        RowBox[{"-", "0.8502617974426346`"}], 
        RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.5263259266197677, -0.005991225038598541], 
         0.8502617974426346, Complex[
         0.5263259266197677, 0.005991225038598541], -0.8502617974426346, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.09561546505371263`"}], "-", 
         RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.09561546505371263`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.7457285581603953, -0.6588406803100867], 
         Complex[-0.09561546505371263, -0.02599150544163175], Complex[
         0.7457285581603953, 0.6588406803100867], Complex[
         0.09561546505371263, -0.02599150544163175]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.3597315457422679`"}], "+", 
         RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], 
        "0.8368575218355715`", "0", "0"},
       {
        RowBox[{"-", "0.8368575218355715`"}], 
        RowBox[{
         RowBox[{"-", "0.3597315457422679`"}], "-", 
         RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.3597315457422679, 0.4126290139400095], 0.8368575218355715, 
         Complex[-0.3597315457422679, -0.4126290139400095], \
-0.8368575218355715, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}], 
        "0.9357642417227214`", "0"},
       {"0", 
        RowBox[{"-", "0.9357642417227214`"}], 
        RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.2812532089294987, 0.21270147244426882`], 
         0.9357642417227214, Complex[
         0.2812532089294987, -0.21270147244426882`], -0.9357642417227214, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.7438610740510132`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.7438610740510132`"}], "-", 
         RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.21292736102551865`, -0.13883258042169538`], Complex[
         0.7438610740510132, -0.6181085309651008], Complex[
         0.21292736102551865`, 0.13883258042169538`], 
         Complex[-0.7438610740510132, -0.6181085309651008]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1591259520]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "ExampleText",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1480244776]
}, Open  ]]
}, Open  ]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso: Quick Start"]], "paclet:Q3/tutorial/QuissoQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->537751834],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->1053489971],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso Package Guide"]], "paclet:Q3/guide/QuissoPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->2056885216],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->2025559553]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Demonstrations", "RelatedDemonstrationsSection",
 CellID->1268215905],

Cell[TextData[ButtonBox["QuantumCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumCircuitUsage"]], "RelatedDemonstrations",
 CellID->341631938]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"TwoLevelDecomposition",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 7, 19, 14, 12, 58.903353}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`", "keywords" -> {}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "TwoLevelDecomposition[mat] returns a list of two-level unitary matrices \
{u1, u2, ...} in terms of TwoLevelU, where Dot[u1, u2, ...] is formally \
equivalent to mat.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "TwoLevelDecomposition", "titlemodifier" -> "", "windowtitle" -> 
    "TwoLevelDecomposition", "type" -> "Symbol", "uri" -> 
    "Q3/ref/TwoLevelDecomposition", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (June 19, 2021)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6625, 191, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"710e8a74-4ba5-4ac4-a0ae-d4ab07b95c1c",
   CellTags->"PrimaryExamplesSection",
   CellID->217532356]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 30988, 906}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 4525, 113, 70, "AnchorBarGrid",ExpressionUUID->"9f278d8c-0905-449f-b357-77902ff210d4",
 CellID->1],
Cell[CellGroupData[{
Cell[5143, 138, 178, 6, 70, "ObjectNameGrid",ExpressionUUID->"8e40b238-c84d-4656-9bd9-d5038568ed78"],
Cell[5324, 146, 1264, 40, 70, "Usage",ExpressionUUID->"a285da1a-c7b8-47ab-afdc-6d04f338630b",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[6625, 191, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"710e8a74-4ba5-4ac4-a0ae-d4ab07b95c1c",
 CellTags->"PrimaryExamplesSection",
 CellID->217532356],
Cell[CellGroupData[{
Cell[6917, 205, 196, 6, 70, "ExampleSection",ExpressionUUID->"476ca246-a2ec-4005-8433-0a9390da7c3d",
 CellID->1049140098],
Cell[7116, 213, 90, 3, 70, "Input",ExpressionUUID->"23075a68-3936-409f-9bc9-21952fd5f8ce",
 CellID->615462090],
Cell[7209, 218, 251, 10, 70, "ExampleText",ExpressionUUID->"88e75299-bd49-41c7-a6a5-f150b80d362a",
 CellID->1918357742],
Cell[CellGroupData[{
Cell[7485, 232, 311, 9, 70, "Input",ExpressionUUID->"79b3e659-aa3b-4959-b869-e87133b4fd75",
 CellID->1893084922],
Cell[7799, 243, 2619, 57, 70, "Output",ExpressionUUID->"700ffea1-0d16-4a88-b534-6ff42c4352ac",
 CellID->660547511]
}, Open  ]],
Cell[10433, 303, 297, 10, 70, "ExampleText",ExpressionUUID->"dca9985d-9e97-48b1-beca-455ce0ebc22b",
 CellID->81370039],
Cell[CellGroupData[{
Cell[10755, 317, 143, 4, 70, "Input",ExpressionUUID->"61be0106-4caf-4cb9-9310-56b5ae517a1b",
 CellID->874151237],
Cell[10901, 323, 5286, 139, 70, "Output",ExpressionUUID->"b1e838a3-19fa-4a66-829d-fcb404fd8a89",
 CellID->228964803]
}, Open  ]],
Cell[16202, 465, 312, 11, 70, "ExampleText",ExpressionUUID->"cdc14301-435f-41c4-a4a2-989206ba0b8a",
 CellID->1784857577],
Cell[CellGroupData[{
Cell[16539, 480, 132, 4, 70, "Input",ExpressionUUID->"b399841b-aa9b-463a-8e0b-386b3bbd994c",
 CellID->344948808],
Cell[16674, 486, 8956, 221, 70, "Output",ExpressionUUID->"2b2b9050-4aca-4ad5-97b5-06ba710a5925",
 CellID->1591259520]
}, Open  ]],
Cell[25645, 710, 92, 1, 70, "ExampleText",ExpressionUUID->"7184ced4-5c91-4f65-88f9-6294e7e67454",
 CellID->732431213],
Cell[CellGroupData[{
Cell[25762, 715, 291, 10, 70, "Input",ExpressionUUID->"3bc8f90d-5c22-4e69-87bd-914b99bb73a3",
 CellID->367426686],
Cell[26056, 727, 612, 19, 70, "Output",ExpressionUUID->"398dcd5a-7790-454c-896f-84b406d3f046",
 CellID->1480244776]
}, Open  ]]
}, Open  ]],
Cell[26695, 750, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"03ca1b11-2dba-4b02-bc96-3cd9e256e6de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26763, 755, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"9878305c-8c3a-4ac1-bf4c-5a02b2df26e9",
 CellID->1255426704],
Cell[26916, 764, 556, 18, 70, "SeeAlso",ExpressionUUID->"e39f48d4-7e43-4def-a821-90c71853dbc8",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[27509, 787, 152, 7, 70, "TutorialsSection",ExpressionUUID->"bc1844e9-470e-4924-b9d4-d1b764e4dd5c",
 CellID->250839057],
Cell[27664, 796, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"428498b0-3647-401e-9342-b3e103e9877a"],
Cell[27698, 798, 189, 6, 70, "Tutorials",ExpressionUUID->"c268de13-9eb8-4a89-8d33-5042a60bd12c",
 CellID->537751834],
Cell[27890, 806, 182, 6, 70, "Tutorials",ExpressionUUID->"aa2a1a4a-f0a1-49b6-ba78-f532da98a5e7",
 CellID->1053489971],
Cell[28075, 814, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"85914346-60d0-447d-b1b7-9f16a63c1526"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28143, 819, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"e2b1eab1-6aa3-4edb-90f1-af1d69063b8f",
 CellID->38303248],
Cell[28302, 828, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"014ceaa6-d941-499c-b1ca-a384d28b1980"],
Cell[28336, 830, 190, 6, 70, "MoreAbout",ExpressionUUID->"04e530bd-cca7-42fa-a0a2-b15826eaf84e",
 CellID->2056885216],
Cell[28529, 838, 156, 6, 70, "MoreAbout",ExpressionUUID->"8c297775-e69b-4bc5-8054-4d889ed8a574",
 CellID->2025559553]
}, Open  ]],
Cell[CellGroupData[{
Cell[28722, 849, 83, 1, 70, "RelatedDemonstrationsSection",ExpressionUUID->"17160325-05de-4c21-88e1-81c4074dfa96",
 CellID->1268215905],
Cell[28808, 852, 181, 4, 70, "RelatedDemonstrations",ExpressionUUID->"6e6efe84-660c-4365-adbf-749aaf12dfc9",
 CellID->341631938]
}, Open  ]],
Cell[29004, 859, 23, 0, 70, "FooterCell",ExpressionUUID->"f9ebe5be-ceb9-49fa-8d8e-4426c42dc50f"]
}
]
*)

(* End of internal cache information *)
