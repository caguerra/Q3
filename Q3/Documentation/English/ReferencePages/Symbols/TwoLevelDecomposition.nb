(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35693,       1015]
NotebookOptionsPosition[     29381,        880]
NotebookOutlinePosition[     31633,        937]
CellTagsIndexPosition[     31548,        932]
WindowTitle->TwoLevelDecomposition
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"QuissoCircuit Usage Examples\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoCircuitUsage"], "\<\"Quisso: Quick \
Start\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"Q3: Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"TwoLevelU\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelU"], "\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/GrayTwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/QuissoPackageGuide"], "\<\"Q3\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/TwoLevelDecomposition\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/TwoLevelDecomposition"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/\
TwoLevelDecomposition.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$163662], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/ref/TwoLevelDecomposition", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["TwoLevelDecomposition", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"TwoLevelDecomposition", "[", 
       StyleBox["mat", "TI"], "]"}]], "InlineFormula"],
     " \[LineSeparator]returns a list of two-level unitary matrices ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula"],
     " in terms of TwoLevelU, where ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Dot"]], "paclet:ref/Dot"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "]"}]], "InlineFormula"],
     " is formally equivalent to ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->1952747857],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1988139145],

Cell[TextData[{
 StyleBox["Gray", "Input"],
 " is a supplementary package and is not loaded by default when the ",
 StyleBox["Q3", "Input"],
 " App is loaded. You need to load it manually."
}], "ExampleText",
 CellID->658460129],

Cell[BoxData[
 RowBox[{"<<", "Q3`Gray`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->615462090],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "ExampleText",
 CellID->1918357742],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.2565603038720275`"}], "+", 
       RowBox[{"0.09760627759745812`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2602656241078555`"}], "+", 
       RowBox[{"0.11578824286339245`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.49588608954994506`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.042671016592310596`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.28583606472410006`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7169927666370844`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1416936101926199`"}], "-", 
       RowBox[{"0.05384096946423671`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7336575843434774`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.15237399819377484`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1469439212282388`"}], "+", 
       RowBox[{"0.5308796124818782`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1153546658435277`"}], "-", 
       RowBox[{"0.31435713222505146`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.8165732571929265`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.44053656997376023`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08656211665658328`"}], "+", 
       RowBox[{"0.03295409806515414`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.20297283066514585`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.20008284913316127`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0947060440919822`"}], "-", 
       RowBox[{"0.20088883055241397`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.1969931157130233`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04475773009390803`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5731904776914679`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.14232815953480718`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1359276824555082`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5908832712438322`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4897972629309142`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.05352658570865057`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1674872903]
}, Open  ]],

Cell[TextData[{
 "Here is a two-level decomposition, where the results are in terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->81370039],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.9953428783825229`"}], "-", 
          RowBox[{"0.09639789651851582`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.20194628256680214`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.20194628256680214`"}], "+", 
          RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9874977219834806`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9874977219834806`"}], ",", 
         RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.7649105241930976`"}], "-", 
          RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.42166257823640535`"}], "-", 
          RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.42166257823640535`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.7649105241930976`"}], "+", 
          RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.25656030387202744`"}], "+", 
          RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.961587138563459`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.961587138563459`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.25656030387202744`"}], "-", 
          RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.27066254702269965`"}], "+", 
          RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9551137796578849`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9551137796578849`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.27066254702269965`"}], "-", 
          RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.3112241341322646`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3112241341322646`"}], "-", 
          RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->250130260]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->1784857577],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[4]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.9953428783825229`"}], "-", 
         RowBox[{"0.09639789651851582`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], 
         Complex[-0.9953428783825229, -0.09639789651851582]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.20194628256680214`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.20194628256680214`"}], "+", 
         RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.8599444625841774, -0.4639350855268786], Complex[
         0.20194628256680214`, 0.06691380011198944], Complex[
         0.8599444625841774, 0.4639350855268786], 
         Complex[-0.20194628256680214`, 0.06691380011198944]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], 
        "0.9874977219834806`", "0"},
       {"0", 
        RowBox[{"-", "0.9874977219834806`"}], 
        RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.14735389494112808`, 0.055991773709318876`], 
         0.9874977219834806, Complex[
         0.14735389494112808`, -0.055991773709318876`], -0.9874977219834806, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.7649105241930976`"}], "-", 
         RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.42166257823640535`"}], "-", 
         RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.42166257823640535`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.7649105241930976`"}], "+", 
         RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.7649105241930976, -0.15743372593990698`], 
         Complex[-0.42166257823640535`, -0.46078973733184037`], 
         Complex[-0.7649105241930976, 0.15743372593990698`], Complex[
         0.42166257823640535`, -0.46078973733184037`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.25656030387202744`"}], "+", 
         RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], 
        "0.961587138563459`", "0", "0"},
       {
        RowBox[{"-", "0.961587138563459`"}], 
        RowBox[{
         RowBox[{"-", "0.25656030387202744`"}], "-", 
         RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.25656030387202744`, 0.09760627759745809], 
         0.961587138563459, 
         Complex[-0.25656030387202744`, -0.09760627759745809], \
-0.961587138563459, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.27066254702269965`"}], "+", 
         RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], 
        "0.9551137796578849`", "0"},
       {"0", 
        RowBox[{"-", "0.9551137796578849`"}], 
        RowBox[{
         RowBox[{"-", "0.27066254702269965`"}], "-", 
         RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.27066254702269965`, 0.12041367674319314`], 
         0.9551137796578849, 
         Complex[-0.27066254702269965`, -0.12041367674319314`], \
-0.9551137796578849, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.3112241341322646`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.3112241341322646`"}], "-", 
         RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.5399308831003644, 0.04646107272818763], Complex[
         0.3112241341322646, -0.7806763404439954], Complex[
         0.5399308831003644, -0.04646107272818763], 
         Complex[-0.3112241341322646, -0.7806763404439954]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->510159525]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "ExampleText",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->829318640]
}, Open  ]]
}, Open  ]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["QuissoCircuit Usage Examples"]], 
   "paclet:Q3/tutorial/QuissoCircuitUsage"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->341631938],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso: Quick Start"]], "paclet:Q3/tutorial/QuissoQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->537751834],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->1053489971],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso Package Guide"]], "paclet:Q3/guide/QuissoPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1956546342],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1404767130]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"TwoLevelDecomposition",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 3, 1, 12, 1, 59.379978}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`Gray`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "TwoLevelDecomposition[mat] returns a list of two-level unitary matrices \
{u1, u2, ...} in terms of TwoLevelU, where Dot[u1, u2, ...] is formally \
equivalent to mat.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "TwoLevelDecomposition", "titlemodifier" -> "", "windowtitle" -> 
    "TwoLevelDecomposition", "type" -> "Symbol", "uri" -> 
    "Q3/ref/TwoLevelDecomposition", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6742, 193, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"618dfb23-9e78-47c6-94f4-33b462400593",
   CellTags->"PrimaryExamplesSection",
   CellID->1952747857]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 31349, 925}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 4642, 115, 70, "AnchorBarGrid",ExpressionUUID->"143fa310-fe9e-4a36-b553-a1cfbaf38c36",
 CellID->1],
Cell[CellGroupData[{
Cell[5260, 140, 178, 6, 70, "ObjectNameGrid",ExpressionUUID->"dd69e496-73be-41e3-9b0e-aff587119830"],
Cell[5441, 148, 1264, 40, 70, "Usage",ExpressionUUID->"17deab39-327f-4b0c-b06c-46942fed0536",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[6742, 193, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"618dfb23-9e78-47c6-94f4-33b462400593",
 CellTags->"PrimaryExamplesSection",
 CellID->1952747857],
Cell[CellGroupData[{
Cell[7035, 207, 196, 6, 70, "ExampleSection",ExpressionUUID->"ef5a5878-3978-4e0e-99cc-f5236cc5403a",
 CellID->1988139145],
Cell[7234, 215, 228, 6, 70, "ExampleText",ExpressionUUID->"e269618b-dfb5-4c0d-a267-d2e53799503c",
 CellID->658460129],
Cell[7465, 223, 95, 3, 70, "Input",ExpressionUUID->"5f474f6c-ebc8-4b51-81cc-7424b8124877",
 CellID->615462090],
Cell[7563, 228, 251, 10, 70, "ExampleText",ExpressionUUID->"5cf25206-728e-4438-9fd0-34c4cc36f12d",
 CellID->1918357742],
Cell[CellGroupData[{
Cell[7839, 242, 311, 9, 70, "Input",ExpressionUUID->"f0849664-eb18-4098-bc35-19edb6aa91bc",
 CellID->1893084922],
Cell[8153, 253, 2619, 58, 70, "Output",ExpressionUUID->"d484b591-45a4-4cbd-9242-126774416877",
 CellID->1674872903]
}, Open  ]],
Cell[10787, 314, 297, 10, 70, "ExampleText",ExpressionUUID->"5a160766-0769-438a-8b2d-ecc5e20ef826",
 CellID->81370039],
Cell[CellGroupData[{
Cell[11109, 328, 143, 4, 70, "Input",ExpressionUUID->"0ba93de3-82f1-4754-9cd0-5f41f1170175",
 CellID->874151237],
Cell[11255, 334, 5325, 144, 70, "Output",ExpressionUUID->"991e1189-64c0-42c2-a14b-36d040ef0525",
 CellID->250130260]
}, Open  ]],
Cell[16595, 481, 312, 11, 70, "ExampleText",ExpressionUUID->"cf2e865e-c458-4864-a829-2862e787be7a",
 CellID->1784857577],
Cell[CellGroupData[{
Cell[16932, 496, 132, 4, 70, "Input",ExpressionUUID->"295480e7-a4e0-4020-a599-15d7e0cf2147",
 CellID->344948808],
Cell[17067, 502, 9011, 227, 70, "Output",ExpressionUUID->"8388fe51-7827-429b-91d7-149b977a2ef7",
 CellID->510159525]
}, Open  ]],
Cell[26093, 732, 92, 1, 70, "ExampleText",ExpressionUUID->"2c82e480-30ef-43b2-a55c-0b5d45dd9b3f",
 CellID->732431213],
Cell[CellGroupData[{
Cell[26210, 737, 291, 10, 70, "Input",ExpressionUUID->"e7462cfd-1f79-49e8-9487-7f7b66da7aa6",
 CellID->367426686],
Cell[26504, 749, 611, 19, 70, "Output",ExpressionUUID->"09af795b-4158-4b3d-ada1-60f86acc40c0",
 CellID->829318640]
}, Open  ]]
}, Open  ]],
Cell[27142, 772, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"2cfd700e-2f4f-4cf1-9479-7110b0fd2c25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27210, 777, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"dbc00e02-f8c9-45eb-af10-e84e44e89371",
 CellID->1255426704],
Cell[27363, 786, 556, 18, 70, "SeeAlso",ExpressionUUID->"97f99d58-f14b-4afc-b8a6-50ad3609c9f9",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[27956, 809, 152, 7, 70, "TutorialsSection",ExpressionUUID->"9d9661b7-da94-45c2-805a-34256c432c77",
 CellID->250839057],
Cell[28111, 818, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"422ee052-2be9-4571-b0ed-d28892d28097"],
Cell[28145, 820, 204, 7, 70, "Tutorials",ExpressionUUID->"f6621210-42f9-49aa-bd33-ede489f210c0",
 CellID->341631938],
Cell[28352, 829, 189, 6, 70, "Tutorials",ExpressionUUID->"befa0ce5-d750-45e3-b12d-c150f09af9c1",
 CellID->537751834],
Cell[28544, 837, 182, 6, 70, "Tutorials",ExpressionUUID->"2e32611d-d28a-4c52-8c72-5ca77421663c",
 CellID->1053489971],
Cell[28729, 845, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"bb669566-85ba-4dad-ab32-d5d31912a4e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28797, 850, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"b531a674-736e-4335-b4f8-e53cb4f932f6",
 CellID->38303248],
Cell[28956, 859, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"ac8f916c-7473-4e60-a3e1-f038038b542c"],
Cell[28990, 861, 190, 6, 70, "MoreAbout",ExpressionUUID->"bbc77756-c53d-4a9e-a67d-daa68ac002a7",
 CellID->1956546342],
Cell[29183, 869, 156, 6, 70, "MoreAbout",ExpressionUUID->"ca7ed9f2-a67e-4146-9c43-ccb4057eebeb",
 CellID->1404767130]
}, Open  ]],
Cell[29354, 878, 23, 0, 70, "FooterCell",ExpressionUUID->"50c8d86f-1f9e-450f-9bad-d3c0bb9047b4"]
}
]
*)

(* End of internal cache information *)
