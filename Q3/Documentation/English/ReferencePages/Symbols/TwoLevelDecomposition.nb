(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35393,        998]
NotebookOptionsPosition[     29031,        861]
NotebookOutlinePosition[     31270,        918]
CellTagsIndexPosition[     31185,        913]
WindowTitle->TwoLevelDecomposition
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"Q3: Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"TwoLevelU\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelU"], "\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/GrayTwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/QuissoPackageGuide"], "\<\"Q3\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/TwoLevelDecomposition\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/TwoLevelDecomposition"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/\
TwoLevelDecomposition.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$200859], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/ref/TwoLevelDecomposition", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["TwoLevelDecomposition", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"TwoLevelDecomposition", "[", 
       StyleBox["mat", "TI"], "]"}]], "InlineFormula"],
     " \[LineSeparator]returns a list of two-level unitary matrices ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula"],
     " in terms of TwoLevelU, where ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Dot"]], "paclet:ref/Dot"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "]"}]], "InlineFormula"],
     " is formally equivalent to ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->1214952793],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1437076275],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->615462090],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "ExampleText",
 CellID->1918357742],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.3597315457422679`"}], "+", 
       RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2353688634330425`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1780008271204879`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.16674370266807073`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.10871998036786737`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5825186070992953`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.48404162155323316`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.44045981062882933`"}], "+", 
       RowBox[{"0.005013801738560857`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6015460390884834`"}], "+", 
       RowBox[{"0.42292947550155774`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.047334130612255436`"}], "-", 
       RowBox[{"0.021714844212824318`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4088517464284628`"}], "-", 
       RowBox[{"0.3088223335257124`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.34113771925252967`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.20565179155424987`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.025255380194073026`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.38666451118000916`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5311374103010292`"}], "+", 
       RowBox[{"0.5199230245693615`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24112769014450972`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2839289623230144`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.17880701602494153`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5618371445709885`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.23993490839997852`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4055541721840187`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.11348074059868132`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6263861991805739`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00664199201767904`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.15824810294954506`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->660547511]
}, Open  ]],

Cell[TextData[{
 "Here is a two-level decomposition, where the results are in terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->81370039],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.9618758588628745`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2734864386707457`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.45765710916945546`"}], "-", 
          RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.45765710916945546`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8502617974426346`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8502617974426346`"}], ",", 
         RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.09561546505371263`"}], "-", 
          RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.09561546505371263`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3597315457422679`"}], "+", 
          RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.8368575218355715`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8368575218355715`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.3597315457422679`"}], "-", 
          RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9357642417227214`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9357642417227214`"}], ",", 
         RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.7438610740510132`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.7438610740510132`"}], "-", 
          RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->228964803]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->1784857577],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[4]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"0.9618758588628745`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2734864386707457`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], Complex[
         0.9618758588628745, -0.2734864386707457]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.45765710916945546`"}], "-", 
         RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.45765710916945546`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.690770412216486`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.47943038065777965`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2890202728793601`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.47943038065777965`, -0.2890202728793601], 
         Complex[-0.45765710916945546`, -0.690770412216486], Complex[
         0.47943038065777965`, 0.2890202728793601], Complex[
         0.45765710916945546`, -0.690770412216486]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}], 
        "0.8502617974426346`", "0"},
       {"0", 
        RowBox[{"-", "0.8502617974426346`"}], 
        RowBox[{"0.5263259266197677`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.005991225038598541`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.5263259266197677, -0.005991225038598541], 
         0.8502617974426346, Complex[
         0.5263259266197677, 0.005991225038598541], -0.8502617974426346, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.09561546505371263`"}], "-", 
         RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.09561546505371263`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.02599150544163175`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.7457285581603953`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6588406803100867`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.7457285581603953, -0.6588406803100867], 
         Complex[-0.09561546505371263, -0.02599150544163175], Complex[
         0.7457285581603953, 0.6588406803100867], Complex[
         0.09561546505371263, -0.02599150544163175]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.3597315457422679`"}], "+", 
         RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], 
        "0.8368575218355715`", "0", "0"},
       {
        RowBox[{"-", "0.8368575218355715`"}], 
        RowBox[{
         RowBox[{"-", "0.3597315457422679`"}], "-", 
         RowBox[{"0.4126290139400095`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.3597315457422679, 0.4126290139400095], 0.8368575218355715, 
         Complex[-0.3597315457422679, -0.4126290139400095], \
-0.8368575218355715, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}], 
        "0.9357642417227214`", "0"},
       {"0", 
        RowBox[{"-", "0.9357642417227214`"}], 
        RowBox[{"0.2812532089294987`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.21270147244426882`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.2812532089294987, 0.21270147244426882`], 
         0.9357642417227214, Complex[
         0.2812532089294987, -0.21270147244426882`], -0.9357642417227214, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.7438610740510132`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.7438610740510132`"}], "-", 
         RowBox[{"0.6181085309651008`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.21292736102551865`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.13883258042169538`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.21292736102551865`, -0.13883258042169538`], Complex[
         0.7438610740510132, -0.6181085309651008], Complex[
         0.21292736102551865`, 0.13883258042169538`], 
         Complex[-0.7438610740510132, -0.6181085309651008]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1591259520]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "ExampleText",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1480244776]
}, Open  ]]
}, Open  ]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso: Quick Start"]], "paclet:Q3/tutorial/QuissoQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->537751834],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->1053489971],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso Package Guide"]], "paclet:Q3/guide/QuissoPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->192376116],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1302492877]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Demonstrations", "RelatedDemonstrationsSection",
 CellID->1268215905],

Cell[TextData[ButtonBox["QuantumCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumCircuitUsage"]], "RelatedDemonstrations",
 CellID->341631938]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"TwoLevelDecomposition",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 12, 2, 21, 52, 26.736455}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`", "keywords" -> {}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "TwoLevelDecomposition[mat] returns a list of two-level unitary matrices \
{u1, u2, ...} in terms of TwoLevelU, where Dot[u1, u2, ...] is formally \
equivalent to mat.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "TwoLevelDecomposition", "titlemodifier" -> "", "windowtitle" -> 
    "TwoLevelDecomposition", "type" -> "Symbol", "uri" -> 
    "Q3/ref/TwoLevelDecomposition", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (July 9, 2021)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6625, 191, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"103568f1-d1db-4f75-a5e0-07784de489be",
   CellTags->"PrimaryExamplesSection",
   CellID->1214952793]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 30986, 906}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 4525, 113, 70, "AnchorBarGrid",ExpressionUUID->"30245be2-d415-4878-b119-a9a206988c05",
 CellID->1],
Cell[CellGroupData[{
Cell[5143, 138, 178, 6, 70, "ObjectNameGrid",ExpressionUUID->"cd62b555-ea26-4e85-b878-dff435c54462"],
Cell[5324, 146, 1264, 40, 70, "Usage",ExpressionUUID->"bb7dd3c1-48bd-44bd-928f-fe84c2c6b79e",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[6625, 191, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"103568f1-d1db-4f75-a5e0-07784de489be",
 CellTags->"PrimaryExamplesSection",
 CellID->1214952793],
Cell[CellGroupData[{
Cell[6918, 205, 196, 6, 70, "ExampleSection",ExpressionUUID->"f700a826-85a1-4e5a-9d90-3a1e4b483fc1",
 CellID->1437076275],
Cell[7117, 213, 90, 3, 70, "Input",ExpressionUUID->"74284563-e0a0-440a-920b-df0a680bf6b7",
 CellID->615462090],
Cell[7210, 218, 251, 10, 70, "ExampleText",ExpressionUUID->"e3722a03-ec6a-4bb6-9855-e0274180d488",
 CellID->1918357742],
Cell[CellGroupData[{
Cell[7486, 232, 311, 9, 70, "Input",ExpressionUUID->"be1c159e-2333-4178-82d8-d53f17e2687e",
 CellID->1893084922],
Cell[7800, 243, 2619, 57, 70, "Output",ExpressionUUID->"266f0781-bd51-4f5d-bfed-14387711f04d",
 CellID->660547511]
}, Open  ]],
Cell[10434, 303, 297, 10, 70, "ExampleText",ExpressionUUID->"5843bce1-3d76-4f5f-abc6-a29d1c722ff5",
 CellID->81370039],
Cell[CellGroupData[{
Cell[10756, 317, 143, 4, 70, "Input",ExpressionUUID->"3d37b047-2231-4c48-870a-ee1649f7bd68",
 CellID->874151237],
Cell[10902, 323, 5286, 139, 70, "Output",ExpressionUUID->"bd61a1ee-c767-4d65-b6d9-5e632ab00b70",
 CellID->228964803]
}, Open  ]],
Cell[16203, 465, 312, 11, 70, "ExampleText",ExpressionUUID->"a5c36c8a-952b-4d40-aad6-98f2d26a1508",
 CellID->1784857577],
Cell[CellGroupData[{
Cell[16540, 480, 132, 4, 70, "Input",ExpressionUUID->"1c051c80-e55d-4043-a67c-8c48232c2b1e",
 CellID->344948808],
Cell[16675, 486, 8956, 221, 70, "Output",ExpressionUUID->"f3c9ebfa-2707-4a08-8982-28b0d9aae48f",
 CellID->1591259520]
}, Open  ]],
Cell[25646, 710, 92, 1, 70, "ExampleText",ExpressionUUID->"b0868317-6d13-45b9-b8aa-42436435bbdf",
 CellID->732431213],
Cell[CellGroupData[{
Cell[25763, 715, 291, 10, 70, "Input",ExpressionUUID->"991f73d7-df55-46c6-a469-1702d25a7401",
 CellID->367426686],
Cell[26057, 727, 612, 19, 70, "Output",ExpressionUUID->"068edb51-7d3e-4160-9e75-3a0b42aedb75",
 CellID->1480244776]
}, Open  ]]
}, Open  ]],
Cell[26696, 750, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"b9d7e435-b750-4175-90d4-ef82bdcd93bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26764, 755, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"a5b0f3d0-87d6-4761-8ad2-7724f7af3ac2",
 CellID->1255426704],
Cell[26917, 764, 556, 18, 70, "SeeAlso",ExpressionUUID->"7863e856-1ab2-4b97-bfe3-890aa81d57f9",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[27510, 787, 152, 7, 70, "TutorialsSection",ExpressionUUID->"4751a08a-fe5b-40ea-a4e4-f82d4108df0f",
 CellID->250839057],
Cell[27665, 796, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"7dacb501-737f-4cb5-b1c2-c747bfa34c0b"],
Cell[27699, 798, 189, 6, 70, "Tutorials",ExpressionUUID->"428d4fd0-0310-4f77-b727-28ce5afdf18e",
 CellID->537751834],
Cell[27891, 806, 182, 6, 70, "Tutorials",ExpressionUUID->"aaa1a394-fe87-400a-a0dd-c17b0a3cd6a7",
 CellID->1053489971],
Cell[28076, 814, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"8431dcd4-ec50-4b46-8355-01d7705bdf19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28144, 819, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"93e12953-3b81-4365-aa3a-0965290e5fd7",
 CellID->38303248],
Cell[28303, 828, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"a3b5542d-ade5-4835-aa48-296f176996ed"],
Cell[28337, 830, 189, 6, 70, "MoreAbout",ExpressionUUID->"1931a77f-6c15-47c8-b11b-2a6d2727f8a3",
 CellID->192376116],
Cell[28529, 838, 156, 6, 70, "MoreAbout",ExpressionUUID->"4799361a-fa1f-4844-b323-761e074c4889",
 CellID->1302492877]
}, Open  ]],
Cell[CellGroupData[{
Cell[28722, 849, 83, 1, 70, "RelatedDemonstrationsSection",ExpressionUUID->"d7659fe1-d8f1-417a-8734-dff3fd69588c",
 CellID->1268215905],
Cell[28808, 852, 181, 4, 70, "RelatedDemonstrations",ExpressionUUID->"06497cb2-ee3a-42b7-83b8-6066130b2d3d",
 CellID->341631938]
}, Open  ]],
Cell[29004, 859, 23, 0, 70, "FooterCell",ExpressionUUID->"7c3c2ef7-c00e-42cc-8076-42bd102cef7e"]
}
]
*)

(* End of internal cache information *)
