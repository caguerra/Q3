(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35857,       1020]
NotebookOptionsPosition[     29361,        881]
NotebookOutlinePosition[     31615,        938]
CellTagsIndexPosition[     31530,        933]
WindowTitle->TwoLevelDecomposition
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"Q3: Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"TwoLevelU\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelU"], "\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/GrayTwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/QuissoPackageGuide"], "\<\"Q3\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/TwoLevelDecomposition\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/TwoLevelDecomposition"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/\
TwoLevelDecomposition.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$172911], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/ref/TwoLevelDecomposition", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["TwoLevelDecomposition", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"TwoLevelDecomposition", "[", 
       StyleBox["mat", "TI"], "]"}]], "InlineFormula"],
     " \[LineSeparator]returns a list of two-level unitary matrices ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula"],
     " in terms of TwoLevelU, where ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Dot"]], "paclet:ref/Dot"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "]"}]], "InlineFormula"],
     " is formally equivalent to ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->1213685907],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1619359743],

Cell[TextData[{
 StyleBox["Gray", "Input"],
 " is a supplementary package and is not loaded by default when the ",
 StyleBox["Q3", "Input"],
 " App is loaded. You need to load it manually."
}], "ExampleText",
 CellID->658460129],

Cell[BoxData[
 RowBox[{"<<", "Q3`Gray`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->615462090],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "ExampleText",
 CellID->1918357742],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.2565603038720275`"}], "+", 
       RowBox[{"0.09760627759745812`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2602656241078555`"}], "+", 
       RowBox[{"0.11578824286339245`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.49588608954994506`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.042671016592310596`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.28583606472410006`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7169927666370844`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1416936101926199`"}], "-", 
       RowBox[{"0.05384096946423671`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7336575843434774`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.15237399819377484`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1469439212282388`"}], "+", 
       RowBox[{"0.5308796124818782`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1153546658435277`"}], "-", 
       RowBox[{"0.31435713222505146`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.8165732571929265`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.44053656997376023`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08656211665658328`"}], "+", 
       RowBox[{"0.03295409806515414`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.20297283066514585`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.20008284913316127`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0947060440919822`"}], "-", 
       RowBox[{"0.20088883055241397`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.1969931157130233`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04475773009390803`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5731904776914679`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.14232815953480718`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1359276824555082`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5908832712438322`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4897972629309142`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.05352658570865057`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1674872903]
}, Open  ]],

Cell[TextData[{
 "Here is a two-level decomposition, where the results are in terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->81370039],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.9953428783825229`"}], "-", 
          RowBox[{"0.09639789651851582`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.20194628256680214`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.20194628256680214`"}], "+", 
          RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9874977219834806`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9874977219834806`"}], ",", 
         RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.7649105241930976`"}], "-", 
          RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.42166257823640535`"}], "-", 
          RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.42166257823640535`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.7649105241930976`"}], "+", 
          RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.25656030387202744`"}], "+", 
          RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.961587138563459`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.961587138563459`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.25656030387202744`"}], "-", 
          RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.27066254702269965`"}], "+", 
          RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9551137796578849`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9551137796578849`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.27066254702269965`"}], "-", 
          RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.3112241341322646`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3112241341322646`"}], "-", 
          RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->250130260]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->1784857577],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[4]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.9953428783825229`"}], "-", 
         RowBox[{"0.09639789651851582`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], 
         Complex[-0.9953428783825229, -0.09639789651851582]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.20194628256680214`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.20194628256680214`"}], "+", 
         RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.8599444625841774, -0.4639350855268786], Complex[
         0.20194628256680214`, 0.06691380011198944], Complex[
         0.8599444625841774, 0.4639350855268786], 
         Complex[-0.20194628256680214`, 0.06691380011198944]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], 
        "0.9874977219834806`", "0"},
       {"0", 
        RowBox[{"-", "0.9874977219834806`"}], 
        RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.14735389494112808`, 0.055991773709318876`], 
         0.9874977219834806, Complex[
         0.14735389494112808`, -0.055991773709318876`], -0.9874977219834806, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.7649105241930976`"}], "-", 
         RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.42166257823640535`"}], "-", 
         RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.42166257823640535`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.7649105241930976`"}], "+", 
         RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.7649105241930976, -0.15743372593990698`], 
         Complex[-0.42166257823640535`, -0.46078973733184037`], 
         Complex[-0.7649105241930976, 0.15743372593990698`], Complex[
         0.42166257823640535`, -0.46078973733184037`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.25656030387202744`"}], "+", 
         RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], 
        "0.961587138563459`", "0", "0"},
       {
        RowBox[{"-", "0.961587138563459`"}], 
        RowBox[{
         RowBox[{"-", "0.25656030387202744`"}], "-", 
         RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.25656030387202744`, 0.09760627759745809], 
         0.961587138563459, 
         Complex[-0.25656030387202744`, -0.09760627759745809], \
-0.961587138563459, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.27066254702269965`"}], "+", 
         RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], 
        "0.9551137796578849`", "0"},
       {"0", 
        RowBox[{"-", "0.9551137796578849`"}], 
        RowBox[{
         RowBox[{"-", "0.27066254702269965`"}], "-", 
         RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.27066254702269965`, 0.12041367674319314`], 
         0.9551137796578849, 
         Complex[-0.27066254702269965`, -0.12041367674319314`], \
-0.9551137796578849, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.3112241341322646`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.3112241341322646`"}], "-", 
         RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.5399308831003644, 0.04646107272818763], Complex[
         0.3112241341322646, -0.7806763404439954], Complex[
         0.5399308831003644, -0.04646107272818763], 
         Complex[-0.3112241341322646, -0.7806763404439954]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->510159525]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "ExampleText",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->829318640]
}, Open  ]]
}, Open  ]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso: Quick Start"]], "paclet:Q3/tutorial/QuissoQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->537751834],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->1053489971],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso Package Guide"]], "paclet:Q3/guide/QuissoPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1518942170],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1722939301]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Demonstrations", "RelatedDemonstrationsSection",
 CellID->1268215905],

Cell[TextData[ButtonBox["QuantumCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumCircuitUsage"]], "RelatedDemonstrations",
 CellID->341631938]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"TwoLevelDecomposition",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 5, 16, 20, 25, 17.968073}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`Gray`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "TwoLevelDecomposition[mat] returns a list of two-level unitary matrices \
{u1, u2, ...} in terms of TwoLevelU, where Dot[u1, u2, ...] is formally \
equivalent to mat.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "TwoLevelDecomposition", "titlemodifier" -> "", "windowtitle" -> 
    "TwoLevelDecomposition", "type" -> "Symbol", "uri" -> 
    "Q3/ref/TwoLevelDecomposition", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6625, 191, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"7c46bbe7-32e5-46eb-ad68-a1bbe7e79d8d",
   CellTags->"PrimaryExamplesSection",
   CellID->1213685907]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 31331, 926}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 4525, 113, 70, "AnchorBarGrid",ExpressionUUID->"da77b73d-9bd2-4e2c-a38c-fce99013d476",
 CellID->1],
Cell[CellGroupData[{
Cell[5143, 138, 178, 6, 70, "ObjectNameGrid",ExpressionUUID->"985ec0c0-9925-4e5b-a00e-814a00518246"],
Cell[5324, 146, 1264, 40, 70, "Usage",ExpressionUUID->"8ed56846-b37d-4172-8db4-665d2e091340",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[6625, 191, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"7c46bbe7-32e5-46eb-ad68-a1bbe7e79d8d",
 CellTags->"PrimaryExamplesSection",
 CellID->1213685907],
Cell[CellGroupData[{
Cell[6918, 205, 196, 6, 70, "ExampleSection",ExpressionUUID->"37e092e9-e899-4f75-bd4b-a88eea07fcb9",
 CellID->1619359743],
Cell[7117, 213, 228, 6, 70, "ExampleText",ExpressionUUID->"1fa0adb2-be86-4fb4-9a4a-6931637bdf79",
 CellID->658460129],
Cell[7348, 221, 95, 3, 70, "Input",ExpressionUUID->"ce9c5ddb-3222-42eb-ab68-1768f5797b52",
 CellID->615462090],
Cell[7446, 226, 251, 10, 70, "ExampleText",ExpressionUUID->"c1ed44a4-49c5-40ce-936c-f15f7c2b4db7",
 CellID->1918357742],
Cell[CellGroupData[{
Cell[7722, 240, 311, 9, 70, "Input",ExpressionUUID->"c06fc2ff-66eb-4875-83ac-d914461ef2a0",
 CellID->1893084922],
Cell[8036, 251, 2619, 58, 70, "Output",ExpressionUUID->"a13d664b-f9b2-4e52-b860-2f21dc1b98c4",
 CellID->1674872903]
}, Open  ]],
Cell[10670, 312, 297, 10, 70, "ExampleText",ExpressionUUID->"cf5cdbdf-882e-410e-9e0a-dd413ef4b22c",
 CellID->81370039],
Cell[CellGroupData[{
Cell[10992, 326, 143, 4, 70, "Input",ExpressionUUID->"aa1d04de-f053-4f7d-b42f-8043d6ccd23e",
 CellID->874151237],
Cell[11138, 332, 5325, 144, 70, "Output",ExpressionUUID->"4c5764ff-e947-4b93-8562-7d254c948b2c",
 CellID->250130260]
}, Open  ]],
Cell[16478, 479, 312, 11, 70, "ExampleText",ExpressionUUID->"7da1b742-31ce-434f-b9f0-688ad3c5c9a8",
 CellID->1784857577],
Cell[CellGroupData[{
Cell[16815, 494, 132, 4, 70, "Input",ExpressionUUID->"dccffbb9-e391-4033-8594-e535414443cb",
 CellID->344948808],
Cell[16950, 500, 9011, 227, 70, "Output",ExpressionUUID->"6ab87b99-7fb5-4a51-930d-c2fd4e5c15ab",
 CellID->510159525]
}, Open  ]],
Cell[25976, 730, 92, 1, 70, "ExampleText",ExpressionUUID->"469e98b5-9cd9-42de-8c1a-a948246022a7",
 CellID->732431213],
Cell[CellGroupData[{
Cell[26093, 735, 291, 10, 70, "Input",ExpressionUUID->"f135bdf9-ee5e-45ba-b12d-52f744b9e818",
 CellID->367426686],
Cell[26387, 747, 611, 19, 70, "Output",ExpressionUUID->"93e7291c-0f00-4b5a-8f51-2357eb358bcc",
 CellID->829318640]
}, Open  ]]
}, Open  ]],
Cell[27025, 770, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"203e58cd-8b62-40dd-9bbe-6a3c52016eb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27093, 775, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"39b14ba1-3e91-4540-80c6-a4b0b70c1743",
 CellID->1255426704],
Cell[27246, 784, 556, 18, 70, "SeeAlso",ExpressionUUID->"120cbcdb-fbea-4db8-b009-6d97b51a5233",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[27839, 807, 152, 7, 70, "TutorialsSection",ExpressionUUID->"55f19d7f-0b8e-412b-a0f9-cb057c6923e6",
 CellID->250839057],
Cell[27994, 816, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"0cbc88b7-3cf2-4840-922b-814c126c06d1"],
Cell[28028, 818, 189, 6, 70, "Tutorials",ExpressionUUID->"49f8f124-917d-4f6d-9fc2-63223356663d",
 CellID->537751834],
Cell[28220, 826, 182, 6, 70, "Tutorials",ExpressionUUID->"34c54f5d-37a2-46bb-a5f5-1805b14cab9a",
 CellID->1053489971],
Cell[28405, 834, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"07e86720-12c7-44d4-bdfb-0b0716e7c7ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28473, 839, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"7264a933-0ebf-47d6-b303-bd2ab971e5a7",
 CellID->38303248],
Cell[28632, 848, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"6a2950ec-c850-4ebc-b0af-c96021bb80b5"],
Cell[28666, 850, 190, 6, 70, "MoreAbout",ExpressionUUID->"8f2da909-536f-47bf-9893-ff47166995c5",
 CellID->1518942170],
Cell[28859, 858, 156, 6, 70, "MoreAbout",ExpressionUUID->"3e6d4e53-5646-43a8-a37e-5c39e43852e6",
 CellID->1722939301]
}, Open  ]],
Cell[CellGroupData[{
Cell[29052, 869, 83, 1, 70, "RelatedDemonstrationsSection",ExpressionUUID->"c75cab2e-67c2-44e0-8add-75bab13fc12c",
 CellID->1268215905],
Cell[29138, 872, 181, 4, 70, "RelatedDemonstrations",ExpressionUUID->"70e994b0-bb19-4f6e-92f6-4ba384d934f3",
 CellID->341631938]
}, Open  ]],
Cell[29334, 879, 23, 0, 70, "FooterCell",ExpressionUUID->"dfd95367-cce8-4884-b051-0e20cc7f42ec"]
}
]
*)

(* End of internal cache information *)
