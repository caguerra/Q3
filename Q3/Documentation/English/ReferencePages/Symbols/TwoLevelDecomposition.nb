(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35687,       1015]
NotebookOptionsPosition[     29378,        880]
NotebookOutlinePosition[     31630,        937]
CellTagsIndexPosition[     31545,        932]
WindowTitle->TwoLevelDecomposition
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"QuissoCircuit Usage Examples\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoCircuitUsage"], "\<\"Quisso: Quick \
Start\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"Q3: Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"TwoLevelU\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/TwoLevelU"], "\<\"GrayTwoLevelU\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/GrayTwoLevelU"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/QuissoPackageGuide"], "\<\"Q3\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/TwoLevelDecomposition\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/TwoLevelDecomposition"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/\
TwoLevelDecomposition.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$165213], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "Q3/ref/TwoLevelDecomposition", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["TwoLevelDecomposition", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"TwoLevelDecomposition", "[", 
       StyleBox["mat", "TI"], "]"}]], "InlineFormula"],
     " \[LineSeparator]returns a list of two-level unitary matrices ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula"],
     " in terms of TwoLevelU, where ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Dot"]], "paclet:ref/Dot"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["u", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "]"}]], "InlineFormula"],
     " is formally equivalent to ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->2069849903],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->879721968],

Cell[TextData[{
 StyleBox["Gray", "Input"],
 " is a supplementary package and is not loaded by default when the ",
 StyleBox["Q3", "Input"],
 " App is loaded. You need to load it manually."
}], "ExampleText",
 CellID->658460129],

Cell[BoxData[
 RowBox[{"<<", "Q3`Gray`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->615462090],

Cell[TextData[{
 "Consider a ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["2", 
    StyleBox["n", "TI"]], "\[Times]", 
   SuperscriptBox["2", 
    StyleBox["n", "TI"]]}]], "InlineFormula"],
 " unitary matrix."
}], "ExampleText",
 CellID->1918357742],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1893084922],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.2565603038720275`"}], "+", 
       RowBox[{"0.09760627759745812`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2602656241078555`"}], "+", 
       RowBox[{"0.11578824286339245`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.49588608954994506`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.042671016592310596`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.28583606472410006`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7169927666370844`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1416936101926199`"}], "-", 
       RowBox[{"0.05384096946423671`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7336575843434774`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.15237399819377484`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1469439212282388`"}], "+", 
       RowBox[{"0.5308796124818782`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1153546658435277`"}], "-", 
       RowBox[{"0.31435713222505146`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.8165732571929265`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.44053656997376023`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08656211665658328`"}], "+", 
       RowBox[{"0.03295409806515414`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.20297283066514585`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.20008284913316127`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0947060440919822`"}], "-", 
       RowBox[{"0.20088883055241397`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.1969931157130233`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04475773009390803`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5731904776914679`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.14232815953480718`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1359276824555082`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5908832712438322`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4897972629309142`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.05352658570865057`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1674872903]
}, Open  ]],

Cell[TextData[{
 "Here is a two-level decomposition, where the results are in terms of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->81370039],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->874151237],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.9953428783825229`"}], "-", 
          RowBox[{"0.09639789651851582`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.20194628256680214`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.20194628256680214`"}], "+", 
          RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9874977219834806`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9874977219834806`"}], ",", 
         RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.7649105241930976`"}], "-", 
          RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.42166257823640535`"}], "-", 
          RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.42166257823640535`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.7649105241930976`"}], "+", 
          RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.25656030387202744`"}], "+", 
          RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.961587138563459`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.961587138563459`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.25656030387202744`"}], "-", 
          RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.27066254702269965`"}], "+", 
          RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], ",", 
         "0.9551137796578849`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9551137796578849`"}], ",", 
         RowBox[{
          RowBox[{"-", "0.27066254702269965`"}], "-", 
          RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.3112241341322646`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3112241341322646`"}], "-", 
          RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->250130260]
}, Open  ]],

Cell[TextData[{
 "You can convert the above results to more human readable full matrix form \
by means of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->1784857577],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", "mm"}]}]], "Input",
 CellLabel->"In[4]:=",
 CellID->344948808],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.9953428783825229`"}], "-", 
         RowBox[{"0.09639789651851582`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {
        1, 1, Complex[1., 0.], 
         Complex[-0.9953428783825229, -0.09639789651851582]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.20194628256680214`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.20194628256680214`"}], "+", 
         RowBox[{"0.06691380011198944`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.8599444625841774`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.4639350855268786`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.8599444625841774, -0.4639350855268786], Complex[
         0.20194628256680214`, 0.06691380011198944], Complex[
         0.8599444625841774, 0.4639350855268786], 
         Complex[-0.20194628256680214`, 0.06691380011198944]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], 
        "0.9874977219834806`", "0"},
       {"0", 
        RowBox[{"-", "0.9874977219834806`"}], 
        RowBox[{"0.14735389494112808`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.055991773709318876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[0.14735389494112808`, 0.055991773709318876`], 
         0.9874977219834806, Complex[
         0.14735389494112808`, -0.055991773709318876`], -0.9874977219834806, 
         1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.7649105241930976`"}], "-", 
         RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.42166257823640535`"}], "-", 
         RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.42166257823640535`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.46078973733184037`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.7649105241930976`"}], "+", 
         RowBox[{"0.15743372593990698`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[-0.7649105241930976, -0.15743372593990698`], 
         Complex[-0.42166257823640535`, -0.46078973733184037`], 
         Complex[-0.7649105241930976, 0.15743372593990698`], Complex[
         0.42166257823640535`, -0.46078973733184037`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.25656030387202744`"}], "+", 
         RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], 
        "0.961587138563459`", "0", "0"},
       {
        RowBox[{"-", "0.961587138563459`"}], 
        RowBox[{
         RowBox[{"-", "0.25656030387202744`"}], "-", 
         RowBox[{"0.09760627759745809`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {2}, {1}, {3}, {4}}}, {
        Complex[-0.25656030387202744`, 0.09760627759745809], 
         0.961587138563459, 
         Complex[-0.25656030387202744`, -0.09760627759745809], \
-0.961587138563459, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.27066254702269965`"}], "+", 
         RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], 
        "0.9551137796578849`", "0"},
       {"0", 
        RowBox[{"-", "0.9551137796578849`"}], 
        RowBox[{
         RowBox[{"-", "0.27066254702269965`"}], "-", 
         RowBox[{"0.12041367674319314`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.27066254702269965`, 0.12041367674319314`], 
         0.9551137796578849, 
         Complex[-0.27066254702269965`, -0.12041367674319314`], \
-0.9551137796578849, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.3112241341322646`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.3112241341322646`"}], "-", 
         RowBox[{"0.7806763404439954`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5399308831003644`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.04646107272818763`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.5399308831003644, 0.04646107272818763], Complex[
         0.3112241341322646, -0.7806763404439954], Complex[
         0.5399308831003644, -0.04646107272818763], 
         Complex[-0.3112241341322646, -0.7806763404439954]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->510159525]
}, Open  ]],

Cell["Check the decomposition with the original matrix.", "ExampleText",
 CellID->732431213],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "mm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->367426686],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->829318640]
}, Open  ]]
}, Open  ]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GrayTwoLevelU"]], "paclet:Q3/ref/GrayTwoLevelU"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["QuissoCircuit Usage Examples"]], 
   "paclet:Q3/tutorial/QuissoCircuitUsage"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->341631938],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso: Quick Start"]], "paclet:Q3/tutorial/QuissoQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->537751834],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->1053489971],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso Package Guide"]], "paclet:Q3/guide/QuissoPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->62206581],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1828954425]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"TwoLevelDecomposition",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 3, 16, 8, 5, 28.157631}", 
    "history" -> {"1.5", "", "", ""}, "context" -> "Q3`Gray`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "TwoLevelDecomposition[mat] returns a list of two-level unitary matrices \
{u1, u2, ...} in terms of TwoLevelU, where Dot[u1, u2, ...] is formally \
equivalent to mat.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "TwoLevelDecomposition", "titlemodifier" -> "", "windowtitle" -> 
    "TwoLevelDecomposition", "type" -> "Symbol", "uri" -> 
    "Q3/ref/TwoLevelDecomposition", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6742, 193, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"b7a82b4f-ea5f-4115-9ace-d1c8b61c807b",
   CellTags->"PrimaryExamplesSection",
   CellID->2069849903]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 31346, 925}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 4642, 115, 70, "AnchorBarGrid",ExpressionUUID->"ef1ab500-f0cb-46d8-81fe-e5d2f20080b0",
 CellID->1],
Cell[CellGroupData[{
Cell[5260, 140, 178, 6, 70, "ObjectNameGrid",ExpressionUUID->"724c4500-c3bb-49fa-b34f-9b1286c8ebb3"],
Cell[5441, 148, 1264, 40, 70, "Usage",ExpressionUUID->"9d9b74ef-366c-4284-ad7a-aab6aef2fc70",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[6742, 193, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"b7a82b4f-ea5f-4115-9ace-d1c8b61c807b",
 CellTags->"PrimaryExamplesSection",
 CellID->2069849903],
Cell[CellGroupData[{
Cell[7035, 207, 195, 6, 70, "ExampleSection",ExpressionUUID->"a2f4539b-fca3-4a71-bed3-13f8eb940786",
 CellID->879721968],
Cell[7233, 215, 228, 6, 70, "ExampleText",ExpressionUUID->"4335473b-c6d1-44b4-a6dc-41fa7f16ca22",
 CellID->658460129],
Cell[7464, 223, 95, 3, 70, "Input",ExpressionUUID->"089bf828-aa54-49aa-be44-666a649f5287",
 CellID->615462090],
Cell[7562, 228, 251, 10, 70, "ExampleText",ExpressionUUID->"d6c1cd42-aa2c-4dab-b5d5-3f5ca00d74c7",
 CellID->1918357742],
Cell[CellGroupData[{
Cell[7838, 242, 311, 9, 70, "Input",ExpressionUUID->"e6c31679-9d55-46b8-a233-484699e15742",
 CellID->1893084922],
Cell[8152, 253, 2619, 58, 70, "Output",ExpressionUUID->"1d78b05d-eb04-4236-8410-7f6344965858",
 CellID->1674872903]
}, Open  ]],
Cell[10786, 314, 297, 10, 70, "ExampleText",ExpressionUUID->"5fa77abd-16a4-47ea-9d45-2083e2e28a7a",
 CellID->81370039],
Cell[CellGroupData[{
Cell[11108, 328, 143, 4, 70, "Input",ExpressionUUID->"7c70c34a-2192-4482-94a8-4fd7b436be8a",
 CellID->874151237],
Cell[11254, 334, 5325, 144, 70, "Output",ExpressionUUID->"0e1a6f9a-963c-4878-83ec-c540fef5b082",
 CellID->250130260]
}, Open  ]],
Cell[16594, 481, 312, 11, 70, "ExampleText",ExpressionUUID->"db9b3bc8-81ba-4b44-97b1-c94fcb663ad6",
 CellID->1784857577],
Cell[CellGroupData[{
Cell[16931, 496, 132, 4, 70, "Input",ExpressionUUID->"e6c9fa8b-8e80-4ac2-8b61-af4308c400dd",
 CellID->344948808],
Cell[17066, 502, 9011, 227, 70, "Output",ExpressionUUID->"8bf74e74-194a-415f-ae73-959606123c2c",
 CellID->510159525]
}, Open  ]],
Cell[26092, 732, 92, 1, 70, "ExampleText",ExpressionUUID->"21016c24-e56f-4d47-90c9-656d90b774fe",
 CellID->732431213],
Cell[CellGroupData[{
Cell[26209, 737, 291, 10, 70, "Input",ExpressionUUID->"8c08c6b0-ab75-4d71-a0cf-b49701089aa3",
 CellID->367426686],
Cell[26503, 749, 611, 19, 70, "Output",ExpressionUUID->"46de7c72-290c-486a-af19-afc0954d9a3d",
 CellID->829318640]
}, Open  ]]
}, Open  ]],
Cell[27141, 772, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"41dbed39-4dcc-4411-810d-e59623d8ebe6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27209, 777, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"1ee70035-e53c-48cd-bb4b-878bfba4a3cb",
 CellID->1255426704],
Cell[27362, 786, 556, 18, 70, "SeeAlso",ExpressionUUID->"c310e89e-e3e8-43f5-9cb4-c0fdbda171b8",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[27955, 809, 152, 7, 70, "TutorialsSection",ExpressionUUID->"fcb779d5-a330-46ef-9d15-ae409a12be0a",
 CellID->250839057],
Cell[28110, 818, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"0bdc1d0a-8fdb-4126-ad15-efa92682a0bb"],
Cell[28144, 820, 204, 7, 70, "Tutorials",ExpressionUUID->"dc139aac-7591-4cb3-b8e5-614896e69491",
 CellID->341631938],
Cell[28351, 829, 189, 6, 70, "Tutorials",ExpressionUUID->"77043750-19cb-4545-822a-471b7ddc1534",
 CellID->537751834],
Cell[28543, 837, 182, 6, 70, "Tutorials",ExpressionUUID->"a64bb8e6-8f19-4114-b163-839a6437460c",
 CellID->1053489971],
Cell[28728, 845, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"9d2606b6-60f2-41f3-91aa-6c100c9eed10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28796, 850, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"efefb4f5-8427-41b3-978e-54b4c68d33e6",
 CellID->38303248],
Cell[28955, 859, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"88419c03-4a5e-4883-8d4e-af92cfabeed2"],
Cell[28989, 861, 188, 6, 70, "MoreAbout",ExpressionUUID->"e48687e9-b487-4569-a9d7-f0e3f9015388",
 CellID->62206581],
Cell[29180, 869, 156, 6, 70, "MoreAbout",ExpressionUUID->"7c38d5e0-d8e8-4369-ba0c-fb723e37ebc7",
 CellID->1828954425]
}, Open  ]],
Cell[29351, 878, 23, 0, 70, "FooterCell",ExpressionUUID->"5a9b1351-f254-4d14-a573-d59068710acd"]
}
]
*)

(* End of internal cache information *)
