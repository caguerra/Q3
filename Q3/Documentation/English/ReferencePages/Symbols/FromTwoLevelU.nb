(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     97904,       2686]
NotebookOptionsPosition[     88624,       2498]
NotebookOutlinePosition[     91243,       2560]
CellTagsIndexPosition[     91121,       2554]
WindowTitle->FromTwoLevelU
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "c569b77b-16d3-47ae-bb0d-ffcafb1ab663"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "259da925-bd23-4681-ac43-033f54d4495b"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4e4d3c8c-a27f-4e95-9b7e-e6f0ae45e867"]
         }],ExpressionUUID->"44258988-5787-4571-be06-ab79e24275ae"],
         StripOnInput->False], {"\<\"TwoLevelDecomposition\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/TwoLevelDecomposition"], "\<\"TwoLevelU\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/TwoLevelU"], "\<\"BinaryToGray\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/ref/BinaryToGray"], "\<\"GrayToBinary\"\>":>
        Documentation`HelpLookup["paclet:Q3/ref/GrayToBinary"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "9e4fc76a-a85f-4a15-a0c2-622422b26e4e"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "2a713113-f8a5-474a-83f8-4e56ba9ffca0"]
         }],ExpressionUUID->"aaa10739-1985-49c0-b769-5593430e0bb4"],
         StripOnInput->False], {"\<\"Quantum Information Systems\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/guide/QuantumInformationSystems"], "\<\"Q3\"\>":>
        Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "15c2c2c8-9075-4789-8e1e-835d67c96f94"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "e7bd4c98-c4c1-4f5b-a46f-bec05921a180"]
         }],ExpressionUUID->"2d2195f2-8956-4232-af5b-7f9a45252b52"],
         StripOnInput->False], {"\<\"Two-Qubit Gates\"\>":>
        Documentation`HelpLookup[
        "paclet:Q3/tutorial/TwoQubitGates"], "\<\"Universal Quantum \
Computation\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/UniversalQuantumComputation"], "\<\"Universal \
Quantum Computation: Demonstration\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/UniversalQuantumComputationDemonstration"], \
"\<\"Quantum Computation: Overview\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumComputationOverview"], "\<\"Quantum \
Information Systems with Q3\"\>":>Documentation`HelpLookup[
        "paclet:Q3/tutorial/QuantumInformationSystems"], "\<\"Q3: Quick Start\
\"\>":>Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4c1fb9e2-b678-4fae-8533-b19e1cc87a04"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "67eddcbc-280d-4566-bb1c-024f4a61373e"]
         }],ExpressionUUID->"2a211481-2443-40d9-a2ca-59344ea57bc9"],
         StripOnInput->False], {"\<\"Q3/ref/FromTwoLevelU\"\>":>
        None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell["Q3/ref/FromTwoLevelU"]}, Visible -> False]]; 
         SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; Null], 
        Delimiter, "\<\"Copy web URL\"\>":>
        Module[{DocumentationSearch`Private`nb$}, 
         DocumentationSearch`Private`nb$ = NotebookPut[
            Notebook[{
              Cell[
               BoxData[
                MakeBoxes[
                 Hyperlink[
                 "http://reference.wolfram.com/language/Q3/ref/FromTwoLevelU.\
html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, Visible -> 
             False]]; SelectionMove[
          DocumentationSearch`Private`nb$, All, Notebook]; 
         FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
         NotebookClose[DocumentationSearch`Private`nb$]; 
         Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
          NotebookLocate[{
            URL[If[
               TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$26449], 
               "http://reference.wolfram.com/system-modeler/", 
               "http://reference.wolfram.com/language/"] <> 
             "Q3/ref/FromTwoLevelU" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d6217a6f-660f-4bf7-aae9-605aca24e39f"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "22701662-7eac-46a8-9a9d-73540f78faf1"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"42a84165-b8fb-4f30-9c8f-1ebbd3bf39a4"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"6e963f56-190f-4052-870f-74ae48b38525"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "FromTwoLevelU", "ObjectName",ExpressionUUID->
      "2522017b-1a17-4e29-ac96-1b966e7226c2"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"a34be65c-d69b-48df-8880-8567aec7b297"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "fc5f59c4-888e-428f-8ca6-0878506bb4b3"]
    }],ExpressionUUID->"90ddaaa6-1b46-4c63-9c17-a424d66ceecc"], 
    "\[SpanFromLeft]"}
  }]], "ObjectNameGrid",ExpressionUUID->"9e0c7f8c-fb27-471c-be2c-\
7d8423bc4b41"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FromTwoLevelU", "[", 
       RowBox[{
        StyleBox["mat", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["x", "TI"], ",", 
          StyleBox["y", "TI"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "2ad03424-cbae-4d75-92ce-52a80ffb697d"],
     " \[LineSeparator]returns a list of ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
       "PackageLink",
       BaseStyle->"InlineFormula"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "9b0413b6-db6d-48b3-b007-ab2b6c5d0097"],
     " gates and one controlled-unitary gate that together reconstruct the \
two-level unitary operation specified by ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "e6031a1e-1d6f-4c0a-8e68-7a2ddf51f9a1"],
     " and the row and column indices ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        StyleBox["x", "TI"], ",", 
        StyleBox["y", "TI"]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "ef633ffd-3468-478d-b6df-436f7c663331"],
     " acting on the qubits ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["q", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["q", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "6b8d5858-de31-4fd9-aa02-71eac8fc19f7"],
     "."
    }],ExpressionUUID->"865ba6d6-dd60-499b-8672-a544f17acfae"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FromTwoLevelU", "[", 
       RowBox[{
        RowBox[{
         TemplateBox[{
           Cell[
            TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"], "[", 
         RowBox[{
          StyleBox["mat", "TI"], ",", 
          RowBox[{"{", 
           RowBox[{
            StyleBox["x", "TI"], ",", 
            StyleBox["y", "TI"]}], "}"}], ",", 
          StyleBox["size", "TI"]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"], ",", 
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["n", "TI"]]}], "}"}]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "71860117-5433-4aff-8dd3-23bc16d6b4d7"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["GrayTwoLevel"]], "paclet:Q3/ref/GrayTwoLevel", 
         "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["mat", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["x", "TI"], ",", 
          StyleBox["y", "TI"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"], ",", 
          SubscriptBox[
           StyleBox["q", "TI"], 
           StyleBox["n", "TI"]]}], "}"}]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "2d782fcc-92c5-484c-abb2-d772c888c930"],
     " as long as ",
     Cell[BoxData[
      RowBox[{
       StyleBox["size", "TI"], "==", 
       SuperscriptBox["2", 
        StyleBox["n", "TI"]]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "77a954f1-d8a4-4387-bb64-c3f44dbb8a1c"],
     "."
    }],ExpressionUUID->"9bbf915d-d8ff-4eff-a363-0e5e4622e9cd"]}
  }]], "Usage",
 CellID->982511436,ExpressionUUID->"89254468-2f72-42c6-8b76-d0b8db9d325b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "267a365a-8a77-4e03-873a-5548273fc0de"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b51f75d1-88f9-4553-862e-f5c9aa933169"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "8028ee43-aaf1-412d-82b4-99c2c520b6d0"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1532228486,ExpressionUUID->"0abdcd28-7f1b-4b6c-b618-c0517cff6fbe"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1927565408,ExpressionUUID->"000dbc6d-d7c6-49d2-ac10-648cf6157b70"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "6863d245-5a4b-4734-b13f-b453c1d2d398"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"d2ba1514-a610-45e2-9265-131a11fcc4ee"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "8cfd2e06-d6af-4b06-88f7-a1a3959c5422"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1687753025,ExpressionUUID->"6f789077-c3f7-4e87-90b4-e9f8b82d38fd"],

Cell[TextData[{
 "Consider an ",
 Cell[BoxData[
  StyleBox["n", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9d6c7f6c-8b0c-456d-9ca5-05aafa280320"],
 "-qubit quantum register."
}], "ExampleText",
 CellID->1841784908,ExpressionUUID->"ad0e6e00-9c22-4c0f-ae9b-e5f4306b7a83"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", "n", "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1668741869,ExpressionUUID->"77e0c600-07b8-4d00-84ed-729d2b527e18"],

Cell[TextData[{
 "Suppose that a 2\[Times]2 unitary matrix U is operating on the ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "019f44e4-c2c5-43d1-b467-a8f7fc333f1c"],
 "th and ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "07d2911d-e8d6-4a73-b20f-82798bc27ca8"],
 "th rows and columns."
}], "ExampleText",
 CellID->1353831685,ExpressionUUID->"a35da415-378a-4e91-9e48-9a265b8732c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"2", "^", "n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->408162463,ExpressionUUID->"76270681-d84a-4d0d-b49c-589cb81204dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1934437947,ExpressionUUID->"948ff6f9-db4a-42f8-b1e9-95024421752e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1343643296,ExpressionUUID->"6bb861f6-1f07-496e-a869-a40bf19b989b"]
}, Open  ]],

Cell["This is the full operator expression.", "ExampleText",
 CellID->1856100676,ExpressionUUID->"266acea6-cb65-459b-92df-4adde27b6fc0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"S", "@", "nn"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "expr", "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->891772264,ExpressionUUID->"7ce0be5e-33f7-4812-bec0-cdf65b4ab38a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 4], 
     $CellContext`S[2, 5], 
     $CellContext`S[3, 5]]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 5], 
     $CellContext`S[2, 4], 
     $CellContext`S[3, 4]]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1501647741,ExpressionUUID->"953081a9-dd9e-4667-941a-7e5d06430a06"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->965763443,ExpressionUUID->"b5c8c737-fb5f-472f-98ca-28de3449513f"]
}, Open  ]],

Cell[TextData[{
 StyleBox["FromTwoLevelU", "Input"],
 " rewrites the two-level unitary operation in terms of CNOT gates and one \
controlled-U gate."
}], "ExampleText",
 CellID->1118998759,ExpressionUUID->"b31cea82-0769-48c3-afa5-463ca567a611"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"FromTwoLevelU", "[", 
   RowBox[{"U", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"S", "@", "nn"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->779608136,ExpressionUUID->"25a2750e-0fe3-4bf3-9f3b-a760fff73f67"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`S[1, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[3, 2]]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`S[1, Q3`$]], "}"}]}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1565537317,ExpressionUUID->"1e4e5e74-382f-40da-9a31-d3103857574d"]
}, Open  ]],

Cell["Here is the quantum circuit representation.", "ExampleText",
 CellID->1313764330,ExpressionUUID->"03b4e896-6b76-4d33-b8b0-a84e96a22f74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1777808801,ExpressionUUID->"ef380120-a773-43ee-853e-9aae797e2981"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
      2.6, -3.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 0}, Rational[1, 2] 3^Rational[1, 2] + 
    Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->1376951407,ExpressionUUID->"a953df0a-9253-4c6f-9536-bbfff4983f36"]
}, Open  ]],

Cell["Certainly, it reproduces the original operator.", "ExampleText",
 CellID->1513410627,ExpressionUUID->"c68aaafa-8c4b-43fa-93bc-5f37d9ca7681"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "expr"}], "//", "Elaborate"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->2001503477,ExpressionUUID->"31492a7e-cdb8-4b29-af0f-a6588f7b6f70"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1529743153,ExpressionUUID->"43f99aaf-bfdc-4563-9caf-40ab8caa5750"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "798a1806-08ae-44bf-8428-d05c9e38fd38"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1200765697,ExpressionUUID->"3f1a380b-38b3-46a8-8acc-abf66a042c8d"],

Cell["\<\
Consider the same unitary operation operating on different levels.\
\>", "ExampleText",
 CellID->1846068461,ExpressionUUID->"cf0b5d88-45a1-4b2a-969e-1937bd89fc1b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"2", "^", "n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"S", "@", "nn"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1891440696,ExpressionUUID->"28ec904e-5055-4e35-9dbc-459717a306ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       7}, {6}, {8}}}, {
      1, 1, 1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1}}]]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->1232636939,ExpressionUUID->"710fce0c-4b48-4bcf-aa95-20e9031127a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 4], 
     $CellContext`S[3, 5]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 5], 
     $CellContext`S[3, 4]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 4], 
     $CellContext`S[3, 5]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 5], 
     $CellContext`S[3, 4]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->154291164,ExpressionUUID->"a1a22652-c915-44ca-860e-c81adbb0f376"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gates", "=", 
  RowBox[{"FromTwoLevelU", "[", 
   RowBox[{"U", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"S", "@", "nn"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1103544376,ExpressionUUID->"1e1c93df-b07b-4840-ada4-437991b6b377"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[3, 2]]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->432477301,ExpressionUUID->"25edb1f9-b49d-440e-a7d8-cda8c6121873"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, 
     LineBox[{{1.6, -3.4}, {2.4, -3.4}, {2.4, -2.6}, {1.6, -2.6}, {
      1.6, -3.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -1}, {3, -3}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 1}, Rational[1, 2] 3^Rational[1, 2] + 
    Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1561336459,ExpressionUUID->"26f30c7b-7b30-4850-834b-cac211896f1c"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJzt3X1QVNX/B3DYBQwfKFFxgMgwCTIbURSVqKYmUMjRCUzKIVNLicKH8Dt9
00BJTYU0H4CRqMniK2Xg8Adj6ZRlTo0jltlQkSD4MAplYqEoJAj7+/y4484O
LLv3nnvuw+59v2Zq5O7uZ8/9nHM/e87d3buhi5YnLTF5eHisvIP+l7Twv49n
Zi5clXwX/fHMspXpacsWv5Sw7D+L0xZnTl1kpo2P0n/76B///28LAAAAAAAA
AAAAABhbe3t7SUlJenr69u3btW4LAAAAAICyPvzww7i4OD8/P48eEydO1LpF
AAAAAADKSkxM9LCBOTAAAAAAuL2WlpZLPbKysjAHBgAAAABDeffddzEHBgAA
AABDwRwYAAAAAIwGc2AAAAAAMBrMgQEAAADAaDAHBgAAAACjwRwYAAAAAIwG
c2AAAAAAMBrMgQEAAADAaDAHBgAAAACjwRy4r6ampilTprz55pu9tqenpyck
JGjSJCs9tw0AXIVxKolx9hQAxEhKSgq4bfDgwR49rFumT5+udQO1l5iYOGDA
gD///NO65fz58yaTaenSpRq2SqDntgGAqzBOJTHOngKAU9HR0R79i4yM1Kph
nZ2dc+bMsa1U4uXn59N+7d2717pl+/bttOXbb79liPb9999TKmxPHWRlZdGW
mpoahmh88W0b37wBgK2zZ89G2/PRRx8xRDNOleObN9RMpfHtL1Cae/RXdnb2
V199pXUreKqoqLj77ru7u7sZHtva2hoeHj5kyJC6ujr68/jx415eXjNnzmRu
zCOPPOLv73/jxg1Lz+Q8MDDw8ccfZ47GF8e2cc+bO2lra3vhhRe0bgWIpcP+
am5uTrORlJREU68BAwbQrIwhmnGqHN+8WVAzFca9vwQ6PKLdg0L9xZfT3s/L
y3Ozzy3MmDFj+fLlzA+vrq729fWdNGnStWvXqEYFBwdTRzNHO3DgAI2KgoIC
S8/knP5dXl7OHI0vvm3jmzd3QgkZN26c1q0AsXTeXzR3mjx5sslkomOWOYhx
qpwVl7yhZqqGS38JdH5EuweO/cWX095vbGz09vY+e/asWi1S1rlz56gXvvvu
OzlBiouLqbiFhoZSKPnvTE2YMGHMmDFdXV2JiYmBgYGdnZ0yA3LEt2188+Y2
UIFdi577q6OjIz4+no6y9957T2Yo41Q5C9e8oWaqgGN/WfR9RLsHvv3Fl5je
nz59et+vu2qivb2dGiwnwrp166guUYHq7w5tbW20+v7iiy9Onz7d3+cl6OEh
ISHUoXPnznX8dGKilZWVCWPDbDavXbtW9K7IxbdtfPOmK8yjznFO6urq1vR4
/fXXhw8fvuY2Wi/LidZLf9F0RekMi8wJ3/7iS8zxRdvnzZtHx9f69evlRzNO
leObN9RMi2JHtIBXf6ECW7lWf6lfz0tLS+kwdNx4dQhLicbGRuYIUVFRGRkZ
dm9qbm5eunSpj4+P9Yt7d955J1WepqamXvfMycmhW8PCwry9vY8dOyYzGlW5
+++/nwqml5fXxYsXmXdNPL5t45s3vi5cuFBYWJiamhoRETFt2rSFCxcyPC/D
qBOTEwr4vx7FxcVBQUH/u43KkZxovfSNxpdLZNhpTvj2F1/ij68VK1bQrf3V
N6nRjFPl+OYNNdOi2BEt4NVfqMBWrtVf6tfzlpYWOqJ//vln8flRSFxcHO0O
cwml0UIPt/uOEu04TY+FdFG1GT9+/NChQ4U/6R+HDh2y3vObb74xmUwLFiy4
dOlSYGAgrQ4uX77MHE3w/vvv003Jycls+yUJ37bxzRtflZWV1sZYeXp6rl69
WlIcqaNOaoYdvxcjNZqaXCXDfKOp+c6p+LZt3ryZNqakpDh4kwtVTum8CVAz
lTuilegvVGDX6i9ebROIrOdTpkxxeh5bBbSgmDp1KvP3Ami5FBAQYLcv8vLy
KEW0cNizZ4/1ZDhN+2NiYkaOHEmTZ2GLUItGjx4tvHFw+PBhWh3Q+OkVU2Q0
q9zcXLr/119/zbZfkvBtG9+8cVRRUUGlwKPnPUQqFNQAatWzzz4rHAtffvml
+FBSR53UDDs+BqVGU40LZZhvNDXnwCLbtnv3brqbr6/vtm3bCm0cOHCAIZpx
qhzfvFmhZip0RCvUX6jArtVfXNpmJbKeZ2VlRUdHS2qJDtFiZNasWXZvmjlz
JuWNxk+v7VRwbM+fJyYmenl52b7XsHHjRnrghg0bGKIJTp48OXDgwEmTJknd
HTZ828Y3bxx1dHTMmzevqKio1/bHHnuMnnfRokUKPa9FYobJv//+62DZLjWa
alwow3yjOe4vvkS27aGHHvKwZ86cOQzRjFPl+OZNgJrJQMP+sqACS6dtf3Fp
m5XIei68KSNc9tB1hYeHr1mzxu5NCQkJlDcaPFyeSGS0N954Y/LkyXTPwYMH
V1dXc3lqp/i2jW/eVCD8bLeiCzpNxpJ+IMMc6XlP3aDK8Y2GmsnMDca5fqC/
lOivxsZGCqvOZ/J7aW9vj4yMHG8jNjaWIc7169cdXJuOFtfCCuXll19uaWmR
12Sx0ZYtW/bkk0/S/9W89BzftvHNmwoyMzOptbNnz3Z8NzmjTpOxxEVDQ4P8
j7chwxzpeU/VrHJSR6ae9xRHdF9uMM71A/2lRH/dunXLbDZrcm23rq6ugwcP
Hjhw4KkeW7ZsoVU2Q5yqqipKC9UEu7feuHFj7NixQuqGDBlCdez06dPMbeYb
jS/j7Glf3d3dDzzwADWVRpHje8oZda6bYTrAH374YTkRkGG+9Lyneh6Zet5T
PeetLxzReq4PfaG/lOuv4ODgV155hUsoNkt7HDt2jG0OvH//fspJW1tbf3f4
559/UlNTTSaTkD1PT89Zs2Yxn/rmG40v4+xpL1u3bvXouUyK+IvAsI06F82w
/FdMZJg7Pe+pnkemnvdUz3nrBUc092iKQn9xj2YVHR2dlJQkM4gcMufApaWl
Pj4+Tu9WW1tLU/1BgwZ53JaZmcn8VVyn0X766af09HTKbVhYWEJCQllZGdsT
KdG2EydOUMKjoqJoVZWSkuL44nh886aEkydPChcMlPR2hpxRp/JYkk/mKyYy
rBw976kKVY55ZKq8p3qrmTiidRtNCegv5aKRp59++oknnmB+uHwy58CFhYUj
RowQeWdaR2zevHn48OFC6nbs2MHwjE6jFRUVmc3mYcOGJScnz549e+DAgXTr
22+/7TRgd3d3V/+4tI0OIjqa/P39586dK1xtz9vbm17L2KIx47WndXV1QUFB
Hj2fkurv52zskjnqLGqNJWa2Gd61a1dMTAwyrM8xzL1tLlTl5IxMB21j40I1
E0e0zqNZ8BrnOtEyMjImTpzo9G5xokltgMyeys3NDQ0NlfSQ5ubmBx98kPIW
ERFh3Shppe84Gg3a5557znrZ8/r6epPJFBwc7DSUcEXr/pw5c0bSbtpt25o1
ax599NG///5b+LOiooJufeaZZ9iiWVjPBXHZU0osZZXuT3sk9Vd75NcHgdJj
yYIMu3WGnbbN0lPtS0tLaTdp5iMzmkGqnIBX3lAzBYoe0Ra9jnML+svd+2v9
+vX0vE6fq040kY23ktlT+fn5fn5+Uh9FS3vKm9lsFlZkbCv9/qL1NWHCBNq7
W7duOY7T1NTkILFST5L01zbbZtDGgIAAGkVs0ZjPBcnf09ra2pCQEHo6yi3D
t0R51QeLwmOJS4ZzcnIiIyORYbvRNBzDTttGNm3aJFwwnyxevFhONB1WObaR
KaZtHPNm0V/NdLMj2qLjcY7XOIu791d2djYdTZJ2gS+ZPbVnzx7ax+vXr9u9
dcuWLeXl5X23r1u3jh517733Cn+KXOmLjNbLZ5995uXlpfQXD9nadvPmzUGD
BiUmJrJFq2M9FyTT8ePHhTdBpk2bRqtRhggMo06TscQlwwyfHkSGRbaZjfij
lRK4a9cu4TeS+nutcd0qJ3VkapK3XvRQM93siLboeJzjNc7i7v21bNkyl/48
sHBdCLtXySgrKxPWKc8//3x1dbWwTKDV2QcffCCsDpYsWWK9s9OVvqRo5PPP
P6c6GRoaSi8NK1asYBvGIkltm1VBQYFHn0/aM0eziD4XJMfBgweFz8PHxcX1
t/ZxSuqo03Ys2WLIsNRXTGRY0THM0La//vqrv9cal65ykkamhnmzpYea6X5H
tEC349wWXuOs3KO/FixYkJyc7Dg5SmhpaWnqsaBHZWXlHXfc0XSb+DgnTpyg
DBw5cqTvTc3NzdZf2fbouaZcWFiY9U/699WrV+3GtLvSlxqNljNUpoT3MmiZ
I/4jLgzY9pSaRDkXvlshP5pFlTPe1NHe3t5CS4YOHUrdRH962ej7W4q2mEed
tmPJSoWzbciw0mOYoW0OXmtcuspJGpl6yJtOaqa7HtG6HedWeI2z5R79FR8f
n56e7uAOCnnqqac8+ke5FRmnvb3dbDbv3bu3vzvs27cvNjaWFgLW4L6+vitX
rrSee+/L7kqfOdrRo0fpNcLf3/+PP/4QuVNsJLXtl19+odUWNez8+fMyo6l5
xnv37t0Oho2Hs++qyBx1Wo0lmRmmdSKtl0XeGRlWegxLbZvF4WsNQzSBHqqc
pJHJ0Da+edNPzXTXI1q34xyvcW7cX0FBQZK+1qdDERER27Ztc3wfWrafOnWK
CvWZM2ccfxy9v5U+WzQB1Svqr5KSEqf3lE9M22gfR4wYMXLkyNraWvnR1Dzj
rQfqjyVkuD+unmGRe+r0tUZSNIsxqpyFa95QM+Vw9XGO/rLLDfqL5s90n6qq
Kse7oHMpKSmvvvoql1BOV/piVFZWUhzbLatWraI803bZDeTg0KFDfn5+o0aN
clrMpVLtjLdL4DKWekGGbRknwyJfa0QyQpUT8MobaqY6dDjOe0F/2XKD/jpy
5IjZbHbwQ8MuYefOnWIu7+aU+JW+Ax0dHVQqfXx80tLSSkpK9u/fn5GRYTKZ
7rvvvtbWVvmNlOmTTz4RfnHmtdde27Bhw/rb7H6gmoGa54L0jMtYsgsZFhgq
wxxfa4xQ5ay45A01UzV6G+d2ob+s3KC/srOzo6Ki+D6j+urr62kfxf+Otl0c
V/o0MObPn0+9KXxkRfhV64aGBplhuZgyZYrdjwmtXbuWIZpLnAtSH8exhAzb
ZbQM6/B8pp6rnBWXvKFmqkaH4xz95YAb9NfYsWNzc3NlPqkehIeHf/zxx8wP
V2ilT9Py6upqXZ0Y4chVzgWpjONYQobtMk6G6+rqdvR46623PHquFCr8efjw
YYZoxqlyfPPGkc7Hm1Z0O87RX3a5TX+dOnWKFu8cP3qhIcqenCu88V3pG4dL
nAtSGd+xhAz3ZZwMl5eX293Tl156iSGacaoc37zxpefxphU9j3P0V19u018b
N26U+lszVrTwp/2l+X9YWFh8fHxWVpaDi12o4Mcff6TJ/5UrVzRsg5Hp8FyQ
m0GGlYYMg5ow3lwL+su1iOmvqKiogoIChuA7d+40mUzCNNvLy0v4x7Bhw2pq
aljbywHtTmFhoYYNAAAAAACdO3fuHE1fL126JPWBv/32mzDvXb58+e+//97W
1rZv377o6GjaMmnSJCWaKlJxcTE1Q8MGAAAAAIDObdu2LT4+nuGBO3fupOlu
SEhIZ2endWNVVZVwNri5uZlfG6VpbW0dM2bM5cuXtWoAAAAAAOjc/PnzS0tL
GR64ceNGmuv2/QJaQEAAbdf24xAAAAAAAEr49ddfaa7r5+dnexG2hoYG2jh6
9GgNGwYAAAAAoJwZM2bQjPeuu+565513rl27dvXqVeHqFlu3btW6aQAAAAAA
irh582Z8fLzwAWBfX9/AwED6x+rVq7VuFwAAAACAIrq6ulatWuXt7e3n5xcT
E+Pp6SlMhmfOnHnhwgWtWwcAAAAAwN+LL75IM96oqCjhpzcuXryYlZU1dOhQ
2hgUFER/at1AAAAAAACejh8/TnNdk8nU6xeW6+vrR40aRTctWbJEq7YBAAAA
ACghPz+fJrqxsbF9b9q0aRPdNH78ePVbBQAAAACgnKKiIproTp06te9NO3bs
oJsiIyPVbxUAAAAAgHJqamqEL8Hl5eV1d3dbt1+8ePGee+6h7RkZGRo2DwAA
AABACTk5OcKFIMaNG0cz3uzs7NTU1IEDB9KW0NBQ/FQxAAAAALif7u7uTz/9
dOzYsR42fHx80tLScG00AAAAAHBvV65c+eGHH44ePVpfX9/R0aF1cwAAAAAA
AAAAAABAmv8DGUyEtQ==
    "], {{0, 31.}, {470., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{470., 31.},
  PlotRange->{{0, 470.}, {0, 31.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[2]=",
 CellID->2101081599,ExpressionUUID->"25803a52-7bda-4ac7-8036-f53c1c66ad5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "a53a5258-8287-4b1d-9f9f-25b2030bef1c"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1884726041,ExpressionUUID->"f546c070-ed56-45ee-9810-06c2c01ac7e6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"2", "^", "n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"S", "@", "nn"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1365328277,ExpressionUUID->"5eed9b54-1404-4c2a-802e-730c68e5d7ec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 3, 4, 6, 7, 8, 9, 10}, {{1}, {4}, {2}, {3}, {4}, {1}, {5}, {
       6}, {7}, {8}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 1, 1, Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2], 1, 1, 1, 1}}]]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->860512319,ExpressionUUID->"a38262af-8ea5-41c5-939e-c0385f1c1ac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 4], 
     $CellContext`S[3, 4]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 5], 
     $CellContext`S[3, 5]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 4], 
     $CellContext`S[3, 4]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 5], 
     $CellContext`S[3, 5]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1475666535,ExpressionUUID->"2197a534-49f8-413e-bc76-63345daf54be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gates", "=", 
  RowBox[{"FromTwoLevelU", "[", 
   RowBox[{"U", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"S", "@", "nn"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1384213357,ExpressionUUID->"e8325b72-1954-43a6-a005-56e588013941"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[3, 2]]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1717204285,ExpressionUUID->"f7cb625c-158a-4320-8584-e922c6cac376"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{1, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{1, -3}, 0.09]}, {
      CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2, -1}, 0.09]}, 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, 
     LineBox[{{1.6, -3.4}, {2.4, -3.4}, {2.4, -2.6}, {1.6, -2.6}, {
      1.6, -3.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -1}, {3, -3}, {3, -2}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -3}, 0.09]}, {
      CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {0, 1}, Rational[1, 2] 3^Rational[1, 2] + 
    Complex[0, 
       Rational[-1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1019685962,ExpressionUUID->"58c5037a-cb26-47f3-a046-44fb0b6f3226"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", "expr"}], "//", "Elaborate"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->876964595,ExpressionUUID->"d89530be-7579-4d00-97eb-8a3ff4bf72d3"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[3]=",
 CellID->5820029,ExpressionUUID->"8d729ec7-0c8e-441f-a6bf-39ec826a9442"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["TwoLevelDecomposition"]], 
           "paclet:Q3/ref/TwoLevelDecomposition", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "4f7ee984-b293-4cf8-9ba6-4d7469aa6b71"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["TwoLevelU"]], "paclet:Q3/ref/TwoLevelU", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "7a50c409-2b7b-4ff7-ba0d-41d4a329d682"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BinaryToGray"]], "paclet:Q3/ref/BinaryToGray", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "0cf8298c-ebf2-43fb-a387-aeec58797952"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["GrayToBinary"]], "paclet:Q3/ref/GrayToBinary", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "efd4716c-076a-4ee5-bfb1-73013d7879b3"]
       }], "SeeAlso",ExpressionUUID->"efa4a4cc-a316-4693-9214-ed07399c9522"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"73058606-b0ea-442e-b86f-\
f68aae6603c2"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox["Tutorials", "TutorialsSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Two-Qubit Gates"]], "paclet:Q3/tutorial/TwoQubitGates"},
          
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "dab24f08-6ffa-4362-89b5-7bcc84cc0052"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Universal Quantum Computation"]], 
           "paclet:Q3/tutorial/UniversalQuantumComputation"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "08b3876d-aa1d-459e-b10a-6f99ff28282d"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Universal Quantum Computation: Demonstration"]], 
           "paclet:Q3/tutorial/UniversalQuantumComputationDemonstration"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "e3db07b5-f7da-412c-acba-e44388aee946"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Computation: Overview"]], 
           "paclet:Q3/tutorial/QuantumComputationOverview"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "03142311-95d9-41db-ba1b-a1a5b1780262"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "fc5e9bcd-d907-4de3-bdab-5867bcbc8ecc"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "725fe260-3def-4b5d-8050-dfb02be27887"]}]}
     }]}
  }]], "TutorialsSection",ExpressionUUID->"6ea063c6-79b8-410b-b9df-\
88b3d361cc23"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "ca6514d2-d0c8-479e-8a0b-f042f219090c"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "1535d782-23a3-4fc6-9454-a6f8f3fca98e"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"41859cf6-5465-46e0-ac6c-\
72f660bafdee"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "7989ab3d-d2cc-4df4-b0cf-beefa2081ec8"]}]],ExpressionUUID->
         "66b31365-85e0-4d35-83ef-99cd1f1b1006"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "05f0bd2c-a968-4bba-8edf-3ebb7ffb1da3"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "95e5e170-f320-405a-9691-55ad6711faec"]}]],ExpressionUUID->
         "0f83bcec-b888-4fb4-8f4a-6431cdec8ef1"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "RelatedLinks",ExpressionUUID->
        "b6cbb230-03fc-48f8-bc76-1008d471b1c9"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"f2d89d02-290a-4358-83ce-\
1576a16a3d60"],

Cell[CellGroupData[{

Cell["Related Demonstrations", "RelatedDemonstrationsSection",
 CellID->1268215905,ExpressionUUID->"ddd35c3d-1a07-43d9-b127-00302c54a9c9"],

Cell[TextData[ButtonBox["QuantumCircuit Usage Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumCircuitUsage"]], "RelatedDemonstrations",
 CellID->1752034351,ExpressionUUID->"ce21d880-ceef-4f73-8f55-775499369e70"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"e3542098-d327-4b9d-bb5d-6321b2d6fa0e"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"FromTwoLevelU",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "HasOptions" -> True, "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2023, 2, 21, 2, 56, 23.454045}", 
    "history" -> {"12", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"universal quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "FromTwoLevelU[mat, {x, y}, {q1, q2, ...}] returns a list of CNOT gates \
and one controlled-unitary gate that together reconstruct the two-level \
unitary operation specified by mat and the row and column indices {x, y} \
acting on the qubits {q1, q2, ...}. FromTwoLevelU[TwoLevelU[mat, {x, y}, \
size], {q1, q2, ..., qn}] is equivalent to GrayTwoLevel[mat, {x, y}, {q1, q2, \
..., qn}] as long as size == 2^n.", "synonyms" -> {}, "tabletags" -> {}, 
    "title" -> "FromTwoLevelU", "titlemodifier" -> "", "windowtitle" -> 
    "FromTwoLevelU", "type" -> "Symbol", "uri" -> "Q3/ref/FromTwoLevelU"}},
CellContext->"Global`",
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "13.2 for Mac OS X ARM (64-bit) (January 30, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"26584c57-50ed-4618-b172-c7bff5377025"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[13404, 358, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"0abdcd28-7f1b-4b6c-b618-c0517cff6fbe",
   CellTags->"PrimaryExamplesSection",
   CellID->1532228486]},
 "RasterizedOutput"->{
  Cell[57696, 1677, 6868, 119, 52, "Output",ExpressionUUID->"25803a52-7bda-4ac7-8036-f53c1c66ad5c",
   CellTags->"RasterizedOutput",
   CellID->2101081599]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 90739, 2543},
 {"RasterizedOutput", 90940, 2547}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[585, 21, 7543, 179, 57, "AnchorBarGrid",ExpressionUUID->"42a84165-b8fb-4f30-9c8f-1ebbd3bf39a4",
 CellID->1],
Cell[8131, 202, 85, 0, 23, "ContextNameCell",ExpressionUUID->"6e963f56-190f-4052-870f-74ae48b38525"],
Cell[CellGroupData[{
Cell[8241, 206, 556, 14, 60, "ObjectNameGrid",ExpressionUUID->"9e0c7f8c-fb27-471c-be2c-7d8423bc4b41"],
Cell[8800, 222, 4567, 131, 216, "Usage",ExpressionUUID->"89254468-2f72-42c6-8b76-d0b8db9d325b",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[13404, 358, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"0abdcd28-7f1b-4b6c-b618-c0517cff6fbe",
 CellTags->"PrimaryExamplesSection",
 CellID->1532228486],
Cell[14797, 397, 192, 3, 31, "Input",ExpressionUUID->"000dbc6d-d7c6-49d2-ac10-648cf6157b70",
 CellID->1927565408],
Cell[CellGroupData[{
Cell[15014, 404, 1368, 36, 31, "ExampleSection",ExpressionUUID->"6f789077-c3f7-4e87-90b4-e9f8b82d38fd",
 CellID->1687753025],
Cell[16385, 442, 303, 8, 38, "ExampleText",ExpressionUUID->"ad0e6e00-9c22-4c0f-ae9b-e5f4306b7a83",
 CellID->1841784908],
Cell[16691, 452, 381, 10, 66, "Input",ExpressionUUID->"77e0c600-07b8-4d00-84ed-729d2b527e18",
 CellID->1668741869],
Cell[17075, 464, 510, 13, 38, "ExampleText",ExpressionUUID->"a35da415-378a-4e91-9e48-9a265b8732c3",
 CellID->1353831685],
Cell[CellGroupData[{
Cell[17610, 481, 801, 23, 120, "Input",ExpressionUUID->"76270681-d84a-4d0d-b49c-589cb81204dc",
 CellID->408162463],
Cell[18414, 506, 944, 29, 86, "Output",ExpressionUUID->"948ff6f9-db4a-42f8-b1e9-95024421752e",
 CellID->1934437947],
Cell[19361, 537, 1369, 37, 188, "Output",ExpressionUUID->"6bb861f6-1f07-496e-a869-a40bf19b989b",
 CellID->1343643296]
}, Open  ]],
Cell[20745, 577, 136, 1, 70, "ExampleText",ExpressionUUID->"266acea6-cb65-459b-92df-4adde27b6fc0",
 CellID->1856100676],
Cell[CellGroupData[{
Cell[20906, 582, 337, 8, 70, "Input",ExpressionUUID->"7ce0be5e-33f7-4812-bec0-cdf65b4ab38a",
 CellID->891772264],
Cell[21246, 592, 5120, 149, 52, "Output",ExpressionUUID->"953081a9-dd9e-4667-941a-7e5d06430a06",
 CellID->1501647741],
Cell[26369, 743, 7439, 211, 52, "Output",ExpressionUUID->"b5c8c737-fb5f-472f-98ca-28de3449513f",
 CellID->965763443]
}, Open  ]],
Cell[33823, 957, 244, 5, 70, "ExampleText",ExpressionUUID->"b31cea82-0769-48c3-afa5-463ca567a611",
 CellID->1118998759],
Cell[CellGroupData[{
Cell[34092, 966, 329, 9, 70, "Input",ExpressionUUID->"25a2750e-0fe3-4bf3-9f3b-a760fff73f67",
 CellID->779608136],
Cell[34424, 977, 4401, 154, 102, "Output",ExpressionUUID->"1e4e5e74-382f-40da-9a31-d3103857574d",
 CellID->1565537317]
}, Open  ]],
Cell[38840, 1134, 142, 1, 70, "ExampleText",ExpressionUUID->"03b4e896-6b76-4d33-b8b0-a84e96a22f74",
 CellID->1313764330],
Cell[CellGroupData[{
Cell[39007, 1139, 217, 5, 70, "Input",ExpressionUUID->"ef380120-a773-43ee-853e-9aae797e2981",
 CellID->1777808801],
Cell[39227, 1146, 2979, 64, 131, "Output",ExpressionUUID->"a953df0a-9253-4c6f-9536-bbfff4983f36",
 CellID->1376951407]
}, Open  ]],
Cell[42221, 1213, 146, 1, 70, "ExampleText",ExpressionUUID->"c68aaafa-8c4b-43fa-93bc-5f37d9ca7681",
 CellID->1513410627],
Cell[CellGroupData[{
Cell[42392, 1218, 329, 9, 70, "Input",ExpressionUUID->"31492a7e-cdb8-4b29-af0f-a6588f7b6f70",
 CellID->2001503477],
Cell[42724, 1229, 127, 2, 37, "Output",ExpressionUUID->"43f99aaf-bfdc-4563-9caf-40ab8caa5750",
 CellID->1529743153]
}, Open  ]],
Cell[CellGroupData[{
Cell[42888, 1236, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"3f1a380b-38b3-46a8-8acc-abf66a042c8d",
 CellID->1200765697],
Cell[43134, 1243, 173, 3, 70, "ExampleText",ExpressionUUID->"cf0b5d88-45a1-4b2a-969e-1937bd89fc1b",
 CellID->1846068461],
Cell[CellGroupData[{
Cell[43332, 1250, 887, 26, 70, "Input",ExpressionUUID->"28ec904e-5055-4e35-9dbc-459717a306ff",
 CellID->1891440696],
Cell[44222, 1278, 1361, 36, 188, "Output",ExpressionUUID->"710fce0c-4b48-4bcf-aa95-20e9031127a3",
 CellID->1232636939],
Cell[45586, 1316, 6504, 189, 52, "Output",ExpressionUUID->"a1a22652-c915-44ca-860e-c81adbb0f376",
 CellID->154291164]
}, Open  ]],
Cell[CellGroupData[{
Cell[52127, 1510, 625, 17, 70, "Input",ExpressionUUID->"1e1c93df-b07b-4840-ada4-437991b6b377",
 CellID->1103544376],
Cell[52755, 1529, 2800, 96, 80, "Output",ExpressionUUID->"25edb1f9-b49d-440e-a7d8-cda8c6121873",
 CellID->432477301],
Cell[55558, 1627, 2135, 48, 131, "Output",ExpressionUUID->"26f30c7b-7b30-4850-834b-cac211896f1c",
 CellID->1561336459],
Cell[57696, 1677, 6868, 119, 52, "Output",ExpressionUUID->"25803a52-7bda-4ac7-8036-f53c1c66ad5c",
 CellTags->"RasterizedOutput",
 CellID->2101081599]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64613, 1802, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"f546c070-ed56-45ee-9810-06c2c01ac7e6",
 CellID->1884726041],
Cell[CellGroupData[{
Cell[64881, 1811, 887, 26, 70, "Input",ExpressionUUID->"5eed9b54-1404-4c2a-802e-730c68e5d7ec",
 CellID->1365328277],
Cell[65771, 1839, 1360, 36, 188, "Output",ExpressionUUID->"a38262af-8ea5-41c5-939e-c0385f1c1ac8",
 CellID->860512319],
Cell[67134, 1877, 6547, 191, 52, "Output",ExpressionUUID->"2197a534-49f8-413e-bc76-63345daf54be",
 CellID->1475666535]
}, Open  ]],
Cell[CellGroupData[{
Cell[73718, 2073, 536, 14, 70, "Input",ExpressionUUID->"e8325b72-1954-43a6-a005-56e588013941",
 CellID->1384213357],
Cell[74257, 2089, 2801, 96, 80, "Output",ExpressionUUID->"f7cb625c-158a-4320-8584-e922c6cac376",
 CellID->1717204285],
Cell[77061, 2187, 2362, 52, 131, "Output",ExpressionUUID->"58c5037a-cb26-47f3-a046-44fb0b6f3226",
 CellID->1019685962]
}, Open  ]],
Cell[CellGroupData[{
Cell[79460, 2244, 211, 5, 70, "Input",ExpressionUUID->"d89530be-7579-4d00-97eb-8a3ff4bf72d3",
 CellID->876964595],
Cell[79674, 2251, 124, 2, 37, "Output",ExpressionUUID->"8d729ec7-0c8e-441f-a6bf-39ec826a9442",
 CellID->5820029]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[80052, 2263, 2373, 64, 70, "SeeAlsoSection",ExpressionUUID->"73058606-b0ea-442e-b86f-f68aae6603c2"],
Cell[82428, 2329, 2539, 63, 70, "TutorialsSection",ExpressionUUID->"6ea063c6-79b8-410b-b9df-88b3d361cc23"],
Cell[84970, 2394, 1045, 27, 70, "MoreAboutSection",ExpressionUUID->"41859cf6-5465-46e0-ac6c-72f660bafdee"],
Cell[86018, 2423, 2106, 59, 70, "RelatedLinksSection",ExpressionUUID->"f2d89d02-290a-4358-83ce-1576a16a3d60"],
Cell[CellGroupData[{
Cell[88149, 2486, 138, 1, 70, "RelatedDemonstrationsSection",ExpressionUUID->"ddd35c3d-1a07-43d9-b127-00302c54a9c9",
 CellID->1268215905],
Cell[88290, 2489, 237, 4, 70, "RelatedDemonstrations",ExpressionUUID->"ce21d880-ceef-4f73-8f55-775499369e70",
 CellID->1752034351]
}, Open  ]],
Cell[88542, 2496, 78, 0, 70, "FooterCell",ExpressionUUID->"e3542098-d327-4b9d-bb5d-6321b2d6fa0e"]
}
]
*)

(* End of internal cache information *)

