(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    108972,       3086]
NotebookOptionsPosition[     97432,       2852]
NotebookOutlinePosition[     99597,       2907]
CellTagsIndexPosition[     99511,       2902]
WindowTitle->FockBilinearSystem
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "98761c10-b1ef-4a0e-8960-485cc8abc3ca"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "d85353b3-d874-4735-aa2c-337dba324b3a"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c4957fbe-70f3-4840-ad05-7122fdf34588"]
         }],ExpressionUUID->"14c1bdeb-a64d-43de-93e5-dd566f0095ad"],
         StripOnInput->False],{
        "\"FockBilinearQ\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/FockBilinearQ"], 
         "\"FockBilinearOperators\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/FockBilinearOperators"], 
         "\"FockBilinearMatrix\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/FockBilinearMatrix"], 
         "\"FockBilinearSystem\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/FockBilinearSystem"], 
         "\"CoefficientTensor\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CoefficientTensor"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f3f61eca-3579-4623-8a1f-c71c6c9d51a7"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "6ecfc508-6554-44f6-8e2e-dd1c030dd202"]
         }],ExpressionUUID->"2496b6a4-bf1b-4023-8a4a-75c42e0d8458"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/QuantumManyBodySystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "01f3a642-0761-4484-9db1-dbb73f06d4a7"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c670cde8-743e-445b-b4f6-9472ea57ed71"]
         }],ExpressionUUID->"b7d5dd89-2db1-4dda-8dfa-5d079311e727"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumManyBodySystems"], "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "c4d7af45-a56e-44a4-b81c-646f1565994b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "821d420a-9ac9-415a-8079-7109c8d2a1b3"]
         }],ExpressionUUID->"7ac47bca-722a-4fdb-9313-48c0de82e11d"],
         StripOnInput->False],{
        "\"Q3/ref/FockBilinearSystem\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{Cell["Q3/ref/FockBilinearSystem"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/Q3/ref/\
FockBilinearSystem.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "Q3/ref/FockBilinearSystem" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b2e9b5b8-39d8-44e8-89ab-d04ddd7c7a86"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "a929be37-f372-4ea1-9cb1-7e5b133ad9e8"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"1ce5dc78-e904-458b-9c4e-d63a02515241"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"5ab97aae-4d96-47c8-8cc7-1044ec8aa85a"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "FockBilinearSystem", "ObjectName",ExpressionUUID->
      "8fd0a5e5-fb55-4e24-9a54-e2b51296feba"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"0ea940e2-0c5d-44af-ac40-879b2df559e1"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "c85576d1-efd3-48c2-9fb8-082634963e2f"]
    }],ExpressionUUID->"298d75fa-91d3-47b3-bed4-fbabee0ff689"], 
    "\[SpanFromLeft]"}
  }]], "ObjectNameGrid",ExpressionUUID->"5eb2f5e0-cd9d-4187-953b-\
0c2ece8b3b52"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FockBilinearSystem", "[", "expr", "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "753142fa-1ab3-4ccc-bd7f-12f6dd1e74fe"],
     " \[LineSeparator]returns a list of {operators, matrix} of the bilinear \
combination."
    }],ExpressionUUID->"f7534391-818a-490b-ab17-503eaf0ecbe1"]}
  }]], "Usage",
 CellID->982511436,ExpressionUUID->"d894b4bd-5431-44b9-9787-7c1e864af0f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "b8fee179-b4fd-4294-b4a8-0694bceafddf"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"aaec9c2f-4bee-47ab-9769-e8a3eed455af"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "86c934f3-b045-45a4-9803-ec6d1ab03f29"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1941128143,ExpressionUUID->"8b3437bb-b2f8-4c94-9c34-d40494d592c2"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->742081683,ExpressionUUID->"3d930caf-cbae-4e7f-a2e9-36c378fa3941"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "25c4afd2-a792-41fe-8c36-763f62d08d3e"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"1a7ce7d3-13fe-4a99-8ede-d98e83c8b440"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "0175f95d-81a4-41e3-88ec-001d3195d655"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->2116617824,ExpressionUUID->"131ac760-1f15-4ca5-855a-71dab1239e1f"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Boson", ",", "a"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->54356201,ExpressionUUID->"1d884ec3-ca88-47bc-b168-30e3cbda0568"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"a", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "**", 
       RowBox[{"a", "[", "3", "]"}]}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->301411736,ExpressionUUID->"ead50cac-9338-40e8-ad62-7e02875d321d"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`a[1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`a[3], 
       $CellContext`a[1]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2048158089,ExpressionUUID->"6d38535b-bb29-402a-b8c3-6d56e0b72f48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`a[3]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`a[3], 
     $CellContext`a[1]]]}], "+", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[2]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[2]], 
     $CellContext`a[1]]]}]}]], "Print",
 CellLabel->"During evaluation of In[372]:=",
 CellID->1377624060,ExpressionUUID->"262af68c-6100-4eb5-8527-977f283b1cc2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`a[3]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[3]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[372]:=",
 CellID->1706378113,ExpressionUUID->"58ed029d-d676-4604-bab0-09958bbe383a"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["x", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], "0", 
      FractionBox["x", "2"], "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 0, 1, 1, 3, 3, 4}, {{1}, {3}, {5}, {1}}}, {
      Rational[1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1600323153,ExpressionUUID->"e7e0d523-0555-4b82-9615-905857abcf78"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`a[1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`a[3], 
       $CellContext`a[1]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1546037443,ExpressionUUID->"bda2e46b-c6f8-4542-8911-8b11d0d6cd7a"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[2]=",
 CellID->1846659448,ExpressionUUID->"b85fc118-2187-4990-b0d5-fec2b6fbe963"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"a", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"Dagger", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}], "**", 
       RowBox[{"a", "[", "3", "]"}]}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->950609431,ExpressionUUID->"0d41b6ea-a3f9-40bd-892f-feddf860f5dd"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"a", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`a[1]]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`a[1]], 
       $CellContext`a[3]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1185499796,ExpressionUUID->"04362a46-9a0a-4307-a717-cf32058b1dca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[1]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`a[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[1]], 
     $CellContext`a[3]]]}], "+", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[2]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[2]], 
     $CellContext`a[1]]]}]}]], "Print",
 CellLabel->"During evaluation of In[379]:=",
 CellID->341794506,ExpressionUUID->"9a7c8f95-81d5-4fdc-a3fc-54ed0b36f58b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`a[3]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[379]:=",
 CellID->21506617,ExpressionUUID->"96cc469e-4649-4a76-9541-ac2a532c7a8c"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{"x", " ", "z"}]},
     {"x", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 1, 2, 2}, {{3}, {
       1}}}, {$CellContext`x $CellContext`z, $CellContext`x}}]]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->684459223,ExpressionUUID->"3b109180-98b3-4c2b-ab7c-003a33ef0784"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"a", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`a[1]]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`a[1]], 
       $CellContext`a[3]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1783747629,ExpressionUUID->"4c97d04a-bbfc-4f19-a7d3-8990cb0ee15e"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[3]=",
 CellID->574688483,ExpressionUUID->"21277026-a609-4b21-bf29-a7d0afbb57fc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c", ",", "d"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1462286656,ExpressionUUID->"2577c066-b53b-492b-a400-c86c8689075a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "Up", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"c", "[", "Down", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"c", "[", "Up", "]"}], "**", 
       RowBox[{"d", "[", "Up", "]"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1828079879,ExpressionUUID->"5822e693-2cfe-4175-ab82-833d7ff619cc"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->2099369269,ExpressionUUID->"1fda13c6-e633-4bc2-85d8-48d0b8009e62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}]}]], "Print",
 CellLabel->"During evaluation of In[387]:=",
 CellID->942983873,ExpressionUUID->"f0a272b4-7f0a-40cd-b523-3911cf842aa6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[(-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["d", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`d[Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[(-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"d", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`d[1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[387]:=",
 CellID->300638651,ExpressionUUID->"fe5c2cac-63d4-4752-9766-4095e072327d"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["x", "2"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], 
      FractionBox["x", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"x", " ", "z"}], "2"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 1, 1, 1, 1, 3, 4}, {{2}, {3}, {4}, {2}}}, {
      Rational[-1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[-1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1952269613,ExpressionUUID->"9fcb7666-2118-4142-82b3-ee7a950f8626"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->392743178,ExpressionUUID->"b7b29984-93c2-4a77-be3e-e21a0f772d6e"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[5]=",
 CellID->1617345415,ExpressionUUID->"782d6a18-a090-44e1-9c5e-7c6fd5e838a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "Up", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"c", "[", "Down", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"c", "[", "Up", "]"}], "**", 
       RowBox[{"d", "[", "Up", "]"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"expr", "+", 
   RowBox[{"Dagger", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->680707724,ExpressionUUID->"1c986325-278e-49ce-9827-04fae00b2669"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1483456694,ExpressionUUID->"f5f50686-f0d7-4270-8788-8bf3d55b34f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "z"}], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            SubscriptBox["d", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`d[Plus[1]/2]], 
           InterpretationBox[
            SubscriptBox["c", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`d[
         Rational[1, 2]], 
        $CellContext`c[
         Rational[1, 2]]]]}], "-", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"c", 
             
             TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
              "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`c[(-1)/2]]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`c[
         Rational[-1, 2]]], 
       $CellContext`c[
        Rational[1, 2]]]]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             
             TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        $CellContext`c[
         Rational[-1, 2]]]]}], "-", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{"z", 
         TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
           StyleBox[
           "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
          "RowWithSeparators"]},
        "Superscript"],
       Conjugate[Q3`Private`z]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            TemplateBox[{"d", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`d[1/2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        Q3`Dagger[
         $CellContext`d[
          Rational[1, 2]]]]]}]}], ")"}]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->171514388,ExpressionUUID->"3af3eae4-b6d1-47df-b601-8cee213095c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[1, 2]]], 
     $CellContext`c[
      Rational[-1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{"z", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1/2]]], 
        InterpretationBox[
         TemplateBox[{"d", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`d[1/2]]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[1, 2]]], 
     Q3`Dagger[
      $CellContext`d[
       Rational[1, 2]]]]]}]}]], "Print",
 CellLabel->"During evaluation of In[394]:=",
 CellID->719264842,ExpressionUUID->"ecf02400-d75c-45fc-ae07-01dc17c16973"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[(-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["d", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`d[Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[(-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"d", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`d[1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[394]:=",
 CellID->498750531,ExpressionUUID->"8a1e0495-6b5b-469b-aad4-908a893188e3"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["x", "2"]}], "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        InterpretationBox[
         TemplateBox[{"x", 
           TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
             StyleBox[
             "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]},
             "RowWithSeparators"]},
          "Superscript"],
         Conjugate[Q3`Private`z]], "2"]}], "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], " ", 
       InterpretationBox[
        TemplateBox[{"z", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]]}]},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], " ", 
       InterpretationBox[
        TemplateBox[{"z", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]]}], "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], "2"], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], 
      FractionBox["x", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"x", " ", "z"}], "2"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 1, 3, 4, 5, 7, 8}, {{2}, {1}, {6}, {5}, {5}, {3}, {4}, {2}}}, {
      Rational[-1, 2] $CellContext`x, Rational[-1, 2] 
       Conjugate[$CellContext`x], Rational[-1, 2] Conjugate[$CellContext`x] 
       Conjugate[$CellContext`z], Rational[1, 2] Conjugate[$CellContext`x] 
       Conjugate[$CellContext`z], Rational[1, 2] Conjugate[$CellContext`x], 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[-1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->871500276,ExpressionUUID->"408df7aa-ab69-44dd-a4c7-48095cce43a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"c", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`c[1/2]]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`c[
         Rational[1, 2]]], 
       $CellContext`c[
        Rational[-1, 2]]]], "+", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{"z", 
         TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
           StyleBox[
           "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
          "RowWithSeparators"]},
        "Superscript"],
       Conjugate[Q3`Private`z]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            TemplateBox[{"d", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`d[1/2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        Q3`Dagger[
         $CellContext`d[
          Rational[1, 2]]]]]}]}], ")"}]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1466666192,ExpressionUUID->"f714c6f5-d6ec-4f76-be2e-c65018dcca6e"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1441388678,ExpressionUUID->"9bd52b9b-eb6a-46b4-ba02-ecd9945cbdc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "00409e62-dd82-4086-a0d1-b8c4d9604eef"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->2034447609,ExpressionUUID->"bad15282-6139-4f34-b396-fedd2a21a1bf"],

Cell["\<\
Here is another important example including anomalous bilinear form.\
\>", "ExampleText",
 CellID->2085944042,ExpressionUUID->"59ce6b42-1750-43bb-8139-1513f05153be"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", "=", 
  RowBox[{"PlusDagger", "[", 
   RowBox[{"FockHopping", "@@", 
    RowBox[{"c", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "@", 
     RowBox[{"FockIsospinor", "[", 
      RowBox[{"c", "[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ThePauli", "[", "1", "]"}], ",", 
    RowBox[{"FockIsospinor", "[", 
     RowBox[{"c", "[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"h0", "+", "h1"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->790976619,ExpressionUUID->"24eafcb7-9079-41e5-8c04-392687dc16b3"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1496184049,ExpressionUUID->"6017d1f9-eba4-46fa-bcbe-e2f3695c6871"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1479288820,ExpressionUUID->"bcae47f2-5782-4010-85d4-c5323ee9799d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->989016421,ExpressionUUID->"57918701-9557-457f-ad32-bde853fe847c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FockBilinearQ", "[", "hh", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FockBilinearQ", "[", 
  RowBox[{"hh", ",", "True"}], "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1401692392,ExpressionUUID->"95ebfb7d-361b-4ebb-8b14-38301d355f79"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[2]=",
 CellID->797663268,ExpressionUUID->"7bbfb170-7f7d-4fe9-b83a-f75a5239990d"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[2]=",
 CellID->1733620702,ExpressionUUID->"4879ebdf-8b3c-4879-bed7-7f2cf9243986"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "hh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1021100159,ExpressionUUID->"680e5f06-2c2b-4603-a929-eb678f0f52c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[1, (-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[1, Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[2, (-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[2, Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
       "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1, (-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1, 1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
       "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2, (-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2, 1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[407]:=",
 CellID->268618996,ExpressionUUID->"2dd8c32e-78ad-4edf-b0ed-e5a1f4f8a80c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {12, 12}, 0, {
     1, {{0, 1, 2, 2, 3, 4, 4, 5, 6, 7, 7, 7, 8}, {{2}, {1}, {11}, {10}, {
       8}, {7}, {6}, {3}}}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
       Rational[-1, 2], Rational[-1, 2], Rational[1, 2], 
       Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->668839778,ExpressionUUID->"61dd02b0-442f-4470-9584-b75061caa022"]
}, Open  ]],

Cell["\<\
Let us check if the found operators and the matrix are correct\
\>", "ExampleText",
 CellID->1362781649,ExpressionUUID->"41552cbc-6c1e-4dd0-83ec-13cd18b0e2b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "-", "hh"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1358079488,ExpressionUUID->"df9d33fa-d5a2-4b2b-910b-f59d14a805dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->592614415,ExpressionUUID->"f90f9683-55a8-410f-a204-8156d0b96c81"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[4]=",
 CellID->41318119,ExpressionUUID->"a448b9e0-56f9-465c-8168-f319c90740cf"]
}, Open  ]],

Cell["A similar example with bosons.", "ExampleText",
 CellID->207674041,ExpressionUUID->"c62ba83e-3b4d-4d46-bd6b-b4d3c8508a49"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", "=", 
  RowBox[{"PlusDagger", "@", 
   RowBox[{"FockHopping", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "**", 
    RowBox[{"a", "[", "2", "]"}]}], "+", 
   RowBox[{"Dagger", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "**", 
     RowBox[{"a", "[", "2", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"h0", "+", "h1"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->716680712,ExpressionUUID->"e1078c36-848d-45c8-8eee-97f8d8f7932f"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1573309734,ExpressionUUID->"182ace29-3199-44fe-bc21-8047eb983ab7"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->650553827,ExpressionUUID->"01ea8cdc-c34c-4288-8bc8-c898dcf14014"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1018923512,ExpressionUUID->"146e2117-320c-4f59-b5d1-24cdadb40ebf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FockBilinearQ", "[", "hh", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FockBilinearQ", "[", 
  RowBox[{"hh", ",", "True"}], "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->227185655,ExpressionUUID->"e38ece31-d3db-4c47-afda-b17a3bc7c3dd"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",
 CellID->1336905752,ExpressionUUID->"b5873112-a230-46a8-aa1f-94e3f7508ae0"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",
 CellID->253575303,ExpressionUUID->"18f96071-30c5-4860-834d-6d9c8d3a5bf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "hh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->95272385,ExpressionUUID->"896c90c3-87b9-446f-b702-da9683409cda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[417]:=",
 CellID->1407168179,ExpressionUUID->"89098d42-090c-4d4f-b1c3-3e2341d04a7d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{2}, {4}, {1}, {3}, {2}, {4}, {1}, {3}}}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2], 
       Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[
       1, 2]}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->38180042,ExpressionUUID->"6fa85cd6-d6d0-48aa-94e8-b2f4cb9e2ad9"]
}, Open  ]],

Cell["\<\
Let us check if the found operators and the matrix are correct\
\>", "ExampleText",
 CellID->352647418,ExpressionUUID->"f5d88f2f-7b91-4156-8b52-d10c83ab1ec3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "-", "hh"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->2037772253,ExpressionUUID->"21d65c3c-3a8a-46bb-9fc3-a284da2ca4ec"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->655607211,ExpressionUUID->"f3522642-9e1f-4d0f-98f7-ea4a124579f5"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[8]=",
 CellID->51802520,ExpressionUUID->"32f1316d-8772-437a-b5cd-41cfed0b26d3"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearQ"]], "paclet:Q3/ref/FockBilinearQ", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "43d736cc-0934-49a0-82a5-80ce41d60986"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearOperators"]], 
           "paclet:Q3/ref/FockBilinearOperators", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "ccf3922c-b656-4ddb-844d-b8f6419830c6"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearMatrix"]], 
           "paclet:Q3/ref/FockBilinearMatrix", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "21dd4555-0185-4bf4-aabc-8cbe23ce119f"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearSystem"]], 
           "paclet:Q3/ref/FockBilinearSystem", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d764d186-d023-402e-8cc6-5ae440483a86"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CoefficientTensor"]], "paclet:Q3/ref/CoefficientTensor",
            "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "f2e34e78-4ec4-4629-b97c-5f51e731b8f1"]
       }], "SeeAlso",ExpressionUUID->"30c7e678-07d6-40d9-9545-9446a8aae6d0"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"5a3350f9-2880-4757-9631-\
fab90074aa58"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox["Tutorials", "TutorialsSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "13abd5d2-3769-4e26-b4b5-35c5bed71ebf"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "20f52d1a-5b51-48c3-b969-09952ee01e2f"]}]}
     }]}
  }]], "TutorialsSection",ExpressionUUID->"6f9bcb21-caab-438e-b0cc-\
61e687d2e2cf"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "dbaab751-290d-4475-947a-87a303cf0766"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "ab8c7453-6cb4-450e-bdd9-30d7f47495f2"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"29227bd6-b638-4f45-a9a0-\
f37fd74a103c"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "75b0d6ba-21d2-455d-80e2-081d7bf10cf6"]}]],ExpressionUUID->
         "be611260-6d6a-4629-ba11-39d4342a18d1"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "37c65b23-8ac2-4462-b98a-9b24d10fd555"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"36691371-539d-4b92-9518-\
4b03462632c1"],

Cell[" ", "FooterCell",ExpressionUUID->"35f3962f-4d5d-4228-8b1e-0dcacdd696e3"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"FockBilinearSystem",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}, 
    "AllOptsTable" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2024, 3, 16, 17, 36, 58.166044}", 
    "history" -> {"12", "", "", ""}, "context" -> "Q3`", "keywords" -> {}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "FockBilinearSystem[expr] returns a list of {operators, matrix} of the \
bilinear combination.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "FockBilinearSystem", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "FockBilinearSystem", "type" -> "Symbol", "uri" -> 
    "Q3/ref/FockBilinearSystem"}},
CellContext->"Global`",
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.0 for Mac OS X ARM (64-bit) (December 12, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"b02da2df-bb0a-43fe-a1b8-5208817d39f7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[9017, 235, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"8b3437bb-b2f8-4c94-9c34-d40494d592c2",
   CellTags->"PrimaryExamplesSection",
   CellID->1941128143]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 99311, 2895}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[590, 21, 7226, 177, 57, "AnchorBarGrid",ExpressionUUID->"1ce5dc78-e904-458b-9c4e-d63a02515241",
 CellID->1],
Cell[7819, 200, 85, 0, 23, "ContextNameCell",ExpressionUUID->"5ab97aae-4d96-47c8-8cc7-1044ec8aa85a"],
Cell[CellGroupData[{
Cell[7929, 204, 561, 14, 60, "ObjectNameGrid",ExpressionUUID->"5eb2f5e0-cd9d-4187-953b-0c2ece8b3b52"],
Cell[8493, 220, 487, 10, 112, "Usage",ExpressionUUID->"d894b4bd-5431-44b9-9787-7c1e864af0f9",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[9017, 235, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"8b3437bb-b2f8-4c94-9c34-d40494d592c2",
 CellTags->"PrimaryExamplesSection",
 CellID->1941128143],
Cell[10410, 274, 191, 3, 31, "Input",ExpressionUUID->"3d930caf-cbae-4e7f-a2e9-36c378fa3941",
 CellID->742081683],
Cell[CellGroupData[{
Cell[10626, 281, 1368, 36, 31, "ExampleSection",ExpressionUUID->"131ac760-1f15-4ca5-855a-71dab1239e1f",
 CellID->2116617824],
Cell[11997, 319, 207, 5, 29, "Input",ExpressionUUID->"1d884ec3-ca88-47bc-b168-30e3cbda0568",
 CellID->54356201],
Cell[CellGroupData[{
Cell[12229, 328, 1209, 36, 138, "Input",ExpressionUUID->"ead50cac-9338-40e8-ad62-7e02875d321d",
 CellID->301411736],
Cell[13441, 366, 1510, 42, 40, "Output",ExpressionUUID->"6d38535b-bb29-402a-b8c3-6d56e0b72f48",
 CellID->2048158089],
Cell[CellGroupData[{
Cell[14976, 412, 1440, 39, 26, "Print",ExpressionUUID->"262af68c-6100-4eb5-8527-977f283b1cc2",
 CellID->1377624060],
Cell[16419, 453, 1356, 40, 27, "Print",ExpressionUUID->"58ed029d-d676-4604-bab0-09958bbe383a",
 CellID->1706378113]
}, Open  ]],
Cell[17790, 496, 1214, 34, 154, "Output",ExpressionUUID->"e7e0d523-0555-4b82-9615-905857abcf78",
 CellID->1600323153],
Cell[19007, 532, 1510, 42, 40, "Output",ExpressionUUID->"bda2e46b-c6f8-4542-8911-8b11d0d6cd7a",
 CellID->1546037443],
Cell[20520, 576, 127, 2, 37, "Output",ExpressionUUID->"b85fc118-2187-4990-b0d5-fec2b6fbe963",
 CellID->1846659448]
}, Open  ]],
Cell[CellGroupData[{
Cell[20684, 583, 1248, 37, 138, "Input",ExpressionUUID->"0d41b6ea-a3f9-40bd-892f-feddf860f5dd",
 CellID->950609431],
Cell[21935, 622, 1730, 48, 40, "Output",ExpressionUUID->"04362a46-9a0a-4307-a717-cf32058b1dca",
 CellID->1185499796],
Cell[CellGroupData[{
Cell[23690, 674, 1622, 43, 70, "Print",ExpressionUUID->"9a7c8f95-81d5-4fdc-a3fc-54ed0b36f58b",
 CellID->341794506],
Cell[25315, 719, 598, 19, 70, "Print",ExpressionUUID->"96cc469e-4649-4a76-9541-ac2a532c7a8c",
 CellID->21506617]
}, Open  ]],
Cell[25928, 741, 779, 23, 82, "Output",ExpressionUUID->"3b109180-98b3-4c2b-ab7c-003a33ef0784",
 CellID->684459223],
Cell[26710, 766, 1730, 48, 40, "Output",ExpressionUUID->"4c97d04a-bbfc-4f19-a7d3-8990cb0ee15e",
 CellID->1783747629],
Cell[28443, 816, 126, 2, 37, "Output",ExpressionUUID->"21277026-a609-4b21-bf29-a7d0afbb57fc",
 CellID->574688483]
}, Open  ]],
Cell[28584, 821, 221, 5, 70, "Input",ExpressionUUID->"2577c066-b53b-492b-a400-c86c8689075a",
 CellID->1462286656],
Cell[CellGroupData[{
Cell[28830, 830, 1221, 37, 70, "Input",ExpressionUUID->"5822e693-2cfe-4175-ab82-833d7ff619cc",
 CellID->1828079879],
Cell[30054, 869, 1808, 55, 40, "Output",ExpressionUUID->"1fda13c6-e633-4bc2-85d8-48d0b8009e62",
 CellID->2099369269],
Cell[CellGroupData[{
Cell[31887, 928, 1648, 46, 70, "Print",ExpressionUUID->"f0a272b4-7f0a-40cd-b523-3911cf842aa6",
 CellID->942983873],
Cell[33538, 976, 1467, 40, 70, "Print",ExpressionUUID->"fe5c2cac-63d4-4752-9766-4095e072327d",
 CellID->300638651]
}, Open  ]],
Cell[35020, 1019, 1263, 36, 154, "Output",ExpressionUUID->"9fcb7666-2118-4142-82b3-ee7a950f8626",
 CellID->1952269613],
Cell[36286, 1057, 1804, 55, 40, "Output",ExpressionUUID->"b7b29984-93c2-4a77-be3e-e21a0f772d6e",
 CellID->392743178],
Cell[38093, 1114, 127, 2, 37, "Output",ExpressionUUID->"782d6a18-a090-44e1-9c5e-7c6fd5e838a3",
 CellID->1617345415]
}, Open  ]],
Cell[CellGroupData[{
Cell[38257, 1121, 1336, 40, 70, "Input",ExpressionUUID->"1c986325-278e-49ce-9827-04fae00b2669",
 CellID->680707724],
Cell[39596, 1163, 1808, 55, 40, "Output",ExpressionUUID->"f5f50686-f0d7-4270-8788-8bf3d55b34f0",
 CellID->1483456694],
Cell[41407, 1220, 4648, 137, 40, "Output",ExpressionUUID->"3af3eae4-b6d1-47df-b601-8cee213095c2",
 CellID->171514388],
Cell[CellGroupData[{
Cell[46080, 1361, 4288, 120, 70, "Print",ExpressionUUID->"ecf02400-d75c-45fc-ae07-01dc17c16973",
 CellID->719264842],
Cell[50371, 1483, 1467, 40, 70, "Print",ExpressionUUID->"8a1e0495-6b5b-469b-aad4-908a893188e3",
 CellID->498750531]
}, Open  ]],
Cell[51853, 1526, 3577, 95, 182, "Output",ExpressionUUID->"408df7aa-ab69-44dd-a4c7-48095cce43a6",
 CellID->871500276],
Cell[55433, 1623, 4355, 126, 40, "Output",ExpressionUUID->"f714c6f5-d6ec-4f76-be2e-c65018dcca6e",
 CellID->1466666192],
Cell[59791, 1751, 127, 2, 37, "Output",ExpressionUUID->"9bd52b9b-eb6a-46b4-ba02-ecd9945cbdc4",
 CellID->1441388678]
}, Open  ]],
Cell[CellGroupData[{
Cell[59955, 1758, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"bad15282-6139-4f34-b396-fedd2a21a1bf",
 CellID->2034447609],
Cell[60201, 1765, 175, 3, 70, "ExampleText",ExpressionUUID->"59ce6b42-1750-43bb-8139-1513f05153be",
 CellID->2085944042],
Cell[CellGroupData[{
Cell[60401, 1772, 746, 20, 70, "Input",ExpressionUUID->"24eafcb7-9079-41e5-8c04-392687dc16b3",
 CellID->790976619],
Cell[61150, 1794, 1507, 41, 39, "Output",ExpressionUUID->"6017d1f9-eba4-46fa-bcbe-e2f3695c6871",
 CellID->1496184049],
Cell[62660, 1837, 1834, 54, 41, "Output",ExpressionUUID->"bcae47f2-5782-4010-85d4-c5323ee9799d",
 CellID->1479288820],
Cell[64497, 1893, 3211, 92, 41, "Output",ExpressionUUID->"57918701-9557-457f-ad32-bde853fe847c",
 CellID->989016421]
}, Open  ]],
Cell[CellGroupData[{
Cell[67745, 1990, 289, 6, 70, "Input",ExpressionUUID->"95ebfb7d-361b-4ebb-8b14-38301d355f79",
 CellID->1401692392],
Cell[68037, 1998, 129, 2, 37, "Output",ExpressionUUID->"7bbfb170-7f7d-4fe9-b83a-f75a5239990d",
 CellID->797663268],
Cell[68169, 2002, 130, 2, 37, "Output",ExpressionUUID->"4879ebdf-8b3c-4879-bed7-7f2cf9243986",
 CellID->1733620702]
}, Open  ]],
Cell[CellGroupData[{
Cell[68336, 2009, 417, 11, 70, "Input",ExpressionUUID->"680e5f06-2c2b-4603-a929-eb678f0f52c8",
 CellID->1021100159],
Cell[68756, 2022, 2769, 78, 70, "Print",ExpressionUUID->"2dd8c32e-78ad-4edf-b0ed-e5a1f4f8a80c",
 CellID->268618996],
Cell[71528, 2102, 1958, 47, 300, "Output",ExpressionUUID->"61dd02b0-442f-4470-9584-b75061caa022",
 CellID->668839778]
}, Open  ]],
Cell[73501, 2152, 169, 3, 70, "ExampleText",ExpressionUUID->"41552cbc-6c1e-4dd0-83ec-13cd18b0e2b7",
 CellID->1362781649],
Cell[CellGroupData[{
Cell[73695, 2159, 349, 9, 70, "Input",ExpressionUUID->"df9d33fa-d5a2-4b2b-910b-f59d14a805dd",
 CellID->1358079488],
Cell[74047, 2170, 3211, 92, 41, "Output",ExpressionUUID->"f90f9683-55a8-410f-a204-8156d0b96c81",
 CellID->592614415],
Cell[77261, 2264, 125, 2, 37, "Output",ExpressionUUID->"a448b9e0-56f9-465c-8168-f319c90740cf",
 CellID->41318119]
}, Open  ]],
Cell[77401, 2269, 128, 1, 70, "ExampleText",ExpressionUUID->"c62ba83e-3b4d-4d46-bd6b-b4d3c8508a49",
 CellID->207674041],
Cell[CellGroupData[{
Cell[77554, 2274, 692, 20, 70, "Input",ExpressionUUID->"e1078c36-848d-45c8-8eee-97f8d8f7932f",
 CellID->716680712],
Cell[78249, 2296, 1507, 41, 39, "Output",ExpressionUUID->"182ace29-3199-44fe-bc21-8047eb983ab7",
 CellID->1573309734],
Cell[79759, 2339, 1506, 41, 39, "Output",ExpressionUUID->"01ea8cdc-c34c-4288-8bc8-c898dcf14014",
 CellID->650553827],
Cell[81268, 2382, 2885, 79, 39, "Output",ExpressionUUID->"146e2117-320c-4f59-b5d1-24cdadb40ebf",
 CellID->1018923512]
}, Open  ]],
Cell[CellGroupData[{
Cell[84190, 2466, 288, 6, 70, "Input",ExpressionUUID->"e38ece31-d3db-4c47-afda-b17a3bc7c3dd",
 CellID->227185655],
Cell[84481, 2474, 130, 2, 37, "Output",ExpressionUUID->"b5873112-a230-46a8-aa1f-94e3f7508ae0",
 CellID->1336905752],
Cell[84614, 2478, 129, 2, 37, "Output",ExpressionUUID->"18f96071-30c5-4860-834d-6d9c8d3a5bf9",
 CellID->253575303]
}, Open  ]],
Cell[CellGroupData[{
Cell[84780, 2485, 415, 11, 70, "Input",ExpressionUUID->"896c90c3-87b9-446f-b702-da9683409cda",
 CellID->95272385],
Cell[85198, 2498, 962, 28, 70, "Print",ExpressionUUID->"89098d42-090c-4d4f-b1c3-3e2341d04a7d",
 CellID->1407168179],
Cell[86163, 2528, 1122, 33, 132, "Output",ExpressionUUID->"6fa85cd6-d6d0-48aa-94e8-b2f4cb9e2ad9",
 CellID->38180042]
}, Open  ]],
Cell[87300, 2564, 168, 3, 70, "ExampleText",ExpressionUUID->"f5d88f2f-7b91-4156-8b52-d10c83ab1ec3",
 CellID->352647418],
Cell[CellGroupData[{
Cell[87493, 2571, 349, 9, 70, "Input",ExpressionUUID->"21d65c3c-3a8a-46bb-9fc3-a284da2ca4ec",
 CellID->2037772253],
Cell[87845, 2582, 2884, 79, 39, "Output",ExpressionUUID->"f3522642-9e1f-4d0f-98f7-ea4a124579f5",
 CellID->655607211],
Cell[90732, 2663, 125, 2, 37, "Output",ExpressionUUID->"32f1316d-8772-437a-b5cd-41cfed0b26d3",
 CellID->51802520]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[91111, 2675, 2924, 78, 70, "SeeAlsoSection",ExpressionUUID->"5a3350f9-2880-4757-9631-fab90074aa58"],
Cell[94038, 2755, 1056, 27, 70, "TutorialsSection",ExpressionUUID->"6f9bcb21-caab-438e-b0cc-61e687d2e2cf"],
Cell[95097, 2784, 1081, 28, 70, "MoreAboutSection",ExpressionUUID->"29227bd6-b638-4f45-a9a0-f37fd74a103c"],
Cell[96181, 2814, 1166, 34, 70, "RelatedLinksSection",ExpressionUUID->"36691371-539d-4b92-9518-4b03462632c1"],
Cell[97350, 2850, 78, 0, 70, "FooterCell",ExpressionUUID->"35f3962f-4d5d-4228-8b1e-0dcacdd696e3"]
}
]
*)

(* End of internal cache information *)

