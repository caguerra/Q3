(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70246,       2267]
NotebookOptionsPosition[     60336,       2061]
NotebookOutlinePosition[     62502,       2117]
CellTagsIndexPosition[     62416,       2112]
WindowTitle->Toffoli
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso: Quick Start\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoQuickStart"], "\<\"QuissoCircuit Tutorial \
with Examples\"\>":>Documentation`HelpLookup[
       "paclet:Q3/tutorial/QuissoCircuitUsage"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"CNOT\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/CNOT"], "\<\"QuissoCNOT\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/QuissoCNOT"], "\<\"SWAP\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/SWAP"], "\<\"QuissoSWAP\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/QuissoSWAP"], "\<\"Toffoli\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/Toffoli"], "\<\"QuissoToffoli\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/QuissoToffoli"], "\<\"Fredkin\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/ref/Fredkin"], "\<\"QuissoFredkin\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/QuissoFredkin"], "\<\"CZ\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/CZ"], "\<\"QuissoCZ\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/QuissoCZ"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Quisso Package Guide\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/QuissoPackageGuide"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/Toffoli\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/Toffoli"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/Toffoli.html"], 
                StandardForm]], "Input", TextClipboardType -> "PlainText"]}, 
            Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$159460], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], "Q3/ref/Toffoli", 
             ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["Toffoli", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"Toffoli", "[", 
       RowBox[{
        StyleBox["a", "TI"], ",", 
        StyleBox["b", "TI"], ",", 
        StyleBox["c", "TI"]}], "]"}]], "InlineFormula"],
     "\[LineSeparator]represents the quantum ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["Toffoli"]], "paclet:Q3/ref/Toffoli"},
       "RefLink",
       BaseStyle->{"InlineFormula"}]], "InlineFormula"],
     " gate, i.e., the three-qubit controlled-note gate on ",
     Cell[BoxData[
      StyleBox["c", "TI"]], "InlineFormula"],
     " controlled jointly by ",
     Cell[BoxData[
      StyleBox["a", "TI"]], "InlineFormula"],
     " and ",
     Cell[BoxData[
      StyleBox["b", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    TemplateBox[{6},
     "Spacer1"]]],
   "Details"
  }], "NotesFrameText"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->"Preemptive"]]]], "NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1378952463],

Cell["", "SectionHeaderSpacer"],

Cell["\<\
Toffoli gate was invented by Tommaso Toffoli for classical reversible \
computation.\
\>", "Notes",
 CellID->1067943069],

Cell["\<\
It is universal for classical reversible computation, but is not universal \
for quantum computation.\
\>", "Notes",
 CellID->1640755739],

Cell["", "SectionFooterSpacer"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->410527217],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->2013461955],

Cell[TextData[{
 StyleBox[ButtonBox["G",
  BaseStyle->"Link",
  ButtonData->"paclet:guide/Gray"], "Input"],
 StyleBox["ray", "Input"],
 " is a supplementary package and should be loaded manually."
}], "ExampleText",
 CellID->2107002657],

Cell[BoxData[{
 RowBox[{"<<", "Q3`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Q3`Gray`"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->985820484],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->84693807],

Cell["This is a quantum circuit model of the Toffoli gate.", "ExampleText",
 CellID->1169838411],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"Toffoli", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1205134369],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImageSize->Medium,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellLabel->"Out[3]=",
 CellID->528575283],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "4"]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1772417389]
}, Open  ]],

Cell["It can be implemented by a combination of two-qubit gates.", \
"ExampleText",
 CellID->1178353731],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gray", "=", 
   RowBox[{"GrayControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", "gray", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "-", "expr"}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1463439166],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
    LineBox[{{1, -1}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -2}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
        4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImageSize->Medium,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellLabel->"Out[4]=",
 CellID->2126035680],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "4"]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->301271327],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[4]=",
 CellID->1848236910]
}, Open  ]],

Cell[TextData[{
 "Here ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"V", "=", 
    SqrtBox["X"]}],
   FontSlant->"Italic"]], "InlineFormula"],
 ", and its matrix representation looks like this."
}], "ExampleText",
 CellID->507963631],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matV", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"ThePauli", "[", "1", "]"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matV", "*", 
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "I"}], ")"}]}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"opV", "=", 
  RowBox[{"QuissoExpression", "[", 
   RowBox[{"matV", ",", 
    RowBox[{"S", "[", "3", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->1527310069],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {
      RowBox[{"-", "\[ImaginaryI]"}], "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->209521500],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "2"], "+", 
    FractionBox["\[ImaginaryI]", "2"]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1702153067]
}, Open  ]],

Cell["Reversing the above circuit gives the identical result.", "ExampleText",
 CellID->1796721321],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"Reverse", "@", "gray"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "-", "expr"}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1727681580],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
    LineBox[{{1, -2}, {1, -3}}], DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -2}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
        4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
    LineBox[{{5, -1}, {5, -3}}], DiskBox[{5, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImageSize->Medium,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellLabel->"Out[6]=",
 CellID->1281760221],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "4"]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1135571290],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->859500141]
}, Open  ]],

Cell["\<\
As noted in Smolin and DiVincenzo (PRA, 1996), it can also be reordered as \
following.\
\>", "ExampleText",
 CellID->1066398032],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"Permute", "[", 
    RowBox[{"gray", ",", 
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "}"}], "}"}], "]"}]}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "-", "expr"}]}], "Input",
 CellLabel->"In[7]:=",
 CellID->485964845],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    LineBox[{{2, -2}, {2, -3}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -1}, {3, -2}}], 
    DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
        3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImageSize->Medium,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellLabel->"Out[7]=",
 CellID->1282823811],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "4"]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1831459244],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[7]=",
 CellID->1452401457]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->144709360],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"toff", "=", 
  RowBox[{"Toffoli", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}], ",", 
    RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "**", 
  RowBox[{"S", "[", 
   RowBox[{"4", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "//", "Elaborate"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toff", "//", "Elaborate"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->1814639935],

Cell[BoxData[
 RowBox[{"Toffoli", "[", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"3"},
     "RowDefault"]]}], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->233643608],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], "4"]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1248012940],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "4"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "4"]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->880702331],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {2}, {1}, {3}, {4}, {
       4}, {3}, {5}, {6}, {6}, {5}, {7}, {8}, {8}, {7}}}, {1, 0, 1, 0, 1, 0, 
      1, 0, 1, 0, 1, 0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->1506781993]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[2]:=",
 CellID->145488415],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImageSize->Medium,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellLabel->"Out[2]=",
 CellID->481524515]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{"qc", "//", "QuissoExpression"}]}]], "Input",
 CellLabel->"In[3]:=",
 CellID->664764407],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TagBox[
     RowBox[{
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm], 
      TagBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm]}],
     DisplayForm]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1294470155]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "expr", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[4]:=",
 CellID->1574284910],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], 
      FractionBox["1", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {2}, {1}, {3}, {4}, {
       4}, {3}, {5}, {6}, {6}, {5}, {7}, {8}, {8}, {7}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], -2^Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2], 2^Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], -2^Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->841496814]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[5]:=",
 CellID->2079974352],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], 
      FractionBox["1", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {1}, {2}, {3}, {4}, {
       3}, {4}, {5}, {6}, {5}, {6}, {7}, {8}, {7}, {8}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], -2^Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], -2^Rational[-1, 2], 2^Rational[-1, 2], 2^
       Rational[-1, 2], -2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]]], "Output",\

 CellLabel->"Out[5]//MatrixForm=",
 CellID->1902503016]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:Q3/ref/CNOT"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuissoCNOT"]], "paclet:Q3/ref/QuissoCNOT"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:Q3/ref/SWAP"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuissoSWAP"]], "paclet:Q3/ref/QuissoSWAP"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Toffoli"]], "paclet:Q3/ref/Toffoli"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuissoToffoli"]], "paclet:Q3/ref/QuissoToffoli"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Fredkin"]], "paclet:Q3/ref/Fredkin"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuissoFredkin"]], "paclet:Q3/ref/QuissoFredkin"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CZ"]], "paclet:Q3/ref/CZ"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuissoCZ"]], "paclet:Q3/ref/QuissoCZ"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso: Quick Start"]], "paclet:Q3/tutorial/QuissoQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->1430896196],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["QuissoCircuit Tutorial with Examples"]], 
   "paclet:Q3/tutorial/QuissoCircuitUsage"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->341631938],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Quisso Package Guide"]], "paclet:Q3/guide/QuissoPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->207768259]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Toffoli",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 2, 27, 1, 32, 26.873770}", 
    "history" -> {"XX", "", "", ""}, "context" -> "Q3`Quisso`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "Toffoli[a, b, c] represents the quantum Toffoli gate, i.e., the \
three-qubit controlled-note gate on c controlled jointly by a and b.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "Toffoli", 
    "titlemodifier" -> "", "windowtitle" -> "Toffoli", "type" -> "Symbol", 
    "uri" -> "Q3/ref/Toffoli", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[7801, 229, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"dce1f56d-0f6a-4225-b424-ab4969388421",
   CellTags->"PrimaryExamplesSection",
   CellID->410527217]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 62218, 2105}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[579, 21, 5081, 123, 70, "AnchorBarGrid",ExpressionUUID->"4ec92bc5-bf43-4b2e-9655-a540136ef110",
 CellID->1],
Cell[CellGroupData[{
Cell[5685, 148, 164, 6, 70, "ObjectNameGrid",ExpressionUUID->"23eb93cf-8abf-4802-9cde-900a1845526a"],
Cell[5852, 156, 894, 28, 70, "Usage",ExpressionUUID->"9a4b8ab6-3fae-4689-b35a-a68f7e8e1107"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6783, 189, 630, 19, 70, "NotesSection",ExpressionUUID->"fe00163d-6d16-438b-94b0-51d4c2004125",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1378952463],
Cell[7416, 210, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"df5c151f-9010-428b-add2-3808adaff971"],
Cell[7450, 212, 130, 4, 70, "Notes",ExpressionUUID->"42846dd7-b36c-4aa6-bf20-c1788abbdbdc",
 CellID->1067943069],
Cell[7583, 218, 147, 4, 70, "Notes",ExpressionUUID->"b14a0439-3af9-46c0-8615-648401e35a74",
 CellID->1640755739],
Cell[7733, 224, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"2278fbc5-efda-4a5c-9b1b-b90eab9af40b"]
}, Closed]],
Cell[CellGroupData[{
Cell[7801, 229, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"dce1f56d-0f6a-4225-b424-ab4969388421",
 CellTags->"PrimaryExamplesSection",
 CellID->410527217],
Cell[CellGroupData[{
Cell[8093, 243, 196, 6, 70, "ExampleSection",ExpressionUUID->"e7654c88-8e43-4e6f-826c-873a3ee3e832",
 CellID->2013461955],
Cell[8292, 251, 236, 7, 70, "ExampleText",ExpressionUUID->"bc10de8e-41d2-46f3-9c75-1aca2071995b",
 CellID->2107002657],
Cell[8531, 260, 145, 4, 70, "Input",ExpressionUUID->"25923936-7fe2-466f-9213-f702a98f45e3",
 CellID->985820484],
Cell[8679, 266, 125, 4, 70, "Input",ExpressionUUID->"6ec9a77e-3e31-4062-a6cb-f05c3c14f3cd",
 CellID->84693807],
Cell[8807, 272, 96, 1, 70, "ExampleText",ExpressionUUID->"fe2a83e9-8316-4ee4-89c8-2f192a56dd71",
 CellID->1169838411],
Cell[CellGroupData[{
Cell[8928, 277, 396, 11, 70, "Input",ExpressionUUID->"e4a900c0-c77d-4040-916d-20240b826008",
 CellID->1205134369],
Cell[9327, 290, 607, 14, 70, "Output",ExpressionUUID->"869a8b6a-fba4-4906-9a42-7d045d4e3098",
 CellID->528575283],
Cell[9937, 306, 2971, 105, 70, "Output",ExpressionUUID->"c118c818-b824-48ef-87ec-9d59634cea06",
 CellID->1772417389]
}, Open  ]],
Cell[12923, 414, 104, 2, 70, "ExampleText",ExpressionUUID->"cb37920a-57bf-4b99-9cab-b9a3339033e5",
 CellID->1178353731],
Cell[CellGroupData[{
Cell[13052, 420, 570, 16, 70, "Input",ExpressionUUID->"9119fc08-c6e4-4729-a207-d003a5879352",
 CellID->1463439166],
Cell[13625, 438, 2005, 47, 70, "Output",ExpressionUUID->"f7684d7e-c7ea-4de9-9642-27ee3b3fd504",
 CellID->2126035680],
Cell[15633, 487, 2970, 105, 70, "Output",ExpressionUUID->"29801a02-03e5-43a3-8014-194df8ee4b92",
 CellID->301271327],
Cell[18606, 594, 72, 2, 70, "Output",ExpressionUUID->"3657c7e0-301f-4886-8eb5-35cab58ed11d",
 CellID->1848236910]
}, Open  ]],
Cell[18693, 599, 229, 9, 70, "ExampleText",ExpressionUUID->"82d2ff43-093c-44ea-addb-e285da83d7db",
 CellID->507963631],
Cell[CellGroupData[{
Cell[18947, 612, 560, 18, 70, "Input",ExpressionUUID->"5f65ec4c-f8fe-40ef-a263-72035a7c6c9d",
 CellID->1527310069],
Cell[19510, 632, 605, 19, 70, "Output",ExpressionUUID->"20dd8999-3c86-44ff-9a13-9f3bec8b947c",
 CellID->209521500],
Cell[20118, 653, 491, 17, 70, "Output",ExpressionUUID->"34097342-20c3-47b5-9acf-e682be8077ad",
 CellID->1702153067]
}, Open  ]],
Cell[20624, 673, 99, 1, 70, "ExampleText",ExpressionUUID->"6ec706a0-8c49-4789-bc17-943c67eb4600",
 CellID->1796721321],
Cell[CellGroupData[{
Cell[20748, 678, 322, 8, 70, "Input",ExpressionUUID->"fb67f81a-9786-4e6c-ab5f-7322017bca9b",
 CellID->1727681580],
Cell[21073, 688, 2005, 47, 70, "Output",ExpressionUUID->"f6f11c1c-b984-4874-ac3e-ea7ac64bac3c",
 CellID->1281760221],
Cell[23081, 737, 2971, 105, 70, "Output",ExpressionUUID->"d78180f6-06c7-44f7-bc52-6789e9551e5a",
 CellID->1135571290],
Cell[26055, 844, 71, 2, 70, "Output",ExpressionUUID->"0c2dfc3d-1d4d-4f5f-ba66-2ccc13059894",
 CellID->859500141]
}, Open  ]],
Cell[26141, 849, 139, 4, 70, "ExampleText",ExpressionUUID->"9def797b-8f05-4828-bd16-eb27498809bf",
 CellID->1066398032],
Cell[CellGroupData[{
Cell[26305, 857, 496, 14, 70, "Input",ExpressionUUID->"28c7f832-a32d-4a3c-804d-49ee2a643d1f",
 CellID->485964845],
Cell[26804, 873, 2006, 47, 70, "Output",ExpressionUUID->"0303c1ee-7fc1-49e4-bf9d-37df4f0973bc",
 CellID->1282823811],
Cell[28813, 922, 2971, 105, 70, "Output",ExpressionUUID->"2273cb2c-8757-4e3e-a0b5-74d3ca373eb1",
 CellID->1831459244],
Cell[31787, 1029, 72, 2, 70, "Output",ExpressionUUID->"c60c45b6-58b8-491e-aa21-af94ca909326",
 CellID->1452401457]
}, Open  ]],
Cell[CellGroupData[{
Cell[31896, 1036, 125, 3, 70, "ExampleDelimiter",ExpressionUUID->"5dc6eacf-ef7c-46b7-8194-bc123fe814ac",
 CellID->144709360],
Cell[CellGroupData[{
Cell[32046, 1043, 552, 16, 70, "Input",ExpressionUUID->"9fc2f45a-2011-4f59-8f0c-03b53285d1b6",
 CellID->1814639935],
Cell[32601, 1061, 440, 19, 70, "Output",ExpressionUUID->"c555f131-f9d1-4b7f-92a9-d218da417fe1",
 CellID->233643608],
Cell[33044, 1082, 4999, 178, 70, "Output",ExpressionUUID->"73272a2d-4b21-42e3-abbd-59dee7b323c5",
 CellID->1248012940],
Cell[38046, 1262, 2970, 105, 70, "Output",ExpressionUUID->"d254ffb8-5a1f-43d6-b0d6-02f31c691d69",
 CellID->880702331],
Cell[41019, 1369, 1105, 28, 70, "Output",ExpressionUUID->"704ad3de-e4a5-41a1-bf82-69b7e24836f8",
 CellID->1506781993]
}, Open  ]],
Cell[CellGroupData[{
Cell[42161, 1402, 454, 13, 70, "Input",ExpressionUUID->"2050d357-3dac-4108-b6c0-6190865d21b3",
 CellID->145488415],
Cell[42618, 1417, 926, 22, 70, "Output",ExpressionUUID->"86ada5e6-239f-47ce-8c8b-9876411638e4",
 CellID->481524515]
}, Open  ]],
Cell[CellGroupData[{
Cell[43581, 1444, 135, 4, 70, "Input",ExpressionUUID->"3afc69cb-ee54-4ba8-81da-cc98ce0ec067",
 CellID->664764407],
Cell[43719, 1450, 7532, 273, 70, "Output",ExpressionUUID->"e0320b83-5a0f-413a-99b8-f13bc27d5e96",
 CellID->1294470155]
}, Open  ]],
Cell[CellGroupData[{
Cell[51288, 1728, 139, 4, 70, "Input",ExpressionUUID->"a3894b28-38cb-4f1c-94ad-8b6aeddbfa8c",
 CellID->1574284910],
Cell[51430, 1734, 2172, 69, 70, "Output",ExpressionUUID->"4c1453e4-9534-4e42-a434-92789cd63d1a",
 CellID->841496814]
}, Open  ]],
Cell[CellGroupData[{
Cell[53639, 1808, 137, 4, 70, "Input",ExpressionUUID->"b8f7faa6-d09f-4740-8110-67855271516f",
 CellID->2079974352],
Cell[53779, 1814, 2175, 70, 70, "Output",ExpressionUUID->"04f52f7f-31a8-4bc2-bc89-b71ebceee6c2",
 CellID->1902503016]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[55993, 1889, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"c198aec2-0260-41c5-b4da-bf3495821651"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56061, 1894, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"1779ed4f-2dd6-4e6d-9992-502c6c43aeab",
 CellID->1255426704],
Cell[56214, 1903, 2996, 98, 70, "SeeAlso",ExpressionUUID->"d32684a2-6fa2-4b00-9ffa-6dec8a7dc697",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[59247, 2006, 152, 7, 70, "TutorialsSection",ExpressionUUID->"4d3e9606-1ce1-4746-8873-806d3b82cb08",
 CellID->250839057],
Cell[59402, 2015, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"3ef9e953-d6d7-420a-af26-8c0bd509165a"],
Cell[59436, 2017, 190, 6, 70, "Tutorials",ExpressionUUID->"52d6585c-54ec-475d-b5c6-8c9469e9c4c9",
 CellID->1430896196],
Cell[59629, 2025, 212, 7, 70, "Tutorials",ExpressionUUID->"fdd20e1d-9e10-415d-9829-712e70273fe2",
 CellID->341631938],
Cell[59844, 2034, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"6695d363-1bfc-4404-a390-49abe183cc3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59912, 2039, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"af48c22e-5f9b-41ac-888d-ec78ba469947",
 CellID->38303248],
Cell[60071, 2048, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"b4d579a8-44a8-4073-b2bf-72b97fd2ac45"],
Cell[60105, 2050, 189, 6, 70, "MoreAbout",ExpressionUUID->"f4220817-4fbf-4ddb-b68d-c69233dcc4f3",
 CellID->207768259]
}, Open  ]],
Cell[60309, 2059, 23, 0, 70, "FooterCell",ExpressionUUID->"7e29c226-9bc8-4b4e-b096-daf0ce74bee6"]
}
]
*)

(* End of internal cache information *)
