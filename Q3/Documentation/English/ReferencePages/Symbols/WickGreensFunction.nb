(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    259079,       6143]
NotebookOptionsPosition[    239607,       5749]
NotebookOutlinePosition[    242234,       5811]
CellTagsIndexPosition[    242147,       5806]
WindowTitle->WickGreensFunction
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "1cbedea6-614b-44bb-8749-661106718993"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "21720302-c6c3-46d8-b37a-8a5e978e0ac0"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "75069fa2-89f0-43ea-b05b-9e80893a50f4"]
         }],ExpressionUUID->"aabf3ffd-96ec-4a4e-a3e6-b64971d726c4"],
         StripOnInput->False],{
        StyleBox["\"WickState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/WickState"], 
         StyleBox["\"WickUnitary\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/WickUnitary"], 
         StyleBox[
          "\"WickOperator\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/WickOperator"], 
         StyleBox["\"BdGState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/BdGState"], 
         StyleBox["\"BdGUnitary\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/BdGUnitary"], 
         StyleBox["\"BdGOperator\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/BdGOperator"], 
         StyleBox["\"NambuMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/NambuMatrix"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "18fa3d1a-91f8-4ca9-b906-3a5bb79666bd"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "ea6c92bf-d869-410e-885a-0ae0c0160dab"]
         }],ExpressionUUID->"57835d23-d89a-41aa-83a6-4649117ce25c"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/QuantumManyBodySystems"], 
         "\"Q3\"" :> Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "bd1468da-8c3c-4f1b-afc4-06a6c2f6c82d"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "0add676e-b296-4c3f-a548-2beab7b39d84"]
         }],ExpressionUUID->"1b556bfd-2537-4a1c-a511-732e4c104f0e"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumManyBodySystems"], "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "cd77754e-136b-4ebd-8a60-4c546d429f30"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "9d7af603-099d-40c8-9679-bc98bd010554"]
         }],ExpressionUUID->"6374bd7b-a3ec-416c-9931-1226d0800379"],
         StripOnInput->False],{
        "\"Q3/ref/WickGreensFunction\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{Cell["Q3/ref/WickGreensFunction"]}, Visible -> 
               DocumentationBuild`Make`Private`visible$29656]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/Q3/ref/\
WickGreensFunction.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> 
               DocumentationBuild`Make`Private`visible$29656]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "Q3/ref/WickGreensFunction" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "61540c31-f6c5-48b0-adec-1c8f6eed93bc"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "0c3fd7da-10a7-4b0b-9e77-c8cb734c6d6a"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"0e805d97-988b-407c-9b51-461d58ea1ade"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"5009fc8d-c1fc-4285-aeaa-1e8228305f2e"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "WickGreensFunction", "ObjectName",ExpressionUUID->
      "e0f7f5df-53d3-4b8a-82d0-465ea024d498"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"1fda1247-e076-421d-84be-60b2337003b8"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "9c7d278b-65f4-4546-a009-76fe70e52bdd"]
    }],ExpressionUUID->"29dc3ddb-6631-47b3-b351-d4fbf20e665b"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "8d672da7-7518-414c-aadd-8a47c228101f"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"393eff38-3c7f-40d8-83db-49aee64b985d"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickGreensFunction"]], "paclet:Q3/ref/WickGreensFunction",
          "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["ws", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "2db30526-6fab-4e34-b3a3-2256d13bdfb8"],
     "\[LineSeparator]returns ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["NambuMatrix"]], "paclet:Q3/ref/NambuMatrix", 
         "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          StyleBox["G", "TI"], ",", 
          StyleBox["F", "TI"]}], "}"}], ",", "\"\<Green's\>\""}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "3e993da1-1575-4a22-a948-90b113dc7307"],
     " with ",
     Cell[BoxData[
      RowBox[{
       StyleBox["n", "TI"], "\[Times]", 
       StyleBox["n", "TI"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "cbd98676-de32-4721-9b1c-4a9b0a7a1333"],
     " matrices ",
     Cell[BoxData[
      StyleBox["G", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "dd43b3fa-d5f9-432b-b35f-ce7fdeb0d983"],
     " and ",
     Cell[BoxData[
      StyleBox["F", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "a4b3d422-abb5-4068-b2e5-4aaf211776b1"],
     " representing the normal and anomalous Green's functions, respectively, \
with respect to Wick state ",
     Cell[BoxData[
      StyleBox["ws", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "dd5554bc-6ccd-44ae-a857-796efe6bc145"],
     " for fermion modes ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["n", "TI"]]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "d577e97f-8105-427d-8855-f84442d8437b"],
     "."
    }],ExpressionUUID->"96aebaca-e30c-4da3-a51b-92735e685990"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickGreensFunction"]], "paclet:Q3/ref/WickGreensFunction",
          "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["ws", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["c", "TI"], 
           SubscriptBox[
            StyleBox["k", "TI"], 
            StyleBox["1", "TR"]]], ",", 
          SubscriptBox[
           StyleBox["c", "TI"], 
           SubscriptBox[
            StyleBox["k", "TI"], 
            StyleBox["2", "TR"]]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "70b77eaa-31d8-4141-aa81-316d8970436a"],
     "\[LineSeparator]computes the Green's function over only the specified \
fermion modes ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         SubscriptBox[
          StyleBox["k", "TI"], 
          StyleBox["1", "TR"]]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         SubscriptBox[
          StyleBox["k", "TI"], 
          StyleBox["2", "TR"]]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "b61d1b3d-6cc1-454e-884b-78c0feb588b9"],
     " (out of all fermion modes ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["n", "TI"]]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "648dd2c9-7d36-444d-b875-cc7ee46d8d2e"],
     " in ",
     Cell[BoxData[
      StyleBox["ws", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "47624cfa-b243-432a-92f5-3fc565f3291c"],
     ")."
    }],ExpressionUUID->"5f2f55e3-1c1d-4dd8-b045-6e939dc60ac2"]}
  }]], "Usage",
 CellID->1552081390,ExpressionUUID->"5ecd6367-9942-4d6e-aa32-c42fbd123e54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"e052f700-5206-4444-b213-d18ecdb4c274"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"5f7b0c42-215b-4a27-9466-df1ceca5f78f"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"04ead560-17cc-498e-afb7-0f9fd387baa4"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"ab37eb4f-2037-43bb-8398-fe822166a22c"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->1798957793,ExpressionUUID->"d572eef4-0a83-4888-9fca-8ee8522a656d"],

Cell[TextData[{
 "The (normal) Green\[CloseCurlyQuote]s function of fermion modes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "k"], TraditionalForm]],ExpressionUUID->
  "d5904cd9-0a07-42b4-85d7-2b562fb6c193"],
 " is defined by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", 
     RowBox[{"i", "\[VeryThinSpace]", "j"}]], ":=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox["c", "i"], 
      SubsuperscriptBox["c", "j", "\[Dagger]"]}], "\[RightAngleBracket]"}]}], 
   TraditionalForm]],ExpressionUUID->"3fba447b-b7a1-47ec-a46d-80759ada45d9"],
 ". The matrix ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],ExpressionUUID->
  "921df96d-df9a-4be5-a1a1-996d5e5d1984"],
 " is Hermitian, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["G", "\[Dagger]"], "=", "G"}], TraditionalForm]],
  ExpressionUUID->"30aec3ec-bc3d-47c0-9087-46309a8bb776"],
 ". The ",
 StyleBox["correlation matrix",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", 
     RowBox[{"i", "\[VeryThinSpace]", "j"}]], ":=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       SubsuperscriptBox["c", "i", "\[Dagger]"], 
       SubscriptBox["c", "j"]}], "\[RightAngleBracket]"}], "\[Congruent]", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"I", "-", 
        SuperscriptBox["G", "T"]}], ")"}], 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"4477d129-26d4-40d9-9274-d1752905a7e9"],
 " has equivalent information and is also frequently used."
}], "Notes",
 CellID->348061621,ExpressionUUID->"0df520ba-a728-4dd0-a60d-791970800399"],

Cell[TextData[{
 "The anomalous Green\[CloseCurlyQuote]s function of fermion modes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "k"], TraditionalForm]],ExpressionUUID->
  "5fa543d5-20d2-4e9f-8544-81532452d818"],
 " is defined by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", 
     RowBox[{"i", "\[VeryThinSpace]", "j"}]], ":=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox["c", "i"], 
      SubscriptBox["c", "j"]}], "\[RightAngleBracket]"}]}], TraditionalForm]],
  ExpressionUUID->"fc870943-e4f5-455c-b298-920761e1db08"],
 ". The matrix ",
 Cell[BoxData[
  FormBox["F", TraditionalForm]],ExpressionUUID->
  "fafd0258-53c5-4cb4-af92-78998fc1c953"],
 " is skew-symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["F", "T"], "=", 
    RowBox[{"-", "F"}]}], TraditionalForm]],ExpressionUUID->
  "f8908447-a24b-4d6f-bcbf-39d89e0d0c0d"],
 "."
}], "Notes",
 CellID->1383491325,ExpressionUUID->"bef8b4ea-3e38-4a67-b7ab-3a5ca349bc7b"],

Cell[TextData[{
 "In the Nambu notation, the full single-particle Green\[CloseCurlyQuote]s \
function is defined to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderscriptBox["G", "_"], ":=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       UnderscriptBox["c", "_"], 
       SuperscriptBox[
        UnderscriptBox["c", "_"], "\[Dagger]"]}], "\[RightAngleBracket]"}], 
     "=", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"G", "F"},
         {
          SuperscriptBox["F", "\[Dagger]"], 
          RowBox[{"I", "-", 
           SuperscriptBox["G", "T"]}]}
        }], ")"}], "=", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"I", "-", 
           SuperscriptBox["C", "T"]}], "F"},
         {
          SuperscriptBox["F", "\[Dagger]"], "C"}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "a53ed94c-8d4f-4cec-939b-1972bc57e0e9"],
 ", where  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     UnderscriptBox["c", "_"], "\[Dagger]"], ":=", 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["c", "1", "\[Dagger]"], ",", "\[Ellipsis]", ",", 
      SubsuperscriptBox["c", "n", "\[Dagger]"], ",", 
      SubscriptBox["c", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "4b8dd307-2be9-4f00-a608-67df530f37d9"],
 " is the Nambu spinor of the fermion modes."
}], "Notes",
 CellID->795234925,ExpressionUUID->"3f91db23-c8f0-4279-b6c0-8d34db223406"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"53540d06-47d8-418c-bffa-e047f9ce7e1d"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"21513163-4e96-44b7-9dbc-5892a7c20551"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "d5f929bb-ed73-482c-be35-f89460340aad"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->661360838,ExpressionUUID->"01ec2fa8-1325-4cb9-8272-2963bed7d800"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1070195861,ExpressionUUID->"bd603189-e058-4bd0-bf70-56b60d45555d"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"45c27619-9cce-4da7-ae36-983e147bb2a5"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3580044b-8102-46de-8d07-6b690044ac32"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "c83d34fc-94f6-4ec6-bd72-ba6fde41e7f0"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->116247394,ExpressionUUID->"ceb8ce18-8da6-4129-9939-3dd146f9da6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "354", "]"}], ";"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->576804685,ExpressionUUID->"c4b8034d-b985-43d8-9498-09fef1ac68d6"],

Cell["The bare modes.", "ExampleText",
 CellID->1240864226,ExpressionUUID->"fe35e0bc-d1f9-4b5e-baf8-fab4552f46fa"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->408820197,ExpressionUUID->"83ef48ef-20f5-432e-aac6-d3f7888ec5b6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->991350365,ExpressionUUID->"214c9160-86f6-4689-bb39-6eb38e81e191"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`c[4]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "5"},
      "RowWithSeparators"]],
    $CellContext`c[5]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1467288376,ExpressionUUID->"e25348d7-16cb-4385-914e-a234509c86ba"]
}, Open  ]],

Cell["Set an initial state.", "ExampleText",
 CellID->616371887,ExpressionUUID->"94d64717-c864-4359-a310-8755d2d2eef9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{"cc", "->", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "$n", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"WickState", "[", "in", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "in", "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->2048675328,ExpressionUUID->"56ef9b36-aa37-4088-8e92-ebb4f40f71bc"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`c[1]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`c[2]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`c[3]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`c[4]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"]], 
          $CellContext`c[5]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
    1, $CellContext`c[4] -> 0, $CellContext`c[5] -> 1|>]]], "Output",
 CellLabel->"Out[4]=",
 CellID->306316208,ExpressionUUID->"5e59a4a7-0a31-4b40-87d0-33aa34f1e963"]
}, Open  ]],

Cell["Define a non-unitary time-evolution operator.", "ExampleText",
 CellID->1286973786,ExpressionUUID->"037a8c96-abc8-4b9c-827d-d9a7f69e8f0e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"non", "=", 
   RowBox[{
    RowBox[{"RandomHermitian", "[", "$n", "]"}], "-", 
    RowBox[{"I", "*", 
     RowBox[{
      RowBox[{"RandomHermitian", "[", "$n", "]"}], "/", "5"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"non", "=", 
  RowBox[{"WickGaussian", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], "*", "non"}], "]"}], ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"+", "I"}], "*", "non"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->506039615,ExpressionUUID->"a198fec4-4213-4f61-8635-2c5687ced69e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickGaussian",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Non-unitary\"", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Non-unitary\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transform: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.4171982441380032`"}], "+", 
                    RowBox[{"0.704988519637621`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.17051312908869018`"}], "+", 
                    RowBox[{"0.1550914038392988`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.13869846458697088`"}], "+", 
                    RowBox[{"0.055818249127921174`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.1371513339334084`"}], "+", 
                    RowBox[{"0.2530650096489441`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.12138487538060098`"}], "+", 
                    RowBox[{"0.22930568485594255`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.5366849005374477`"}], "+", 
                    RowBox[{"0.08851986939510978`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.08129645257035963`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.2026475339922144`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.15457622674201804`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.3357749833464141`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.4156752099622119`"}], "-", 
                    RowBox[{"0.045988248923390596`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.2873246587168593`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.12001399342229137`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.6198884689665758`"}], "+", 
                    RowBox[{"0.4366729369552919`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.11616694193685921`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.4307630782352543`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.21169460209201754`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.12146898986158927`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.1522047738129341`"}], "+", 
                    RowBox[{"0.04172987781856368`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.057940168396266804`"}], "+", 
                    RowBox[{"0.05704757439022534`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.5152462443231293`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{"0.48375923304376917`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.4899491861129251`"}], "-", 
                    RowBox[{"0.7187903749705047`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.2795419756053968`"}], "-", 
                    RowBox[{"0.2976474905790625`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.24550944936937572`"}], "-", 
                    RowBox[{"0.15400743279851858`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.1807510343641748`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{"0.23217986258135195`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.14101734509027825`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.45492031671390476`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.6229230025295084`"}], "-", 
                    RowBox[{"0.025506217302299253`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.4028401119798151`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.3149498472625833`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.022636744320051014`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.10705489190486411`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.00356039794179918`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.24058574900909477`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.324757980898333`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.16292653380591268`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.7649974216652784`"}], "-", 
                    RowBox[{"0.3037705479780939`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.20089818784823987`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.1404240607813383`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.0065137515410379696`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.26983183164689317`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.3971813518461731`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.558960469107107`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.26358592393613933`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.3690656259766181`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.34449386749865096`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.6537662307031683`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  {{Complex[-0.4171982441380032, 0.704988519637621], 
   Complex[-0.17051312908869018`, 0.1550914038392988], 
   Complex[-0.13869846458697088`, 0.055818249127921174`], 
   Complex[-0.1371513339334084, 0.2530650096489441], Complex[
   0.07877864345032703, -0.29066468360822284`]}, {
   Complex[-0.12138487538060098`, 0.22930568485594255`], 
   Complex[-0.5366849005374477, 0.08851986939510978], Complex[
   0.08129645257035963, -0.2026475339922144], Complex[
   0.15457622674201804`, -0.3357749833464141], Complex[-0.38612840313848695`, 
   0.0207231361325323]}, {
   Complex[-0.4156752099622119, -0.045988248923390596`], Complex[
   0.2873246587168593, 0.12001399342229137`], Complex[-0.6198884689665758, 
   0.4366729369552919], Complex[0.11616694193685921`, -0.4307630782352543], 
   Complex[-0.06828556860305944, 0.03390470677502281]}, {Complex[
   0.21169460209201754`, -0.12146898986158927`], Complex[-0.1522047738129341, 
   0.04172987781856368], Complex[-0.057940168396266804`, 0.05704757439022534],
    Complex[0.5152462443231293, -0.48375923304376917`], Complex[
   0.4965576876001562, -0.28645412638295914`]}, {Complex[
   0.13893290421270085`, -0.22561518478715564`], Complex[-0.2558113613883872, 
   0.7938687926602412], Complex[-0.19316730920188666`, 0.6484409552436916], 
   Complex[0.23361075189611313`, -0.05604014860656904], 
   Complex[-0.10650220605323765`, -0.20443721176178087`]}},
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[5]=",
 CellID->1159855816,ExpressionUUID->"8ad53edd-391d-4cb2-b4ce-db02cfffeee9"]
}, Open  ]],

Cell["\<\
Operate the non-unitary evolution operator on the above initial state.\
\>", "ExampleText",
 CellID->2080173378,ExpressionUUID->"5a5c021a-60c5-402e-9edd-aa2cebc6adb2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ws", "=", 
  RowBox[{"non", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->1866836762,ExpressionUUID->"b15799cb-c82e-41e9-9333-b8a15a9c046f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"]], 
                    $CellContext`c[5]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"]], 
                    $CellContext`c[5]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operator transforms: \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.4171982441380032`"}], "+", 
                    RowBox[{"0.704988519637621`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.12138487538060098`"}], "+", 
                    RowBox[{"0.22930568485594255`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.4156752099622119`"}], "-", 
                    RowBox[{"0.045988248923390596`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.21169460209201754`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{
                    "0.12146898986158927`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.13869846458697088`"}], "+", 
                    RowBox[{"0.055818249127921174`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.08129645257035963`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.2026475339922144`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.6198884689665758`"}], "+", 
                    RowBox[{"0.4366729369552919`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.057940168396266804`"}], "+", 
                    
                    RowBox[{
                    "0.05704757439022534`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07877864345032703`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.29066468360822284`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.38612840313848695`"}], "+", 
                    RowBox[{"0.0207231361325323`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.06828556860305944`"}], "+", 
                    RowBox[{"0.03390470677502281`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.4965576876001562`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{
                    "0.28645412638295914`", " ", "\[ImaginaryI]"}]}]}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`WickState[{
   Q3`Dagger -> {Complex[-0.4171982441380032, 0.704988519637621], 
     Complex[-0.12138487538060098`, 0.22930568485594255`], 
     Complex[-0.4156752099622119, -0.045988248923390596`], Complex[
     0.21169460209201754`, -0.12146898986158927`], Complex[
     0.13893290421270085`, -0.22561518478715564`]}, 
    Q3`Dagger -> {Complex[-0.13869846458697088`, 0.055818249127921174`], 
     Complex[0.08129645257035963, -0.2026475339922144], 
     Complex[-0.6198884689665758, 0.4366729369552919], 
     Complex[-0.057940168396266804`, 0.05704757439022534], 
     Complex[-0.19316730920188666`, 0.6484409552436916]}, 
    Q3`Dagger -> {Complex[0.07877864345032703, -0.29066468360822284`], 
     Complex[-0.38612840313848695`, 0.0207231361325323], 
     Complex[-0.06828556860305944, 0.03390470677502281], Complex[
     0.4965576876001562, -0.28645412638295914`], 
     Complex[-0.10650220605323765`, -0.20443721176178087`]}}, {
    $CellContext`c[1], 
    $CellContext`c[2], 
    $CellContext`c[3], 
    $CellContext`c[4], 
    $CellContext`c[5]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[6]=",
 CellID->1118796585,ExpressionUUID->"6c2baca1-aa6a-467c-9c32-0b2889838f19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NormSquare", "[", "ws", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->1069082772,ExpressionUUID->"29cedba6-39b7-4125-8827-4c010050dd5b"],

Cell[BoxData["0.681146510750619`"], "Output",
 CellLabel->"Out[7]=",
 CellID->113335102,ExpressionUUID->"0bbfd78f-6f88-4629-99fe-78d3320fbd08"]
}, Open  ]],

Cell["\<\
Calculate the Green's functions associated with the noisy Wick state.\
\>", "ExampleText",
 CellID->646584999,ExpressionUUID->"a7e40d1c-a29c-463c-9db9-ef206312e38d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"WickGreensFunction", "[", 
    RowBox[{"ws", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->366886627,ExpressionUUID->"de574498-e404-479e-b670-c92acdab66a4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.13303891621297698`", 
      RowBox[{
       RowBox[{"-", "0.0908435156317484`"}], "-", 
       RowBox[{"0.09435858162884231`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0764141260091103`"}], "+", 
       RowBox[{"0.13341579887141486`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.03989505659319184`"}], "+", 
       RowBox[{"0.0326758293763644`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0908435156317484`"}], "+", 
       RowBox[{"0.09435858162884231`", " ", "\[ImaginaryI]"}]}], 
      "0.4455969008768674`", 
      RowBox[{"0.00661935525038896`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06586241633297525`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24868764562333087`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.097938512847421`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0764141260091103`"}], "-", 
       RowBox[{"0.13341579887141486`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00661935525038896`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06586241633297525`", " ", "\[ImaginaryI]"}]}], 
      "0.20521547215550384`", 
      RowBox[{"0.130855588588444`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.017109153812375547`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.03989505659319184`"}], "-", 
       RowBox[{"0.0326758293763644`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24868764562333087`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.097938512847421`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.130855588588444`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.017109153812375547`", " ", "\[ImaginaryI]"}]}], 
      "0.2786592383337565`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {3}, {4}, {3}, {
       1}, {2}, {4}, {4}, {1}, {2}, {3}}}, {
      0.13303891621297698`, 
       Complex[-0.0908435156317484, -0.09435858162884231], 
       Complex[-0.0764141260091103, 0.13341579887141486`], 
       Complex[-0.03989505659319184, 0.0326758293763644], 0.4455969008768674, 
       Complex[-0.0908435156317484, 0.09435858162884231], Complex[
       0.00661935525038896, -0.06586241633297525], Complex[
       0.24868764562333087`, 0.097938512847421], 0.20521547215550384`, 
       Complex[-0.0764141260091103, -0.13341579887141486`], Complex[
       0.00661935525038896, 0.06586241633297525], Complex[
       0.130855588588444, -0.017109153812375547`], 0.2786592383337565, 
       Complex[-0.03989505659319184, -0.0326758293763644], Complex[
       0.24868764562333087`, -0.097938512847421], Complex[
       0.130855588588444, 0.017109153812375547`]}}], {}]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1164624709,ExpressionUUID->"07e70c70-84fe-4295-bc5b-0527c06fb226"]
}, Open  ]],

Cell["\<\
Now, let us verify the above result by computing the Green's functions in the \
conventional way.\
\>", "ExampleText",
 CellID->1904178883,ExpressionUUID->"c5908881-1623-438f-bc04-dfcfa5be3020"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"alt", "=", 
   RowBox[{"Elaborate", "[", "ws", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{
     RowBox[{"Dagger", "[", "alt", "]"}], "**", 
     RowBox[{"Outer", "[", 
      RowBox[{"Multiply", ",", "cc", ",", 
       RowBox[{"Dagger", "@", "cc"}]}], "]"}], "**", "alt"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->890962738,ExpressionUUID->"7ba18549-dc79-4f9c-845a-b61bf6ecbf38"],

Cell[BoxData["1.19509`"], "EchoTiming",
 CellID->1339990444,ExpressionUUID->"9c4f40d5-ba55-4026-b245-be2a2975955c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.13303891621297698`", 
      RowBox[{
       RowBox[{"-", "0.09084351563174842`"}], "-", 
       RowBox[{"0.09435858162884231`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.07641412600911032`"}], "+", 
       RowBox[{"0.1334157988714148`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.03989505659319185`"}], "+", 
       RowBox[{"0.03267582937636435`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.09084351563174842`"}], "+", 
       RowBox[{"0.09435858162884231`", " ", "\[ImaginaryI]"}]}], 
      "0.44559690087686743`", 
      RowBox[{"0.006619355250388958`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06586241633297525`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24868764562333082`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09793851284742099`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.07641412600911032`"}], "-", 
       RowBox[{"0.1334157988714148`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.006619355250388958`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06586241633297525`", " ", "\[ImaginaryI]"}]}], 
      "0.20521547215550387`", 
      RowBox[{"0.13085558858844396`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.01710915381237553`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.03989505659319185`"}], "-", 
       RowBox[{"0.03267582937636435`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24868764562333082`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09793851284742099`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.13085558858844396`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.01710915381237553`", " ", "\[ImaginaryI]"}]}], 
      "0.2786592383337565`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, {}]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->558386219,ExpressionUUID->"bd762b13-d4af-49e5-912e-d8c152b714cc"]
}, Open  ]],

Cell["Compare the results.", "ExampleText",
 CellID->1358460726,ExpressionUUID->"fb8fd635-f1b8-456a-a1c0-2b9127f7faca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gg", "-", "new"}], "//", "Chop"}], "//", "ArrayShort"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[10]:=",
 CellID->1525269532,ExpressionUUID->"12bae6f7-b904-42e0-b55f-d1755f49379e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, {}]]]], "Output",
 CellLabel->"Out[10]//MatrixForm=",
 CellID->579109312,ExpressionUUID->"acbced73-8679-4800-8bd2-2b6bb6c11438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gg", "-", "new"}], "//", "Chop"}], "//", "Flatten"}], ",", 
   "0"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[11]:=",
 CellID->1205688208,ExpressionUUID->"ae7136ea-855f-4523-a051-803167a033f4"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[11]=",
 CellID->674099364,ExpressionUUID->"d37607b0-bab3-45b3-b151-ffe47a4c47c8"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WickGreensFunction"]], "paclet:Q3/ref/WickGreensFunction", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "09306b9b-33c8-4416-936c-db77c126c377"],
 " assumes the noisy Wick state is normalized. In this particular example, it \
is not. We need to normalize the Green's functions manually. (This might be \
changed in the future version.)"
}], "ExampleText",
 CellID->1611772823,ExpressionUUID->"57399638-e4d4-4452-a262-60671c8ce1d6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ggg", "=", 
   RowBox[{"gg", "/", 
    RowBox[{"NormSquare", "[", "ws", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ggg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[12]:=",
 CellID->151650472,ExpressionUUID->"c2010832-46ab-45c0-8314-5eda162e86f4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.19531615315237974`", 
      RowBox[{
       RowBox[{"-", "0.1333685399513233`"}], "-", 
       RowBox[{"0.13852905379322836`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11218456646706217`"}], "+", 
       RowBox[{"0.19586945945651474`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.05857044844761481`"}], "+", 
       RowBox[{"0.0479718076223511`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1333685399513233`"}], "+", 
       RowBox[{"0.13852905379322836`", " ", "\[ImaginaryI]"}]}], 
      "0.6541865719694027`", 
      RowBox[{"0.009717961034689106`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09669346505261445`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3651015481959655`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14378479710553518`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.11218456646706217`"}], "-", 
       RowBox[{"0.19586945945651474`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.009717961034689106`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09669346505261445`", " ", "\[ImaginaryI]"}]}], 
      "0.3012794882107782`", 
      RowBox[{"0.19211078163527842`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.02511816994191363`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.05857044844761481`"}], "-", 
       RowBox[{"0.0479718076223511`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3651015481959655`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.14378479710553518`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.19211078163527842`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.02511816994191363`", " ", "\[ImaginaryI]"}]}], 
      "0.4091032310019115`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {3}, {4}, {3}, {
       1}, {2}, {4}, {4}, {1}, {2}, {3}}}, {
      0.19531615315237974`, 
       Complex[-0.1333685399513233, -0.13852905379322836`], 
       Complex[-0.11218456646706217`, 0.19586945945651474`], 
       Complex[-0.05857044844761481, 0.0479718076223511], 0.6541865719694027, 
       Complex[-0.1333685399513233, 0.13852905379322836`], Complex[
       0.009717961034689106, -0.09669346505261445], Complex[
       0.3651015481959655, 0.14378479710553518`], 0.3012794882107782, 
       Complex[-0.11218456646706217`, -0.19586945945651474`], Complex[
       0.009717961034689106, 0.09669346505261445], Complex[
       0.19211078163527842`, -0.02511816994191363], 0.4091032310019115, 
       Complex[-0.05857044844761481, -0.0479718076223511], Complex[
       0.3651015481959655, -0.14378479710553518`], Complex[
       0.19211078163527842`, 0.02511816994191363]}}], {}]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->895862348,ExpressionUUID->"c36c6021-559f-4a5a-beee-6ecdd798e66b"]
}, Open  ]],

Cell["\<\
Check that all eigenvalues of the Green's function matrix lie between 0 and 1.\
\>", "ExampleText",
 CellID->374649487,ExpressionUUID->"6cf54ea4-acc9-4da7-8f49-fb8622e736cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigenvalues", "[", "ggg", "]"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[13]:=",
 CellID->1967000432,ExpressionUUID->"4f6f5220-3cdf-4adc-a818-5923ca36a5d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0000000000000004`", ",", "0.9999999999999998`", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellLabel->"Out[13]=",
 CellID->259304973,ExpressionUUID->"7ce70868-9ce1-4421-a9fa-6f85038fd91e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "a2001572-31cd-4b95-b806-a456ff878e8a"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->638164847,ExpressionUUID->"36efed70-f9e7-4048-86ee-6b53adb68082"],

Cell[TextData[{
 "Here is another example using ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WickOperator"]], "paclet:Q3/ref/WickOperator", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3f47e591-7e2c-483a-9ca7-2ea814bb30b3"],
 "."
}], "ExampleText",
 CellID->1997299767,ExpressionUUID->"9e07e093-58d9-4125-a86a-e257ee0528d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "354", "]"}], ";"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1180578376,ExpressionUUID->"506c0cf3-5c73-43aa-ab59-81d3dca6661b"],

Cell["The bare modes.", "ExampleText",
 CellID->1070147002,ExpressionUUID->"12de9134-ac6c-48a4-b451-1e9543fb8b53"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1515066942,ExpressionUUID->"cbdc26d0-8a34-4c2b-8e85-cb497fdbe73a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->354468647,ExpressionUUID->"1233ca0b-abc1-4dc0-9292-63cbec13d9c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`c[4]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "5"},
      "RowWithSeparators"]],
    $CellContext`c[5]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->557648950,ExpressionUUID->"7b935e2a-154a-48b6-a83a-041a65ae7270"]
}, Open  ]],

Cell["Set an initial state.", "ExampleText",
 CellID->501009457,ExpressionUUID->"c3b4c4e5-ef11-485c-8571-df84bda09708"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{"cc", "->", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "$n", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"WickState", "[", "in", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Elaborate", "[", "in", "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1526959957,ExpressionUUID->"62b5a072-2ccb-42a5-9838-4b1eb8306662"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`c[1]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`c[2]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`c[3]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`c[4]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"]], 
          $CellContext`c[5]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
    1, $CellContext`c[4] -> 0, $CellContext`c[5] -> 1|>]]], "Output",
 CellLabel->"Out[4]=",
 CellID->1219504959,ExpressionUUID->"a13cd4e3-3ef6-4fa4-ad7c-d273d104ecc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$N", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"RandomMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"$N", ",", "$n"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dd", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"mm", ".", "cc"}], ",", 
    RowBox[{"mm", ".", 
     RowBox[{"Dagger", "[", "cc", "]"}]}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1842944571,ExpressionUUID->"31269647-80df-4e63-a339-d9ec9616562e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.5375525539458578`"}], "+", 
       RowBox[{"0.2771998008132765`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.191232291739151`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6911328036372765`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`c[2]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.34225286838960506`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.45856594919284954`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`c[3]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.19002350748555746`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3815486295255058`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`c[4]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.9169605416251648`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.20046069611801`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "5"},
        "RowWithSeparators"]],
      $CellContext`c[5]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.6616935824512652`"}], "+", 
       RowBox[{"0.3020710480121508`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.3332132716335892`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6630454802653405`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`c[2]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.4714118624210524`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7974018176166241`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`c[3]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.4429715097804307`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.8318881461257299`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`c[4]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.6083374117631575`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.10120823521481331`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "5"},
        "RowWithSeparators"]],
      $CellContext`c[5]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.5375525539458578`"}], "+", 
       RowBox[{"0.2771998008132765`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.191232291739151`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6911328036372765`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[2]]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.34225286838960506`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.45856594919284954`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[3]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.19002350748555746`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3815486295255058`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[4]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.9169605416251648`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.20046069611801`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[5]]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.6616935824512652`"}], "+", 
       RowBox[{"0.3020710480121508`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.3332132716335892`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6630454802653405`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[2]]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.4714118624210524`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7974018176166241`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[3]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.4429715097804307`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.8318881461257299`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[4]]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.6083374117631575`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.10120823521481331`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"c", 
        TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
       "Subsuperscript"],
      Q3`Dagger[
       $CellContext`c[5]]]}]}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->584496245,ExpressionUUID->"17d571c7-aa24-403e-8c69-ddfd6dd248ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jmp", "=", 
  RowBox[{"WickOperatorFor", "[", 
   RowBox[{"dd", ",", "cc"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->697768032,ExpressionUUID->"5baf7a26-0d05-46e7-90cf-ff3c6a65ea89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickOperator",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"], 
               ImageSizeCache -> {
                9.875531250000002, {0., 9.875531250000002}}], Appearance -> 
              None, BaseStyle -> {}, 
              ButtonFunction :> (Typeset`open$$ = True), Evaluator -> 
              Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}}, AutoDelete -> False, 
             BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {
              "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
          False, BaselinePosition -> {1, 1}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True -> 
        GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"], 
               ImageSizeCache -> {
                9.875531250000002, {0., 9.875531250000002}}], Appearance -> 
              None, BaseStyle -> {}, 
              ButtonFunction :> (Typeset`open$$ = False), Evaluator -> 
              Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transforms: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.5375525539458578`"}], "+", 
                    RowBox[{"0.2771998008132765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{"1.191232291739151`", "\[VeryThinSpace]", "-", 
                    RowBox[{"0.6911328036372765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.34225286838960506`"}], "-", 
                    RowBox[{"0.45856594919284954`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{"0.19002350748555746`", "\[VeryThinSpace]", "+", 
                    RowBox[{"0.3815486295255058`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.6616935824512652`"}], "+", 
                    RowBox[{"0.3020710480121508`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{"1.3332132716335892`", "\[VeryThinSpace]", "-", 
                    RowBox[{"0.6630454802653405`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "1.4714118624210524`"}], "+", 
                    RowBox[{"0.7974018176166241`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{"0.4429715097804307`", "\[VeryThinSpace]", "+", 
                    RowBox[{"0.8318881461257299`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.5375525539458578`"}], "+", 
                    RowBox[{"0.2771998008132765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{"1.191232291739151`", "\[VeryThinSpace]", "-", 
                    RowBox[{"0.6911328036372765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.34225286838960506`"}], "-", 
                    RowBox[{"0.45856594919284954`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{"0.19002350748555746`", "\[VeryThinSpace]", "+", 
                    RowBox[{"0.3815486295255058`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.6616935824512652`"}], "+", 
                    RowBox[{"0.3020710480121508`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{"1.3332132716335892`", "\[VeryThinSpace]", "-", 
                    RowBox[{"0.6630454802653405`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "1.4714118624210524`"}], "+", 
                    RowBox[{"0.7974018176166241`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{"0.4429715097804307`", "\[VeryThinSpace]", "+", 
                    RowBox[{"0.8318881461257299`", " ", "\[ImaginaryI]"}]}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Center}}, "Rows" -> {{Baseline}}}, 
                    GridBoxSpacings -> {"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}}], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], "SummaryItem"]}]}}, 
             AutoDelete -> False, 
             BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {
              "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
          False, BaselinePosition -> {1, 1}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  {{Complex[-0.5375525539458578, 0.2771998008132765], Complex[
   1.191232291739151, -0.6911328036372765], 
   Complex[-0.34225286838960506`, -0.45856594919284954`], Complex[
   0.19002350748555746`, 0.3815486295255058], Complex[0.9169605416251648, 
   1.20046069611801]}, {Complex[-0.6616935824512652, 0.3020710480121508], 
   Complex[1.3332132716335892`, -0.6630454802653405], 
   Complex[-1.4714118624210524`, 0.7974018176166241], Complex[
   0.4429715097804307, 0.8318881461257299], Complex[-0.6083374117631575, 
   0.10120823521481331`]}, {Complex[-0.5375525539458578, 0.2771998008132765], 
   Complex[1.191232291739151, -0.6911328036372765], 
   Complex[-0.34225286838960506`, -0.45856594919284954`], Complex[
   0.19002350748555746`, 0.3815486295255058], Complex[0.9169605416251648, 
   1.20046069611801]}, {Complex[-0.6616935824512652, 0.3020710480121508], 
   Complex[1.3332132716335892`, -0.6630454802653405], 
   Complex[-1.4714118624210524`, 0.7974018176166241], Complex[
   0.4429715097804307, 0.8318881461257299], Complex[-0.6083374117631575, 
   0.10120823521481331`]}},
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[6]=",
 CellID->1560010347,ExpressionUUID->"8ab4dadc-b1a5-406f-ab91-2b1f2c478e44"]
}, Open  ]],

Cell["Operate the quantum jump operator on the initial state.", "ExampleText",
 CellID->357527536,ExpressionUUID->"7c985c81-4dae-4d1a-a005-ca1b1ccfa7e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ws", "=", 
  RowBox[{"jmp", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->422859641,ExpressionUUID->"bbac59b0-3942-4861-ad22-9c23011d5487"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"]], 
                    $CellContext`c[5]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "5"}, "RowWithSeparators"]], 
                    $CellContext`c[5]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operator transforms: \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.5375525539458578`"}], "+", 
                    RowBox[{"0.2771998008132765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"1.191232291739151`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.6911328036372765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.34225286838960506`"}], "-", 
                    RowBox[{"0.45856594919284954`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.19002350748555746`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.3815486295255058`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.6616935824512652`"}], "+", 
                    RowBox[{"0.3020710480121508`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"1.3332132716335892`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.6630454802653405`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "1.4714118624210524`"}], "+", 
                    RowBox[{"0.7974018176166241`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.4429715097804307`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.8318881461257299`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.5375525539458578`"}], "+", 
                    RowBox[{"0.2771998008132765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"1.191232291739151`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.6911328036372765`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.34225286838960506`"}], "-", 
                    RowBox[{"0.45856594919284954`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.19002350748555746`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.3815486295255058`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.6616935824512652`"}], "+", 
                    RowBox[{"0.3020710480121508`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"1.3332132716335892`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.6630454802653405`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "1.4714118624210524`"}], "+", 
                    RowBox[{"0.7974018176166241`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.4429715097804307`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.8318881461257299`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`WickState[{
   Identity -> {Complex[-0.5375525539458578, 0.2771998008132765], Complex[
     1.191232291739151, -0.6911328036372765], 
     Complex[-0.34225286838960506`, -0.45856594919284954`], Complex[
     0.19002350748555746`, 0.3815486295255058], Complex[0.9169605416251648, 
     1.20046069611801]}, 
    Identity -> {Complex[-0.6616935824512652, 0.3020710480121508], Complex[
     1.3332132716335892`, -0.6630454802653405], Complex[-1.4714118624210524`, 
     0.7974018176166241], Complex[0.4429715097804307, 0.8318881461257299], 
     Complex[-0.6083374117631575, 0.10120823521481331`]}, 
    Q3`Dagger -> {Complex[-0.5375525539458578, 0.2771998008132765], Complex[
     1.191232291739151, -0.6911328036372765], 
     Complex[-0.34225286838960506`, -0.45856594919284954`], Complex[
     0.19002350748555746`, 0.3815486295255058], Complex[0.9169605416251648, 
     1.20046069611801]}, 
    Q3`Dagger -> {Complex[-0.6616935824512652, 0.3020710480121508], Complex[
     1.3332132716335892`, -0.6630454802653405], Complex[-1.4714118624210524`, 
     0.7974018176166241], Complex[0.4429715097804307, 0.8318881461257299], 
     Complex[-0.6083374117631575, 0.10120823521481331`]}, Q3`Dagger -> 
    SparseArray[Automatic, {5}, 0, {1, {{0, 1}, {{1}}}, {1}}], Q3`Dagger -> 
    SparseArray[Automatic, {5}, 0, {1, {{0, 1}, {{3}}}, {1}}], Q3`Dagger -> 
    SparseArray[Automatic, {5}, 0, {1, {{0, 1}, {{5}}}, {1}}]}, {
    $CellContext`c[1], 
    $CellContext`c[2], 
    $CellContext`c[3], 
    $CellContext`c[4], 
    $CellContext`c[5]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[7]=",
 CellID->2063466143,ExpressionUUID->"e28cf5fc-018e-4a63-be3d-21b7ff368f8b"]
}, Open  ]],

Cell["\<\
Note that this state is not normalized since the process is non-unitary.\
\>", "ExampleText",
 CellID->1214338793,ExpressionUUID->"9f5cc38c-b1b5-412f-810f-be26c28d1eef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NormSquare", "[", "ws", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->1465007594,ExpressionUUID->"aa216960-8d42-40de-84ae-3d33d95675b3"],

Cell[BoxData["12.395677372178104`"], "Output",
 CellLabel->"Out[8]=",
 CellID->1631738415,ExpressionUUID->"a8a68aca-5631-4124-bd83-55236a9f7b7b"]
}, Open  ]],

Cell["\<\
Calculate the Green's functions associated with the noisy Wick state.\
\>", "ExampleText",
 CellID->1261368715,ExpressionUUID->"b460415e-a720-4f5c-80b8-7d6ce5d7ba78"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"WickGreensFunction", "[", 
    RowBox[{"ws", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->986963702,ExpressionUUID->"e088ebb2-f1ef-4f99-b6cd-93d6b3de6a93"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.2917798919745345`", 
      RowBox[{
       RowBox[{"-", "2.782092489328799`"}], "+", 
       RowBox[{"0.11029747989350747`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6464789643192557`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.41234449863832745`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06060511273177854`"}], "-", 
       RowBox[{"1.3123589142901158`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "2.782092489328799`"}], "-", 
       RowBox[{"0.11029747989350747`", " ", "\[ImaginaryI]"}]}], 
      "6.046124051891309`", 
      RowBox[{
       RowBox[{"-", "3.0646482878531156`"}], "-", 
       RowBox[{"1.1555834799613298`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.023537212530643226`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.7167329032974203`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"1.6464789643192557`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.41234449863832745`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "3.0646482878531156`"}], "+", 
       RowBox[{"1.1555834799613298`", " ", "\[ImaginaryI]"}]}], 
      "7.0175550314055055`", 
      RowBox[{
       RowBox[{"-", "0.12146246374108194`"}], "-", 
       RowBox[{"2.7791984838942696`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.06060511273177854`"}], "+", 
       RowBox[{"1.3123589142901158`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.023537212530643226`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.7167329032974203`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.12146246374108194`"}], "+", 
       RowBox[{"2.7791984838942696`", " ", "\[ImaginaryI]"}]}], 
      "1.6301967463819986`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {3}, {4}, {3}, {
       1}, {2}, {4}, {4}, {1}, {2}, {3}}}, {
      1.2917798919745345`, Complex[-2.782092489328799, 0.11029747989350747`], 
       Complex[1.6464789643192557`, 0.41234449863832745`], 
       Complex[-0.06060511273177854, -1.3123589142901158`], 6.046124051891309,
        Complex[-2.782092489328799, -0.11029747989350747`], 
       Complex[-3.0646482878531156`, -1.1555834799613298`], Complex[
       0.023537212530643226`, 2.7167329032974203`], 7.0175550314055055`, 
       Complex[1.6464789643192557`, -0.41234449863832745`], 
       Complex[-3.0646482878531156`, 1.1555834799613298`], 
       Complex[-0.12146246374108194`, -2.7791984838942696`], 
       1.6301967463819986`, 
       Complex[-0.06060511273177854, 1.3123589142901158`], Complex[
       0.023537212530643226`, -2.7167329032974203`], 
       Complex[-0.12146246374108194`, 
        2.7791984838942696`]}}], {}]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1003576167,ExpressionUUID->"24311b73-d2cb-4b9f-9145-68014670a392"]
}, Open  ]],

Cell["\<\
Now, let us verify the above result using the conventional method.\
\>", "ExampleText",
 CellID->54296516,ExpressionUUID->"4bd2161e-456f-4868-adde-4ddfea29ba6a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"alt", "=", 
   RowBox[{"Elaborate", "[", "ws", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{
     RowBox[{"Dagger", "[", "alt", "]"}], "**", 
     RowBox[{"Outer", "[", 
      RowBox[{"Multiply", ",", "cc", ",", 
       RowBox[{"Dagger", "@", "cc"}]}], "]"}], "**", "alt"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[10]:=",
 CellID->654174471,ExpressionUUID->"9374aef1-9a45-4405-9d8d-39c448a7be7e"],

Cell[BoxData["1.177984`"], "EchoTiming",
 CellID->259402558,ExpressionUUID->"65ce34ea-08d1-46b2-bf57-515888e52127"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.2917798919745227`", 
      RowBox[{
       RowBox[{"-", "2.782092489328784`"}], "+", 
       RowBox[{"0.11029747989352634`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6464789643192401`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.41234449863830663`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06060511273177377`"}], "-", 
       RowBox[{"1.312358914290128`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "2.782092489328784`"}], "-", 
       RowBox[{"0.11029747989352634`", " ", "\[ImaginaryI]"}]}], 
      "6.0461240518912955`", 
      RowBox[{
       RowBox[{"-", "3.0646482878531036`"}], "-", 
       RowBox[{"1.1555834799613032`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.02353721253065616`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.7167329032974035`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"1.6464789643192401`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.41234449863830663`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "3.0646482878531036`"}], "+", 
       RowBox[{"1.1555834799613032`", " ", "\[ImaginaryI]"}]}], 
      "7.017555031405481`", 
      RowBox[{
       RowBox[{"-", "0.12146246374107761`"}], "-", 
       RowBox[{"2.7791984838942847`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.06060511273177377`"}], "+", 
       RowBox[{"1.312358914290128`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.023537212530656156`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.716732903297404`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.12146246374107761`"}], "+", 
       RowBox[{"2.7791984838942847`", " ", "\[ImaginaryI]"}]}], 
      "1.6301967463819604`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, {}]]]], "Output",
 CellLabel->"Out[10]//MatrixForm=",
 CellID->386988896,ExpressionUUID->"7d61095d-3017-47d4-9c89-2cec16e868af"]
}, Open  ]],

Cell["Compare the two results", "ExampleText",
 CellID->1798939601,ExpressionUUID->"a951aea8-36d0-4877-a255-2620258904b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gg", "-", "new"}], "//", "Chop"}], "//", "ArrayShort"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[11]:=",
 CellID->1410219982,ExpressionUUID->"78c0c6e4-21e9-4e98-a36b-2261e168d902"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, {}]]]], "Output",
 CellLabel->"Out[11]//MatrixForm=",
 CellID->1551658223,ExpressionUUID->"e5d5b88c-f8e9-4b15-a4f6-9538ce0f084e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gg", "-", "new"}], "//", "Chop"}], "//", "Flatten"}], ",", 
   "0"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[12]:=",
 CellID->1086985013,ExpressionUUID->"71a1e92e-7c65-44e1-ab60-20633fcfc5ac"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[12]=",
 CellID->1880305782,ExpressionUUID->"6aee4d86-2766-4e0d-859a-e459b3ff8001"]
}, Open  ]],

Cell["\<\
Recall that the noisy Wick state is not normalized. The Green\
\[CloseCurlyQuote]s function needs to be normalized manually since \
WickGreensFunction assumes the noisy Wick state is normalized (this might be \
changed in the future versions).\
\>", "ExampleText",
 CellID->657344503,ExpressionUUID->"73d3baa0-a24c-48fe-9b35-eff04caa58aa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ggg", "=", 
   RowBox[{"gg", "/", 
    RowBox[{"NormSquare", "[", "ws", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ggg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[13]:=",
 CellID->427940498,ExpressionUUID->"f8988d3f-fe11-4e1f-bd23-fa460ce1c97c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.10421212598465279`", 
      RowBox[{
       RowBox[{"-", "0.22444053727738672`"}], "+", 
       RowBox[{"0.00889805991087412`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.13282686495332244`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.033265184810620185`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0048892134662850886`"}], "-", 
       RowBox[{"0.10587230329466979`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.22444053727738672`"}], "-", 
       RowBox[{"0.00889805991087412`", " ", "\[ImaginaryI]"}]}], 
      "0.48776068224087016`", 
      RowBox[{
       RowBox[{"-", "0.24723524143437847`"}], "-", 
       RowBox[{"0.09322471416971678`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0018988242291197506`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2191677648367231`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.13282686495332244`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.033265184810620185`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24723524143437847`"}], "+", 
       RowBox[{"0.09322471416971678`", " ", "\[ImaginaryI]"}]}], 
      "0.5661292094578303`", 
      RowBox[{
       RowBox[{"-", "0.009798775822747893`"}], "-", 
       RowBox[{"0.2242070683553071`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0048892134662850886`"}], "+", 
       RowBox[{"0.10587230329466979`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0018988242291197506`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2191677648367231`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.009798775822747893`"}], "+", 
       RowBox[{"0.2242070683553071`", " ", "\[ImaginaryI]"}]}], 
      "0.1315133249628575`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {3}, {4}, {3}, {
       1}, {2}, {4}, {4}, {1}, {2}, {3}}}, {
      0.10421212598465279`, 
       Complex[-0.22444053727738672`, 0.00889805991087412], Complex[
       0.13282686495332244`, 0.033265184810620185`], 
       Complex[-0.0048892134662850886`, -0.10587230329466979`], 
       0.48776068224087016`, 
       Complex[-0.22444053727738672`, -0.00889805991087412], 
       Complex[-0.24723524143437847`, -0.09322471416971678], Complex[
       0.0018988242291197506`, 0.2191677648367231], 0.5661292094578303, 
       Complex[0.13282686495332244`, -0.033265184810620185`], 
       Complex[-0.24723524143437847`, 0.09322471416971678], 
       Complex[-0.009798775822747893, -0.2242070683553071], 
       0.1315133249628575, 
       Complex[-0.0048892134662850886`, 0.10587230329466979`], Complex[
       0.0018988242291197506`, -0.2191677648367231], 
       Complex[-0.009798775822747893, 0.2242070683553071]}}], {}]]]], "Output",\

 CellLabel->"Out[13]//MatrixForm=",
 CellID->774235321,ExpressionUUID->"856c763a-9a54-4f07-bf8c-7ddc126f7387"]
}, Open  ]],

Cell["\<\
Check whether all eigenvalues of the Green's functions matrix lie between 0 \
and 1.\
\>", "ExampleText",
 CellID->197303479,ExpressionUUID->"7b8bb181-b49d-4ac3-bce3-baa3d5a33963"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigenvalues", "[", "ggg", "]"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[14]:=",
 CellID->1825031986,ExpressionUUID->"e9f082af-83c0-4bdb-b106-528925de86d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0000000000000033`", ",", "1.0000000000000007`", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellLabel->"Out[14]=",
 CellID->2037730684,ExpressionUUID->"ec081ada-7837-4d4e-91da-af1708cf5d36"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"b158121a-db36-4d42-8005-a5fcec93f7bd"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"0be86cc7-39a6-4818-b041-2e4d4c777182"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "c8b55110-dba9-4c60-8bca-62092289d9a2"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->778883717,ExpressionUUID->"594667a4-ce46-42c5-b43b-489030e2746f"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"3596a37c-1a61-4fe7-b9fd-26d21e0c442a"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b411b758-070b-4ad7-9b6d-e83d9b38ae07"],
 "BdGState",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "7126d7a2-beb6-45bd-af99-0bfac4ad4223"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1116349899,ExpressionUUID->"4e9ad41d-1bd9-462f-88ae-9c6d31cf960e"],

Cell[TextData[{
 "Consider a set of ",
 StyleBox["n",
  FontSlant->"Italic"],
 " fermionic modes."
}], "ExampleText",
 CellID->857188823,ExpressionUUID->"338220fc-c200-4ded-8284-02d02a633c0c"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1720633530,ExpressionUUID->"b017b141-e895-41fb-bb2b-83f80a421636"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cd", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"Dagger", "@", "cc"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1101815844,ExpressionUUID->"65f26cad-6025-4ebf-94ca-d92b105f2774"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`c[4]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->36168252,ExpressionUUID->"cbb3d6af-7ae6-45a6-9da3-bd18f7b32359"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`c[4]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[3]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[4]]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->141939263,ExpressionUUID->"a7215a8b-8534-43e3-8eb6-a697d6db2454"]
}, Open  ]],

Cell["\<\
Examples here include generating random numbers. To get the same result every \
time you try this example, set the seed of the random number generator.\
\>", "ExampleText",
 CellID->1024190994,ExpressionUUID->"93bb49c0-c8e7-4cb0-b4df-6fcc78a62579"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "354", "]"}], ";"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->192352138,ExpressionUUID->"2e76e02a-b8e8-4f14-a661-d86d6fc3bd28"],

Cell["\<\
Take a single-particle unitary evolution in the Nambu space. Note that due to \
the particle-hole symmetry, the above unitary matrix has redundant blocks. \
Extract the minimal blocks. Recall the convention:\
\>", "ExampleText",
 CellID->2002615694,ExpressionUUID->"8e2cbe84-fdda-4374-a731-2e5b46dac984"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderscriptBox["c", "_"], " ", "\[RightTeeArrow]", 
    RowBox[{
     UnderscriptBox["U", "_"], " ", 
     UnderscriptBox["c", "_"], " "}]}], TraditionalForm]],ExpressionUUID->
  "61041f1c-7c93-471e-952e-b03c80abeb50"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     UnderscriptBox["c", "_"], "\[Dagger]"], ":=", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["c", "n"], ",", 
      SubsuperscriptBox["c", "1", "\[Dagger]"], ",", "\[Ellipsis]", ",", 
      SubsuperscriptBox["c", "n", "\[Dagger]"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"94453209-c9dc-4cdf-b90d-79b90f8b410d"],
 " and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderscriptBox["U", "_"], ":=", 
    RowBox[{"(", GridBox[{
       {"U", "V"},
       {
        SuperscriptBox["V", "*"], 
        SuperscriptBox["U", "*"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "2940fb4b-7c71-48d7-bad8-7e8771f8886a"],
 "."
}], "ExampleText",
 CellID->450769627,ExpressionUUID->"12dc9d0c-5a28-4ef1-91c8-d07c1907f996"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wu", "=", 
  RowBox[{"BdGUnitary", "[", 
   RowBox[{
    RowBox[{"NambuRandomMatrix", "[", 
     RowBox[{"$n", ",", "\"\<Unitary\>\""}], "]"}], ",", "cc"}], 
   "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1855946863,ExpressionUUID->"de0648eb-6284-43b7-9417-0dc0c2de8aef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BdGUnitary",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Blocks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.29782049126244`"}], "+", 
                    RowBox[{"0.07010037722320996`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.3689114350133573`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.2147196376882074`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.3062218806199851`"}], "-", 
                    RowBox[{"0.05311492846869014`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.41510517266995395`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.05861853207393349`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.2145176955572163`"}], "-", 
                    RowBox[{"0.1945130487677691`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.05459644533848827`"}], "-", 
                    RowBox[{"0.3586058774319928`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.470165919042878`"}], "-", 
                    RowBox[{"0.2585196818943845`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.25719285218490234`"}], "-", 
                    
                    RowBox[{"0.24245414496714793`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.276195570420626`"}], "+", 
                    RowBox[{"0.010000651088534701`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.10023861977881143`"}], "+", 
                    RowBox[{"0.4781091139697569`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.24155477120632293`"}], "+", 
                    RowBox[{"0.20850733108432815`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.20179906864512334`"}], "-", 
                    RowBox[{"0.3265419374085345`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.062476011219438514`", "\[VeryThinSpace]"}], 
                    "+", 
                    RowBox[{"0.34137916375194177`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.42100184038967103`"}], "+", 
                    RowBox[{"0.11885985795153348`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.033006244490783605`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.3382685497442966`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.1065529990401558`"}], "+", 
                    RowBox[{"0.1522995120305104`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.1767012505739982`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.03524464172797239`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.1883939186773164`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.20583040264804137`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.3565615027695809`"}], "+", 
                    RowBox[{"0.37682439793684636`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.23219188303402183`"}], "-", 
                    
                    RowBox[{"0.13593199501887587`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.33887588409018976`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.3056564571763431`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.03616215938961801`"}], "+", 
                    RowBox[{"0.1733847079861299`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.11845105303844157`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.25702609889840616`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.21991312130762675`"}], "+", 
                    
                    RowBox[{"0.06049586949360669`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.5439844784961934`"}], "+", 
                    RowBox[{"0.22534061308970674`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.13979439523283496`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.166159547577746`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.1556927925517249`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.06749507609831383`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.11175358121600834`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.02587867256768045`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.14733673488555335`"}], "+", 
                    RowBox[{"0.128743400334188`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.21787059332167164`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.22883862507694783`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.016645802715384687`"}], "+", 
                    RowBox[{"0.14099927304934876`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.6154586119883115`"}], "-", 
                    
                    RowBox[{"0.03253034101962337`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`BdGUnitary[{{{Complex[-0.29782049126244, 0.07010037722320996], Complex[
     0.3689114350133573, 0.2147196376882074], 
     Complex[-0.3062218806199851, -0.05311492846869014], Complex[
     0.41510517266995395`, -0.05861853207393349]}, {
     Complex[-0.2145176955572163, -0.1945130487677691], 
     Complex[-0.05459644533848827, -0.3586058774319928], 
     Complex[-0.470165919042878, -0.2585196818943845], 
     Complex[-0.25719285218490234`, -0.24245414496714793`]}, {
     Complex[-0.276195570420626, 0.010000651088534701`], 
     Complex[-0.10023861977881143`, 0.4781091139697569], 
     Complex[-0.24155477120632293`, 0.20850733108432815`], 
     Complex[-0.20179906864512334`, -0.3265419374085345]}, {Complex[
     0.062476011219438514`, 0.34137916375194177`], 
     Complex[-0.42100184038967103`, 0.11885985795153348`], Complex[
     0.033006244490783605`, -0.3382685497442966], Complex[-0.1065529990401558,
      0.1522995120305104]}}, {{Complex[
     0.1767012505739982, -0.03524464172797239], Complex[0.1883939186773164, 
     0.20583040264804137`], Complex[-0.3565615027695809, 
     0.37682439793684636`], 
     Complex[-0.23219188303402183`, -0.13593199501887587`]}, {Complex[
     0.33887588409018976`, 0.3056564571763431], Complex[-0.03616215938961801, 
     0.1733847079861299], Complex[
     0.11845105303844157`, -0.25702609889840616`], 
     Complex[-0.21991312130762675`, 0.06049586949360669]}, {
     Complex[-0.5439844784961934, 0.22534061308970674`], Complex[
     0.13979439523283496`, 0.166159547577746], Complex[
     0.1556927925517249, -0.06749507609831383], Complex[
     0.11175358121600834`, -0.02587867256768045]}, {
     Complex[-0.14733673488555335`, 0.128743400334188], Complex[
     0.21787059332167164`, -0.22883862507694783`], 
     Complex[-0.016645802715384687`, 0.14099927304934876`], 
     Complex[-0.6154586119883115, -0.03253034101962337]}}}, {
    $CellContext`c[1], 
    $CellContext`c[2], 
    $CellContext`c[3], 
    $CellContext`c[4]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1640170704,ExpressionUUID->"24c7d807-87f8-49d7-85c2-7eb50d581a0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "wu", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->704924832,ExpressionUUID->"cbd2163e-f5a4-4a44-a9e7-280cef60ce80"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.29782049126244`"}], "+", 
         RowBox[{"0.07010037722320996`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.3689114350133573`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.2147196376882074`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.3062218806199851`"}], "-", 
         RowBox[{"0.05311492846869014`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.41510517266995395`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.05861853207393349`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.2145176955572163`"}], "-", 
         RowBox[{"0.1945130487677691`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.05459644533848827`"}], "-", 
         RowBox[{"0.3586058774319928`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.470165919042878`"}], "-", 
         RowBox[{"0.2585196818943845`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.25719285218490234`"}], "-", 
         RowBox[{"0.24245414496714793`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.276195570420626`"}], "+", 
         RowBox[{"0.010000651088534701`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.10023861977881143`"}], "+", 
         RowBox[{"0.4781091139697569`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.24155477120632293`"}], "+", 
         RowBox[{"0.20850733108432815`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.20179906864512334`"}], "-", 
         RowBox[{"0.3265419374085345`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.062476011219438514`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.34137916375194177`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.42100184038967103`"}], "+", 
         RowBox[{"0.11885985795153348`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.033006244490783605`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.3382685497442966`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.1065529990401558`"}], "+", 
         RowBox[{"0.1522995120305104`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.1767012505739982`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.03524464172797239`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.1883939186773164`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.20583040264804137`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.3565615027695809`"}], "+", 
         RowBox[{"0.37682439793684636`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.23219188303402183`"}], "-", 
         RowBox[{"0.13593199501887587`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.33887588409018976`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.3056564571763431`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.03616215938961801`"}], "+", 
         RowBox[{"0.1733847079861299`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.11845105303844157`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.25702609889840616`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.21991312130762675`"}], "+", 
         RowBox[{"0.06049586949360669`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.5439844784961934`"}], "+", 
         RowBox[{"0.22534061308970674`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.13979439523283496`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.166159547577746`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.1556927925517249`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.06749507609831383`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.11175358121600834`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.02587867256768045`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.14733673488555335`"}], "+", 
         RowBox[{"0.128743400334188`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.21787059332167164`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.22883862507694783`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.016645802715384687`"}], "+", 
         RowBox[{"0.14099927304934876`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6154586119883115`"}], "-", 
         RowBox[{"0.03253034101962337`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1834923262,ExpressionUUID->"58eef417-6dfd-4a3d-906a-7acbf0b65d69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"BdGOperator", "[", 
   RowBox[{
    RowBox[{"cd", "[", 
     RowBox[{"[", 
      RowBox[{";;", ";;", "2"}], "]"}], "]"}], ",", "cc"}], "]"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->725351330,ExpressionUUID->"03a9e788-a311-4453-b746-1cc2fb9f2af3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BdGOperator",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transforms: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"1", "0", "0", "0"}, {"0", "0", "1", "0"}, {
                    "0", "0", "0", "0"}, {"0", "0", "0", "0"}}, RowSpacings -> 
                    1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"0", "0", "0", "0"}, {"0", "0", "0", "0"}, {
                    "1", "0", "0", "0"}, {"0", "0", "1", "0"}}, RowSpacings -> 
                    1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Private`mat,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[6]=",
 CellID->34779457,ExpressionUUID->"e63b5807-5df8-49f0-b3a4-04afa840842d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WickElements", "[", "op", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->1492531398,ExpressionUUID->"12596288-b75e-45cb-b650-dd68b27f2be2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[3]]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->482293325,ExpressionUUID->"ab20c74e-fb23-48ad-b244-cfd56aaf74e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"BdGState", "[", 
   RowBox[{
    RowBox[{"Dagger", "@", 
     RowBox[{"cc", "[", 
      RowBox[{"[", 
       RowBox[{";;", ";;", "2"}], "]"}], "]"}]}], ",", "cc"}], 
   "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->409865564,ExpressionUUID->"f02bbfaf-8e2c-439b-86ef-c37faeb0cbdc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BdGState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Overall unitary: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                    "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                    1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {4, 4}, 0, {
                    1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 
                    1}}], {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"0", "0", "0", "0"}, {"0", "0", "0", "0"}, {
                    "0", "0", "0", "0"}, {"0", "0", "0", "0"}}, RowSpacings -> 
                    1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {4, 4}, 0, {
                    1, {{0, 0, 0, 0, 0}, {}}, {}}], {}]]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operator transforms: \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"0", "0", "0", "0"}, {"0", "0", "0", "0"}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"1", "0", "0", "0"}, {"0", "0", "1", "0"}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`BdGState[{
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}], SparseArray[
    Automatic, {4, 4}, 0, {1, {{0, 0, 0, 0, 0}, {}}, {}}]}, {{0, 0, 0, 0, 1, 
   0, 0, 0}, {0, 0, 0, 0, 0, 0, 1, 0}}, {
    $CellContext`c[1], 
    $CellContext`c[2], 
    $CellContext`c[3], 
    $CellContext`c[4]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[8]=",
 CellID->821583196,ExpressionUUID->"a8876d06-9a51-4c1f-9373-8c754bc705fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "in", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->535708347,ExpressionUUID->"930053cb-25c7-4887-b787-4f08cf903d0c"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`c[1]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`c[2]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`c[3]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
    1, $CellContext`c[4] -> 0|>]]], "Output",
 CellLabel->"Out[9]=",
 CellID->1368335257,ExpressionUUID->"f0fa8b6b-939d-4e13-95ba-f710df71d7fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ws", "=", 
  RowBox[{"wu", "**", "op", "**", "wu", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[10]:=",
 CellID->124801220,ExpressionUUID->"5b7e0b9e-15df-4b7a-a117-9fd2e8e92419"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BdGState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["6", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operators: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["6", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Overall unitary: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.6322731691082184`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.07247095811208784`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.13156898760134697`"}], "-", 
                    RowBox[{"0.30311354918975225`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.14722471016175684`"}], "-", 
                    RowBox[{"0.30695461996571216`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.1206799108489195`"}], "+", 
                    
                    RowBox[{"0.16659987796948997`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.22630958795941297`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.3624794105185358`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.2150570304857637`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.31095932566351847`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.058773014168895854`", "\[VeryThinSpace]"}], 
                    "+", 
                    RowBox[{"0.06962743072325628`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.04708412873376508`"}], "+", 
                    
                    RowBox[{"0.09876756604114784`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.2339501722101545`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.2294189579741976`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.12965346569081407`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.04013126883666514`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.42960755896215613`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.06559177617166304`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.2418977698807941`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{"0.19267604069870592`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.10714503702639251`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.08950530589355443`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.046175261575523235`", "\[VeryThinSpace]"}], 
                    "+", 
                    RowBox[{"0.15637220466306936`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.517451437706332`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.22141717862300203`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.3833729703805415`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.2371279546674086`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.03995754244583498`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.19123721870518626`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.19295891095247422`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.06494167826545777`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.13774829970537575`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.262303695108271`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.37841983750787794`"}], "-", 
                    RowBox[{"0.1302947641537634`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.2956349033798724`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.13808300482328068`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.02494294236787796`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.1981636067954796`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.2587891478405307`"}], "-", 
                    RowBox[{"0.2821406178850028`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.3309281278023948`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.5017237988818242`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.0023993715293638`"}], "-", 
                    RowBox[{"0.0629551114077847`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.6379848933706505`"}], "+", 
                    RowBox[{"0.04534604942761347`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.23828141103424566`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.11858937402272694`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.18990009761149063`"}], "+", 
                    
                    RowBox[{"0.26411472173471084`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.09443304422811044`"}], "+", 
                    RowBox[{"0.3577601890850597`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.3763593191141375`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.2660690406038954`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.18851388603540145`"}], "-", 
                    RowBox[{"0.17153156257639546`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.13144182885718142`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.04849454256097874`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Operator transforms: \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.29782049126244`"}], "+", 
                    RowBox[{"0.07010037722320996`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.3689114350133573`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.2147196376882074`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.3062218806199851`"}], "-", 
                    RowBox[{"0.05311492846869014`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.41510517266995395`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.05861853207393349`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.276195570420626`"}], "+", 
                    RowBox[{"0.010000651088534701`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.10023861977881143`"}], "+", 
                    RowBox[{"0.4781091139697569`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.24155477120632293`"}], "+", 
                    RowBox[{"0.20850733108432815`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.20179906864512334`"}], "-", 
                    RowBox[{"0.3265419374085345`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.1767012505739982`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.03524464172797239`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.1883939186773164`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.20583040264804137`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.3565615027695809`"}], "-", 
                    RowBox[{"0.37682439793684636`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.23219188303402183`"}], "+", 
                    
                    RowBox[{"0.13593199501887587`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.5439844784961934`"}], "-", 
                    RowBox[{"0.22534061308970674`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.13979439523283496`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.166159547577746`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.1556927925517249`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.06749507609831383`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.11175358121600834`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.02587867256768045`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\""}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.1767012505739982`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.03524464172797239`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.1883939186773164`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.20583040264804137`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.3565615027695809`"}], "+", 
                    RowBox[{"0.37682439793684636`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.23219188303402183`"}], "-", 
                    
                    RowBox[{"0.13593199501887587`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.5439844784961934`"}], "+", 
                    RowBox[{"0.22534061308970674`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.13979439523283496`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.166159547577746`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.1556927925517249`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.06749507609831383`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.11175358121600834`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.02587867256768045`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.29782049126244`"}], "-", 
                    RowBox[{"0.07010037722320996`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.3689114350133573`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.2147196376882074`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.3062218806199851`"}], "+", 
                    RowBox[{"0.05311492846869014`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.41510517266995395`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.05861853207393349`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.276195570420626`"}], "-", 
                    RowBox[{"0.010000651088534701`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.10023861977881143`"}], "-", 
                    RowBox[{"0.4781091139697569`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.24155477120632293`"}], "-", 
                    RowBox[{"0.20850733108432815`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.20179906864512334`"}], "+", 
                    
                    RowBox[{"0.3265419374085345`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\""}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`BdGState[{{{Complex[0.6322731691082184, -0.07247095811208784], 
     Complex[-0.13156898760134697`, -0.30311354918975225`], 
     Complex[-0.14722471016175684`, -0.30695461996571216`], 
     Complex[-0.1206799108489195, 0.16659987796948997`]}, {Complex[
     0.22630958795941297`, 0.3624794105185358], Complex[
     0.2150570304857637, -0.31095932566351847`], Complex[
     0.058773014168895854`, 0.06962743072325628], 
     Complex[-0.04708412873376508, 0.09876756604114784]}, {Complex[
     0.2339501722101545, -0.2294189579741976], Complex[0.12965346569081407`, 
     0.04013126883666514], Complex[
     0.42960755896215613`, -0.06559177617166304], Complex[
     0.2418977698807941, -0.19267604069870592`]}, {Complex[
     0.10714503702639251`, -0.08950530589355443], Complex[
     0.046175261575523235`, 0.15637220466306936`], Complex[0.517451437706332, 
     0.22141717862300203`], Complex[0.3833729703805415, 
     0.2371279546674086]}}, {{Complex[0.03995754244583498, 
     0.19123721870518626`], Complex[0.19295891095247422`, 
     0.06494167826545777], Complex[0.13774829970537575`, -0.262303695108271], 
     Complex[-0.37841983750787794`, -0.1302947641537634]}, {Complex[
     0.2956349033798724, -0.13808300482328068`], Complex[
     0.02494294236787796, -0.1981636067954796], 
     Complex[-0.2587891478405307, -0.2821406178850028], Complex[
     0.3309281278023948, 0.5017237988818242]}, {
     Complex[-0.0023993715293638, -0.0629551114077847], 
     Complex[-0.6379848933706505, 0.04534604942761347], Complex[
     0.23828141103424566`, -0.11858937402272694`], 
     Complex[-0.18990009761149063`, 0.26411472173471084`]}, {
     Complex[-0.09443304422811044, 0.3577601890850597], Complex[
     0.3763593191141375, 0.2660690406038954], 
     Complex[-0.18851388603540145`, -0.17153156257639546`], Complex[
     0.13144182885718142`, -0.04849454256097874]}}}, {{
    Complex[-0.29782049126244, 0.07010037722320996], Complex[
    0.3689114350133573, 0.2147196376882074], 
    Complex[-0.3062218806199851, -0.05311492846869014], Complex[
    0.41510517266995395`, -0.05861853207393349], Complex[
    0.1767012505739982, -0.03524464172797239], Complex[0.1883939186773164, 
    0.20583040264804137`], Complex[-0.3565615027695809, 0.37682439793684636`],
     Complex[-0.23219188303402183`, -0.13593199501887587`]}, {
    Complex[-0.276195570420626, 0.010000651088534701`], 
    Complex[-0.10023861977881143`, 0.4781091139697569], 
    Complex[-0.24155477120632293`, 0.20850733108432815`], 
    Complex[-0.20179906864512334`, -0.3265419374085345], 
    Complex[-0.5439844784961934, 0.22534061308970674`], Complex[
    0.13979439523283496`, 0.166159547577746], Complex[
    0.1556927925517249, -0.06749507609831383], Complex[
    0.11175358121600834`, -0.02587867256768045]}, {Complex[0.1767012505739982,
     0.03524464172797239], Complex[0.1883939186773164, -0.20583040264804137`],
     Complex[-0.3565615027695809, -0.37682439793684636`], 
    Complex[-0.23219188303402183`, 0.13593199501887587`], 
    Complex[-0.29782049126244, -0.07010037722320996], Complex[
    0.3689114350133573, -0.2147196376882074], Complex[-0.3062218806199851, 
    0.05311492846869014], Complex[0.41510517266995395`, 
    0.05861853207393349]}, {
    Complex[-0.5439844784961934, -0.22534061308970674`], Complex[
    0.13979439523283496`, -0.166159547577746], Complex[0.1556927925517249, 
    0.06749507609831383], Complex[0.11175358121600834`, 0.02587867256768045], 
    Complex[-0.276195570420626, -0.010000651088534701`], 
    Complex[-0.10023861977881143`, -0.4781091139697569], 
    Complex[-0.24155477120632293`, -0.20850733108432815`], 
    Complex[-0.20179906864512334`, 0.3265419374085345]}, {0, 0, 0, 0, 1, 0, 0,
     0}, {0, 0, 0, 0, 0, 0, 1, 0}}, {
    $CellContext`c[1], 
    $CellContext`c[2], 
    $CellContext`c[3], 
    $CellContext`c[4]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[10]=",
 CellID->1558129492,ExpressionUUID->"2e2bb176-74a8-404e-b835-fbfb3343614d"]
}, Open  ]],

Cell["Calculate the normal and anomalous Green's functions.", "ExampleText",
 CellID->908585160,ExpressionUUID->"8b0b2618-b526-4fff-aa8f-728588c7b828"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grn", "=", 
  RowBox[{"WickGreensFunction", "[", "ws", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[11]:=",
 CellID->591811922,ExpressionUUID->"63dfe884-89ec-4506-987e-fe3fe32edb82"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["NambuMatrix",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Green's\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Green's\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Blocks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.18860567283372914`", 
                    RowBox[{
                    RowBox[{"0.07471773147089365`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.059297251281969734`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.07619385436927767`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.021838236203433267`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.12111127918669373`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.03571347398829687`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07471773147089365`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.059297251281969734`", " ", "\[ImaginaryI]"}]}],
                     "0.22245206846761897`", 
                    RowBox[{
                    RowBox[{"0.06819721347650344`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.10331828056154305`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.04778173541569821`"}], "-", 
                    RowBox[{"0.06633803168833854`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07619385436927767`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.021838236203433267`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.06819721347650344`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.10331828056154305`", " ", "\[ImaginaryI]"}]}], 
                    "0.11944099625286585`", 
                    RowBox[{
                    RowBox[{"-", "0.016365409693346822`"}], "+", 
                    
                    RowBox[{"0.05259781531836763`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.12111127918669373`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.03571347398829687`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.04778173541569821`"}], "+", 
                    RowBox[{"0.06633803168833854`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.016365409693346822`"}], "-", 
                    RowBox[{"0.05259781531836763`", " ", "\[ImaginaryI]"}]}], 
                    "0.27882658179194647`"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", 
                    RowBox[{
                    RowBox[{"-", "0.07718254198528404`"}], "+", 
                    
                    RowBox[{"0.0031408985782598285`", " ", 
                    "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.0695934277240098`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.07839701194001075`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.009860650039441251`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.07359189162472707`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07718254198528404`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.0031408985782598285`", " ", 
                    "\[ImaginaryI]"}]}], "0", 
                    RowBox[{
                    RowBox[{"0.015429723063111508`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.030554974945036346`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.11088491116786525`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.0733218800630035`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.0695934277240098`"}], "-", 
                    RowBox[{"0.07839701194001075`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.015429723063111508`"}], "+", 
                    RowBox[{"0.030554974945036346`", " ", "\[ImaginaryI]"}]}],
                     "0", 
                    RowBox[{
                    RowBox[{"0.0581194764599978`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{"0.04633395332198404`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.009860650039441251`"}], "+", 
                    RowBox[{"0.07359189162472707`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.11088491116786525`"}], "+", 
                    RowBox[{"0.0733218800630035`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.0581194764599978`"}], "+", 
                    RowBox[{"0.04633395332198404`", " ", "\[ImaginaryI]"}]}], 
                    "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
                    RowAlignments -> Baseline, ColumnAlignments -> Center], 
                    "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`NambuMatrix[{{{0.18860567283372914`, 
      Complex[0.07471773147089365, -0.059297251281969734`], 
      Complex[0.07619385436927767, -0.021838236203433267`], 
      Complex[0.12111127918669373`, -0.03571347398829687]}, {
      Complex[0.07471773147089365, 0.059297251281969734`], 
      0.22245206846761897`, 
      Complex[0.06819721347650344, 0.10331828056154305`], 
      Complex[-0.04778173541569821, -0.06633803168833854]}, {
      Complex[0.07619385436927767, 0.021838236203433267`], 
      Complex[0.06819721347650344, -0.10331828056154305`], 
      0.11944099625286585`, 
      Complex[-0.016365409693346822`, 0.05259781531836763]}, {
      Complex[0.12111127918669373`, 0.03571347398829687], 
      Complex[-0.04778173541569821, 0.06633803168833854], 
      Complex[-0.016365409693346822`, -0.05259781531836763], 
      0.27882658179194647`}}, {{0, 
      Complex[-0.07718254198528404, 0.0031408985782598285`], 
      Complex[0.0695934277240098, 0.07839701194001075], 
      Complex[0.009860650039441251, -0.07359189162472707]}, {
      Complex[0.07718254198528404, -0.0031408985782598285`], 0, 
      Complex[0.015429723063111508`, -0.030554974945036346`], 
      Complex[0.11088491116786525`, -0.0733218800630035]}, {
      Complex[-0.0695934277240098, -0.07839701194001075], 
      Complex[-0.015429723063111508`, 0.030554974945036346`], 0, 
      Complex[0.0581194764599978, -0.04633395332198404]}, {
      Complex[-0.009860650039441251, 0.07359189162472707], 
      Complex[-0.11088491116786525`, 0.0733218800630035], 
      Complex[-0.0581194764599978, 0.04633395332198404], 0}}}, "Green's"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[11]=",
 CellID->1596925455,ExpressionUUID->"59486438-f19f-4f42-8285-b0e4af8d22c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Chop", "@", "grn"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[12]:=",
 CellID->1602982056,ExpressionUUID->"cb7668ca-5a7e-4300-b5a5-f148c844c44c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.18860567283372914`", 
        RowBox[{"0.07471773147089365`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.059297251281969734`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.07619385436927767`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.021838236203433267`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.12111127918669373`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.03571347398829687`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.07471773147089365`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.059297251281969734`", " ", "\[ImaginaryI]"}]}], 
        "0.22245206846761897`", 
        RowBox[{"0.06819721347650344`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.10331828056154305`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.04778173541569821`"}], "-", 
         RowBox[{"0.06633803168833854`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.07619385436927767`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.021838236203433267`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.06819721347650344`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.10331828056154305`", " ", "\[ImaginaryI]"}]}], 
        "0.11944099625286585`", 
        RowBox[{
         RowBox[{"-", "0.016365409693346822`"}], "+", 
         RowBox[{"0.05259781531836763`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.12111127918669373`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.03571347398829687`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.04778173541569821`"}], "+", 
         RowBox[{"0.06633803168833854`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.016365409693346822`"}], "-", 
         RowBox[{"0.05259781531836763`", " ", "\[ImaginaryI]"}]}], 
        "0.27882658179194647`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"-", "0.07718254198528404`"}], "+", 
         RowBox[{"0.0031408985782598285`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.0695934277240098`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.07839701194001075`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.009860650039441251`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.07359189162472707`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.07718254198528404`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.0031408985782598285`", " ", "\[ImaginaryI]"}]}], "0", 
        RowBox[{"0.015429723063111508`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.030554974945036346`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.11088491116786525`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.0733218800630035`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.0695934277240098`"}], "-", 
         RowBox[{"0.07839701194001075`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.015429723063111508`"}], "+", 
         RowBox[{"0.030554974945036346`", " ", "\[ImaginaryI]"}]}], "0", 
        RowBox[{"0.0581194764599978`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.04633395332198404`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.009860650039441251`"}], "+", 
         RowBox[{"0.07359189162472707`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.11088491116786525`"}], "+", 
         RowBox[{"0.0733218800630035`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.0581194764599978`"}], "+", 
         RowBox[{"0.04633395332198404`", " ", "\[ImaginaryI]"}]}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[12]=",
 CellID->29036889,ExpressionUUID->"48495888-9136-49a1-9110-6840f78db547"]
}, Open  ]],

Cell[TextData[{
 "Compare the above results with the ones from ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WickExpectation"]], "paclet:Q3/ref/WickExpectation", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "712f2c1e-6e7a-4901-ada1-2cfd88713aa3"],
 ". Note that ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WickExpectation"]], "paclet:Q3/ref/WickExpectation", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "4f8eef8c-7374-4cd5-9a71-24edb97b33b6"],
 " should give the same result, ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WickGreensFunction"]], "paclet:Q3/ref/WickGreensFunction", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "02ee55ca-b574-42f5-a967-d35b8dd32270"],
 " is slightly more efficient."
}], "ExampleText",
 CellID->2072333363,ExpressionUUID->"15fe89c2-41af-4b71-9e3d-f8299cf7b4d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{
   RowBox[{"Elaborate", "[", "ws", "]"}], "//", "Chop"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[13]:=",
 CellID->1845119099,ExpressionUUID->"43cb4c2e-830b-4d24-80ad-107603f36d9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09396147485260786`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10517722098911464`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
      0, $CellContext`c[4] -> 0|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.23822898023501027`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07275261415465009`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
      1, $CellContext`c[4] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06266570160844445`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.18346454960261196`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 1, $CellContext`c[3] -> 
      0, $CellContext`c[4] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.22766548355667782`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.13134257820694342`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 1, $CellContext`c[3] -> 
      1, $CellContext`c[4] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.041437154037812805`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0677924226281516`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
      0, $CellContext`c[4] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3490751377806484`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.11112501918503528`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
      1, $CellContext`c[4] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.21886147177952867`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0880372900104206`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 1, $CellContext`c[3] -> 
      0, $CellContext`c[4] -> 0|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.21256645696290305`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.20944982826793074`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`c[3]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 1, $CellContext`c[3] -> 
      1, $CellContext`c[4] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[13]=",
 CellID->36594520,ExpressionUUID->"7e5bfc3b-e266-41a7-94cd-93e0500b3fc0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "cc", ",", 
     RowBox[{"Dagger", "@", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dagger", "[", "alt", "]"}], "**", "dd", "**", "alt"}], "//", 
    "Chop"}]}], ";"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[14]:=",
 CellID->3590320,ExpressionUUID->"01aa45e5-8e2f-4077-98e9-9169a3503186"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "cc", ",", "cc"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dagger", "[", "alt", "]"}], "**", "dd", "**", "alt"}], "//", 
    "Chop"}]}], ";"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[15]:=",
 CellID->601121677,ExpressionUUID->"360befe7-05a6-4583-8218-e5dbc4ea5c71"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"NambuMatrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ff"}], "}"}], ",", "\"\<Green's\>\""}], 
   "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[16]:=",
 CellID->437786665,ExpressionUUID->"1053c511-42eb-4735-aa54-30555f680a5a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["NambuMatrix",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Green's\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Green's\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Blocks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.18860567283372948`", 
                    RowBox[{
                    RowBox[{"0.0747177314708937`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.05929725128196983`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.07619385436927768`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.021838236203433194`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.12111127918669382`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.03571347398829697`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.0747177314708937`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.05929725128196983`", " ", "\[ImaginaryI]"}]}], 
                    "0.22245206846761909`", 
                    RowBox[{
                    RowBox[{"0.06819721347650363`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.10331828056154296`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.047781735415698315`"}], "-", 
                    RowBox[{"0.06633803168833852`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07619385436927768`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.021838236203433194`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.06819721347650363`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.10331828056154296`", " ", "\[ImaginaryI]"}]}], 
                    "0.11944099625286586`", 
                    RowBox[{
                    RowBox[{"-", "0.016365409693346877`"}], "+", 
                    
                    RowBox[{"0.05259781531836742`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.12111127918669382`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.03571347398829697`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.047781735415698315`"}], "+", 
                    RowBox[{"0.06633803168833852`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.016365409693346877`"}], "-", 
                    RowBox[{"0.05259781531836742`", " ", "\[ImaginaryI]"}]}], 
                    "0.27882658179194675`"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]], ",", 
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", 
                    RowBox[{
                    RowBox[{"-", "0.07718254198528422`"}], "+", 
                    
                    RowBox[{"0.0031408985782597973`", " ", 
                    "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.0695934277240099`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.07839701194001072`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.009860650039441364`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.07359189162472712`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07718254198528422`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.0031408985782597973`", " ", 
                    "\[ImaginaryI]"}]}], "0", 
                    RowBox[{
                    RowBox[{"0.015429723063111425`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.030554974945036506`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.11088491116786522`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.07332188006300364`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.0695934277240099`"}], "-", 
                    RowBox[{"0.07839701194001072`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.015429723063111425`"}], "+", 
                    RowBox[{"0.030554974945036506`", " ", "\[ImaginaryI]"}]}],
                     "0", 
                    RowBox[{
                    RowBox[{"0.058119476459997946`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.04633395332198406`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.009860650039441364`"}], "+", 
                    RowBox[{"0.07359189162472712`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.11088491116786522`"}], "+", 
                    RowBox[{"0.07332188006300364`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.058119476459997946`"}], "+", 
                    RowBox[{"0.04633395332198406`", " ", "\[ImaginaryI]"}]}], 
                    "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
                    RowAlignments -> Baseline, ColumnAlignments -> Center], 
                    "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {}]]]}], "}"}], "SummaryItem"]}]}},
              GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`NambuMatrix[{{{0.18860567283372948`, 
      Complex[0.0747177314708937, -0.05929725128196983], 
      Complex[0.07619385436927768, -0.021838236203433194`], 
      Complex[0.12111127918669382`, -0.03571347398829697]}, {
      Complex[0.0747177314708937, 0.05929725128196983], 0.22245206846761909`, 
      
      Complex[0.06819721347650363, 0.10331828056154296`], 
      Complex[-0.047781735415698315`, -0.06633803168833852]}, {
      Complex[0.07619385436927768, 0.021838236203433194`], 
      Complex[0.06819721347650363, -0.10331828056154296`], 
      0.11944099625286586`, 
      Complex[-0.016365409693346877`, 0.05259781531836742]}, {
      Complex[0.12111127918669382`, 0.03571347398829697], 
      Complex[-0.047781735415698315`, 0.06633803168833852], 
      Complex[-0.016365409693346877`, -0.05259781531836742], 
      0.27882658179194675`}}, {{0, 
      Complex[-0.07718254198528422, 0.0031408985782597973`], 
      Complex[0.0695934277240099, 0.07839701194001072], 
      Complex[0.009860650039441364, -0.07359189162472712]}, {
      Complex[0.07718254198528422, -0.0031408985782597973`], 0, 
      Complex[0.015429723063111425`, -0.030554974945036506`], 
      Complex[0.11088491116786522`, -0.07332188006300364]}, {
      Complex[-0.0695934277240099, -0.07839701194001072], 
      Complex[-0.015429723063111425`, 0.030554974945036506`], 0, 
      Complex[0.058119476459997946`, -0.04633395332198406]}, {
      Complex[-0.009860650039441364, 0.07359189162472712], 
      Complex[-0.11088491116786522`, 0.07332188006300364], 
      Complex[-0.058119476459997946`, 0.04633395332198406], 0}}}, "Green's"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[16]=",
 CellID->366008055,ExpressionUUID->"b272445e-0592-49c9-b05c-156f90469766"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"grn", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[17]:=",
 CellID->1658229744,ExpressionUUID->"76f491c1-9d05-4bb7-8334-93992892a6e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[17]=",
 CellID->715007450,ExpressionUUID->"3cd7bf53-620d-4786-a86c-bc9782def959"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickState"]], "paclet:Q3/ref/WickState", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "f23aeac4-d102-4739-ac8f-f2e022e6c175"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickUnitary"]], "paclet:Q3/ref/WickUnitary", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "1004f701-7f81-4e2e-b198-5399c21e3f50"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickOperator"]], "paclet:Q3/ref/WickOperator", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "e11085b2-bfd8-43aa-a058-ac175d0a1ef7"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BdGState"]], "paclet:Q3/ref/BdGState", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "5f87be48-9ce1-4700-876b-4cb4668d81cf"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BdGUnitary"]], "paclet:Q3/ref/BdGUnitary", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "6b5620a5-ff55-4b9c-8fd4-f217b0a9955c"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BdGOperator"]], "paclet:Q3/ref/BdGOperator", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "dd20cf3d-9070-48fa-826c-6cee271acb34"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["NambuMatrix"]], "paclet:Q3/ref/NambuMatrix", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "51a849f9-6735-4ada-8b8e-7a4889af600e"]
       }], "SeeAlso",ExpressionUUID->"4a1cbf42-64b1-4e78-84b8-1b58971f3d55"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"6196e143-d088-437f-9845-\
1b0cd5f5b8e6"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "524d4b17-3ab1-40c4-beff-4554af256cb4"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "83daea03-4d60-4b2d-be58-86db8a9bec2f"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"6250a1b5-4430-4304-a7d1-\
823274b4d220"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "da87bcca-a822-4e7d-934b-c6499abf3a04"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "6d01f0a8-b27b-43d1-88a7-0193a17d8d5a"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"3365ce67-da23-42a7-b088-\
a3ab119d0f5f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "B. M. Terhal and D. P. DiVincenzo (2002)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.65.032325"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "15dc4e6f-c196-4d7f-8844-281ae9324564"]}]],ExpressionUUID->
         "86455a5f-1ecb-485e-b68d-7f85db4f82fe"],
        ", Physical Review A 65, 032325, \"Classical simulation of \
noninteracting-fermion quantum circuits.\""
       }], "RelatedLinks",ExpressionUUID->
        "9c40ddb1-62d7-44e0-b26f-eb8a544109a4"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "e1f1e182-c6bb-407d-8f16-6dd48914f3a6"]}]],ExpressionUUID->
         "5d3dfd93-6c2a-4899-b255-65af5ba2170a"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "b320e05d-7f35-4522-8edb-856a77a9f658"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"374c7755-f491-4297-b841-\
96aeb6d5cd01"],

Cell[" ", "FooterCell",ExpressionUUID->"075117ca-d78f-4107-9275-aaa9240674e1"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"WickGreensFunction",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed, "ExampleSubsection" -> {"0" -> Closed}},
   "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2024, 8, 11, 23, 55, 29.314745}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "Q3`", "keywords" -> {}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "WickGreensFunction[ws] returns NambuMatrix[{G, F}, \"Green's\"] with n*n \
matrices G and F representing the normal and anomalous Green's functions, \
respectively, with respect to Wick state ws for fermion modes {c1, c2, ..., \
cn}. WickGreensFunction[ws, {c Subscript[k, 1], c Subscript[k, 2], ...}] \
computes the Green's function over only the specified fermion modes {c \
Subscript[k, 1], c Subscript[k, 2], ...} (out of all fermion modes {c1, c2, \
..., cn} in ws).", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "WickGreensFunction", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "WickGreensFunction", "type" -> "Symbol", "uri" -> 
    "Q3/ref/WickGreensFunction"}},
CellContext->"Global`",
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.1 for Mac OS X ARM (64-bit) (July 16, 2024)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"091166bd-3e81-4449-853c-2d9109aa4e53"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[20919, 578, 1440, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"01ec2fa8-1325-4cb9-8272-2963bed7d800",
   CellTags->"PrimaryExamplesSection",
   CellID->661360838]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 241947, 5799}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[586, 21, 7785, 183, 50, "AnchorBarGrid",ExpressionUUID->"0e805d97-988b-407c-9b51-461d58ea1ade",
 CellID->1],
Cell[8374, 206, 85, 0, 22, "ContextNameCell",ExpressionUUID->"5009fc8d-c1fc-4285-aeaa-1e8228305f2e"],
Cell[CellGroupData[{
Cell[8484, 210, 1392, 38, 57, "ObjectNameGrid",ExpressionUUID->"393eff38-3c7f-40d8-83db-49aee64b985d"],
Cell[9879, 250, 4806, 139, 201, "Usage",ExpressionUUID->"5ecd6367-9942-4d6e-aa32-c42fbd123e54",
 CellID->1552081390]
}, Open  ]],
Cell[CellGroupData[{
Cell[14722, 394, 1917, 48, 34, "NotesSection",ExpressionUUID->"d572eef4-0a83-4888-9fca-8ee8522a656d",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1798957793],
Cell[16642, 444, 1663, 49, 70, "Notes",ExpressionUUID->"0df520ba-a728-4dd0-a60d-791970800399",
 CellID->348061621],
Cell[18308, 495, 992, 30, 70, "Notes",ExpressionUUID->"bef8b4ea-3e38-4a67-b7ab-3a5ca349bc7b",
 CellID->1383491325],
Cell[19303, 527, 1489, 45, 70, "Notes",ExpressionUUID->"3f91db23-c8f0-4279-b6c0-8d34db223406",
 CellID->795234925]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[20919, 578, 1440, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"01ec2fa8-1325-4cb9-8272-2963bed7d800",
 CellTags->"PrimaryExamplesSection",
 CellID->661360838],
Cell[22362, 618, 192, 3, 29, "Input",ExpressionUUID->"bd603189-e058-4bd0-bf70-56b60d45555d",
 CellID->1070195861],
Cell[CellGroupData[{
Cell[22579, 625, 1418, 37, 29, "ExampleSection",ExpressionUUID->"ceb8ce18-8da6-4129-9939-3dd146f9da6f",
 CellID->116247394],
Cell[24000, 664, 208, 5, 28, "Input",ExpressionUUID->"c4b8034d-b985-43d8-9498-09fef1ac68d6",
 CellID->576804685],
Cell[24211, 671, 114, 1, 37, "ExampleText",ExpressionUUID->"fe35e0bc-d1f9-4b5e-baf8-fab4552f46fa",
 CellID->1240864226],
Cell[24328, 674, 210, 5, 28, "Input",ExpressionUUID->"83ef48ef-20f5-432e-aac6-d3f7888ec5b6",
 CellID->408820197],
Cell[CellGroupData[{
Cell[24563, 683, 303, 8, 45, "Input",ExpressionUUID->"214c9160-86f6-4689-bb39-6eb38e81e191",
 CellID->991350365],
Cell[24869, 693, 862, 29, 36, "Output",ExpressionUUID->"e25348d7-16cb-4385-914e-a234509c86ba",
 CellID->1467288376]
}, Open  ]],
Cell[25746, 725, 119, 1, 37, "ExampleText",ExpressionUUID->"94d64717-c864-4359-a310-8755d2d2eef9",
 CellID->616371887],
Cell[CellGroupData[{
Cell[25890, 730, 618, 18, 63, "Input",ExpressionUUID->"56ef9b36-aa37-4088-8e92-ebb4f40f71bc",
 CellID->2048675328],
Cell[26511, 750, 1591, 38, 38, "Output",ExpressionUUID->"5e59a4a7-0a31-4b40-87d0-33aa34f1e963",
 CellID->306316208]
}, Open  ]],
Cell[28117, 791, 144, 1, 37, "ExampleText",ExpressionUUID->"037a8c96-abc8-4b9c-827d-d9a7f69e8f0e",
 CellID->1286973786],
Cell[CellGroupData[{
Cell[28286, 796, 688, 21, 45, "Input",ExpressionUUID->"a198fec4-4213-4f61-8635-2c5687ced69e",
 CellID->506039615],
Cell[28977, 819, 12500, 245, 60, "Output",ExpressionUUID->"8ad53edd-391d-4cb2-b4ce-db02cfffeee9",
 CellID->1159855816]
}, Open  ]],
Cell[41492, 1067, 177, 3, 70, "ExampleText",ExpressionUUID->"5a5c021a-60c5-402e-9edd-aa2cebc6adb2",
 CellID->2080173378],
Cell[CellGroupData[{
Cell[41694, 1074, 203, 5, 70, "Input",ExpressionUUID->"b15799cb-c82e-41e9-9333-b8a15a9c046f",
 CellID->1866836762],
Cell[41900, 1081, 9903, 205, 70, "Output",ExpressionUUID->"6c2baca1-aa6a-467c-9c32-0b2889838f19",
 CellID->1118796585]
}, Open  ]],
Cell[CellGroupData[{
Cell[51840, 1291, 190, 4, 70, "Input",ExpressionUUID->"29cedba6-39b7-4125-8827-4c010050dd5b",
 CellID->1069082772],
Cell[52033, 1297, 143, 2, 36, "Output",ExpressionUUID->"0bbfd78f-6f88-4629-99fe-78d3320fbd08",
 CellID->113335102]
}, Open  ]],
Cell[52191, 1302, 175, 3, 70, "ExampleText",ExpressionUUID->"a7e40d1c-a29c-463c-9db9-ef206312e38d",
 CellID->646584999],
Cell[CellGroupData[{
Cell[52391, 1309, 329, 8, 70, "Input",ExpressionUUID->"de574498-e404-479e-b670-c92acdab66a4",
 CellID->366886627],
Cell[52723, 1319, 3233, 69, 91, "Output",ExpressionUUID->"07e70c70-84fe-4295-bc5b-0527c06fb226",
 CellID->1164624709]
}, Open  ]],
Cell[55971, 1391, 204, 4, 70, "ExampleText",ExpressionUUID->"c5908881-1623-438f-bc04-dfcfa5be3020",
 CellID->1904178883],
Cell[CellGroupData[{
Cell[56200, 1399, 598, 16, 70, "Input",ExpressionUUID->"7ba18549-dc79-4f9c-845a-b61bf6ecbf38",
 CellID->890962738],
Cell[56801, 1417, 115, 1, 70, "EchoTiming",ExpressionUUID->"9c4f40d5-ba55-4026-b245-be2a2975955c",
 CellID->1339990444],
Cell[56919, 1420, 2284, 52, 91, "Output",ExpressionUUID->"bd762b13-d4af-49e5-912e-d8c152b714cc",
 CellID->558386219]
}, Open  ]],
Cell[59218, 1475, 119, 1, 70, "ExampleText",ExpressionUUID->"fb8fd635-f1b8-456a-a1c0-2b9127f7faca",
 CellID->1358460726],
Cell[CellGroupData[{
Cell[59362, 1480, 242, 7, 70, "Input",ExpressionUUID->"12bae6f7-b904-42e0-b55f-d1755f49379e",
 CellID->1525269532],
Cell[59607, 1489, 671, 19, 91, "Output",ExpressionUUID->"acbced73-8679-4800-8bd2-2b6bb6c11438",
 CellID->579109312]
}, Open  ]],
Cell[CellGroupData[{
Cell[60315, 1513, 307, 9, 70, "Input",ExpressionUUID->"ae7136ea-855f-4523-a051-803167a033f4",
 CellID->1205688208],
Cell[60625, 1524, 144, 3, 36, "Output",ExpressionUUID->"d37607b0-bab3-45b3-b151-ffe47a4c47c8",
 CellID->674099364]
}, Open  ]],
Cell[60784, 1530, 603, 14, 70, "ExampleText",ExpressionUUID->"57399638-e4d4-4452-a262-60671c8ce1d6",
 CellID->1611772823],
Cell[CellGroupData[{
Cell[61412, 1548, 327, 9, 70, "Input",ExpressionUUID->"c2010832-46ab-45c0-8314-5eda162e86f4",
 CellID->151650472],
Cell[61742, 1559, 3250, 69, 91, "Output",ExpressionUUID->"c36c6021-559f-4a5a-beee-6ecdd798e66b",
 CellID->895862348]
}, Open  ]],
Cell[65007, 1631, 184, 3, 70, "ExampleText",ExpressionUUID->"6cf54ea4-acc9-4da7-8f49-fb8622e736cd",
 CellID->374649487],
Cell[CellGroupData[{
Cell[65216, 1638, 220, 5, 70, "Input",ExpressionUUID->"4f6f5220-3cdf-4adc-a818-5923ca36a5d1",
 CellID->1967000432],
Cell[65439, 1645, 245, 6, 36, "Output",ExpressionUUID->"7ce70868-9ce1-4421-a9fa-6f85038fd91e",
 CellID->259304973]
}, Open  ]],
Cell[CellGroupData[{
Cell[65721, 1656, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"36efed70-f9e7-4048-86ee-6b53adb68082",
 CellID->638164847],
Cell[65966, 1663, 440, 13, 70, "ExampleText",ExpressionUUID->"9e07e093-58d9-4125-a86a-e257ee0528d5",
 CellID->1997299767],
Cell[66409, 1678, 209, 5, 70, "Input",ExpressionUUID->"506c0cf3-5c73-43aa-ab59-81d3dca6661b",
 CellID->1180578376],
Cell[66621, 1685, 114, 1, 70, "ExampleText",ExpressionUUID->"12de9134-ac6c-48a4-b451-1e9543fb8b53",
 CellID->1070147002],
Cell[66738, 1688, 211, 5, 70, "Input",ExpressionUUID->"cbdc26d0-8a34-4c2b-8e85-cb497fdbe73a",
 CellID->1515066942],
Cell[CellGroupData[{
Cell[66974, 1697, 303, 8, 70, "Input",ExpressionUUID->"1233ca0b-abc1-4dc0-9292-63cbec13d9c9",
 CellID->354468647],
Cell[67280, 1707, 861, 29, 36, "Output",ExpressionUUID->"7b935e2a-154a-48b6-a83a-041a65ae7270",
 CellID->557648950]
}, Open  ]],
Cell[68156, 1739, 119, 1, 70, "ExampleText",ExpressionUUID->"c3b4c4e5-ef11-485c-8571-df84bda09708",
 CellID->501009457],
Cell[CellGroupData[{
Cell[68300, 1744, 618, 18, 70, "Input",ExpressionUUID->"62b5a072-2ccb-42a5-9838-4b1eb8306662",
 CellID->1526959957],
Cell[68921, 1764, 1592, 38, 38, "Output",ExpressionUUID->"a13cd4e3-3ef6-4fa4-ad7c-d273d104ecc1",
 CellID->1219504959]
}, Open  ]],
Cell[CellGroupData[{
Cell[70550, 1807, 557, 17, 70, "Input",ExpressionUUID->"31269647-80df-4e63-a339-d9ec9616562e",
 CellID->1842944571],
Cell[71110, 1826, 7881, 212, 121, "Output",ExpressionUUID->"17d571c7-aa24-403e-8c69-ddfd6dd248ec",
 CellID->584496245]
}, Open  ]],
Cell[CellGroupData[{
Cell[79028, 2043, 244, 6, 70, "Input",ExpressionUUID->"5baf7a26-0d05-46e7-90cf-ff3c6a65ea89",
 CellID->697768032],
Cell[79275, 2051, 8627, 167, 70, "Output",ExpressionUUID->"8ab4dadc-b1a5-406f-ab91-2b1f2c478e44",
 CellID->1560010347]
}, Open  ]],
Cell[87917, 2221, 153, 1, 70, "ExampleText",ExpressionUUID->"7c985c81-4dae-4d1a-a005-ca1b1ccfa7e2",
 CellID->357527536],
Cell[CellGroupData[{
Cell[88095, 2226, 202, 5, 70, "Input",ExpressionUUID->"bbac59b0-3942-4861-ad22-9c23011d5487",
 CellID->422859641],
Cell[88300, 2233, 11031, 219, 70, "Output",ExpressionUUID->"e28cf5fc-018e-4a63-be3d-21b7ff368f8b",
 CellID->2063466143]
}, Open  ]],
Cell[99346, 2455, 179, 3, 70, "ExampleText",ExpressionUUID->"9f5cc38c-b1b5-412f-810f-be26c28d1eef",
 CellID->1214338793],
Cell[CellGroupData[{
Cell[99550, 2462, 190, 4, 70, "Input",ExpressionUUID->"aa216960-8d42-40de-84ae-3d33d95675b3",
 CellID->1465007594],
Cell[99743, 2468, 145, 2, 36, "Output",ExpressionUUID->"a8a68aca-5631-4124-bd83-55236a9f7b7b",
 CellID->1631738415]
}, Open  ]],
Cell[99903, 2473, 176, 3, 70, "ExampleText",ExpressionUUID->"b460415e-a720-4f5c-80b8-7d6ce5d7ba78",
 CellID->1261368715],
Cell[CellGroupData[{
Cell[100104, 2480, 329, 8, 70, "Input",ExpressionUUID->"e088ebb2-f1ef-4f99-b6cd-93d6b3de6a93",
 CellID->986963702],
Cell[100436, 2490, 3255, 72, 91, "Output",ExpressionUUID->"24311b73-d2cb-4b9f-9145-68014670a392",
 CellID->1003576167]
}, Open  ]],
Cell[103706, 2565, 171, 3, 70, "ExampleText",ExpressionUUID->"4bd2161e-456f-4868-adde-4ddfea29ba6a",
 CellID->54296516],
Cell[CellGroupData[{
Cell[103902, 2572, 599, 16, 70, "Input",ExpressionUUID->"9374aef1-9a45-4405-9d8d-39c448a7be7e",
 CellID->654174471],
Cell[104504, 2590, 115, 1, 70, "EchoTiming",ExpressionUUID->"65ce34ea-08d1-46b2-bf57-515888e52127",
 CellID->259402558],
Cell[104622, 2593, 2269, 54, 91, "Output",ExpressionUUID->"7d61095d-3017-47d4-9c89-2cec16e868af",
 CellID->386988896]
}, Open  ]],
Cell[106906, 2650, 122, 1, 70, "ExampleText",ExpressionUUID->"a951aea8-36d0-4877-a255-2620258904b3",
 CellID->1798939601],
Cell[CellGroupData[{
Cell[107053, 2655, 242, 7, 70, "Input",ExpressionUUID->"78c0c6e4-21e9-4e98-a36b-2261e168d902",
 CellID->1410219982],
Cell[107298, 2664, 672, 19, 91, "Output",ExpressionUUID->"e5d5b88c-f8e9-4b15-a4f6-9538ce0f084e",
 CellID->1551658223]
}, Open  ]],
Cell[CellGroupData[{
Cell[108007, 2688, 307, 9, 70, "Input",ExpressionUUID->"71a1e92e-7c65-44e1-ab60-20633fcfc5ac",
 CellID->1086985013],
Cell[108317, 2699, 145, 3, 36, "Output",ExpressionUUID->"6aee4d86-2766-4e0d-859a-e459b3ff8001",
 CellID->1880305782]
}, Open  ]],
Cell[108477, 2705, 349, 6, 70, "ExampleText",ExpressionUUID->"73d3baa0-a24c-48fe-9b35-eff04caa58aa",
 CellID->657344503],
Cell[CellGroupData[{
Cell[108851, 2715, 327, 9, 70, "Input",ExpressionUUID->"f8988d3f-fe11-4e1f-bd23-fa460ce1c97c",
 CellID->427940498],
Cell[109181, 2726, 3307, 74, 91, "Output",ExpressionUUID->"856c763a-9a54-4f07-bf8c-7ddc126f7387",
 CellID->774235321]
}, Open  ]],
Cell[112503, 2803, 190, 4, 70, "ExampleText",ExpressionUUID->"7b8bb181-b49d-4ac3-bce3-baa3d5a33963",
 CellID->197303479],
Cell[CellGroupData[{
Cell[112718, 2811, 220, 5, 70, "Input",ExpressionUUID->"e9f082af-83c0-4bdb-b106-528925de86d1",
 CellID->1825031986],
Cell[112941, 2818, 246, 6, 36, "Output",ExpressionUUID->"ec081ada-7837-4d4e-91da-af1708cf5d36",
 CellID->2037730684]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[113348, 2833, 1410, 37, 70, "ExampleSection",ExpressionUUID->"594667a4-ce46-42c5-b43b-489030e2746f",
 CellID->778883717],
Cell[CellGroupData[{
Cell[114783, 2874, 1423, 37, 70, "ExampleSubsection",ExpressionUUID->"4e9ad41d-1bd9-462f-88ae-9c6d31cf960e",
 CellID->1116349899],
Cell[116209, 2913, 192, 6, 70, "ExampleText",ExpressionUUID->"338220fc-c200-4ded-8284-02d02a633c0c",
 CellID->857188823],
Cell[116404, 2921, 211, 5, 70, "Input",ExpressionUUID->"b017b141-e895-41fb-bb2b-83f80a421636",
 CellID->1720633530],
Cell[CellGroupData[{
Cell[116640, 2930, 442, 12, 70, "Input",ExpressionUUID->"65f26cad-6025-4ebf-94ca-d92b105f2774",
 CellID->1101815844],
Cell[117085, 2944, 718, 24, 36, "Output",ExpressionUUID->"cbb3d6af-7ae6-45a6-9da3-bd18f7b32359",
 CellID->36168252],
Cell[117806, 2970, 1727, 52, 37, "Output",ExpressionUUID->"a7215a8b-8534-43e3-8eb6-a697d6db2454",
 CellID->141939263]
}, Open  ]],
Cell[119548, 3025, 258, 4, 70, "ExampleText",ExpressionUUID->"93bb49c0-c8e7-4cb0-b4df-6fcc78a62579",
 CellID->1024190994],
Cell[119809, 3031, 208, 5, 70, "Input",ExpressionUUID->"2e76e02a-b8e8-4f14-a661-d86d6fc3bd28",
 CellID->192352138],
Cell[120020, 3038, 314, 5, 70, "ExampleText",ExpressionUUID->"8e2cbe84-fdda-4374-a731-2e5b46dac984",
 CellID->2002615694],
Cell[120337, 3045, 1146, 37, 70, "ExampleText",ExpressionUUID->"12dc9d0c-5a28-4ef1-91c8-d07c1907f996",
 CellID->450769627],
Cell[CellGroupData[{
Cell[121508, 3086, 329, 9, 70, "Input",ExpressionUUID->"de0648eb-6284-43b7-9417-0dc0c2de8aef",
 CellID->1855946863],
Cell[121840, 3097, 15030, 306, 70, "Output",ExpressionUUID->"24c7d807-87f8-49d7-85c2-7eb50d581a0d",
 CellID->1640170704]
}, Open  ]],
Cell[CellGroupData[{
Cell[136907, 3408, 189, 4, 70, "Input",ExpressionUUID->"cbd2163e-f5a4-4a44-a9e7-280cef60ce80",
 CellID->704924832],
Cell[137099, 3414, 5497, 122, 142, "Output",ExpressionUUID->"58eef417-6dfd-4a3d-906a-7acbf0b65d69",
 CellID->1834923262]
}, Open  ]],
Cell[CellGroupData[{
Cell[142633, 3541, 326, 10, 70, "Input",ExpressionUUID->"03a9e788-a311-4453-b746-1cc2fb9f2af3",
 CellID->725351330],
Cell[142962, 3553, 6780, 143, 70, "Output",ExpressionUUID->"e63b5807-5df8-49f0-b3a4-04afa840842d",
 CellID->34779457]
}, Open  ]],
Cell[CellGroupData[{
Cell[149779, 3701, 192, 4, 70, "Input",ExpressionUUID->"12596288-b75e-45cb-b650-dd68b27f2be2",
 CellID->1492531398],
Cell[149974, 3707, 939, 28, 37, "Output",ExpressionUUID->"ab20c74e-fb23-48ad-b244-cfd56aaf74e2",
 CellID->482293325]
}, Open  ]],
Cell[CellGroupData[{
Cell[150950, 3740, 358, 11, 70, "Input",ExpressionUUID->"f02bbfaf-8e2c-439b-86ef-c37faeb0cbdc",
 CellID->409865564],
Cell[151311, 3753, 8573, 184, 70, "Output",ExpressionUUID->"a8876d06-9a51-4c1f-9373-8c754bc705fb",
 CellID->821583196]
}, Open  ]],
Cell[CellGroupData[{
Cell[159921, 3942, 188, 4, 70, "Input",ExpressionUUID->"930053cb-25c7-4887-b787-4f08cf903d0c",
 CellID->535708347],
Cell[160112, 3948, 1328, 32, 38, "Output",ExpressionUUID->"f0fa8b6b-939d-4e13-95ba-f710df71d7fe",
 CellID->1368335257]
}, Open  ]],
Cell[CellGroupData[{
Cell[161477, 3985, 226, 5, 70, "Input",ExpressionUUID->"5b7e0b9e-15df-4b7a-a117-9fd2e8e92419",
 CellID->124801220],
Cell[161706, 3992, 24722, 494, 70, "Output",ExpressionUUID->"2e2bb176-74a8-404e-b835-fbfb3343614d",
 CellID->1558129492]
}, Open  ]],
Cell[186443, 4489, 151, 1, 70, "ExampleText",ExpressionUUID->"8b0b2618-b526-4fff-aa8f-728588c7b828",
 CellID->908585160],
Cell[CellGroupData[{
Cell[186619, 4494, 223, 5, 70, "Input",ExpressionUUID->"63dfe884-89ec-4506-987e-fe3fe32edb82",
 CellID->591811922],
Cell[186845, 4501, 11657, 234, 70, "Output",ExpressionUUID->"59486438-f19f-4f42-8285-b0e4af8d22c3",
 CellID->1596925455]
}, Open  ]],
Cell[CellGroupData[{
Cell[198539, 4740, 218, 5, 70, "Input",ExpressionUUID->"cb7668ca-5a7e-4300-b5a5-f148c844c44c",
 CellID->1602982056],
Cell[198760, 4747, 4554, 99, 142, "Output",ExpressionUUID->"48495888-9136-49a1-9110-6840f78db547",
 CellID->29036889]
}, Open  ]],
Cell[203329, 4849, 1138, 33, 70, "ExampleText",ExpressionUUID->"15fe89c2-41af-4b71-9e3d-f8299cf7b4d1",
 CellID->2072333363],
Cell[CellGroupData[{
Cell[204492, 4886, 243, 6, 70, "Input",ExpressionUUID->"43cb4c2e-830b-4d24-80ad-107603f36d9c",
 CellID->1845119099],
Cell[204738, 4894, 11638, 275, 94, "Output",ExpressionUUID->"7e5bfc3b-e266-41a7-94cd-93e0500b3fc0",
 CellID->36594520]
}, Open  ]],
Cell[216391, 5172, 482, 14, 70, "Input",ExpressionUUID->"01aa45e5-8e2f-4077-98e9-9169a3503186",
 CellID->3590320],
Cell[216876, 5188, 456, 14, 70, "Input",ExpressionUUID->"360befe7-05a6-4583-8218-e5dbc4ea5c71",
 CellID->601121677],
Cell[CellGroupData[{
Cell[217357, 5206, 310, 9, 70, "Input",ExpressionUUID->"1053c511-42eb-4735-aa54-30555f680a5a",
 CellID->437786665],
Cell[217670, 5217, 11792, 240, 70, "Output",ExpressionUUID->"b272445e-0592-49c9-b05c-156f90469766",
 CellID->366008055]
}, Open  ]],
Cell[CellGroupData[{
Cell[229499, 5462, 243, 7, 70, "Input",ExpressionUUID->"76f491c1-9d05-4bb7-8334-93992892a6e3",
 CellID->1658229744],
Cell[229745, 5471, 1296, 38, 79, "Output",ExpressionUUID->"3cd7bf53-620d-4786-a86c-bc9782def959",
 CellID->715007450]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[231398, 5521, 3880, 106, 70, "SeeAlsoSection",ExpressionUUID->"6196e143-d088-437f-9845-1b0cd5f5b8e6"],
Cell[235281, 5629, 1100, 28, 70, "TechNotesSection",ExpressionUUID->"6250a1b5-4430-4304-a7d1-823274b4d220"],
Cell[236384, 5659, 1056, 27, 70, "MoreAboutSection",ExpressionUUID->"3365ce67-da23-42a7-b088-a3ab119d0f5f"],
Cell[237443, 5688, 2079, 57, 70, "RelatedLinksSection",ExpressionUUID->"374c7755-f491-4297-b841-96aeb6d5cd01"],
Cell[239525, 5747, 78, 0, 70, "FooterCell",ExpressionUUID->"075117ca-d78f-4107-9275-aaa9240674e1"]
}
]
*)

(* End of internal cache information *)

