(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     55235,       1783]
NotebookOptionsPosition[     46856,       1604]
NotebookOutlinePosition[     49435,       1666]
CellTagsIndexPosition[     49349,       1661]
WindowTitle->FockMatrix
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["QUISSO PACKAGE SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Matrix\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/Matrix"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Fock\"\>":>Documentation`HelpLookup[
       "paclet:Q3/guide/Fock"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/FockMatrix\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/FockMatrix"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/FockMatrix.\
html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$87926], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], "Q3/ref/FockMatrix", 
             ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["FockMatrix", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FockMatrix", "[", 
       RowBox[{
        StyleBox["op", "TI"], ",", " ", 
        StyleBox["vlist", "TI"]}], "]"}]], "InlineFormula"],
     "\[LineSeparator]computes the matrix elements of the operator op between \
the vectors in the list vlist. Vecotrs in vlist can be either in the Ket or \
Cat form (the latter is slightly more efficient. "
    }]]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FockMatrix", "[", 
       RowBox[{
        StyleBox["op", "TI"], ",", " ", 
        SubscriptBox[
         StyleBox["vlist", "TI"], 
         StyleBox["1", "TR"]], ",", " ", 
        SubscriptBox[
         StyleBox["vlist", "TI"], 
         StyleBox["2", "TR"]]}], "]"}]], "InlineFormula"],
     "\[LineSeparator]calculates the matrix elements between two vectors, one \
from vlist1 and the other from vlist2. "
    }]]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FockMatrix", "[", 
       RowBox[{
        StyleBox["op", "TI"], ",", " ", 
        StyleBox["basis", "TI"]}], "]"}]], "InlineFormula"],
     "\[LineSeparator]calculates the matrix elements between vectors in the \
basis 'basis'. The basis is a list with particular structure and can be \
constructed by ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["FermionBasis"]], "paclet:Q3/ref/FermionBasis"},
       "RefLink",
       BaseStyle->{"InlineFormula"}]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {None, None, {None}}}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    TemplateBox[{6},
     "Spacer1"]]],
   "Details"
  }], "NotesFrameText"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->"Preemptive"]]]], "NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1291687],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[{
 "To be distinguished from the more general ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "Notes",
 CellID->613871602],

Cell["The following options can be given: ", "Notes"],

Cell["", "SectionFooterSpacer"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->234546939],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1397911528],

Cell[BoxData[
 RowBox[{"<<", "Q3`Fock`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->666594043],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Boson", ",", "a", ",", "b"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"aa", "=", 
  RowBox[{"a", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], "]"}]}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1983840372],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    SubscriptBox[
     TemplateBox[{"a"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    DisplayForm], ",", 
   TagBox[
    SubscriptBox[
     TemplateBox[{"a"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    DisplayForm]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1319658651]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vv", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FockCat", "[", 
       RowBox[{"aa", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"uu", "=", 
  RowBox[{"FockKet", "[", "vv", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"HH", "=", 
  RowBox[{"PlusDagger", "[", 
   RowBox[{"Hop", "@@", 
    RowBox[{"a", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1206877450],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], ",", 
   TagBox[
    RowBox[{
     TagBox[
      TagBox[
       TemplateBox[{
         TemplateBox[{"a"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm],
      DisplayForm], 
     TagBox[
      TemplateBox[{"\"\[SpaceIndicator]\""},
       "Ket"],
      DisplayForm]}],
    DisplayForm], ",", 
   FractionBox[
    TagBox[
     RowBox[{
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TemplateBox[{"\"\[SpaceIndicator]\""},
        "Ket"],
       DisplayForm]}],
     DisplayForm], 
    SqrtBox["2"]], ",", 
   TagBox[
    RowBox[{
     TagBox[
      TagBox[
       TemplateBox[{
         TemplateBox[{"a"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm],
      DisplayForm], 
     TagBox[
      TemplateBox[{"\"\[SpaceIndicator]\""},
       "Ket"],
      DisplayForm]}],
    DisplayForm], ",", 
   TagBox[
    RowBox[{
     TagBox[
      TagBox[
       TemplateBox[{
         TemplateBox[{"a"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm],
      DisplayForm], 
     TagBox[
      TagBox[
       TemplateBox[{
         TemplateBox[{"a"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
        "Subsuperscript"],
       DisplayForm],
      DisplayForm], 
     TagBox[
      TemplateBox[{"\"\[SpaceIndicator]\""},
       "Ket"],
      DisplayForm]}],
    DisplayForm], ",", 
   FractionBox[
    TagBox[
     RowBox[{
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TemplateBox[{"\"\[SpaceIndicator]\""},
        "Ket"],
       DisplayForm]}],
     DisplayForm], 
    SqrtBox["2"]], ",", 
   FractionBox[
    TagBox[
     RowBox[{
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TemplateBox[{"\"\[SpaceIndicator]\""},
        "Ket"],
       DisplayForm]}],
     DisplayForm], 
    SqrtBox["2"]], ",", 
   FractionBox[
    TagBox[
     RowBox[{
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TemplateBox[{"\"\[SpaceIndicator]\""},
        "Ket"],
       DisplayForm]}],
     DisplayForm], 
    SqrtBox["2"]], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    TagBox[
     RowBox[{
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TagBox[
        TemplateBox[{
          TemplateBox[{"a"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm],
       DisplayForm], 
      TagBox[
       TemplateBox[{"\"\[SpaceIndicator]\""},
        "Ket"],
       DisplayForm]}],
     DisplayForm]}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1761666659],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["2", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], DisplayForm]], 
        SubscriptBox["1", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], DisplayForm]], 
        SubscriptBox["2", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["2", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["2", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], DisplayForm]], 
        SubscriptBox["1", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["2", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], DisplayForm]], 
        SubscriptBox["2", 
         TagBox[
          SubscriptBox[
           TemplateBox[{"a"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], DisplayForm]]}, "RowDefault"], 
      DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->974496624],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"a"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"a"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1654467546]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"FockMatrix", "[", 
    RowBox[{"HH", ",", "vv"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"M1", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1412906953],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SqrtBox["2"], "0", "0", "0", 
      SqrtBox["2"], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1869408139]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{"FockMatrix", "[", 
    RowBox[{"HH", ",", "uu"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"M2", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[5]:=",
 CellID->965767512],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SqrtBox["2"], "0", "0", "0", 
      SqrtBox["2"], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1741296647]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{"FockMatrix", "[", 
    RowBox[{"HH", ",", "uu", ",", "vv"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"M2", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[6]:=",
 CellID->835389954],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SqrtBox["2"], "0", "0", "0", 
      SqrtBox["2"], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->294770522]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{"FockMatrix", "[", 
    RowBox[{"HH", ",", "vv", ",", "uu"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"M2", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[7]:=",
 CellID->1688311684],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SqrtBox["2"], "0", "0", "0", 
      SqrtBox["2"], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2", "0"},
     {"0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1452736288]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Generalizations & Extensions",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1020263627],

Cell["\<\
FockMatrix can take a special data structure returned by FermionBasis. The \
basis structure consists of the conserved quantum numbers and the basis \
spanning the subspace corresponding to the quantum numbers.\
\>", "ExampleText",
 CellID->15291577],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c", ",", "d"}], "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1454980646],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"FermionBasis", "[", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], ",", 
     RowBox[{"c", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "BasisForm"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->463428933],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], 
     RowBox[{"{", 
      TemplateBox[{"\"\[SpaceIndicator]\""},
       "Ket"], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "2"]}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             TagBox[
              SubscriptBox[
               TemplateBox[{"c"}, "RowDefault"], 
               TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
              DisplayForm]]}, "RowDefault"], DisplayForm]},
        "Ket"], ",", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             TagBox[
              SubscriptBox[
               TemplateBox[{"c"}, "RowDefault"], 
               TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
              DisplayForm]]}, "RowDefault"], DisplayForm]},
        "Ket"]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                
                TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""}, 
                 "RowDefault"]], DisplayForm]], 
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
               DisplayForm]]}, "RowDefault"], DisplayForm]},
         "Ket"]}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          TemplateBox[{
            TagBox[
             TemplateBox[{
               SubscriptBox["1", 
                TagBox[
                 SubscriptBox[
                  TemplateBox[{"c"}, "RowDefault"], 
                  
                  TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""}, 
                   "RowDefault"]], DisplayForm]], 
               SubscriptBox["1", 
                TagBox[
                 SubscriptBox[
                  TemplateBox[{"c"}, "RowDefault"], 
                  
                  TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, 
                   "RowDefault"]], DisplayForm]]}, "RowDefault"], 
             DisplayForm]},
           "Ket"]}], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               TagBox[
                SubscriptBox[
                 TemplateBox[{"c"}, "RowDefault"], 
                 TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]],
                 DisplayForm]], 
              SubscriptBox["1", 
               TagBox[
                SubscriptBox[
                 TemplateBox[{"c"}, "RowDefault"], 
                 
                 TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""}, 
                  "RowDefault"]], DisplayForm]]}, "RowDefault"], DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], ",", 
       RowBox[{"-", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                
                TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""}, 
                 "RowDefault"]], DisplayForm]], 
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
               DisplayForm]]}, "RowDefault"], DisplayForm]},
         "Ket"]}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], 
     RowBox[{"{", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            TagBox[
             SubscriptBox[
              TemplateBox[{"c"}, "RowDefault"], 
              TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
             DisplayForm]], 
           SubscriptBox["1", 
            TagBox[
             SubscriptBox[
              TemplateBox[{"c"}, "RowDefault"], 
              TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
             DisplayForm]]}, "RowDefault"], DisplayForm]},
       "Ket"], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["1", "2"]}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                
                TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""}, 
                 "RowDefault"]], DisplayForm]], 
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
               DisplayForm]], 
             SubscriptBox["1", 
              TagBox[
               SubscriptBox[
                TemplateBox[{"c"}, "RowDefault"], 
                TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
               DisplayForm]]}, "RowDefault"], DisplayForm]},
         "Ket"]}], ",", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             TagBox[
              SubscriptBox[
               TemplateBox[{"c"}, "RowDefault"], 
               TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
              DisplayForm]], 
            SubscriptBox["1", 
             TagBox[
              SubscriptBox[
               TemplateBox[{"c"}, "RowDefault"], 
               TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""}, "RowDefault"]],
               DisplayForm]], 
            SubscriptBox["1", 
             TagBox[
              SubscriptBox[
               TemplateBox[{"c"}, "RowDefault"], 
               TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
              DisplayForm]]}, "RowDefault"], DisplayForm]},
        "Ket"]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], 
     RowBox[{"{", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            TagBox[
             SubscriptBox[
              TemplateBox[{"c"}, "RowDefault"], 
              TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""}, "RowDefault"]], 
             DisplayForm]], 
           SubscriptBox["1", 
            TagBox[
             SubscriptBox[
              TemplateBox[{"c"}, "RowDefault"], 
              TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
             DisplayForm]], 
           SubscriptBox["1", 
            TagBox[
             SubscriptBox[
              TemplateBox[{"c"}, "RowDefault"], 
              TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""}, "RowDefault"]], 
             DisplayForm]], 
           SubscriptBox["1", 
            TagBox[
             SubscriptBox[
              TemplateBox[{"c"}, "RowDefault"], 
              TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"]], 
             DisplayForm]]}, "RowDefault"], DisplayForm]},
       "Ket"], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {Center, {Left}}, "Rows" -> {{Center}}},
   GridBoxDividers->{"Rows" -> {True, {
        Dashing[{Small, Small}]}, True}},
   GridBoxFrame->{"Columns" -> False, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->"Out[2]=",
 CellID->202806099]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"HH", "=", 
  RowBox[{"PlusDagger", "[", " ", 
   RowBox[{"Hop", "@@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "All"}], "]"}], ",", 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "All"}], "]"}]}], "}"}]}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MM", "=", 
  RowBox[{"FockMatrix", "[", 
   RowBox[{"HH", ",", "bs"}], "]"}]}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1735956165],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"2", "\",\"", "\"\[DownArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1", "\",\"", "\"\[DownArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TagBox[
      TemplateBox[{
        TemplateBox[{"c"}, "RowDefault"], 
        TemplateBox[{"2", "\",\"", "\"\[UpArrow]\""}, "RowDefault"], 
        TemplateBox[{"\"\[Dagger]\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm],
     DisplayForm], 
    TagBox[
     TagBox[
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1", "\",\"", "\"\[UpArrow]\""},
        "RowDefault"]],
      DisplayForm],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->246656538],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      FractionBox["1", "2"]}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SqrtBox["2"], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SqrtBox["2"], ",", "0", ",", 
        SqrtBox["2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SqrtBox["2"], ",", "0"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", 
      FractionBox["1", "2"]}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"4", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1481608909]
}, Open  ]],

Cell["\<\
In this case, the output has a special data structure. It is convenient to \
use FockMatrixForm to display the particular data structure.\
\>", "ExampleText",
 CellID->797316146],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MM", "//", "FockMatrixForm"}]], "Input",
 CellLabel->"In[4]:=",
 CellID->194508542],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "2"]}], "}"}], "\[SpanFromLeft]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], "\[SpanFromLeft]", "\[SpanFromLeft]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["1", "2"]}], "}"}], "\[SpanFromLeft]", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0", 
     "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "2"]}], "}"}], "0", "0", "1", "0", "0", "0", "0", "0",
      "0", "0"},
    {"\[SpanFromAbove]", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], "0", "0", "0", "0", 
     SqrtBox["2"], "0", "0", "0", "0", "0"},
    {"\[SpanFromAbove]", "0", "0", "0", 
     SqrtBox["2"], "0", 
     SqrtBox["2"], "0", "0", "0", "0"},
    {"\[SpanFromAbove]", "0", "0", "0", "0", 
     SqrtBox["2"], "0", "0", "0", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0", 
     "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["1", "2"]}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0",
      "1", "0"},
    {"\[SpanFromAbove]", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0", 
     "0", "0"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Center}}},
   GridBoxDividers->{
    "ColumnsIndexed" -> {
      2 -> True, 3 -> Dashing[{Small, Small}], 5 -> Dashing[{Small, Small}], 
       8 -> Dashing[{Small, Small}], 9 -> Dashing[{Small, Small}], 11 -> 
       Dashing[{Small, Small}]}, 
     "RowsIndexed" -> {
      2 -> True, 3 -> Dashing[{Small, Small}], 5 -> Dashing[{Small, Small}], 
       8 -> Dashing[{Small, Small}], 9 -> Dashing[{Small, Small}], 11 -> 
       Dashing[{Small, Small}]}},
   GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->"Out[4]=",
 CellID->2051228671]
}, Open  ]],

Cell[TextData[{
 "Above only diagonal blocks have been evaluated given that the Hamiltonian \
conserves Spin and Number. You can check if the off-diagonal blocks indeed \
vanishes by setting the option ",
 StyleBox["DiagonalOnly\[Rule]False",
  FontWeight->"Bold"],
 "."
}], "ExampleText",
 CellID->836728677],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{"FockMatrix", "[", 
    RowBox[{"HH", ",", "bs", ",", 
     RowBox[{"DiagonalOnly", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"M2", "//", "FockMatrixForm"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->1175953783],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "2"]}], "}"}], "\[SpanFromLeft]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], "\[SpanFromLeft]", "\[SpanFromLeft]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["1", "2"]}], "}"}], "\[SpanFromLeft]", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0", 
     "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "2"]}], "}"}], "0", "0", "1", "0", "0", "0", "0", "0",
      "0", "0"},
    {"\[SpanFromAbove]", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], "0", "0", "0", "0", 
     SqrtBox["2"], "0", "1", "0", "0", "0"},
    {"\[SpanFromAbove]", "0", "0", "0", 
     SqrtBox["2"], "0", 
     SqrtBox["2"], "0", "0", "0", "0"},
    {"\[SpanFromAbove]", "0", "0", "0", "0", 
     SqrtBox["2"], "0", 
     RowBox[{"-", "1"}], "0", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "0", "0", "0", "1", "0", 
     RowBox[{"-", "1"}], "0", "0", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["1", "2"]}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0",
      "1", "0"},
    {"\[SpanFromAbove]", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
    {
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], "0", "0", "0", "0", "0", "0", "0", "0", 
     "0", "0"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Center}}},
   GridBoxDividers->{
    "ColumnsIndexed" -> {
      2 -> True, 3 -> Dashing[{Small, Small}], 5 -> Dashing[{Small, Small}], 
       8 -> Dashing[{Small, Small}], 9 -> Dashing[{Small, Small}], 11 -> 
       Dashing[{Small, Small}]}, 
     "RowsIndexed" -> {
      2 -> True, 3 -> Dashing[{Small, Small}], 5 -> Dashing[{Small, Small}], 
       8 -> Dashing[{Small, Small}], 9 -> Dashing[{Small, Small}], 11 -> 
       Dashing[{Small, Small}]}},
   GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->"Out[5]=",
 CellID->948055358]
}, Open  ]]
}, Closed]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Matrix"]], "paclet:Q3/ref/Matrix"},
  "RefLink",
  BaseStyle->{
   "InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Fock"]], "paclet:Q3/guide/Fock"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1227952916]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"FockMatrix",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 1, 6, 9, 41, 23.255385}", 
    "history" -> {"XX", "", "", ""}, "context" -> "Q3`Fock`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quisso Package Symbol", "language" -> "en", "paclet" -> "Quisso Package",
     "status" -> "None", "summary" -> 
    "FockMatrix[op, vlist] computes the matrix elements of the operator op \
between the vectors in the list vlist. Vecotrs in vlist can be either in the \
Ket or Cat form (the latter is slightly more efficient. FockMatrix[op, \
vlist1, vlist2] calculates the matrix elements between two vectors, one from \
vlist1 and the other from vlist2. FockMatrix[op, basis] calculates the matrix \
elements between vectors in the basis 'basis'. The basis is a list with \
particular structure and can be constructed by FermionBasis.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "FockMatrix", 
    "titlemodifier" -> "", "windowtitle" -> "FockMatrix", "type" -> "Symbol", 
    "uri" -> "Q3/ref/FockMatrix", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.1 for Mac OS X x86 (64-bit) (June 19, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6961, 213, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"6c59078d-d232-480f-8275-4f280b8b5159",
   CellTags->"PrimaryExamplesSection",
   CellID->234546939]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 49151, 1654}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[582, 21, 3490, 89, 70, "AnchorBarGrid",ExpressionUUID->"400d0858-d2ed-4312-9785-63471cc03c4f",
 CellID->1],
Cell[CellGroupData[{
Cell[4097, 114, 167, 6, 70, "ObjectNameGrid",ExpressionUUID->"47880f8c-b16f-4916-a623-a94e7c1c3f52"],
Cell[4267, 122, 1607, 44, 70, "Usage",ExpressionUUID->"639fe501-1c7b-4785-a03e-944765f5f878"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5911, 171, 627, 19, 70, "NotesSection",ExpressionUUID->"29186dc5-9122-448f-88d9-eed635bf2d4f",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1291687],
Cell[6541, 192, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"40344b66-ad7f-4ed6-9483-76db0a9ab3a3"],
Cell[6575, 194, 259, 10, 70, "Notes",ExpressionUUID->"d0a9b8fc-765d-49f0-990b-75d5eb1d69b1",
 CellID->613871602],
Cell[6837, 206, 53, 0, 70, "Notes",ExpressionUUID->"7dcde984-142e-44a4-be5e-2b8a320eb842"],
Cell[6893, 208, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"4c32a9a4-b3e0-4cc2-a8d8-7494edb2f307"]
}, Closed]],
Cell[CellGroupData[{
Cell[6961, 213, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"6c59078d-d232-480f-8275-4f280b8b5159",
 CellTags->"PrimaryExamplesSection",
 CellID->234546939],
Cell[CellGroupData[{
Cell[7253, 227, 196, 6, 70, "ExampleSection",ExpressionUUID->"427c3c51-ccf4-4253-aae8-98f512a7b859",
 CellID->1397911528],
Cell[7452, 235, 95, 3, 70, "Input",ExpressionUUID->"0e2e7f7e-bd42-4099-a839-41b7040c95dd",
 CellID->666594043],
Cell[CellGroupData[{
Cell[7572, 242, 267, 8, 70, "Input",ExpressionUUID->"664def93-f23f-4bbe-8978-384f5e9336bc",
 CellID->1983840372],
Cell[7842, 252, 387, 18, 70, "Output",ExpressionUUID->"850807b1-ab42-437a-b0fa-7495d7428f0f",
 CellID->1319658651]
}, Open  ]],
Cell[CellGroupData[{
Cell[8266, 275, 763, 24, 70, "Input",ExpressionUUID->"b75fa2f2-a6f6-4e21-909c-4ddc31d82d76",
 CellID->1206877450],
Cell[9032, 301, 6351, 234, 70, "Output",ExpressionUUID->"1ddd231f-76a9-4b4e-9a6a-59a4465e4c69",
 CellID->1761666659],
Cell[15386, 537, 3108, 106, 70, "Output",ExpressionUUID->"711c1f6c-ef55-4ad3-9c47-57b453daf88b",
 CellID->974496624],
Cell[18497, 645, 1040, 45, 70, "Output",ExpressionUUID->"4630c968-67ba-4f06-a3bb-7c5d9a622ffe",
 CellID->1654467546]
}, Open  ]],
Cell[CellGroupData[{
Cell[19574, 695, 240, 7, 70, "Input",ExpressionUUID->"4705aa4a-1379-4f2f-a836-69bc4c869144",
 CellID->1412906953],
Cell[19817, 704, 1036, 28, 70, "Output",ExpressionUUID->"f48ac1d5-edb4-4493-a9f8-3dded96620c0",
 CellID->1869408139]
}, Open  ]],
Cell[CellGroupData[{
Cell[20890, 737, 262, 7, 70, "Input",ExpressionUUID->"d4bf7a2e-dd1b-4b88-b5cb-c6b524e44208",
 CellID->965767512],
Cell[21155, 746, 1036, 28, 70, "Output",ExpressionUUID->"4ad26825-b60e-4f0f-8bbc-527cf7f989b4",
 CellID->1741296647]
}, Open  ]],
Cell[CellGroupData[{
Cell[22228, 779, 276, 8, 70, "Input",ExpressionUUID->"8f501f0b-bce1-4948-909e-dce7b46e968e",
 CellID->835389954],
Cell[22507, 789, 1035, 28, 70, "Output",ExpressionUUID->"b75a9794-90f9-475c-a971-1b7d1839520e",
 CellID->294770522]
}, Open  ]],
Cell[CellGroupData[{
Cell[23579, 822, 254, 8, 70, "Input",ExpressionUUID->"0ce0274e-e986-42b0-81f1-5319c47ef1dd",
 CellID->1688311684],
Cell[23836, 832, 1036, 28, 70, "Output",ExpressionUUID->"85948162-3b12-4de7-9b6a-86f6a52b7489",
 CellID->1452736288]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24921, 866, 210, 6, 70, "ExampleSection",ExpressionUUID->"ebffe170-1bc9-490f-b1d9-882e3bccf52e",
 CellID->1020263627],
Cell[25134, 874, 260, 5, 70, "ExampleText",ExpressionUUID->"894a45e0-7efa-4147-85a6-93fe558c7d3d",
 CellID->15291577],
Cell[25397, 881, 139, 4, 70, "Input",ExpressionUUID->"e1bc411b-5011-4a84-a62d-4310ec551d04",
 CellID->1454980646],
Cell[CellGroupData[{
Cell[25561, 889, 300, 9, 70, "Input",ExpressionUUID->"7428e1f5-df15-486c-904b-dcd2e8a1e276",
 CellID->463428933],
Cell[25864, 900, 7864, 228, 70, "Output",ExpressionUUID->"ebfcb799-5f79-4cba-be72-0c6a28c2beb1",
 CellID->202806099]
}, Open  ]],
Cell[CellGroupData[{
Cell[33765, 1133, 463, 15, 70, "Input",ExpressionUUID->"2994c55b-cc44-4b97-ae1b-93ba1c7605df",
 CellID->1735956165],
Cell[34231, 1150, 4385, 171, 70, "Output",ExpressionUUID->"42d0b8d8-3532-4b28-a801-184d791ab5fd",
 CellID->246656538],
Cell[38619, 1323, 1531, 54, 70, "Output",ExpressionUUID->"c0bc4540-6dde-49cb-a716-0a70688155ee",
 CellID->1481608909]
}, Open  ]],
Cell[40165, 1380, 188, 4, 70, "ExampleText",ExpressionUUID->"8462c4f6-9164-4fe5-b621-510154fa4318",
 CellID->797316146],
Cell[CellGroupData[{
Cell[40378, 1388, 107, 3, 70, "Input",ExpressionUUID->"741c516e-30f9-4640-ac90-322589a90fee",
 CellID->194508542],
Cell[40488, 1393, 2385, 66, 70, "Output",ExpressionUUID->"61f569b6-56e5-4cc2-b76b-985326974e0c",
 CellID->2051228671]
}, Open  ]],
Cell[42888, 1462, 309, 8, 70, "ExampleText",ExpressionUUID->"71709f7c-a08a-4bbc-91dc-4592b057e321",
 CellID->836728677],
Cell[CellGroupData[{
Cell[43222, 1474, 304, 9, 70, "Input",ExpressionUUID->"aea38837-e50c-4d95-8627-b7b42703a507",
 CellID->1175953783],
Cell[43529, 1485, 2420, 67, 70, "Output",ExpressionUUID->"aaf7e9b4-abe5-433e-b84a-8aee5df33bc6",
 CellID->948055358]
}, Open  ]]
}, Closed]],
Cell[45976, 1556, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"f8714483-2a43-4287-9cea-e03f48537a2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46044, 1561, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"01358d07-62c8-44e7-8747-e002c7c0af45",
 CellID->1255426704],
Cell[46197, 1570, 227, 7, 70, "SeeAlso",ExpressionUUID->"73ba19bb-5f0f-4920-a738-665bc5d8a7c5",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[46461, 1582, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"e8c9bd2b-6a5a-451a-9322-cea2ff5992b6",
 CellID->38303248],
Cell[46620, 1591, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"2d4d2f08-b1cf-44ed-8902-5b21c84f673d"],
Cell[46654, 1593, 160, 6, 70, "MoreAbout",ExpressionUUID->"5c68df94-718c-4f1b-9db7-46492131dd93",
 CellID->1227952916]
}, Open  ]],
Cell[46829, 1602, 23, 0, 70, "FooterCell",ExpressionUUID->"32fe70e6-9711-4462-8ea3-ca34b2733d3d"]
}
]
*)

(* End of internal cache information *)
