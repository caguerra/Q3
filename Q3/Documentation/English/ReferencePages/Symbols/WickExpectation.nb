(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71374,       1845]
NotebookOptionsPosition[     63556,       1686]
NotebookOutlinePosition[     65863,       1742]
CellTagsIndexPosition[     65777,       1737]
WindowTitle->WickExpectation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "20085efc-f760-4b0a-850a-c6e19af186ae"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "b0a7b693-c5fa-4512-ad17-8611d25a1e59"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "5ee59b29-7454-4c53-8dca-43368744124c"]
         }],ExpressionUUID->"33e5e0d3-6384-41be-9e3e-26a532fefe4c"],
         StripOnInput->False],{
        "\"WickState\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/WickState"], "\"Fermion\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/Fermion"], "\"Majorana\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/Majorana"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "12a6fcd8-c735-4e2f-8843-06fd52bf9b0a"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "df8c886f-9275-4cd1-af13-825700e863d1"]
         }],ExpressionUUID->"e8b294d6-c96c-4987-a285-d5f4ba769bd3"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/QuantumManyBodySystems"], 
         "\"Q3\"" :> Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "9f89c594-dac1-4e2f-8b1b-832346a4c1bc"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "db5bd755-c81d-4db9-8ada-4e9994de0253"]
         }],ExpressionUUID->"7c8def40-75e3-4b49-9532-1fb65b9414b7"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumManyBodySystems"], "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "687d0e79-2474-4428-b984-dc949c3194c1"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "43fee9de-6d18-4655-88a8-e0005e8b8bbc"]
         }],ExpressionUUID->"ecbb700d-e55b-4422-94fe-191c8174a8b1"],
         StripOnInput->False],{
        "\"Q3/ref/WickExpectation\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{Cell["Q3/ref/WickExpectation"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/Q3/ref/\
WickExpectation.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "Q3/ref/WickExpectation" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "5a15ed8c-584b-4a53-9cfd-716c22a0f263"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "648a9629-64ca-401e-88f1-9a3064493ae6"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"6e30c819-4341-4af3-950c-294b86fd0088"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"228250eb-87a5-4227-819c-f38897c3a8cb"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "WickExpectation", "ObjectName",ExpressionUUID->
      "27987a23-9361-4817-9599-2efa67c2d7ea"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"e72fa9d2-f055-4e6c-8116-2aa1bbd5686a"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "ba5a7869-9d02-4a07-ae97-6a68c64bf537"]
    }],ExpressionUUID->"6fb0f687-4fc4-420b-9dc4-82d1f71b288d"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "ed696f60-3116-4be0-a4aa-e4524d40bd6e"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"0814ec97-c688-44f1-bcb8-e76e813b13f8"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickExpectation"]], "paclet:Q3/ref/WickExpectation", 
         "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["expr", "TI"], ",", 
        StyleBox["mat", "TI"], ",", 
        StyleBox["assoc", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "5824f752-d533-435b-9e9a-840ecd4e0fd8"],
     "\[LineSeparator]calculates the expectation value of a polynomial ",
     Cell[BoxData[
      StyleBox["expr", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "9f80424c-1810-4005-a53d-6b1981c5f0ad"],
     " of fermion creation and annihilation operators with respect to \
many-fermion state ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickState"]], "paclet:Q3/ref/WickState", 
         "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["mat", "TI"], ",", 
        StyleBox["assoc", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "b1cc6456-bb9f-46dd-bead-f5909a265324"],
     " efficiently based on the Wick theorem."
    }],ExpressionUUID->"6e54a796-78b4-49fd-af99-cdd79805cca6"]}
  }]], "Usage",
 CellID->181326928,ExpressionUUID->"5c22140a-88a9-4b46-bcc1-da07620acd10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "36e5d608-6518-4fe1-b975-47bad9d3b1c3"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"461728ca-8498-4d19-b4f8-f5d1e317d50c"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "e03aaf8b-ebca-411e-8d6b-f20978651dc6"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1664338330,ExpressionUUID->"856d2445-501e-4704-aac1-ed453478a1a2"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1273144629,ExpressionUUID->"01468630-bdf3-45ba-8977-78072c7ce9a8"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "0fcb8ef4-dd9e-438e-ac78-19c47f92da00"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"0b432bec-70b4-4aae-b623-e5fb07a9d296"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "2e0eee64-faaa-4048-b316-83dc95163be6"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1559810135,ExpressionUUID->"cad0737b-be12-44be-a5c7-5cd73f2982bf"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->642232351,ExpressionUUID->"9ecb138c-9f1e-4135-8812-22a085139e0f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$L", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$L"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->2081441484,ExpressionUUID->"ed61832b-5d53-41b7-b717-0108c47fd50b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`c[4]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->370362795,ExpressionUUID->"b390f22e-3718-4afb-86d3-a809286b6aea"]
}, Open  ]],

Cell["\<\
Consider a initial state expressed in terms of bare fermion modes.\
\>", "ExampleText",
 CellID->211265417,ExpressionUUID->"d9581685-7a5c-49e4-8a03-14f820c481e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Ket", "[", 
   RowBox[{"cc", "->", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", "$L"}], "]"}]}], "]"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1072961204,ExpressionUUID->"3a59e698-e038-4f3d-93cc-9ed39a24508b"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`c[1]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`c[2]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`c[3]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`c[4]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
    1, $CellContext`c[4] -> 1|>]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1071813380,ExpressionUUID->"d0c51faa-26cd-465c-bb7a-101559126060"]
}, Open  ]],

Cell["\<\
Consider a unitary matrix that, typically, governs the time-evolution of the \
fermion operators in the Heisenberg picture.\
\>", "ExampleText",
 CellID->1840183255,ExpressionUUID->"89a8a62c-7c83-4a79-8c84-dcea3b898248"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", "$L", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1177047662,ExpressionUUID->"5a073f95-7124-4efe-9dff-bd78b9bf5ee4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.11376033370966554`"}], "+", 
       RowBox[{"0.27527843736669705`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.13116332821527235`"}], "+", 
       RowBox[{"0.06937335634521405`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06571664697564669`"}], "-", 
       RowBox[{"0.001542086574803347`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6913033384319722`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6379988445978497`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.4260531383082617`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.15305127399428245`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5271688235214991`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.003857624450523161`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6458266220731048`"}], "-", 
       RowBox[{"0.26111725575894373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.17819223874769916`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.010269377956327713`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.6378646081103229`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3403316257044068`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.32844981194394746`"}], "-", 
       RowBox[{"0.3643759511067113`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3753518779361359`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24342012830438559`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.17078631002995498`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.08569514996293229`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.4284617414237478`"}], "-", 
       RowBox[{"0.0076198204317560955`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.41224558172789144`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5380205726887658`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.22871722329042057`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5078885093032209`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.09414457648531065`"}], "-", 
       RowBox[{"0.19448498859468724`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1246621672,ExpressionUUID->"6c2f9df8-8cad-4e36-b887-31cdbddc641c"]
}, Open  ]],

Cell["\<\
Construct a fermionic Gaussian state, which is typically the final state \
after a time evolution.\
\>", "ExampleText",
 CellID->1302181131,ExpressionUUID->"fc49456c-627b-47c2-ab81-7fe703efb81d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vec", "=", 
  RowBox[{"WickState", "[", 
   RowBox[{"mat", ",", "in"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1291801220,ExpressionUUID->"86a8a02c-f487-40c8-8b4d-18e6889cb8ee"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Bare modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Occupation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Bare modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`c[1]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`c[2]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`c[3]], ",", 
                    InterpretationBox[
                    SubscriptBox["c", 
                    TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                    $CellContext`c[4]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Occupation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.11376033370966554`"}], "+", 
                    RowBox[{"0.27527843736669705`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.13116332821527235`"}], "+", 
                    RowBox[{"0.06937335634521405`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.06571664697564669`"}], "-", 
                    RowBox[{"0.001542086574803347`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.6913033384319722`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.6379988445978497`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.4260531383082617`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.15305127399428245`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.5271688235214991`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.003857624450523161`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.6458266220731048`"}], "-", 
                    RowBox[{"0.26111725575894373`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.17819223874769916`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{
                    "0.010269377956327713`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.6378646081103229`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.3403316257044068`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.32844981194394746`"}], "-", 
                    RowBox[{"0.3643759511067113`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.3753518779361359`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.24342012830438559`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.17078631002995498`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{
                    "0.08569514996293229`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.4284617414237478`"}], "-", 
                    
                    RowBox[{
                    "0.0076198204317560955`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.41224558172789144`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5380205726887658`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.22871722329042057`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5078885093032209`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.09414457648531065`"}], "-", 
                    
                    RowBox[{
                    "0.19448498859468724`", " ", "\[ImaginaryI]"}]}]}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, {{
                    Complex[-0.11376033370966554`, 0.27527843736669705`], 
                    Complex[-0.13116332821527235`, 0.06937335634521405], 
                    Complex[-0.06571664697564669, -0.001542086574803347], 
                    Complex[0.6913033384319722, -0.6379988445978497]}, {
                    Complex[0.4260531383082617, -0.15305127399428245`], 
                    Complex[0.5271688235214991, 0.003857624450523161], 
                    Complex[-0.6458266220731048, -0.26111725575894373`], 
                    Complex[0.17819223874769916`, 0.010269377956327713`]}, {
                    Complex[0.6378646081103229, -0.3403316257044068], 
                    Complex[-0.32844981194394746`, -0.3643759511067113], 
                    Complex[0.3753518779361359, -0.24342012830438559`], 
                    Complex[0.17078631002995498`, -0.08569514996293229]}, {
                    Complex[-0.4284617414237478, -0.0076198204317560955`], 
                    Complex[0.41224558172789144`, -0.5380205726887658], 
                    Complex[0.22871722329042057`, -0.5078885093032209], 
                    Complex[-0.09414457648531065, -0.19448498859468724`]}}]]],
                   "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`WickState[{{
     Complex[-0.11376033370966554`, 0.27527843736669705`], 
     Complex[-0.13116332821527235`, 0.06937335634521405], 
     Complex[-0.06571664697564669, -0.001542086574803347], 
     Complex[0.6913033384319722, -0.6379988445978497]}, {
     Complex[0.4260531383082617, -0.15305127399428245`], 
     Complex[0.5271688235214991, 0.003857624450523161], 
     Complex[-0.6458266220731048, -0.26111725575894373`], 
     Complex[0.17819223874769916`, 0.010269377956327713`]}, {
     Complex[0.6378646081103229, -0.3403316257044068], 
     Complex[-0.32844981194394746`, -0.3643759511067113], 
     Complex[0.3753518779361359, -0.24342012830438559`], 
     Complex[0.17078631002995498`, -0.08569514996293229]}, {
     Complex[-0.4284617414237478, -0.0076198204317560955`], 
     Complex[0.41224558172789144`, -0.5380205726887658], 
     Complex[0.22871722329042057`, -0.5078885093032209], 
     Complex[-0.09414457648531065, -0.19448498859468724`]}}, <|$CellContext`c[
     1] -> 0, $CellContext`c[2] -> 0, $CellContext`c[3] -> 
    1, $CellContext`c[4] -> 1|>],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[5]=",
 CellID->1053464656,ExpressionUUID->"d69ae5b5-f95c-48f7-9efd-22aa784a4204"]
}, Open  ]],

Cell["We will take the expectation value of this operator.", "ExampleText",
 CellID->2030733412,ExpressionUUID->"96b741ce-e6a0-466e-bbce-d3ff94a93ac9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"msr", "=", 
  RowBox[{
   RowBox[{"Dagger", "[", 
    RowBox[{"c", "[", "3", "]"}], "]"}], "**", 
   RowBox[{"c", "[", "1", "]"}]}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->889371961,ExpressionUUID->"d5ec5a30-6bd7-4851-b3ae-d6c7291ab887"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      InterpretationBox[
       TemplateBox[{"c", 
         TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
        "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
       Q3`Dagger[
        $CellContext`c[3]]], 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
       $CellContext`c[1]]}, "RowWithSeparators"]},
   "RowDefault"],
  Q3`Multiply[
   Q3`Dagger[
    $CellContext`c[3]], 
   $CellContext`c[1]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->47769971,ExpressionUUID->"b6f6dafa-9fcb-486f-b5ab-4594222b6186"]
}, Open  ]],

Cell["\<\
Calculate the expectation value with the new method based on the Wick theorem.\
\>", "ExampleText",
 CellID->291580177,ExpressionUUID->"ed8c8f66-95d5-42bc-b139-d3b6cd55a44d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"avg", "=", 
  RowBox[{
   RowBox[{"WickExpectation", "[", 
    RowBox[{"msr", ",", "mat", ",", "in"}], "]"}], "//", "Chop"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->662420490,ExpressionUUID->"b06b0415-3dc9-4d46-b790-6a6fba1e4cb6"],

Cell[BoxData[
 RowBox[{"0.14844706100409602`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.06629570494577632`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1303993290,ExpressionUUID->"a9111e41-d999-446a-8c70-d571f87375ba"]
}, Open  ]],

Cell["\<\
Now, let us calculate the same expectation value with the traditional method.\
\
\>", "ExampleText",
 CellID->358366140,ExpressionUUID->"ed9d2433-8cfa-47ed-8ceb-834d8f259889"],

Cell["\<\
To do that, first calculate the transformation of the fermion operators in \
the Heisenberg picture.\
\>", "ExampleText",
 CellID->1352111716,ExpressionUUID->"07f1a36c-e8f0-4aad-ab96-edd8dcb4b356"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trs", "=", 
  RowBox[{"TransformBy", "[", 
   RowBox[{
    RowBox[{"cc", "->", "cc"}], ",", "mat"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->798243277,ExpressionUUID->"a0ee0075-eb07-4108-b937-41a3d23b93d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`c[1]], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.11376033370966554`"}], "+", 
        RowBox[{"0.27527843736669705`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.13116332821527235`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.06937335634521405`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`c[2]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.06571664697564669`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.001542086574803347`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`c[3]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.6913033384319722`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.6379988445978497`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`c[4]]}]}]}], ",", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`c[2]], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.4260531383082617`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.15305127399428245`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.5271688235214991`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.003857624450523161`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`c[2]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.6458266220731048`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.26111725575894373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`c[3]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.17819223874769916`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.010269377956327713`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`c[4]]}]}]}], ",", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "3"},
       "RowWithSeparators"]],
     $CellContext`c[3]], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.6378646081103229`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.3403316257044068`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.32844981194394746`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.3643759511067113`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`c[2]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.3753518779361359`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.24342012830438559`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`c[3]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.17078631002995498`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.08569514996293229`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`c[4]]}]}]}], ",", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "4"},
       "RowWithSeparators"]],
     $CellContext`c[4]], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.4284617414237478`"}], "-", 
        RowBox[{"0.0076198204317560955`", " ", "\[ImaginaryI]"}]}], ")"}], 
      " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.41224558172789144`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.5380205726887658`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`c[2]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.22871722329042057`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.5078885093032209`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`c[3]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.09414457648531065`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.19448498859468724`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`c[4]]}]}]}]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->283594785,ExpressionUUID->"4cf2f0b5-6e9a-4880-b0ce-71c67bd1441d"]
}, Open  ]],

Cell["\<\
Apply the above transformation rule to calculate the evolution of the \
operator.\
\>", "ExampleText",
 CellID->1101221534,ExpressionUUID->"44880587-f8b8-4760-b73b-3450299c8f35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{"msr", "/.", "trs"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->1541026710,ExpressionUUID->"f2c34fc6-f548-40e8-944f-967342106ec9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "0.16624964879059206`"}], "+", 
     RowBox[{"0.136874133260044`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10727439209601818`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.00038821996586659024`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04139350243846555`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.023349095749773556`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.6580891170337873`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.1716844939608094`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
         $CellContext`c[4]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[4]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06294028222103915`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1318666807789916`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[1]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.01780258778649629`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07057842831426761`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0221465196031208`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0234390676997998`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.005412984301120027`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.4614449119730141`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
         $CellContext`c[4]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[4]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.10970846743579662`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0756347233933582`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.0661192728644141`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.005888374600082992`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.024291491942079968`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.01657557973033847`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.41478376691401925`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07119691710252704`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
         $CellContext`c[4]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[4]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04301873459375084`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.03726507969158725`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[4]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[4]], 
     $CellContext`c[1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.028345861012569303`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0006079584635471993`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[4]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[4]], 
     $CellContext`c[2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.011091354304228302`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.005894965193496519`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[4]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[4]], 
     $CellContext`c[3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17273855294617596`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.04972012521543784`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[4]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
         $CellContext`c[4]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[4]], 
     $CellContext`c[4]]]}]}]], "Output",
 CellLabel->"Out[9]=",
 CellID->990268252,ExpressionUUID->"8463c15c-4a3f-456c-b4e5-91d06b6825bf"]
}, Open  ]],

Cell["Calculate the expectation value with the traditional method.", \
"ExampleText",
 CellID->911311823,ExpressionUUID->"9e358212-4cdf-40c3-88e9-3bb75088c215"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Dagger", "[", "in", "]"}], "**", "alt", "**", "in"}], "//", 
   "Chop"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[10]:=",
 CellID->1114693032,ExpressionUUID->"e63eb79c-4b3e-4eaa-affa-c14638c436ea"],

Cell[BoxData[
 RowBox[{"0.148447061004096`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.0662957049457763`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellLabel->"Out[10]=",
 CellID->1647693784,ExpressionUUID->"c1615882-7535-4b05-8142-b614a86e3730"]
}, Open  ]],

Cell["Compare the two results.", "ExampleText",
 CellID->947911960,ExpressionUUID->"b5a971a6-4e6a-47f2-bbd3-b2519b82e376"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"avg", "-", "new"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[11]:=",
 CellID->1962460341,ExpressionUUID->"c88342b5-6619-4639-ad7e-ec3757bf094d"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[11]=",
 CellID->838650777,ExpressionUUID->"78363452-d9bf-4d0d-8139-a4aee53df1ae"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickState"]], "paclet:Q3/ref/WickState", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "9ba0e147-a447-4af0-9ba9-3715c81d6583"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fermion"]], "paclet:Q3/ref/Fermion", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "0e637fd1-cd16-4d79-943b-5875c050fbe1"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Majorana"]], "paclet:Q3/ref/Majorana", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "ea523db7-bf98-4334-89bb-ab176ed8acb2"]
       }], "SeeAlso",ExpressionUUID->"e38008a2-dd69-45e0-8a59-9c132eb94b70"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"958a497c-cc4e-4dc9-854a-\
a948f90923ca"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "64892842-b5c7-498a-a744-e0f7b2f1cf69"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "0233c41b-43cc-4152-baa6-aead8d73bfed"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"b822ecff-74e1-4dde-aff7-\
797691159049"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "1bd130b7-3d5b-4eff-8c56-41a97c00d59e"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "180df32e-7aa0-4329-a293-268d732d24ad"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"c6f7a506-5963-4c2c-ac65-\
48f2a15eeb15"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "B. M. Terhal and D. P. DiVincenzo (2002)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.65.032325"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "59081209-e051-4c23-b9af-c90494a42f0a"]}]],ExpressionUUID->
         "5b9d41c8-591b-4085-8406-829069b6eb63"],
        ", Physical Review A 65, 032325, \"Classical simulation of \
noninteracting-fermion quantum circuits.\""
       }], "RelatedLinks",ExpressionUUID->
        "c927555a-61e2-42bf-a3ac-db7a16bd0285"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "07f03bde-19e7-4f76-b576-e59fecbdc79c"]}]],ExpressionUUID->
         "97e345ae-4636-4582-b1c4-33df063f319d"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "b7f6eaa4-abf3-4bc4-8982-f8bfae8332fa"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"d817a8a6-4e0c-4461-9330-\
7d5e8b0de003"],

Cell[" ", "FooterCell",ExpressionUUID->"288ae5ac-f32a-46a1-9520-02f3810703d1"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"WickExpectation",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}, 
    "AllOptsTable" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2024, 5, 14, 18, 11, 2.097038}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"Wick theorem"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "WickExpectation[expr, mat, assoc] calculates the expectation value of a \
polynomial expr of fermion creation and annihilation operators with respect \
to many-fermion state WickState[mat, assoc] efficiently based on the Wick \
theorem.", "synonyms" -> {}, "tabletags" -> {}, "title" -> "WickExpectation", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "WickExpectation", "type" -> "Symbol", "uri" -> "Q3/ref/WickExpectation"}},
CellContext->"Global`",
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.0 for Mac OS X ARM (64-bit) (December 12, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"262827fa-e0c1-493a-86b2-0780dada8b9d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[10527, 281, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"856d2445-501e-4704-aac1-ed453478a1a2",
   CellTags->"PrimaryExamplesSection",
   CellID->1664338330]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 65576, 1730}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 6881, 170, 57, "AnchorBarGrid",ExpressionUUID->"6e30c819-4341-4af3-950c-294b86fd0088",
 CellID->1],
Cell[7471, 193, 85, 0, 23, "ContextNameCell",ExpressionUUID->"228250eb-87a5-4227-819c-f38897c3a8cb"],
Cell[CellGroupData[{
Cell[7581, 197, 1389, 38, 60, "ObjectNameGrid",ExpressionUUID->"0814ec97-c688-44f1-bcb8-e76e813b13f8"],
Cell[8973, 237, 1517, 39, 138, "Usage",ExpressionUUID->"5c22140a-88a9-4b46-bcc1-da07620acd10",
 CellID->181326928]
}, Open  ]],
Cell[CellGroupData[{
Cell[10527, 281, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"856d2445-501e-4704-aac1-ed453478a1a2",
 CellTags->"PrimaryExamplesSection",
 CellID->1664338330],
Cell[11920, 320, 192, 3, 31, "Input",ExpressionUUID->"01468630-bdf3-45ba-8977-78072c7ce9a8",
 CellID->1273144629],
Cell[CellGroupData[{
Cell[12137, 327, 1368, 36, 31, "ExampleSection",ExpressionUUID->"cad0737b-be12-44be-a5c7-5cd73f2982bf",
 CellID->1559810135],
Cell[13508, 365, 210, 5, 29, "Input",ExpressionUUID->"9ecb138c-9f1e-4135-8812-22a085139e0f",
 CellID->642232351],
Cell[CellGroupData[{
Cell[13743, 374, 304, 8, 48, "Input",ExpressionUUID->"ed61832b-5d53-41b7-b717-0108c47fd50b",
 CellID->2081441484],
Cell[14050, 384, 719, 24, 37, "Output",ExpressionUUID->"b390f22e-3718-4afb-86d3-a809286b6aea",
 CellID->370362795]
}, Open  ]],
Cell[14784, 411, 172, 3, 38, "ExampleText",ExpressionUUID->"d9581685-7a5c-49e4-8a03-14f820c481e2",
 CellID->211265417],
Cell[CellGroupData[{
Cell[14981, 418, 357, 11, 29, "Input",ExpressionUUID->"3a59e698-e038-4f3d-93cc-9ed39a24508b",
 CellID->1072961204],
Cell[15341, 431, 1328, 32, 41, "Output",ExpressionUUID->"d0c51faa-26cd-465c-bb7a-101559126060",
 CellID->1071813380]
}, Open  ]],
Cell[16684, 466, 230, 4, 38, "ExampleText",ExpressionUUID->"89a8a62c-7c83-4a79-8c84-dcea3b898248",
 CellID->1840183255],
Cell[CellGroupData[{
Cell[16939, 474, 304, 8, 48, "Input",ExpressionUUID->"5a073f95-7124-4efe-9dff-bd78b9bf5ee4",
 CellID->1177047662],
Cell[17246, 484, 2681, 58, 100, "Output",ExpressionUUID->"6c2f9df8-8cad-4e36-b887-31cdbddc641c",
 CellID->1246621672]
}, Open  ]],
Cell[19942, 545, 205, 4, 38, "ExampleText",ExpressionUUID->"fc49456c-627b-47c2-ab81-7fe703efb81d",
 CellID->1302181131],
Cell[CellGroupData[{
Cell[20172, 553, 240, 6, 29, "Input",ExpressionUUID->"86a8a02c-f487-40c8-8b4d-18e6889cb8ee",
 CellID->1291801220],
Cell[20415, 561, 11898, 238, 65, "Output",ExpressionUUID->"d69ae5b5-f95c-48f7-9efd-22aa784a4204",
 CellID->1053464656]
}, Open  ]],
Cell[32328, 802, 151, 1, 70, "ExampleText",ExpressionUUID->"96b741ce-e6a0-466e-bbce-d3ff94a93ac9",
 CellID->2030733412],
Cell[CellGroupData[{
Cell[32504, 807, 293, 8, 70, "Input",ExpressionUUID->"d5ec5a30-6bd7-4851-b3ae-d6c7291ab887",
 CellID->889371961],
Cell[32800, 817, 785, 21, 39, "Output",ExpressionUUID->"b6f6dafa-9fcb-486f-b5ab-4594222b6186",
 CellID->47769971]
}, Open  ]],
Cell[33600, 841, 184, 3, 70, "ExampleText",ExpressionUUID->"ed8c8f66-95d5-42bc-b139-d3b6cd55a44d",
 CellID->291580177],
Cell[CellGroupData[{
Cell[33809, 848, 288, 8, 70, "Input",ExpressionUUID->"b06b0415-3dc9-4d46-b790-6a6fba1e4cb6",
 CellID->662420490],
Cell[34100, 858, 242, 4, 37, "Output",ExpressionUUID->"a9111e41-d999-446a-8c70-d571f87375ba",
 CellID->1303993290]
}, Open  ]],
Cell[34357, 865, 185, 4, 70, "ExampleText",ExpressionUUID->"ed9d2433-8cfa-47ed-8ceb-834d8f259889",
 CellID->358366140],
Cell[34545, 871, 207, 4, 70, "ExampleText",ExpressionUUID->"07f1a36c-e8f0-4aad-ab96-edd8dcb4b356",
 CellID->1352111716],
Cell[CellGroupData[{
Cell[34777, 879, 268, 7, 70, "Input",ExpressionUUID->"a0ee0075-eb07-4108-b937-41a3d23b93d3",
 CellID->798243277],
Cell[35048, 888, 6328, 186, 123, "Output",ExpressionUUID->"4cf2f0b5-6e9a-4880-b0ce-71c67bd1441d",
 CellID->283594785]
}, Open  ]],
Cell[41391, 1077, 188, 4, 70, "ExampleText",ExpressionUUID->"44880587-f8b8-4760-b73b-3450299c8f35",
 CellID->1101221534],
Cell[CellGroupData[{
Cell[41604, 1085, 205, 5, 70, "Input",ExpressionUUID->"f2c34fc6-f548-40e8-944f-967342106ec9",
 CellID->1541026710],
Cell[41812, 1092, 14151, 373, 129, "Output",ExpressionUUID->"8463c15c-4a3f-456c-b4e5-91d06b6825bf",
 CellID->990268252]
}, Open  ]],
Cell[55978, 1468, 160, 2, 70, "ExampleText",ExpressionUUID->"9e358212-4cdf-40c3-88e9-3bb75088c215",
 CellID->911311823],
Cell[CellGroupData[{
Cell[56163, 1474, 284, 8, 70, "Input",ExpressionUUID->"e63eb79c-4b3e-4eaa-affa-c14638c436ea",
 CellID->1114693032],
Cell[56450, 1484, 240, 4, 37, "Output",ExpressionUUID->"c1615882-7535-4b05-8142-b614a86e3730",
 CellID->1647693784]
}, Open  ]],
Cell[56705, 1491, 122, 1, 70, "ExampleText",ExpressionUUID->"b5a971a6-4e6a-47f2-bbd3-b2519b82e376",
 CellID->947911960],
Cell[CellGroupData[{
Cell[56852, 1496, 207, 5, 70, "Input",ExpressionUUID->"c88342b5-6619-4639-ad7e-ec3757bf094d",
 CellID->1962460341],
Cell[57062, 1503, 127, 2, 37, "Output",ExpressionUUID->"78363452-d9bf-4d0d-8139-a4aee53df1ae",
 CellID->838650777]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[57431, 1514, 1828, 50, 70, "SeeAlsoSection",ExpressionUUID->"958a497c-cc4e-4dc9-854a-a948f90923ca"],
Cell[59262, 1566, 1084, 28, 70, "TechNotesSection",ExpressionUUID->"b822ecff-74e1-4dde-aff7-797691159049"],
Cell[60349, 1596, 1040, 27, 70, "MoreAboutSection",ExpressionUUID->"c6f7a506-5963-4c2c-ac65-48f2a15eeb15"],
Cell[61392, 1625, 2079, 57, 70, "RelatedLinksSection",ExpressionUUID->"d817a8a6-4e0c-4461-9330-7d5e8b0de003"],
Cell[63474, 1684, 78, 0, 70, "FooterCell",ExpressionUUID->"288ae5ac-f32a-46a1-9520-02f3810703d1"]
}
]
*)

(* End of internal cache information *)

