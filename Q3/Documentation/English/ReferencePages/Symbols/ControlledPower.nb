(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    158299,       4119]
NotebookOptionsPosition[    143575,       3813]
NotebookOutlinePosition[    146059,       3874]
CellTagsIndexPosition[    145935,       3868]
WindowTitle->ControlledPower
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "9e00c85a-87fc-45ac-9373-26326356fc68"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "5ffe6ed7-4b8b-41eb-b119-b94717f95b99"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "7d4f56dc-cffd-48e2-8f97-bb2a32a29f95"]
         }],ExpressionUUID->"bfafc39e-69d0-4c80-83db-37ff0362fb90"],
         StripOnInput->False],{
        "\"ControlledGate\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/ControlledGate"], "\"CNOT\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CNOT"], "\"CX\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CX"], "\"CZ\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CZ"], 
         "\"UniformlyControlledRotation\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/ref/UniformlyControlledRotation"], "\"QuantumCircuit\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/QuantumCircuit"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "fa4aaabd-f34d-4b9b-b94c-b1b347f1176c"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "8be4161e-865e-4fb3-8c57-230ce0948cec"]
         }],ExpressionUUID->"2a400da3-5e8a-460b-bf67-040a6278c66d"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/guide/QuantumInformationSystems"], "\"Q3\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "84c83272-8ab9-490f-af67-bb4d064eb32b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "a0fc5ebb-b7c7-48ed-a991-c8e89686d93d"]
         }],ExpressionUUID->"dc1c2cfe-be17-44f6-986a-7d9e6d6efc4f"],
         StripOnInput->False],{
        "\"Quantum Phase Estimation\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumPhaseEstimation"], 
         "\"Multi-Control Unitary Gates\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/MultiControlUnitaryGates"], 
         "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumInformationSystems"], 
         "\"Quick Quantum Computing with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuickQuantumComputingWithQ3"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "e4e8f1ac-8d87-423c-99c8-4201c9369c49"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "ffdfbbad-70cc-4fa2-9db0-20908bffd458"]
         }],ExpressionUUID->"de937515-409e-46ce-a536-ef4eab0c8f81"],
         StripOnInput->False],{
        "\"Q3/ref/ControlledPower\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{Cell["Q3/ref/ControlledPower"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/Q3/ref/\
ControlledPower.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$23131], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "Q3/ref/ControlledPower" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f906a79a-5ff6-49d1-8388-d2008fc7af98"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "f877481b-53a8-4f1b-accf-beac2acf16ce"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"acf18b30-f6e9-4036-b14a-03a9646a6c31"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"d643695f-3f1f-40f9-b051-e55619c2f69a"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "ControlledPower", "ObjectName",ExpressionUUID->
      "eda26ef5-5498-4943-85bc-a42cbbd47881"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"33bb4a74-7f9b-477e-a218-ce38a3188ae8"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "949b5496-1012-4924-b8a7-45b35d8b0d2f"]
    }],ExpressionUUID->"9e32ffd1-e6da-4df4-97fa-7b692489fb60"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 13.1\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 13.2",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "43e3742c-1915-4b28-86f4-2ab61db7a8b5"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"13312ff9-1b7c-40c9-9651-74eee9d84dff"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
         "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["c", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["c", "TI"], 
           StyleBox["2", "TR"]], ",", " ", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
        StyleBox["op", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "e7c36cdc-17f8-4d46-8bc0-87bd5cfffbea"],
     "\[LineSeparator]represents the ",
     StyleBox["controlled power",
      FontSlant->"Italic"],
     " (also known as ",
     StyleBox["controlled exponentiation",
      FontSlant->"Italic"],
     ") of unitary operator ",
     Cell[BoxData[
      StyleBox["op", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "1f823491-10b5-49b7-9477-2497839c9165"],
     "."
    }],ExpressionUUID->"ab0c19d2-e10d-4c60-9670-1dfe259558e2"]}
  }]], "Usage",
 CellID->64829665,ExpressionUUID->"df1e2fa1-fba5-4572-a409-864423852d21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
    ExpressionUUID->"a5f30f0d-ed90-4d86-8e7d-3a667bda3194"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"31b934c6-85a6-4dab-bc46-4b8234b131e0"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"2caf933d-d6a4-469f-a3cf-6df5ebaadeda"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"133a8c26-256c-4a36-847b-ed3c9730fbec"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->1746863534,ExpressionUUID->"558a94aa-ec61-426c-8750-acfd4f380a57"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
     "Q3 Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", " ", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    StyleBox["op", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c8fb74e4-3861-4769-a952-4013a105cd45"],
 " transforms computational basis states as\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["c", "1"], 
         SubscriptBox["c", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["c", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Psi]"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["c", "1"], 
         SubscriptBox["c", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["c", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        StyleBox["op",
         FontSlant->"Italic"], "c"], 
       TemplateBox[{"\[Psi]"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "36e3e24d-5cdc-4299-a4dc-fab1a9d9f715"],
 ", \[LineSeparator]where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["c", "1"], 
       SubscriptBox["c", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["c", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"6269290e-977c-425a-8e41-a01b1da0b4f2"],
 ", that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["c", "1"], 
      SuperscriptBox["2", 
       RowBox[{"n", "-", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["c", "2"], 
      SuperscriptBox["2", 
       RowBox[{"n", "-", "2"}]]}], "+", "\[Ellipsis]", "+", 
     SubscriptBox["c", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "2a876ae7-538d-42fe-aeff-e7e11bf77937"],
 "."
}], "Notes",
 CellID->100026970,ExpressionUUID->"c2f41ce3-45e4-4d5b-bd69-e73c069eb2d7"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Elaborate"]], "paclet:Q3/ref/Elaborate", "Q3 Package Symbol"},
    
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0a9563ba-075b-4884-8773-bd1ab9af8d88"],
 " gives the expression of the controlled power in terms of the Pauli \
operators."
}], "Notes",
 CellID->2112528434,ExpressionUUID->"e8ecf42d-30e4-4ea1-837c-866382304e2f"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Expand"]], "paclet:ref/Expand"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "320db2e7-6172-4732-b87b-2442c800f9bd"],
 " gives a sequence of controlled-unitary gates that compose the controlled \
exponentiation."
}], "Notes",
 CellID->1630510880,ExpressionUUID->"0230f574-1480-4d58-a55b-4bde45981f61"],

Cell[TextData[{
 "This gate can be implemented by using ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/ControlledGate"],
 "."
}], "Notes",
 CellID->1639654363,ExpressionUUID->"40b1b323-1c2b-4add-a452-fd88141c903a"],

Cell["The following options can be given: ", "Notes",
 CellID->817970626,ExpressionUUID->"fcc911b7-0b1c-47c3-bc06-f07a9c9cab73"],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "06bcd4a6-8db1-45df-b6a6-a89567bc5716"], "\"\<Label\>\"", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "U"}], "}"}], Cell[
    "Labels for the controll and target registers, respectively.", 
     "TableText",ExpressionUUID->"8a378223-d0a2-4f9f-b977-c1fecbfa3a6f"]}
  }]], "3ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}},
 GridBoxDividers->{"Rows" -> {{True, True}}}},
 CellID->1589486735,ExpressionUUID->"5c00ac90-f36c-403b-97a1-9637302d42cc"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "9a71b438-ffdd-4292-8705-503ab5406ef7"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ac869f26-a8ec-4c10-a30c-2b21658ab198"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "5db0787d-28f3-4944-b9a0-05fa1a3314a0"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1286477801,ExpressionUUID->"f9acc45c-fc99-498b-a855-45423969bf68"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->851865642,ExpressionUUID->"3ae6a338-1c6b-4df7-90e2-76b0f0911490"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "2f0214b3-74da-4511-9164-4b9359660541"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"25a5d623-df2f-4d9b-be36-465e97269fd0"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "1af3cf0d-1a7e-4ba2-8c2b-90854fbde45c"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->967043411,ExpressionUUID->"2d539c51-c752-4c92-bcba-f229db593851"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2076530764,ExpressionUUID->"014c9d9f-afb5-4ad8-8cc5-1c42a125b410"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1495803151,ExpressionUUID->"43e7994d-b777-4613-8787-aab3582a14a8"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]]}], "}"}], ",", 
   InterpretationBox[
    TagBox[
     FormBox[
      TagBox[
       RowBox[{
        FormBox[
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[3, 3]],
         TraditionalForm], "\[InvisibleApplication]", 
        RowBox[{"(", "\[Phi]", ")"}]}],
       HoldForm],
      TraditionalForm],
     TraditionalForm,
     Editable->True],
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[3, 3]]]}], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->673416036,ExpressionUUID->"209a4b72-e5ab-46e6-838d-0457d51125c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "**", 
  RowBox[{"Ket", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"S", "[", "3", "]"}], "->", "1"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->2104788460,ExpressionUUID->"db4b4573-02cf-42e8-9571-711f0f01a586"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->276539833,ExpressionUUID->"aaf41707-e77b-4bd6-a929-aea4b6641bda"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"Total", "[", "bs", "]"}], "**", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", "3", "]"}], "->", "1"}], "]"}]}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1154618494,ExpressionUUID->"ca6ccab4-701c-4904-85bc-2de3b98289cd"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1850771476,ExpressionUUID->"1715a31b-8b1e-4b9d-953a-f39573314f8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"op", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1825261592,ExpressionUUID->"6c0d3b13-3e92-4232-9cc2-7eff46157e12"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->751109998,ExpressionUUID->"4e11ae3a-4650-411f-95b6-ad6e805d21e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "ac408bd6-2458-48a3-9cbf-c880db2d3044"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->360562160,ExpressionUUID->"54692882-e20b-4d8b-9f03-ff61715191fb"],

Cell["\<\
Convert the controlled exponentiation operator to its matrix representation \
in the computational basis.\
\>", "ExampleText",
 CellID->83261738,ExpressionUUID->"65655618-cd8b-4b84-aaeb-c1c3298f0f8c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2073621093,ExpressionUUID->"fda527a0-5cc8-4730-a467-961f6ad8c0c8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       8}}}, {1, 1, 1, E^(Complex[0, 1] $CellContext`\[Phi]), 1, 
       E^(Complex[0, 2] $CellContext`\[Phi]), 1, 
       E^(Complex[0, 3] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->980386803,ExpressionUUID->"07955347-6414-4a3c-8a5f-6850bf9101cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"op", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->43453953,ExpressionUUID->"71861f93-8a49-4cb1-b2e2-addc4d6551df"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {
      1, 1, 1, 1, 1, 1, E^(Complex[0, 1] $CellContext`\[Phi]), 
       E^(Complex[0, 1] $CellContext`\[Phi]), 1, 1, 
       E^(Complex[0, 2] $CellContext`\[Phi]), 
       E^(Complex[0, 2] $CellContext`\[Phi]), 1, 1, 
       E^(Complex[0, 3] $CellContext`\[Phi]), 
       E^(Complex[0, 3] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1352181494,ExpressionUUID->"5534a071-d640-4fe8-80eb-dc3ad4664ad8"]
}, Open  ]],

Cell["\<\
Expand the controlled exponentiation operator in terms of the Pauli operators.\
\>", "ExampleText",
 CellID->1098295329,ExpressionUUID->"f4e1cde4-0892-4331-b315-9e932b2aaa39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Elaborate", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->337611983,ExpressionUUID->"3ca5008e-3096-4154-9bf8-0b46da43860f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"5", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"3", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1960610846,ExpressionUUID->"9e555684-301b-49fe-a870-c5d8a2e5f340"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"new", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}], "-", 
   "mat"}], "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1061819516,ExpressionUUID->"9efc0514-79c9-40d0-9d9f-8ff227b4e5fb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->136914852,ExpressionUUID->"e62115d8-4508-4a32-9bd9-192a09aaaeca"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "0e0b3f6a-d2df-4741-a61a-b7c886c9c63d"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->689713619,ExpressionUUID->"17e27e71-530c-4fb8-aef8-ec274ee60c36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], "**", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2047551674,ExpressionUUID->"cf578579-8438-4b2c-962b-cb007b450fa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[4, 1]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1866703794,ExpressionUUID->"53d51f91-2e84-4cfb-8e51-d591d6d9a925"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], "->", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Expand", "@", 
     RowBox[{"ControlledPower", "[", 
      RowBox[{
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "op"}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->629762013,ExpressionUUID->"6aed0638-7cbc-4e07-973c-4a830dda48aa"],

Cell[BoxData[
 TemplateBox[{
  "ControlledGate", "argr", 
   "\"\\!\\(\\*RowBox[{\\\"ControlledGate\\\"}]\\) called with 1 argument; \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"", 2, 137, 1, 
   18474533537699876265, "Local", "Q3`ControlledGate"},
  "MessageTemplate2"]], "Message", "MSG",
 CellLabel->"During evaluation of In[2]:=",
 CellID->850822339,ExpressionUUID->"51f5f03b-6eca-4bb5-be43-d6eb66358b02"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], InsetBox[
     StyleBox[
      FormBox[
       InterpretationBox[
        TagBox[
         TemplateBox[{
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]},
          "Ket"],
         DisplayForm],
        Ket[1]],
       TraditionalForm],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -4}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -2}, {3, -4}}], 
     DiskBox[{3, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -3}, {4, -4}}], 
     DiskBox[{4, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], 
   $CellContext`S[4, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 4] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 4] $CellContext`\[Phi])) $CellContext`S[4, 1], {
      $CellContext`S[4, Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 2]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 2] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 2] $CellContext`\[Phi])) $CellContext`S[4, 1], {
      $CellContext`S[4, Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 1]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[4, 1], {
      $CellContext`S[4, Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 0]]], 
   $CellContext`S[4, 6]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1824929847,ExpressionUUID->"56534550-2e40-4844-bf64-adbecf2314a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], "->", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledPower", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "op"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->658842380,ExpressionUUID->"80aa047e-f3d4-4cc2-9d97-2ffe8cc0ca7d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], InsetBox[
     StyleBox[
      FormBox[
       InterpretationBox[
        TagBox[
         TemplateBox[{
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]},
          "Ket"],
         DisplayForm],
        Ket[1]],
       TraditionalForm],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
          1.6, -0.47439999999999993`}, {1.6, -1}}], 
        Line[{{1.6, -1}, {1.6, -3}}], 
        BezierCurve[{{1.6, -3.5256}, {2.4, -3.5256}, {2.4, -3}}]}]}, 
     InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[
      4, 1]], 
   $CellContext`S[4, 6]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->580842540,ExpressionUUID->"2630ad85-c720-46d6-987e-3f1a825925a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qc", "]"}], "-", 
   RowBox[{"Matrix", "[", "new", "]"}]}], "//", "Normal"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1562364716,ExpressionUUID->"e6bd92c0-8044-469f-a740-4c9a5356cfd1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1684672560,ExpressionUUID->"7e21e137-206b-4f5e-aad4-77d4a4bc85a0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "826f537a-6ad8-4cb6-b8c3-58e8891dacd1"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1935006837,ExpressionUUID->"034d79bd-3423-4766-9526-e22e165360af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], "**", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1747542897,ExpressionUUID->"40b1aafd-8e07-4bbc-92be-ad01bcf309dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[4, 1]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1757603009,ExpressionUUID->"a9a965a2-c204-4025-91d4-c6d20a746178"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], "->", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledPower", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "op"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->765966584,ExpressionUUID->"e2fdfe6a-610b-4723-965d-c20fb88ec766"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], InsetBox[
     StyleBox[
      FormBox[
       InterpretationBox[
        TagBox[
         TemplateBox[{
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]},
          "Ket"],
         DisplayForm],
        Ket[1]],
       TraditionalForm],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
          1.6, -0.47439999999999993`}, {1.6, -1}}], 
        Line[{{1.6, -1}, {1.6, -3}}], 
        BezierCurve[{{1.6, -3.5256}, {2.4, -3.5256}, {2.4, -3}}]}]}, 
     InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[
      4, 1]], 
   $CellContext`S[4, 6]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1446896036,ExpressionUUID->"8acee048-7ef1-4da7-b390-2ce9021876b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->538882566,ExpressionUUID->"f34e1d4c-09b7-4640-aa4d-253215d8cd32"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXtsFOUah7dbShoKzaHIJQhBUhADIVzDpWjNMYJQRWIbbJSbNdwK1VZp
PGkiAh7BhD/QEwulKZK4iAYNJBCLxpAA4f5HbUOVhHKLcj00oSRc5No532EO
e8ad2ens7nw7szPPk0C6M9/M75t9n+/dZrK7Hfh2eeHCYCAQWJYp/iss+cff
33+/pKrob+LBzHeXlS56d8H8ae9WLli04P0Jb6eLjc+If1MyAoH//qwAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAEAs9OzZ0+kp+J3y8vLPP//cwQnggOPgAOAA
4ADgAOAA4ADE4QBVc5zPPvtsxIgRDk4ABxwHBwAHAAcABwAHAAcgDgeomuOc
PXs2EAiI/52aAA44Dg4ADgAOAA4ADgAOQBwOUDU3MGLEiHXr1jmVjgNuAAcA
BwAHAAcABwAHIFYHqJobWLFiRX5+vlPpOOAGcABwAHAAcABwAHAAYnWgw6o1
Nzd/8MEH4pzDhg176623tmzZktgEreKr3KampvT09NbW1iRk6cEBPX/++Wco
FCotLU3al5PgQDSSXwuFPmCE3xxwJNflDih+Wo9O5eKAIb7qPzjgqlz6gCG+
csCR3FgdMK/a7t27u3btGvgrJSUl9+7ds2Oy5P6fp5566ssvv5SdYggOaNm8
efPkyZOzs7PVxNGjR0uN04IDEThVC/qAHr85QB/Q47f1SB/Q4zcH6AN6/NaT
6QN6/OZAqvQBk6qdOnUqPT1dTH769OmNjY0XL16srq7u1KmT2FJVVWXTZMn9
HxUVFSJXdoohOKCloKBA27eTuXJxIAJHakEf0OM3BxzMVdzqgOKz9UgfMMRX
Dij0ASN81ZPpA4b4ygEHc5UYHTCpWllZmZj5c889p70TtXnzZrGxe/fuN2/e
THSi5GrYt29fZmam7BRDcEDL9evX//2IDz/8MMkrFwcicKQW9AE9fnPAwVzF
rQ4oPluP9AFDfOWAQh8wwlc9mT5giK8ccDBXidGBaFW7detWVlaWmPn27du1
2+/fv9+nTx+xva6uzoa5+j43zIMHD5544omI9OSAA4asW7cuySsXB6KRtFo4
fr04EI3kr0encl3oQASeX4+OO48DYRyvhQp9QI/ne7Lj7uEAuTE5EK1qv/32
m5h2ly5d9B8VWbp0qdhVXl6e6ETJ/SslJSWzZ8+O48AzZ87s2bMn7lwcMMSR
joEDhiStFm64XhwwxD+v4Ir7HIjA8+vRDc7jgIobaqHQB4zwfE92g3s4QK51
B6JV7eeffxbTHjRokPLoFsHy5cvffPPNX3/9VTxcu3at2FVUVGTjhH2bq2Xn
zp3du3e/f/9+rAfW1tZOmjQp7lwcMMSRlYsDhiStFm64XhwwxFev4G5zIALP
r0c3OI8DKm6ohUIfMMLzPdkN7uEAudYdiFY19XMizz77rPi5vr4+8IgZM2aI
h6FQSPw8YcKEiEPa2toaGxuvXbuWyMz9lqvl9u3bWVlZcdxVk7Ry/VwLxdrK
xQGP1cIN14sDhjiyHp3KdZsDEXh+PbrBeRxQcUMtFPqAEZ7vyW5wDwfIte5A
tKrV1NSIab/wwgvKo7/doJr8yiuviIfbtm0TP48cOTI8+NSpU5MnTw48ZtCg
QWJMfDP3W24EhYWFZWVlsR4laeX6vBbmKxcHPFkLl1wvDuhxaj3SB/R4fj26
xHkcUFxTC/qAHs/3ZJe4hwPkWnQgWtV27twp5jN8+HDl8btN5s2bp77b5Isv
vhC7Xn75ZXXknTt3Bg8enJaWNmvWLKHQxx9//PTTT4sBR44ciWPafsuNIBQK
9evXz8rI9vb2h48RbScvL++hhphCccAQk5WLA4pHa+GS68UBPU6tR/qAHs+v
R5c4jwOKa2pBH9Dj+Z7sEvdwgFyLDkSrWkNDg5iJ4V712/sXLlyoPjx8+LBW
bOXR90N+++23cc3ad7kRnDt3Tpz87NmzHY7U3gjSY+UMYXDAEJOViwOKR2vh
kuvFAT1OrUf6gB7Pr0eXOI8DimtqQR/Q4/me7BL3cIBciw5Eq1pra2taWpo4
Q1NTU8SucePGie1r1qxRH6rvRYnjPSHk6hHV79OnT3t7e4cjL1261PKYlStX
jhw5skVDTLfjcMAQk5WLA4pHa+GS68UBPU6tR/qAHs+vR5c4jwOKa2pBH9Dj
+Z7sEvdwgFyLDphUberUqfrpHT9+XGwMBoPhewXXrl3r0aOH0L6iouKPP/4w
PFVbW9vWrVuLi4tramo6nLlduQ0NDe+8886YMWOGDh0qovVLUlLuL7/8Ulpa
Ktb74MGDp02b9t1333V4yWHEPMM3/awj7/MyfnNAi8nKxYEkOKAlkVrQByyC
A7bneskBLYk8J0qKvBbQB8zxgwNa6AN6kumAXbn0AYvggO25SXDApGo//vij
mHl6evrXX3+tbrl06dKQIUPExtdee0078tChQwMGDFAHFxUVHTx4ULv3008/
VW9zCRYsWNDhlGzJFTJ37tw5Jyfn9ddfF4UTYzIyMsTzKTt348aNYqMoq9g+
Y8aMLl26iGGrV6/u8KoFd+/ezc7O3r17t5XBWuStXL85oMX8GzBwQLYDWuKu
BX3AOjhgb67HHNAS93OipM5rAX3AHD84YMv14kBKvxbQB8zxgwO25CbHAZOq
tbe3z507V4SK51xceEFBgTineNi/f/+TJ0/qE7/66quxY8eq1SkuLhZb1F1H
jx6tqalR/3qjlarZkvvRRx/l5+eH/3zAjh07xN6ZM2fKzm1paXnjjTdaW1vV
YadPnw4Gg08++WSHVy346aefunXrdufOHSuDtchbuX5zoLCwsNdjunbtqp4w
vOWll16ykosDtjhgSy3oA9bBAXtzPeaALc+JkjqvBfQBPX5zgD6gxykH+H3A
ymAtOODDPmB+H0bIvHz58pycHHVunTp1ev755y9cuGByyIEDB0aNGhXQfMBE
5erVqxarZlfugwcPwnsfPnwonvlhw4YlITcCsVc4oJ1MNBYvXmzuVTQaGho2
bdoUx4EqOBBG/WxUNLR/qcTK9YbBgTDWHbCrFvQBi+CA7bkRpLQD9j4n7n8t
sCs3AhwI434H6AN6nHKA3wdiBQei5Xq4D1h5Z4Xw+cSJE0eOHLl165aVcwrV
xVVMmTJFuzGm7m1jrsrdu3ezsrIKCgqSnLtt2zax/JcsWWIltG/fvlu3brWS
aC84kDg4oMcuB2KFPhAfOCA11zMOxEqqvxbQBxIn1R2IFRzQk+qvBfSBxEl1
B2zMleRA4lXbt29fZWXl7du3w1vUtzHMmTNHO8z2qlnMVamurha7amtrk5Nb
X18vDBk4cKAoWUVFRVtbW4enPXbsWEZGhpWRtoMDMnJxAAdwAAdwAAdwAAdw
AAdwAAdkO5B41YqLi8Wcc3Nzly1btn79elEXcU4x2wMHDmiH2V41i7mCpqam
zMzMvLy8mP52QyK5oo6TJk3q37+/GJmfn2/lqxSrqqpefPHFxKcXBzggIxcH
cAAHcAAHcAAHcAAHcAAHcEC2A4lXrb29fcOGDUOGDAkGg+rHCsTP9fX1EcNs
r5rF3Obm5l69eokn8Pfff09mrsrhw4dFdE5OzuXLl81PO3To0OrqaltmGCs4
IClXBQe04ID5aXFAXi4OdAgOSMpVwQEtOGB+WhyQl4sDHYIDknJVJDlg42cl
bty40djYGP4qvwjkfVbCJLepqUlcYO/evfVfSik1V8umTZvEhYdCIZMxLS0t
Ysz58+dtnaBVcEBGrhYcCIMDJmNwQF4uDlgBB2TkasGBMDhgMgYH5OXigBVw
QEauFhkOyPj2A0OS8O0HEezZsyc7O3vAgAEyShaNXbt2NTc3a7dUVVWJCxfb
TY5au3btmDFjJE8tKjhgLzhgAg6YHIUDksABi+CAveCACThgchQOSAIHLIID
9pIcB2RXraWl5V+PWLVqlZj8xIkT1Yd79+6VmvvNN9907txZJL733nuffPLJ
Px+zf/9+eaH37t0TkojcRYsWhUKhH374oaysLBgM5ubm3rhxw+TAvLw8MTd5
EzMHB2wEBwzBARzAARzAARzAARzAARzAARkOyK7a999/HzBi/vz5UnPHjx9v
mLtixQqpuVevXp07d27v3r3VuLS0tFdfffXMmTMmh1y5ckVUNuLuTTLBAXvB
AT04gAM4gAM4gAM4gAM4gAM4IMOBpL2zwm9cvHjx+PHj5rdfVOrq6nJzc5Mw
pWjggCRwAHAAcABwAHAAcACkOkDVHKe4uLiystLBCeCA4+AA4ADgAOAA4ADg
AMThAFUDHAAcABwAHAAcABwAHEhFqBrgAOAA4ADgAOAA4ADgQCpC1QAHAAcA
BwAHAAcABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgRfkPaLf5QA==
    "], {{0, 20.}, {675., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{675., 20.},
  PlotRange->{{0, 675.}, {0, 20.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[3]=",
 CellID->942368181,ExpressionUUID->"6a2741b2-0158-431d-80de-f530aa0148d8"]
}, Open  ]],

Cell["\<\
Operating on the superposition state, the controlled exponentiation induces \
relative phase shifts.\
\>", "ExampleText",
 CellID->1730346951,ExpressionUUID->"34cac316-4777-4267-a51a-90e9a9e4d86a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1719176194,ExpressionUUID->"f6c6be04-47e9-40ee-8e42-aaf41c6ba907"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->10909938,ExpressionUUID->"c9eaef96-8f79-4a8d-a4ab-9e017019b9e5"]
}, Open  ]],

Cell["\<\
When the phase is one of the discrete values, the QFT can pick it up.\
\>", "ExampleText",
 CellID->1639236511,ExpressionUUID->"f21ebdce-16df-4873-b1f7-9388c15cc979"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trs", "=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{"2", "Pi", "*", 
       RowBox[{"2", "/", 
        RowBox[{"2", "^", "3"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Dagger", "[", 
       RowBox[{"QFT", "[", 
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "**", 
      "out"}], "//", "Simplify"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->575394993,ExpressionUUID->"b11bd4ac-91be-429d-9ada-0e6e343107f4"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SqrtBox["2"], " ", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
     1|>]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1250659583,ExpressionUUID->"5aded30e-4a5d-4a22-ad1c-dffc5f5c5b8a"]
}, Open  ]],

Cell["\<\
If the dimensionless phase value is not one of the discrete values that can \
be represented by the finite set \[LineSeparator]of control register, the QFT \
results in a superposition. But the probability distribution has a sharp peak.\
\>", "ExampleText",
 CellID->1511280490,ExpressionUUID->"0001e554-d158-495e-b4cc-8210a4257698"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trs", "=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{"2", "Pi", "*", 
       RowBox[{"2.125", "/", 
        RowBox[{"2", "^", "3"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Dagger", "[", 
       RowBox[{"QFT", "[", 
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "**", 
      "out"}], "//", "Simplify"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->881512640,ExpressionUUID->"c4c249c0-6eb1-48e7-aef9-6c374328891c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.16507009142403095`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07807233879672618`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3160669899902172`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.015527375534336807`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.5962101484200346`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.9289388448395193`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2975749012646729`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.2697061693323886`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.08613955167004794`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.18212677996519847`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.00734390168977761`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.14948855308736705`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04563583907545338`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.1275436259313973`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09650241046095226`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10647400219210479`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->410779439,ExpressionUUID->"e98a5341-510d-4021-be6e-51ce4d40373c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"prb", "=", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"Normalize", "@", 
       RowBox[{"Matrix", "@", 
        RowBox[{"KetDrop", "[", 
         RowBox[{"trs", ",", 
          RowBox[{"S", "[", "4", "]"}]}], "]"}]}]}], "]"}], "^", "2"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"prb", ",", "\[IndentingNewLine]", 
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", "\"\<\[FilledCircle]\>\"", "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "7"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<8 \[Phi] / 2\[Pi]\>\"", ",", "\"\<probability\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->2115899125,ExpressionUUID->"dde9b646-5e33-4742-963a-9e63a23dab53"],

Cell[BoxData["0.003153`"], "EchoTiming",
 CellID->1936494848,ExpressionUUID->"c2f727e4-bdf9-41c3-9e35-7205cb447a3b"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.012833333333333334`], Thickness[Large], 
          LineBox[{{0., 0.004167928145991091}, {1., 0.01251743019405755}, {2.,
            0.9504043140263699}, {3., 0.020161529954828863`}, {4., 
           0.0050737732928010865`}, {4.999999999999999, 
           0.0028000950495229602`}, {6., 0.00229375079048111}, {7., 
           0.002581178545947306}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, 
       TagBox[
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.012833333333333334`], Thickness[Large], 
         GeometricTransformationBox[
          TagBox[InsetBox["\[FilledCircle]", {0., 0.}],
           "InsetString"], {{{0., 0.004167928145991091}}, {{1., 
          0.01251743019405755}}, {{2., 0.9504043140263699}}, {{3., 
          0.020161529954828863`}}, {{4., 0.0050737732928010865`}}, {{
          4.999999999999999, 0.0028000950495229602`}}, {{6., 
          0.00229375079048111}}, {{7., 0.002581178545947306}}}]},
        Annotation[#, "Charting`Private`Tag#1"]& ]},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2], 
             Thickness[Large]], 
            
            Line[{{0., 0.004167928145991091}, {1., 0.01251743019405755}, {2., 
             0.9504043140263699}, {3., 0.020161529954828863`}, {4., 
             0.0050737732928010865`}, {4.999999999999999, 
             0.0028000950495229602`}, {6., 0.00229375079048111}, {7., 
             0.002581178545947306}}]}, "Charting`Private`Tag#1"]}, {
          Annotation[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2], 
             Thickness[Large]], 
            GeometricTransformation[
             Inset["\[FilledCircle]", {0., 0.}], {{{0., 
             0.004167928145991091}}, {{1., 0.01251743019405755}}, {{2., 
             0.9504043140263699}}, {{3., 0.020161529954828863`}}, {{4., 
             0.0050737732928010865`}}, {{4.999999999999999, 
             0.0028000950495229602`}}, {{6., 0.00229375079048111}}, {{7., 
             0.002581178545947306}}}]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 7.}, {0, 0.9504043140263699}}, 
           "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
           "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {False, False}, 
           "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[0.012833333333333334`], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2], 
              Thickness[Large]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{0, 7.}, {0, 0.9504043140263699}}, 
          "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
          "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {False, False}, 
          "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2], 
             Thickness[Large]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}]},
    Annotation[{{{}, {}, 
       Annotation[{
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2], 
          Thickness[Large]], 
         Line[{{0., 0.004167928145991091}, {1., 0.01251743019405755}, {2., 
          0.9504043140263699}, {3., 0.020161529954828863`}, {4., 
          0.0050737732928010865`}, {4.999999999999999, 
          0.0028000950495229602`}, {6., 0.00229375079048111}, {7., 
          0.002581178545947306}}]}, "Charting`Private`Tag#1"]}, {
       Annotation[{
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2], 
          Thickness[Large]], 
         GeometricTransformation[
          Inset["\[FilledCircle]", {0., 0.}], {{{0., 
          0.004167928145991091}}, {{1., 0.01251743019405755}}, {{2., 
          0.9504043140263699}}, {{3., 0.020161529954828863`}}, {{4., 
          0.0050737732928010865`}}, {{4.999999999999999, 
          0.0028000950495229602`}}, {{6., 0.00229375079048111}}, {{7., 
          0.002581178545947306}}}]}, "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PlotRange" -> {{0, 7.}, {0, 0.9504043140263699}}, 
        "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
        "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {False, False}, 
        "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[2], 
           Thickness[Large]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"8 \[Phi] / 2\[Pi]\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentSet", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 7.}, {0, 0.9504043140263699}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1554240051,ExpressionUUID->"47ebc756-d291-4f12-a52d-e7734dd7610d"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
  ExpressionUUID->"25759889-e61d-42f8-9b13-6851d02d66fa"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"486d7cf2-d9c3-4297-b19b-14b9c2a9693e"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "0e1880fc-1b4c-45de-8432-2fcbff1bcf99"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1911880702,ExpressionUUID->"f8debabd-17af-4e89-88e4-9f3a7b96a816"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
  ExpressionUUID->"fad64652-1b25-4620-a7ee-bff18307ce80"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"c265d7a4-fa9f-463f-8df9-2e5cb71f959a"],
 "Expand",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "1ff5d48b-a001-4c97-b005-00240b8facad"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->207624942,ExpressionUUID->"cb476c86-d6dd-495c-9839-7786dd0fb124"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "T"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->280441185,ExpressionUUID->"d36cb268-44b9-49ed-84ea-71a018f0f354"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$n", "=", "3"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kk", "=", 
    RowBox[{"Range", "[", "$n", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "$"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "\"\<probe\>\"", " ", "register"}], " ", 
   "*)"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->61660548,ExpressionUUID->"38768c1f-761d-42e3-b98c-d5dce2749076"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1054617866,ExpressionUUID->"3155daa8-2dba-4a53-95e7-bc3c8dc4dec3"]
}, Open  ]],

Cell["\<\
Consider the phase gate in the eigen-basis of the Pauli X operator.\
\>", "ExampleText",
 CellID->834601618,ExpressionUUID->"80322106-2c62-4e43-a291-361e505bd093"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", "6", "]"}], "**", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"T", "[", "3", "]"}]}], "]"}], "**", 
    RowBox[{"T", "[", "6", "]"}]}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->630087907,ExpressionUUID->"ce14cacb-50ab-41a8-b266-97a0126d68f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"T", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"X\""}, 
       "RowWithSeparators"]},
     "Superscript"],
    $CellContext`T[1]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->918237217,ExpressionUUID->"843b77f3-d6be-42ca-b6b8-da32443eda3e"]
}, Open  ]],

Cell["\<\
This is the quantum circuit for the controlled exponentiation.\
\>", "ExampleText",
 CellID->898727511,ExpressionUUID->"a3187f89-ff16-4b1a-b101-5f8d142531fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cop", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{"SS", ",", "op"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->422652495,ExpressionUUID->"601ab193-6aab-4b19-8a1b-82700511382a"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{"T", 
        TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"X\""}, 
         "RowWithSeparators"]},
       "Superscript"],
      $CellContext`T[1]]}]}]}], "]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1113204312,ExpressionUUID->"f55433b8-4ed4-437d-abad-aad6f980b586"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "cop", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1336888100,ExpressionUUID->"e7f117f7-0510-4572-9783-557308353a42"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
          0.6, -0.47439999999999993`}, {0.6, -1}}], 
        Line[{{0.6, -1}, {0.6, -3}}], 
        BezierCurve[{{0.6, -3.5256}, {1.4, -3.5256}, {1.4, -3}}]}]}, 
     InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`T[
      1]]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->1413335810,ExpressionUUID->"a03e85c0-a1c2-46c8-8b62-c48f943b249e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Expand", "[", "cop", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->1480632628,ExpressionUUID->"30c8d0bb-54b6-4966-874b-8074951a3446"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -4}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 4] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 4] $CellContext`\[Phi])) $CellContext`T[1], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 2]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 2] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 2] $CellContext`\[Phi])) $CellContext`T[1], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 1]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`T[1], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 0]], "LabelSize" -> 0.65]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->1876823011,ExpressionUUID->"4db974a8-fdd7-48a8-b775-d3d2a59763e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", "new", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->377776937,ExpressionUUID->"1b0aa8fc-680b-4b9b-b75a-b63a28fc20d0"],

Cell["\<\
QuantumCircuit[ControlledGate[{S[1, $] -> 1}, 
  OperatorOn[(1 + E^((4*I)*\[Phi]))/2 + ((1 - E^((4*I)*\[Phi]))*T[1])/2, \
{T[$]}], 
  \"Label\" -> Superscript[\"U\", Superscript[2, 2]], \"LabelSize\" -> 0.65], \

 ControlledGate[{S[2, $] -> 1}, OperatorOn[(1 + E^((2*I)*\[Phi]))/2 + 
    ((1 - E^((2*I)*\[Phi]))*T[1])/2, {T[$]}], 
  \"Label\" -> Superscript[\"U\", Superscript[2, 1]], \"LabelSize\" -> 0.65], \

 ControlledGate[{S[3, $] -> 1}, OperatorOn[(1 + E^(I*\[Phi]))/2 + 
    ((1 - E^(I*\[Phi]))*T[1])/2, {T[$]}], 
  \"Label\" -> Superscript[\"U\", Superscript[2, 0]], \"LabelSize\" -> 0.65]]\
\
\>", "Output",
 CellLabel->"Out[7]//InputForm=",
 CellID->831666262,ExpressionUUID->"18f211d4-c676-4d27-8a80-06c5eb6ad3a6"]
}, Open  ]],

Cell[TextData[{
 "Of course, it may also be expanded inside ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "26a429ac-7965-4e75-ad31-4db98b550a43"],
 "."
}], "ExampleText",
 CellID->1285635407,ExpressionUUID->"ff5bd0b8-b201-4888-9141-913705286200"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"Expand", "@", "cop"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->479929715,ExpressionUUID->"1b06caf2-68dc-414c-9727-6a028b3a1c35"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -4}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 4] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 4] $CellContext`\[Phi])) $CellContext`T[1], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 2]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 2] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 2] $CellContext`\[Phi])) $CellContext`T[1], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 1]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`T[1], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 0]], "LabelSize" -> 0.65]]]], "Output",
 CellLabel->"Out[8]=",
 CellID->2001078325,ExpressionUUID->"3a34e1d9-f13c-4677-9c60-3750365bdaa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Elaborate", "[", "qc", "]"}], "-", 
   RowBox[{"Elaborate", "[", "new", "]"}]}], "//", "Simplify"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->793501579,ExpressionUUID->"3d947bbc-b757-4143-a8c4-884bf9291eb9"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[9]=",
 CellID->1058872749,ExpressionUUID->"8059997b-1f46-4e90-90f9-70ec49b9b488"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ControlledGate"]], "paclet:Q3/ref/ControlledGate", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "6fc9ced1-2e59-49c5-9514-4e101a754b2a"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "5762e2c0-5ea4-4e04-a38f-e9c10c998345"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CX"]], "paclet:Q3/ref/CX", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "a354f3e9-2a28-4a21-816e-60556fabf51e"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CZ"]], "paclet:Q3/ref/CZ", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "eeae7a87-0f6d-4050-8fa9-4734086cf986"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["UniformlyControlledRotation"]], 
           "paclet:Q3/ref/UniformlyControlledRotation", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "1f2c6714-6355-429c-b95c-896e2b2f351a"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "68a4d916-f7f2-41f9-b1f8-5456c612d75b"]
       }], "SeeAlso",ExpressionUUID->"91055e82-c722-4c99-9bd0-9c6ddee32c4e"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"b0f6afa4-8a3f-4519-8427-\
119ebbba7cd2"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Phase Estimation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumPhaseEstimation"]], 
         "TechNotes",ExpressionUUID->
         "800aa863-d975-4c82-afee-87d8eb6adf66"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Multi-Control Unitary Gates"]], 
           "paclet:Q3/tutorial/MultiControlUnitaryGates"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "ee1a73a3-3663-4ef5-bbab-689e95a5cc5f"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Computation: Overview"]], 
           "paclet:Q3/tutorial/QuantumComputationOverview"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "8da0df4b-8a41-4b3f-ac84-959133ddf84b"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "af705e42-2d26-4652-b9c5-b43e02574a51"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quick Quantum Computing with Q3"]], 
           "paclet:Q3/tutorial/QuickQuantumComputingWithQ3"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "3f140254-b5a9-4c32-aa84-f2bb434b9028"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "aa643f60-be22-49c8-9521-de6d9d4b395d"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"01339590-0db0-45ed-9e0e-\
088e5b3d6aec"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "0f7a4452-bf7d-4e99-afe8-cec142f0e44c"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "fe189ae1-3831-491c-9c24-9bd61af9ae26"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"59d733dd-2044-4359-b589-\
839de0fddf39"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "2c80e9e4-a07a-4217-b8d8-6a902d2050f5"]}]],ExpressionUUID->
         "7fd72885-753d-4528-94b4-1e721abf6e8a"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "3d4bf305-7529-477d-a84c-8be347c7b530"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "b772e0dd-20a6-4272-b08a-3c8044b04e93"]}]],ExpressionUUID->
         "ee34028a-28c1-48b9-9c62-f8e8a082fea9"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "RelatedLinks",ExpressionUUID->
        "40d7976d-0ce8-4797-86cc-8e347640e75f"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"8a18b3e0-58c2-468a-8928-\
e90c25efb909"],

Cell[" ", "FooterCell",ExpressionUUID->"07abbb2b-b778-4fdf-a2e4-b5f82b87354d"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"ControlledPower",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "HasOptions" -> True, "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "NotesSection" -> 
    Closed, "ExampleSubsection" -> {"0" -> Closed}}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "RootCaptions" -> 
  "", "Metadata" -> {
   "built" -> "{2023, 8, 5, 20, 35, 35.466930}", 
    "history" -> {"13.1", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"controlled exponentiation", "controlled power"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "ControlledPower[{c1, c2, ...}, op] represents the controlled power (also \
known as controlled exponentiation) of unitary operator op.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "ControlledPower", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "ControlledPower", "type" -> "Symbol", "uri" -> "Q3/ref/ControlledPower"}},
CellContext->"Global`",
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (June 3, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "13.3 for Mac OS X ARM (64-bit) (June 3, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"41498c44-663b-4957-ae5a-2ed754c02e13"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[18073, 503, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"f9acc45c-fc99-498b-a855-45423969bf68",
   CellTags->"PrimaryExamplesSection",
   CellID->1286477801]},
 "RasterizedOutput"->{
  Cell[69573, 1921, 5012, 88, 41, "Output",ExpressionUUID->"6a2741b2-0158-431d-80de-f530aa0148d8",
   CellTags->"RasterizedOutput",
   CellID->942368181]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 145555, 3857},
 {"RasterizedOutput", 145756, 3861}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 7814, 189, 57, "AnchorBarGrid",ExpressionUUID->"acf18b30-f6e9-4036-b14a-03a9646a6c31",
 CellID->1],
Cell[8404, 212, 85, 0, 23, "ContextNameCell",ExpressionUUID->"d643695f-3f1f-40f9-b051-e55619c2f69a"],
Cell[CellGroupData[{
Cell[8514, 216, 1391, 38, 60, "ObjectNameGrid",ExpressionUUID->"13312ff9-1b7c-40c9-9651-74eee9d84dff"],
Cell[9908, 256, 1310, 37, 114, "Usage",ExpressionUUID->"df1e2fa1-fba5-4572-a409-864423852d21",
 CellID->64829665]
}, Open  ]],
Cell[CellGroupData[{
Cell[11255, 298, 1899, 47, 37, "NotesSection",ExpressionUUID->"558a94aa-ec61-426c-8750-acfd4f380a57",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1746863534],
Cell[13157, 347, 2383, 78, 70, "Notes",ExpressionUUID->"c2f41ce3-45e4-4d5b-bd69-e73c069eb2d7",
 CellID->100026970],
Cell[15543, 427, 726, 22, 70, "Notes",ExpressionUUID->"e8ecf42d-30e4-4ea1-837c-866382304e2f",
 CellID->2112528434],
Cell[16272, 451, 700, 21, 70, "Notes",ExpressionUUID->"0230f574-1480-4d58-a55b-4bde45981f61",
 CellID->1630510880],
Cell[16975, 474, 259, 7, 70, "Notes",ExpressionUUID->"40b1b323-1c2b-4add-a452-fd88141c903a",
 CellID->1639654363],
Cell[17237, 483, 128, 1, 70, "Notes",ExpressionUUID->"fcc911b7-0b1c-47c3-bc06-f07a9c9cab73",
 CellID->817970626],
Cell[17368, 486, 578, 11, 70, "3ColumnTableMod",ExpressionUUID->"5c00ac90-f36c-403b-97a1-9637302d42cc",
 CellID->1589486735]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[18073, 503, 1390, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"f9acc45c-fc99-498b-a855-45423969bf68",
 CellTags->"PrimaryExamplesSection",
 CellID->1286477801],
Cell[19466, 542, 191, 3, 31, "Input",ExpressionUUID->"3ae6a338-1c6b-4df7-90e2-76b0f0911490",
 CellID->851865642],
Cell[CellGroupData[{
Cell[19682, 549, 1367, 36, 31, "ExampleSection",ExpressionUUID->"2d539c51-c752-4c92-bcba-f229db593851",
 CellID->967043411],
Cell[21052, 587, 209, 5, 29, "Input",ExpressionUUID->"014c9d9f-afb5-4ad8-8cc5-1c42a125b410",
 CellID->2076530764],
Cell[CellGroupData[{
Cell[21286, 596, 445, 13, 29, "Input",ExpressionUUID->"43e7994d-b777-4613-8787-aab3582a14a8",
 CellID->1495803151],
Cell[21734, 611, 1131, 36, 40, "Output",ExpressionUUID->"209a4b72-e5ab-46e6-838d-0457d51125c9",
 CellID->673416036]
}, Open  ]],
Cell[CellGroupData[{
Cell[22902, 652, 395, 12, 29, "Input",ExpressionUUID->"db4b4573-02cf-42e8-9571-711f0f01a586",
 CellID->2104788460],
Cell[23300, 666, 1292, 32, 41, "Output",ExpressionUUID->"aaf41707-e77b-4bd6-a929-aea4b6641bda",
 CellID->276539833]
}, Open  ]],
Cell[CellGroupData[{
Cell[24629, 703, 504, 15, 48, "Input",ExpressionUUID->"ca6ccab4-701c-4904-85bc-2de3b98289cd",
 CellID->1154618494],
Cell[25136, 720, 4389, 111, 41, "Output",ExpressionUUID->"1715a31b-8b1e-4b9d-953a-f39573314f8a",
 CellID->1850771476]
}, Open  ]],
Cell[CellGroupData[{
Cell[29562, 836, 203, 5, 29, "Input",ExpressionUUID->"6c0d3b13-3e92-4232-9cc2-7eff46157e12",
 CellID->1825261592],
Cell[29768, 843, 4801, 120, 41, "Output",ExpressionUUID->"4e11ae3a-4650-411f-95b6-ad6e805d21e6",
 CellID->751109998]
}, Open  ]],
Cell[CellGroupData[{
Cell[34606, 968, 242, 5, 14, "ExampleDelimiter",ExpressionUUID->"54692882-e20b-4d8b-9f03-ff61715191fb",
 CellID->360562160],
Cell[34851, 975, 210, 4, 38, "ExampleText",ExpressionUUID->"65655618-cd8b-4b84-aaeb-c1c3298f0f8c",
 CellID->83261738],
Cell[CellGroupData[{
Cell[35086, 983, 294, 7, 48, "Input",ExpressionUUID->"fda527a0-5cc8-4730-a467-961f6ad8c0c8",
 CellID->2073621093],
Cell[35383, 992, 1489, 35, 174, "Output",ExpressionUUID->"07955347-6414-4a3c-8a5f-6850bf9101cf",
 CellID->980386803]
}, Open  ]],
Cell[CellGroupData[{
Cell[36909, 1032, 421, 12, 70, "Input",ExpressionUUID->"71861f93-8a49-4cb1-b2e2-addc4d6551df",
 CellID->43453953],
Cell[37333, 1046, 3143, 69, 316, "Output",ExpressionUUID->"5534a071-d640-4fe8-80eb-dc3ad4664ad8",
 CellID->1352181494]
}, Open  ]],
Cell[40491, 1118, 185, 3, 70, "ExampleText",ExpressionUUID->"f4e1cde4-0892-4331-b315-9e932b2aaa39",
 CellID->1098295329],
Cell[CellGroupData[{
Cell[40701, 1125, 213, 5, 70, "Input",ExpressionUUID->"3ca5008e-3096-4154-9bf8-0b46da43860f",
 CellID->337611983],
Cell[40917, 1132, 7516, 193, 84, "Output",ExpressionUUID->"9e555684-301b-49fe-a870-c5d8a2e5f340",
 CellID->1960610846]
}, Open  ]],
Cell[CellGroupData[{
Cell[48470, 1330, 376, 11, 70, "Input",ExpressionUUID->"9efc0514-79c9-40d0-9d9f-8ff227b4e5fb",
 CellID->1061819516],
Cell[48849, 1343, 2331, 53, 304, "Output",ExpressionUUID->"e62115d8-4508-4a32-9bd9-192a09aaaeca",
 CellID->136914852]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51229, 1402, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"17e27e71-530c-4fb8-aef8-ec274ee60c36",
 CellID->689713619],
Cell[CellGroupData[{
Cell[51496, 1411, 481, 14, 70, "Input",ExpressionUUID->"cf578579-8438-4b2c-962b-cb007b450fa6",
 CellID->2047551674],
Cell[51980, 1427, 737, 21, 52, "Output",ExpressionUUID->"53d51f91-2e84-4cfb-8e51-d591d6d9a925",
 CellID->1866703794]
}, Open  ]],
Cell[CellGroupData[{
Cell[52754, 1453, 792, 22, 70, "Input",ExpressionUUID->"6aed0638-7cbc-4e07-973c-4a830dda48aa",
 CellID->629762013],
Cell[53549, 1477, 423, 8, 70, "Message",ExpressionUUID->"51f5f03b-6eca-4bb5-be43-d6eb66358b02",
 CellID->850822339],
Cell[53975, 1487, 4887, 117, 165, "Output",ExpressionUUID->"56534550-2e40-4844-bf64-adbecf2314a2",
 CellID->1824929847]
}, Open  ]],
Cell[CellGroupData[{
Cell[58899, 1609, 657, 19, 70, "Input",ExpressionUUID->"80aa047e-f3d4-4cc2-9d97-2ffe8cc0ca7d",
 CellID->658842380],
Cell[59559, 1630, 3389, 88, 163, "Output",ExpressionUUID->"2630ad85-c720-46d6-987e-3f1a825925a9",
 CellID->580842540]
}, Open  ]],
Cell[CellGroupData[{
Cell[62985, 1723, 275, 7, 70, "Input",ExpressionUUID->"e6bd92c0-8044-469f-a740-4c9a5356cfd1",
 CellID->1562364716],
Cell[63263, 1732, 323, 7, 37, "Output",ExpressionUUID->"7e21e137-206b-4f5e-aad4-77d4a4bc85a0",
 CellID->1684672560]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63635, 1745, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"034d79bd-3423-4766-9526-e22e165360af",
 CellID->1935006837],
Cell[CellGroupData[{
Cell[63903, 1754, 481, 14, 70, "Input",ExpressionUUID->"40b1aafd-8e07-4bbc-92be-ad01bcf309dc",
 CellID->1747542897],
Cell[64387, 1770, 737, 21, 52, "Output",ExpressionUUID->"a9a965a2-c204-4025-91d4-c6d20a746178",
 CellID->1757603009]
}, Open  ]],
Cell[CellGroupData[{
Cell[65161, 1796, 656, 19, 70, "Input",ExpressionUUID->"e2fdfe6a-610b-4723-965d-c20fb88ec766",
 CellID->765966584],
Cell[65820, 1817, 3390, 88, 163, "Output",ExpressionUUID->"8acee048-7ef1-4da7-b390-2ce9021876b8",
 CellID->1446896036]
}, Open  ]],
Cell[CellGroupData[{
Cell[69247, 1910, 323, 9, 70, "Input",ExpressionUUID->"f34e1d4c-09b7-4640-aa4d-253215d8cd32",
 CellID->538882566],
Cell[69573, 1921, 5012, 88, 41, "Output",ExpressionUUID->"6a2741b2-0158-431d-80de-f530aa0148d8",
 CellTags->"RasterizedOutput",
 CellID->942368181]
}, Open  ]],
Cell[74600, 2012, 207, 4, 70, "ExampleText",ExpressionUUID->"34cac316-4777-4267-a51a-90e9a9e4d86a",
 CellID->1730346951],
Cell[CellGroupData[{
Cell[74832, 2020, 203, 5, 70, "Input",ExpressionUUID->"f6c6be04-47e9-40ee-8e42-aaf41c6ba907",
 CellID->1719176194],
Cell[75038, 2027, 11995, 295, 61, "Output",ExpressionUUID->"c9eaef96-8f79-4a8d-a4ab-9e017019b9e5",
 CellID->10909938]
}, Open  ]],
Cell[87048, 2325, 176, 3, 70, "ExampleText",ExpressionUUID->"f21ebdce-16df-4873-b1f7-9388c15cc979",
 CellID->1639236511],
Cell[CellGroupData[{
Cell[87249, 2332, 690, 20, 70, "Input",ExpressionUUID->"b11bd4ac-91be-429d-9ada-0e6e343107f4",
 CellID->575394993],
Cell[87942, 2354, 1520, 38, 41, "Output",ExpressionUUID->"5aded30e-4a5d-4a22-ad1c-dffc5f5c5b8a",
 CellID->1250659583]
}, Open  ]],
Cell[89477, 2395, 343, 5, 70, "ExampleText",ExpressionUUID->"0001e554-d158-495e-b4cc-8210a4257698",
 CellID->1511280490],
Cell[CellGroupData[{
Cell[89845, 2404, 694, 20, 70, "Input",ExpressionUUID->"c4c249c0-6eb1-48e7-aef9-6c374328891c",
 CellID->881512640],
Cell[90542, 2426, 12583, 307, 101, "Output",ExpressionUUID->"e98a5341-510d-4021-be6e-51ce4d40373c",
 CellID->410779439]
}, Open  ]],
Cell[CellGroupData[{
Cell[103162, 2738, 1086, 28, 70, "Input",ExpressionUUID->"dde9b646-5e33-4742-963a-9e63a23dab53",
 CellID->2115899125],
Cell[104251, 2768, 116, 1, 70, "EchoTiming",ExpressionUUID->"c2f727e4-bdf9-41c3-9e35-7205cb447a3b",
 CellID->1936494848],
Cell[104370, 2771, 10817, 247, 70, "Output",ExpressionUUID->"47ebc756-d291-4f12-a52d-e7734dd7610d",
 CellID->1554240051]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[115348, 3027, 1394, 36, 70, "ExampleSection",ExpressionUUID->"f8debabd-17af-4e89-88e4-9f3a7b96a816",
 CellID->1911880702],
Cell[CellGroupData[{
Cell[116767, 3067, 1403, 36, 70, "ExampleSubsection",ExpressionUUID->"cb476c86-d6dd-495c-9839-7786dd0fb124",
 CellID->207624942],
Cell[118173, 3105, 218, 5, 70, "Input",ExpressionUUID->"d36cb268-44b9-49ed-84ea-71a018f0f354",
 CellID->280441185],
Cell[CellGroupData[{
Cell[118416, 3114, 542, 17, 70, "Input",ExpressionUUID->"38768c1f-761d-42e3-b98c-d5dce2749076",
 CellID->61660548],
Cell[118961, 3133, 596, 19, 37, "Output",ExpressionUUID->"3155daa8-2dba-4a53-95e7-bc3c8dc4dec3",
 CellID->1054617866]
}, Open  ]],
Cell[119572, 3155, 173, 3, 70, "ExampleText",ExpressionUUID->"80322106-2c62-4e43-a291-361e505bd093",
 CellID->834601618],
Cell[CellGroupData[{
Cell[119770, 3162, 400, 11, 70, "Input",ExpressionUUID->"ce14cacb-50ab-41a8-b266-97a0126d68f6",
 CellID->630087907],
Cell[120173, 3175, 698, 21, 52, "Output",ExpressionUUID->"843b77f3-d6be-42ca-b6b8-da32443eda3e",
 CellID->918237217]
}, Open  ]],
Cell[120886, 3199, 168, 3, 70, "ExampleText",ExpressionUUID->"a3187f89-ff16-4b1a-b101-5f8d142531fd",
 CellID->898727511],
Cell[CellGroupData[{
Cell[121079, 3206, 244, 6, 70, "Input",ExpressionUUID->"601ab193-6aab-4b19-8a1b-82700511382a",
 CellID->422652495],
Cell[121326, 3214, 1304, 40, 52, "Output",ExpressionUUID->"f55433b8-4ed4-437d-abad-aad6f980b586",
 CellID->1113204312]
}, Open  ]],
Cell[CellGroupData[{
Cell[122667, 3259, 219, 5, 70, "Input",ExpressionUUID->"e7f117f7-0510-4572-9783-557308353a42",
 CellID->1336888100],
Cell[122889, 3266, 1957, 49, 167, "Output",ExpressionUUID->"a03e85c0-a1c2-46c8-8b62-c48f943b249e",
 CellID->1413335810]
}, Open  ]],
Cell[CellGroupData[{
Cell[124883, 3320, 212, 5, 70, "Input",ExpressionUUID->"30c8d0bb-54b6-4966-874b-8074951a3446",
 CellID->1480632628],
Cell[125098, 3327, 3456, 78, 167, "Output",ExpressionUUID->"4db974a8-fdd7-48a8-b775-d3d2a59763e9",
 CellID->1876823011]
}, Open  ]],
Cell[CellGroupData[{
Cell[128591, 3410, 189, 4, 70, "Input",ExpressionUUID->"1b0aa8fc-680b-4b9b-b75a-b63a28fc20d0",
 CellID->377776937],
Cell[128783, 3416, 736, 16, 186, "Output",ExpressionUUID->"18f211d4-c676-4d27-8a80-06c5eb6ad3a6",
 CellID->831666262]
}, Open  ]],
Cell[129534, 3435, 456, 13, 70, "ExampleText",ExpressionUUID->"ff5bd0b8-b201-4888-9141-913705286200",
 CellID->1285635407],
Cell[CellGroupData[{
Cell[130015, 3452, 222, 5, 70, "Input",ExpressionUUID->"1b06caf2-68dc-414c-9727-6a028b3a1c35",
 CellID->479929715],
Cell[130240, 3459, 3456, 78, 167, "Output",ExpressionUUID->"3a34e1d9-f13c-4677-9c60-3750365bdaa5",
 CellID->2001078325]
}, Open  ]],
Cell[CellGroupData[{
Cell[133733, 3542, 282, 7, 70, "Input",ExpressionUUID->"3d947bbc-b757-4143-a8c4-884bf9291eb9",
 CellID->793501579],
Cell[134018, 3551, 127, 2, 37, "Output",ExpressionUUID->"8059997b-1f46-4e90-90f9-70ec49b9b488",
 CellID->1058872749]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[134502, 3565, 3325, 89, 70, "SeeAlsoSection",ExpressionUUID->"b0f6afa4-8a3f-4519-8427-119ebbba7cd2"],
Cell[137830, 3656, 2503, 63, 70, "TechNotesSection",ExpressionUUID->"01339590-0db0-45ed-9e0e-088e5b3d6aec"],
Cell[140336, 3721, 1045, 27, 70, "MoreAboutSection",ExpressionUUID->"59d733dd-2044-4359-b589-839de0fddf39"],
Cell[141384, 3750, 2106, 59, 70, "RelatedLinksSection",ExpressionUUID->"8a18b3e0-58c2-468a-8928-e90c25efb909"],
Cell[143493, 3811, 78, 0, 70, "FooterCell",ExpressionUUID->"07abbb2b-b778-4fdf-a2e4-b5f82b87354d"]
}
]
*)

(* End of internal cache information *)

