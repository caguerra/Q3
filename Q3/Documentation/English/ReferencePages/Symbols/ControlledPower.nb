(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    148828,       3862]
NotebookOptionsPosition[    135367,       3582]
NotebookOutlinePosition[    137810,       3643]
CellTagsIndexPosition[    137686,       3637]
WindowTitle->ControlledPower
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "c908ab2d-b214-4a96-b2d3-eb6cb37f434e"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "517b0d54-2f6d-48a2-b588-ec212fbb34c7"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c8e68149-0631-4bca-aec6-24eb3b8071be"]
         }],ExpressionUUID->"c3b033f2-85b9-49d7-b09e-c1baeeacdfcf"],
         StripOnInput->False],{
        "\"ControlledGate\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/ControlledGate"], "\"CNOT\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CNOT"], "\"CX\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CX"], "\"CZ\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/CZ"], "\"QuantumCircuit\"" :> 
         Documentation`HelpLookup["paclet:Q3/ref/QuantumCircuit"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "10e9f3a3-7f14-4b5d-b084-1acca7e46c7c"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "8b76d70f-fd73-423f-8e50-9939bb6b6812"]
         }],ExpressionUUID->"9159cfc6-f574-40d6-a6ba-8d4a9bc167f7"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/guide/QuantumInformationSystems"], "\"Q3\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "ac1acfb4-ba1e-41b1-933f-4b98ba7bdc7b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "688e589c-e5be-44c9-90d5-9c40e7729314"]
         }],ExpressionUUID->"73c8e31a-6326-428d-b681-99d6f06cddcf"],
         StripOnInput->False],{
        "\"Quantum Phase Estimation\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumPhaseEstimation"], 
         "\"Multi-Control Unitary Gates\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/MultiControlUnitaryGates"], 
         "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumInformationSystems"], 
         "\"Quick Quantum Computing with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuickQuantumComputingWithQ3"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "9c376c12-21b0-4a11-91e4-8ce0ed9dfbf3"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "a05190ea-033c-47a5-a7a9-62a9431515f9"]
         }],ExpressionUUID->"b427f7bb-abd6-4c0f-bdb8-7f3dca98c57c"],
         StripOnInput->False],{
        "\"Q3/ref/ControlledPower\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{Cell["Q3/ref/ControlledPower"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/Q3/ref/\
ControlledPower.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$25449], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "Q3/ref/ControlledPower" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "acb83f38-b3bf-45b2-80c5-7ffcc98ce5e9"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "e66db742-f3fa-4ef4-9a42-3a330680ba01"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"6661cf18-e522-4b90-97d2-d077c1cca515"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"5791f12f-1dd5-4017-83bb-85b2bf993ae8"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "ControlledPower", "ObjectName",ExpressionUUID->
      "072fa86f-cdcc-46ae-9089-b4fa34a09aaa"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"46a461fb-5824-4b79-86c9-70e898f350fa"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "3fd8bf75-a2af-4ee6-b02a-a5ed6fac1a59"]
    }],ExpressionUUID->"1dfbb461-562c-47ab-b392-d256346d3f4e"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 13.1\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 13.2",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "768a633d-a101-4150-bd85-fb339a4ef9b2"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"1de71747-ace0-49b4-a2dc-ba568b942761"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
         "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["c", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["c", "TI"], 
           StyleBox["2", "TR"]], ",", " ", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
        StyleBox["op", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "e7c36cdc-17f8-4d46-8bc0-87bd5cfffbea"],
     "\[LineSeparator]represents the ",
     StyleBox["controlled power",
      FontSlant->"Italic"],
     " (also known as ",
     StyleBox["controlled exponentiation",
      FontSlant->"Italic"],
     ") of unitary operator ",
     Cell[BoxData[
      StyleBox["op", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "1f823491-10b5-49b7-9477-2497839c9165"],
     "."
    }],ExpressionUUID->"3d0063e8-602b-483d-894d-7da419dad489"]}
  }]], "Usage",
 CellID->64829665,ExpressionUUID->"df1e2fa1-fba5-4572-a409-864423852d21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
    ExpressionUUID->"878f79b6-2ea2-4007-a2bc-e0af56ae42a4"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"b384b68d-b58e-49b6-8ba3-906e347134ad"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"3d452220-77ad-44b5-aa8a-1775603eb072"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"708b17c9-c309-4ec5-abfe-d552d1bcfa29"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->556126009,ExpressionUUID->"5cdbbdd9-7225-47e3-b506-ec45fa645ca5"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
     "Q3 Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", " ", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    StyleBox["op", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c8fb74e4-3861-4769-a952-4013a105cd45"],
 " transforms computational basis states as\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["c", "1"], 
         SubscriptBox["c", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["c", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Psi]"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["c", "1"], 
         SubscriptBox["c", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["c", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        StyleBox["op",
         FontSlant->"Italic"], "c"], 
       TemplateBox[{"\[Psi]"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "36e3e24d-5cdc-4299-a4dc-fab1a9d9f715"],
 ", \[LineSeparator]where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["c", "1"], 
       SubscriptBox["c", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["c", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"6269290e-977c-425a-8e41-a01b1da0b4f2"],
 ", that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["c", "1"], 
      SuperscriptBox["2", 
       RowBox[{"n", "-", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["c", "2"], 
      SuperscriptBox["2", 
       RowBox[{"n", "-", "2"}]]}], "+", "\[Ellipsis]", "+", 
     SubscriptBox["c", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "2a876ae7-538d-42fe-aeff-e7e11bf77937"],
 "."
}], "Notes",
 CellID->100026970,ExpressionUUID->"c2f41ce3-45e4-4d5b-bd69-e73c069eb2d7"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Elaborate"]], "paclet:Q3/ref/Elaborate", "Q3 Package Symbol"},
    
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0a9563ba-075b-4884-8773-bd1ab9af8d88"],
 " gives the expression of the controlled power in terms of the Pauli \
operators."
}], "Notes",
 CellID->2112528434,ExpressionUUID->"e8ecf42d-30e4-4ea1-837c-866382304e2f"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Expand"]], "paclet:ref/Expand"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
      "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "320db2e7-6172-4732-b87b-2442c800f9bd"],
 " gives a sequence of controlled-unitary gates that compose the controlled \
exponentiation."
}], "Notes",
 CellID->1630510880,ExpressionUUID->"0230f574-1480-4d58-a55b-4bde45981f61"],

Cell[TextData[{
 "This gate can be implemented by using ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/ControlledGate"],
 "."
}], "Notes",
 CellID->1639654363,ExpressionUUID->"40b1b323-1c2b-4add-a452-fd88141c903a"],

Cell["The following options can be given: ", "Notes",
 CellID->817970626,ExpressionUUID->"fcc911b7-0b1c-47c3-bc06-f07a9c9cab73"],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "d9d505e2-6b65-4452-9c04-6d07cbd9840d"], "\"\<Label\>\"", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "U"}], "}"}], Cell[
    "Labels for the controll and target registers, respectively.", 
     "TableText",ExpressionUUID->"8a378223-d0a2-4f9f-b977-c1fecbfa3a6f"]}
  }]], "3ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}},
 GridBoxDividers->{"Rows" -> {{True, True}}}},
 CellID->1589486735,ExpressionUUID->"5c00ac90-f36c-403b-97a1-9637302d42cc"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "b33ba7f5-9010-42e5-a8b9-753d4c45488f"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"591eedaf-93cc-412a-a754-1df9fe8199fb"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "d7675adf-3d6e-431b-b6a4-9cc9d0671a5a"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->961001519,ExpressionUUID->"7317560c-8b4c-4791-b3a8-6af8e14cce37"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->851865642,ExpressionUUID->"3ae6a338-1c6b-4df7-90e2-76b0f0911490"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "bd4ac6d0-c24f-49f0-871f-d6930a1879cc"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b702b91c-82a7-4ca4-8442-f849821d3ca2"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "9678099a-7bb3-4a22-ad68-cc4fa8afe8ed"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->328020746,ExpressionUUID->"a3253d2d-ed40-4480-a737-5f028d9da84d"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2076530764,ExpressionUUID->"014c9d9f-afb5-4ad8-8cc5-1c42a125b410"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1495803151,ExpressionUUID->"43e7994d-b777-4613-8787-aab3582a14a8"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]]}], "}"}], ",", 
   InterpretationBox[
    TagBox[
     FormBox[
      TagBox[
       RowBox[{
        FormBox[
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[3, 3]],
         TraditionalForm], "\[InvisibleApplication]", 
        RowBox[{"(", "\[Phi]", ")"}]}],
       HoldForm],
      TraditionalForm],
     TraditionalForm,
     Editable->True],
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[3, 3]]]}], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1034004646,ExpressionUUID->"0bd262a1-1ddb-4298-a791-2164afcf392e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "**", 
  RowBox[{"Ket", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"S", "[", "3", "]"}], "->", "1"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->2104788460,ExpressionUUID->"db4b4573-02cf-42e8-9571-711f0f01a586"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1547837474,ExpressionUUID->"35080271-3faf-45f4-9d72-6584144e1a59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"Total", "[", "bs", "]"}], "**", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", "3", "]"}], "->", "1"}], "]"}]}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1154618494,ExpressionUUID->"ca6ccab4-701c-4904-85bc-2de3b98289cd"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->2117441002,ExpressionUUID->"8b3a4108-3272-43f9-9a77-5a761a92eb16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"op", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1825261592,ExpressionUUID->"6c0d3b13-3e92-4232-9cc2-7eff46157e12"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->40362989,ExpressionUUID->"0a38929d-7946-4822-aa96-e6fbbd6f86c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "ac408bd6-2458-48a3-9cbf-c880db2d3044"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->360562160,ExpressionUUID->"54692882-e20b-4d8b-9f03-ff61715191fb"],

Cell["\<\
Convert the controlled exponentiation operator to its matrix representation \
in the computational basis.\
\>", "ExampleText",
 CellID->83261738,ExpressionUUID->"65655618-cd8b-4b84-aaeb-c1c3298f0f8c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2073621093,ExpressionUUID->"fda527a0-5cc8-4730-a467-961f6ad8c0c8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       8}}}, {1, 1, 1, E^(Complex[0, 1] $CellContext`\[Phi]), 1, 
       E^(Complex[0, 2] $CellContext`\[Phi]), 1, 
       E^(Complex[0, 3] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->267393073,ExpressionUUID->"00c4d1ce-7d36-4e54-ac0b-d862096f3966"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"op", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->43453953,ExpressionUUID->"71861f93-8a49-4cb1-b2e2-addc4d6551df"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {
      1, 1, 1, 1, 1, 1, E^(Complex[0, 1] $CellContext`\[Phi]), 
       E^(Complex[0, 1] $CellContext`\[Phi]), 1, 1, 
       E^(Complex[0, 2] $CellContext`\[Phi]), 
       E^(Complex[0, 2] $CellContext`\[Phi]), 1, 1, 
       E^(Complex[0, 3] $CellContext`\[Phi]), 
       E^(Complex[0, 3] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1729498494,ExpressionUUID->"cb53c8ee-df21-458c-a325-cc2a6a3aa9b3"]
}, Open  ]],

Cell["\<\
Expand the controlled exponentiation operator in terms of the Pauli operators.\
\>", "ExampleText",
 CellID->1098295329,ExpressionUUID->"f4e1cde4-0892-4331-b315-9e932b2aaa39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Elaborate", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->337611983,ExpressionUUID->"3ca5008e-3096-4154-9bf8-0b46da43860f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"5", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"3", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1876972792,ExpressionUUID->"a47ec22f-7a31-4a79-9608-b46adece7ddd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"new", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}], "-", 
   "mat"}], "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1061819516,ExpressionUUID->"9efc0514-79c9-40d0-9d9f-8ff227b4e5fb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->196808537,ExpressionUUID->"f49d33ae-e9b5-4f05-9873-22b638daa9d7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "0e0b3f6a-d2df-4741-a61a-b7c886c9c63d"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->689713619,ExpressionUUID->"17e27e71-530c-4fb8-aef8-ec274ee60c36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], "**", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2047551674,ExpressionUUID->"cf578579-8438-4b2c-962b-cb007b450fa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[4, 1]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1765364494,ExpressionUUID->"a5284fe0-ef25-4555-8f52-8c367c5e6208"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], "->", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Expand", "@", 
     RowBox[{"ControlledPower", "[", 
      RowBox[{
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "op"}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->629762013,ExpressionUUID->"6aed0638-7cbc-4e07-973c-4a830dda48aa"],

Cell[BoxData[
 TemplateBox[{
  "ControlledGate", "argr", 
   "\"\\!\\(\\*RowBox[{\\\"ControlledGate\\\"}]\\) called with 1 argument; \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"", 2, 594, 6, 
   18472843316783986475, "Local", "Q3`ControlledGate"},
  "MessageTemplate2"]], "Message", "MSG",
 CellLabel->"During evaluation of In[2]:=",
 CellID->1060667912,ExpressionUUID->"74d68942-d554-4402-830a-f2456ca9b6a1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], InsetBox[
     StyleBox[
      FormBox[
       InterpretationBox[
        TagBox[
         TemplateBox[{
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]},
          "Ket"],
         DisplayForm],
        Ket[1]],
       TraditionalForm],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -4}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -2}, {3, -4}}], 
     DiskBox[{3, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -3}, {4, -4}}], 
     DiskBox[{4, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], 
   $CellContext`S[4, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 4] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 4] $CellContext`\[Phi])) $CellContext`S[4, 1], {
      $CellContext`S[4, Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 2]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 2] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 2] $CellContext`\[Phi])) $CellContext`S[4, 1], {
      $CellContext`S[4, Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 1]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`OperatorOn[
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
     Rational[1, 2] (1 - 
       E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[4, 1], {
      $CellContext`S[4, Q3`$]}], "Label" -> Superscript["U", 
      Superscript[2, 0]]], 
   $CellContext`S[4, 6]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->383843237,ExpressionUUID->"f7e32f2d-8222-4342-9d38-8bd996008803"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], "->", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledPower", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "op"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->658842380,ExpressionUUID->"80aa047e-f3d4-4cc2-9d97-2ffe8cc0ca7d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], InsetBox[
     StyleBox[
      FormBox[
       InterpretationBox[
        TagBox[
         TemplateBox[{
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]},
          "Ket"],
         DisplayForm],
        Ket[1]],
       TraditionalForm],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
          1.6, -0.47439999999999993`}, {1.6, -1}}], 
        Line[{{1.6, -1}, {1.6, -3}}], 
        BezierCurve[{{1.6, -3.5256}, {2.4, -3.5256}, {2.4, -3}}]}]}, 
     InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[
      4, 1]], 
   $CellContext`S[4, 6]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1656120149,ExpressionUUID->"d0f7dde2-3006-4b9a-b233-c8fbd47afe54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qc", "]"}], "-", 
   RowBox[{"Matrix", "[", "new", "]"}]}], "//", "Normal"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1562364716,ExpressionUUID->"e6bd92c0-8044-469f-a740-4c9a5356cfd1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1799556762,ExpressionUUID->"f94386d7-acde-44b1-a89c-f477b0354994"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "826f537a-6ad8-4cb6-b8c3-58e8891dacd1"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1935006837,ExpressionUUID->"034d79bd-3423-4766-9526-e22e165360af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], "**", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"4", ",", "3"}], "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1747542897,ExpressionUUID->"40b1aafd-8e07-4bbc-92be-ad01bcf309dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[4, 1]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1553916659,ExpressionUUID->"077f9401-83e1-43e6-9a1c-8f541146dff7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], "->", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledPower", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "op"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->765966584,ExpressionUUID->"e2fdfe6a-610b-4723-965d-c20fb88ec766"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], InsetBox[
     StyleBox[
      FormBox[
       InterpretationBox[
        TagBox[
         TemplateBox[{
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]},
          "Ket"],
         DisplayForm],
        Ket[1]],
       TraditionalForm],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
          1.6, -0.47439999999999993`}, {1.6, -1}}], 
        Line[{{1.6, -1}, {1.6, -3}}], 
        BezierCurve[{{1.6, -3.5256}, {2.4, -3.5256}, {2.4, -3}}]}]}, 
     InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[
      4, 1]], 
   $CellContext`S[4, 6]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1829551932,ExpressionUUID->"f03bdf8e-11a7-458f-9892-0fe0507aa4aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->538882566,ExpressionUUID->"f34e1d4c-09b7-4640-aa4d-253215d8cd32"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXtsFOUah7dbShoKzaHIJQhBUhADIVzDpWjNMYJQRWIbbJSbNdwK1VZp
PGkiAh7BhD/QEwulKZK4iAYNJBCLxpAA4f5HbUOVhHKLcj00oSRc5No532EO
e8ad2ens7nw7szPPk0C6M9/M75t9n+/dZrK7Hfh2eeHCYCAQWJYp/iss+cff
33+/pKrob+LBzHeXlS56d8H8ae9WLli04P0Jb6eLjc+If1MyAoH//qwAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAEAs9OzZ0+kp+J3y8vLPP//cwQnggOPgAOAA
4ADgAOAA4ADE4QBVc5zPPvtsxIgRDk4ABxwHBwAHAAcABwAHAAcgDgeomuOc
PXs2EAiI/52aAA44Dg4ADgAOAA4ADgAOQBwOUDU3MGLEiHXr1jmVjgNuAAcA
BwAHAAcABwAHIFYHqJobWLFiRX5+vlPpOOAGcABwAHAAcABwAHAAYnWgw6o1
Nzd/8MEH4pzDhg176623tmzZktgEreKr3KampvT09NbW1iRk6cEBPX/++Wco
FCotLU3al5PgQDSSXwuFPmCE3xxwJNflDih+Wo9O5eKAIb7qPzjgqlz6gCG+
csCR3FgdMK/a7t27u3btGvgrJSUl9+7ds2Oy5P6fp5566ssvv5SdYggOaNm8
efPkyZOzs7PVxNGjR0uN04IDEThVC/qAHr85QB/Q47f1SB/Q4zcH6AN6/NaT
6QN6/OZAqvQBk6qdOnUqPT1dTH769OmNjY0XL16srq7u1KmT2FJVVWXTZMn9
HxUVFSJXdoohOKCloKBA27eTuXJxIAJHakEf0OM3BxzMVdzqgOKz9UgfMMRX
Dij0ASN81ZPpA4b4ygEHc5UYHTCpWllZmZj5c889p70TtXnzZrGxe/fuN2/e
THSi5GrYt29fZmam7BRDcEDL9evX//2IDz/8MMkrFwcicKQW9AE9fnPAwVzF
rQ4oPluP9AFDfOWAQh8wwlc9mT5giK8ccDBXidGBaFW7detWVlaWmPn27du1
2+/fv9+nTx+xva6uzoa5+j43zIMHD5544omI9OSAA4asW7cuySsXB6KRtFo4
fr04EI3kr0encl3oQASeX4+OO48DYRyvhQp9QI/ne7Lj7uEAuTE5EK1qv/32
m5h2ly5d9B8VWbp0qdhVXl6e6ETJ/SslJSWzZ8+O48AzZ87s2bMn7lwcMMSR
joEDhiStFm64XhwwxD+v4Ir7HIjA8+vRDc7jgIobaqHQB4zwfE92g3s4QK51
B6JV7eeffxbTHjRokPLoFsHy5cvffPPNX3/9VTxcu3at2FVUVGTjhH2bq2Xn
zp3du3e/f/9+rAfW1tZOmjQp7lwcMMSRlYsDhiStFm64XhwwxFev4G5zIALP
r0c3OI8DKm6ohUIfMMLzPdkN7uEAudYdiFY19XMizz77rPi5vr4+8IgZM2aI
h6FQSPw8YcKEiEPa2toaGxuvXbuWyMz9lqvl9u3bWVlZcdxVk7Ry/VwLxdrK
xQGP1cIN14sDhjiyHp3KdZsDEXh+PbrBeRxQcUMtFPqAEZ7vyW5wDwfIte5A
tKrV1NSIab/wwgvKo7/doJr8yiuviIfbtm0TP48cOTI8+NSpU5MnTw48ZtCg
QWJMfDP3W24EhYWFZWVlsR4laeX6vBbmKxcHPFkLl1wvDuhxaj3SB/R4fj26
xHkcUFxTC/qAHs/3ZJe4hwPkWnQgWtV27twp5jN8+HDl8btN5s2bp77b5Isv
vhC7Xn75ZXXknTt3Bg8enJaWNmvWLKHQxx9//PTTT4sBR44ciWPafsuNIBQK
9evXz8rI9vb2h48RbScvL++hhphCccAQk5WLA4pHa+GS68UBPU6tR/qAHs+v
R5c4jwOKa2pBH9Dj+Z7sEvdwgFyLDkSrWkNDg5iJ4V712/sXLlyoPjx8+LBW
bOXR90N+++23cc3ad7kRnDt3Tpz87NmzHY7U3gjSY+UMYXDAEJOViwOKR2vh
kuvFAT1OrUf6gB7Pr0eXOI8DimtqQR/Q4/me7BL3cIBciw5Eq1pra2taWpo4
Q1NTU8SucePGie1r1qxRH6rvRYnjPSHk6hHV79OnT3t7e4cjL1261PKYlStX
jhw5skVDTLfjcMAQk5WLA4pHa+GS68UBPU6tR/qAHs+vR5c4jwOKa2pBH9Dj
+Z7sEvdwgFyLDphUberUqfrpHT9+XGwMBoPhewXXrl3r0aOH0L6iouKPP/4w
PFVbW9vWrVuLi4tramo6nLlduQ0NDe+8886YMWOGDh0qovVLUlLuL7/8Ulpa
Ktb74MGDp02b9t1333V4yWHEPMM3/awj7/MyfnNAi8nKxYEkOKAlkVrQByyC
A7bneskBLYk8J0qKvBbQB8zxgwNa6AN6kumAXbn0AYvggO25SXDApGo//vij
mHl6evrXX3+tbrl06dKQIUPExtdee0078tChQwMGDFAHFxUVHTx4ULv3008/
VW9zCRYsWNDhlGzJFTJ37tw5Jyfn9ddfF4UTYzIyMsTzKTt348aNYqMoq9g+
Y8aMLl26iGGrV6/u8KoFd+/ezc7O3r17t5XBWuStXL85oMX8GzBwQLYDWuKu
BX3AOjhgb67HHNAS93OipM5rAX3AHD84YMv14kBKvxbQB8zxgwO25CbHAZOq
tbe3z507V4SK51xceEFBgTineNi/f/+TJ0/qE7/66quxY8eq1SkuLhZb1F1H
jx6tqalR/3qjlarZkvvRRx/l5+eH/3zAjh07xN6ZM2fKzm1paXnjjTdaW1vV
YadPnw4Gg08++WSHVy346aefunXrdufOHSuDtchbuX5zoLCwsNdjunbtqp4w
vOWll16ykosDtjhgSy3oA9bBAXtzPeaALc+JkjqvBfQBPX5zgD6gxykH+H3A
ymAtOODDPmB+H0bIvHz58pycHHVunTp1ev755y9cuGByyIEDB0aNGhXQfMBE
5erVqxarZlfugwcPwnsfPnwonvlhw4YlITcCsVc4oJ1MNBYvXmzuVTQaGho2
bdoUx4EqOBBG/WxUNLR/qcTK9YbBgTDWHbCrFvQBi+CA7bkRpLQD9j4n7n8t
sCs3AhwI434H6AN6nHKA3wdiBQei5Xq4D1h5Z4Xw+cSJE0eOHLl165aVcwrV
xVVMmTJFuzGm7m1jrsrdu3ezsrIKCgqSnLtt2zax/JcsWWIltG/fvlu3brWS
aC84kDg4oMcuB2KFPhAfOCA11zMOxEqqvxbQBxIn1R2IFRzQk+qvBfSBxEl1
B2zMleRA4lXbt29fZWXl7du3w1vUtzHMmTNHO8z2qlnMVamurha7amtrk5Nb
X18vDBk4cKAoWUVFRVtbW4enPXbsWEZGhpWRtoMDMnJxAAdwAAdwAAdwAAdw
AAdwAAdkO5B41YqLi8Wcc3Nzly1btn79elEXcU4x2wMHDmiH2V41i7mCpqam
zMzMvLy8mP52QyK5oo6TJk3q37+/GJmfn2/lqxSrqqpefPHFxKcXBzggIxcH
cAAHcAAHcAAHcAAHcAAHcEC2A4lXrb29fcOGDUOGDAkGg+rHCsTP9fX1EcNs
r5rF3Obm5l69eokn8Pfff09mrsrhw4dFdE5OzuXLl81PO3To0OrqaltmGCs4
IClXBQe04ID5aXFAXi4OdAgOSMpVwQEtOGB+WhyQl4sDHYIDknJVJDlg42cl
bty40djYGP4qvwjkfVbCJLepqUlcYO/evfVfSik1V8umTZvEhYdCIZMxLS0t
Ysz58+dtnaBVcEBGrhYcCIMDJmNwQF4uDlgBB2TkasGBMDhgMgYH5OXigBVw
QEauFhkOyPj2A0OS8O0HEezZsyc7O3vAgAEyShaNXbt2NTc3a7dUVVWJCxfb
TY5au3btmDFjJE8tKjhgLzhgAg6YHIUDksABi+CAveCACThgchQOSAIHLIID
9pIcB2RXraWl5V+PWLVqlZj8xIkT1Yd79+6VmvvNN9907txZJL733nuffPLJ
Px+zf/9+eaH37t0TkojcRYsWhUKhH374oaysLBgM5ubm3rhxw+TAvLw8MTd5
EzMHB2wEBwzBARzAARzAARzAARzAARzAARkOyK7a999/HzBi/vz5UnPHjx9v
mLtixQqpuVevXp07d27v3r3VuLS0tFdfffXMmTMmh1y5ckVUNuLuTTLBAXvB
AT04gAM4gAM4gAM4gAM4gAM4IMOBpL2zwm9cvHjx+PHj5rdfVOrq6nJzc5Mw
pWjggCRwAHAAcABwAHAAcACkOkDVHKe4uLiystLBCeCA4+AA4ADgAOAA4ADg
AMThAFUDHAAcABwAHAAcABwAHEhFqBrgAOAA4ADgAOAA4ADgQCpC1QAHAAcA
BwAHAAcABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgRfkPaLf5QA==
    "], {{0, 20.}, {675., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    SmoothingQuality->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{675., 20.},
  PlotRange->{{0, 675.}, {0, 20.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[3]=",
 CellID->454156173,ExpressionUUID->"b6e68268-9a51-498f-8384-37188c6e2b40"]
}, Open  ]],

Cell["\<\
Operating on the superposition state, the controlled exponentiation induces \
relative phase shifts.\
\>", "ExampleText",
 CellID->1730346951,ExpressionUUID->"34cac316-4777-4267-a51a-90e9a9e4d86a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1719176194,ExpressionUUID->"f6c6be04-47e9-40ee-8e42-aaf41c6ba907"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->326811059,ExpressionUUID->"bb41d7a2-dc05-468b-a512-08c4b495dcb1"]
}, Open  ]],

Cell["\<\
When the phase is one of the discrete values, the QFT can pick it up.\
\>", "ExampleText",
 CellID->1639236511,ExpressionUUID->"f21ebdce-16df-4873-b1f7-9388c15cc979"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trs", "=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{"2", "Pi", "*", 
       RowBox[{"2", "/", 
        RowBox[{"2", "^", "3"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Dagger", "[", 
       RowBox[{"QFT", "[", 
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "**", 
      "out"}], "//", "Simplify"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->575394993,ExpressionUUID->"b11bd4ac-91be-429d-9ada-0e6e343107f4"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SqrtBox["2"], " ", 
  InterpretationBox[
   TagBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    DisplayForm],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
     1|>]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->292850670,ExpressionUUID->"bf581f05-bd7b-44c9-8675-f962db13a9ac"]
}, Open  ]],

Cell["\<\
If the dimensionless phase value is not one of the discrete values that can \
be represented by the finite set \[LineSeparator]of control register, the QFT \
results in a superposition. But the probability distribution has a sharp peak.\
\>", "ExampleText",
 CellID->1511280490,ExpressionUUID->"0001e554-d158-495e-b4cc-8210a4257698"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trs", "=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{"2", "Pi", "*", 
       RowBox[{"2.125", "/", 
        RowBox[{"2", "^", "3"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Dagger", "[", 
       RowBox[{"QFT", "[", 
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "**", 
      "out"}], "//", "Simplify"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->881512640,ExpressionUUID->"c4c249c0-6eb1-48e7-aef9-6c374328891c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.16507009142403095`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.07807233879672618`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3160669899902172`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.015527375534336807`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.5962101484200346`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.9289388448395193`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2975749012646729`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.2697061693323886`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.08613955167004794`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.18212677996519847`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.00734390168977761`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.14948855308736705`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.04563583907545338`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.1275436259313973`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.09650241046095226`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10647400219210479`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TagBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     DisplayForm],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->89356322,ExpressionUUID->"84412f79-9118-4415-b4f1-c35801ff54ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"prb", "=", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"Normalize", "@", 
       RowBox[{"Matrix", "@", 
        RowBox[{"KetDrop", "[", 
         RowBox[{"trs", ",", 
          RowBox[{"S", "[", "4", "]"}]}], "]"}]}]}], "]"}], "^", "2"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"prb", ",", "\[IndentingNewLine]", 
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", "\"\<\[FilledCircle]\>\"", "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "7"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<8 \[Phi] / 2\[Pi]\>\"", ",", "\"\<probability\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->2115899125,ExpressionUUID->"dde9b646-5e33-4742-963a-9e63a23dab53"],

Cell[BoxData["0.004908`"], "EchoTiming",
 CellID->1017279614,ExpressionUUID->"e6418a4d-20b3-4c2a-b235-6b9077f8c207"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.012833333333333334`], Thickness[Large], 
          LineBox[{{0., 0.004167928145991091}, {1., 0.01251743019405755}, {2.,
            0.9504043140263699}, {3., 0.020161529954828863`}, {4., 
           0.0050737732928010865`}, {4.999999999999999, 
           0.0028000950495229602`}, {6., 0.00229375079048111}, {7., 
           0.002581178545947306}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, 
       TagBox[
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.012833333333333334`], Thickness[Large], 
         GeometricTransformationBox[
          TagBox[InsetBox["\[FilledCircle]", {0., 0.}],
           "InsetString"], {{{0., 0.004167928145991091}}, {{1., 
          0.01251743019405755}}, {{2., 0.9504043140263699}}, {{3., 
          0.020161529954828863`}}, {{4., 0.0050737732928010865`}}, {{
          4.999999999999999, 0.0028000950495229602`}}, {{6., 
          0.00229375079048111}}, {{7., 0.002581178545947306}}}]},
        Annotation[#, "Charting`Private`Tag#1"]& ]},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
          Annotation[{
            Hue[0.67, 0.6, 0.6], 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2], 
             Thickness[Large]], 
            
            Line[{{0., 0.004167928145991091}, {1., 0.01251743019405755}, {2., 
             0.9504043140263699}, {3., 0.020161529954828863`}, {4., 
             0.0050737732928010865`}, {4.999999999999999, 
             0.0028000950495229602`}, {6., 0.00229375079048111}, {7., 
             0.002581178545947306}}]}, "Charting`Private`Tag#1"]}, {
          Annotation[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2], 
             Thickness[Large]], 
            GeometricTransformation[
             Inset["\[FilledCircle]", {0., 0.}], {{{0., 
             0.004167928145991091}}, {{1., 0.01251743019405755}}, {{2., 
             0.9504043140263699}}, {{3., 0.020161529954828863`}}, {{4., 
             0.0050737732928010865`}}, {{4.999999999999999, 
             0.0028000950495229602`}}, {{6., 0.00229375079048111}}, {{7., 
             0.002581178545947306}}}]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 7.}, {0, 0.9504043140263699}}, 
           "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
           "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {False, False}, 
           "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[0.012833333333333334`], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2], 
              Thickness[Large]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{0, 7.}, {0, 0.9504043140263699}}, 
          "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
          "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {False, False}, 
          "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2], 
             Thickness[Large]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}]},
    Annotation[{{{}, {}, 
       Annotation[{
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2], 
          Thickness[Large]], 
         Line[{{0., 0.004167928145991091}, {1., 0.01251743019405755}, {2., 
          0.9504043140263699}, {3., 0.020161529954828863`}, {4., 
          0.0050737732928010865`}, {4.999999999999999, 
          0.0028000950495229602`}, {6., 0.00229375079048111}, {7., 
          0.002581178545947306}}]}, "Charting`Private`Tag#1"]}, {
       Annotation[{
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2], 
          Thickness[Large]], 
         GeometricTransformation[
          Inset["\[FilledCircle]", {0., 0.}], {{{0., 
          0.004167928145991091}}, {{1., 0.01251743019405755}}, {{2., 
          0.9504043140263699}}, {{3., 0.020161529954828863`}}, {{4., 
          0.0050737732928010865`}}, {{4.999999999999999, 
          0.0028000950495229602`}}, {{6., 0.00229375079048111}}, {{7., 
          0.002581178545947306}}}]}, "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PlotRange" -> {{0, 7.}, {0, 0.9504043140263699}}, 
        "Frame" -> {{True, True}, {True, True}}, "AxesOrigin" -> {0, 0}, 
        "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {False, False}, 
        "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[2], 
           Thickness[Large]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"8 \[Phi] / 2\[Pi]\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentSet", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 7.}, {0, 0.9504043140263699}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1301158731,ExpressionUUID->"0f6d65df-44d4-4ccf-9a83-465c3ccd063f"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
  ExpressionUUID->"4bc46987-cf74-452b-8301-971dcb2260c3"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"a4c0576a-4f3a-4641-8946-8ba033447da0"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "83c9aeac-c6f3-4305-80d0-b6920ef9c349"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1911880702,ExpressionUUID->"f8debabd-17af-4e89-88e4-9f3a7b96a816"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$m", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "number", " ", "of", " ", "qubits", " ", "in", " ", "the", 
    " ", "\"\<probe\>\"", " ", "register"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prb", "=", 
    RowBox[{"Range", "[", "$m", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "\"\<probe\>\"", " ", "register"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"$m", "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "\"\<system\>\"", " ", "register"}], " ", 
   "*)"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->61660548,ExpressionUUID->"38768c1f-761d-42e3-b98c-d5dce2749076"],

Cell["\<\
Consider the phase gate in the eigen-basis of the Pauli X operator.\
\>", "ExampleText",
 CellID->834601618,ExpressionUUID->"80322106-2c62-4e43-a291-361e505bd093"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"sys", ",", "6"}], "]"}], "**", 
    RowBox[{"Phase", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"S", "[", 
       RowBox[{"sys", ",", "3"}], "]"}]}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"sys", ",", "6"}], "]"}]}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->630087907,ExpressionUUID->"ce14cacb-50ab-41a8-b266-97a0126d68f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[4, 1]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1480978664,ExpressionUUID->"f4a84ace-85ed-429c-ad89-250fbdb1fb91"]
}, Open  ]],

Cell["\<\
This is the quantum circuit for the controlled exponentiation.\
\>", "ExampleText",
 CellID->898727511,ExpressionUUID->"a3187f89-ff16-4b1a-b101-5f8d142531fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledPower", "[", 
    RowBox[{
     RowBox[{"S", "@", "prb"}], ",", "op"}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1336888100,ExpressionUUID->"e7f117f7-0510-4572-9783-557308353a42"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
          0.6, -0.47439999999999993`}, {0.6, -1}}], 
        Line[{{0.6, -1}, {0.6, -3}}], 
        BezierCurve[{{0.6, -3.5256}, {1.4, -3.5256}, {1.4, -3}}]}]}, 
     InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[
      4, 1]]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->602880084,ExpressionUUID->"d168e626-5ac1-4881-8794-754c1304194c"]
}, Open  ]],

Cell["\<\
The controlled exponentiation can be implemented by using controlled-unitary \
gates.\
\>", "ExampleText",
 CellID->1066700697,ExpressionUUID->"4fbe218c-25ee-49f0-9197-dd6aaf8c976a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ctrlU", "[", "j_", "]"}], ":=", 
  RowBox[{"ControlledGate", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"MultiplyPower", "[", 
     RowBox[{"op", ",", 
      RowBox[{"Power", "[", 
       RowBox[{"2", ",", 
        RowBox[{"$m", "-", "j"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", 
     RowBox[{"Superscript", "[", 
      RowBox[{"\"\<U\>\"", ",", 
       RowBox[{"Superscript", "[", 
        RowBox[{"\"\<2\>\"", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"$m", "-", "j"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<LabelSize\>\"", "\[Rule]", "0.65"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->511664418,ExpressionUUID->"631b3042-275b-437a-9dea-17c411368910"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"ctrlU", "[", "1", "]"}], ",", 
    RowBox[{"ctrlU", "[", "2", "]"}], ",", 
    RowBox[{"ctrlU", "[", "3", "]"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1019350738,ExpressionUUID->"ab6bd862-3713-4ba6-88f2-ff0d07de9504"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -4}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"\"2\"", "\"2\""}, "Superscript", SyntaxForm -> 
          SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
     LineBox[{{1.6, -4.4}, {2.4, -4.4}, {2.4, -3.6}, {1.6, -3.6}, {
      1.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"\"2\"", "\"1\""}, "Superscript", SyntaxForm -> 
          SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", 
         TemplateBox[{"\"2\"", "\"0\""}, "Superscript", SyntaxForm -> 
          SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Rational[1, 2] (1 + E^(Complex[0, 4] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 4] $CellContext`\[Phi])) $CellContext`S[
      4, 1], "Label" -> Superscript["U", 
      Superscript["2", "2"]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Rational[1, 2] (1 + E^(Complex[0, 2] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 2] $CellContext`\[Phi])) $CellContext`S[
      4, 1], "Label" -> Superscript["U", 
      Superscript["2", "1"]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 2] (1 + E^(Complex[0, 1] $CellContext`\[Phi])) + 
    Rational[1, 2] (1 - E^(Complex[0, 1] $CellContext`\[Phi])) $CellContext`S[
      4, 1], "Label" -> Superscript["U", 
      Superscript["2", "0"]], "LabelSize" -> 0.65]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->105304209,ExpressionUUID->"982f20ed-db0f-46cb-a18a-611c75141d25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Elaborate", "[", "qc", "]"}], "-", 
   RowBox[{"Elaborate", "[", "new", "]"}]}], "//", "Simplify"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->793501579,ExpressionUUID->"3d947bbc-b757-4143-a8c4-884bf9291eb9"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1488565717,ExpressionUUID->"3d59796b-cd6a-4d90-a1e3-52dcf7274235"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ControlledGate"]], "paclet:Q3/ref/ControlledGate", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "6d59e184-6ac0-4135-8917-8f79bf72ee15"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "072c5c6a-5efd-45d1-bb6c-af168848d937"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CX"]], "paclet:Q3/ref/CX", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "516fa686-303c-4f52-b3c7-fecc9e86d163"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CZ"]], "paclet:Q3/ref/CZ", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "b31f361b-2333-43b1-a255-01e30022d732"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QuantumCircuit"]], "paclet:Q3/ref/QuantumCircuit", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "8d79f64d-2a32-4c88-b42b-f39f6a3cd622"]
       }], "SeeAlso",ExpressionUUID->"e414ae21-d324-48b5-84ab-c7d030af5047"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"5858fcce-5579-48c5-9593-\
e1a1d9b51e1e"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Phase Estimation",
         BaseStyle->"Link",
         ButtonData->"paclet:Q3/tutorial/QuantumPhaseEstimation"]], 
         "TechNotes",ExpressionUUID->
         "800aa863-d975-4c82-afee-87d8eb6adf66"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Multi-Control Unitary Gates"]], 
           "paclet:Q3/tutorial/MultiControlUnitaryGates"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "ee1a73a3-3663-4ef5-bbab-689e95a5cc5f"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Computation: Overview"]], 
           "paclet:Q3/tutorial/QuantumComputationOverview"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "8da0df4b-8a41-4b3f-ac84-959133ddf84b"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "af705e42-2d26-4652-b9c5-b43e02574a51"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quick Quantum Computing with Q3"]], 
           "paclet:Q3/tutorial/QuickQuantumComputingWithQ3"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "3f140254-b5a9-4c32-aa84-f2bb434b9028"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "aa643f60-be22-49c8-9521-de6d9d4b395d"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"a5f89721-9edd-4975-bd2f-\
2951af378a28"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "7c633744-5496-4b45-9556-f55bffb03b8d"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "fdbe9609-03d5-49b9-9b73-494136e54c19"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"507a7baa-2ed5-4f3d-ae86-\
d460061cc785"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "f277b4bf-7743-48ea-8cf1-20f6552f0bc4"]}]],ExpressionUUID->
         "8b39868b-a0a8-4f72-bb74-fdaf91b2c120"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "3d4bf305-7529-477d-a84c-8be347c7b530"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "b748038b-e48a-48c4-a81b-084d444f3ffa"]}]],ExpressionUUID->
         "b677facc-7d00-4d09-9fd9-463b1fbadc8e"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "RelatedLinks",ExpressionUUID->
        "40d7976d-0ce8-4797-86cc-8e347640e75f"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"a8d6a901-14f5-4aba-b0e9-\
f11a389c645f"],

Cell[" ", "FooterCell",ExpressionUUID->"14817b9d-f979-4a35-b333-953697668d7c"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"ControlledPower",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "HasOptions" -> True, "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "NotesSection" -> 
    Closed}, "NewStyles" -> True, "CitationPopupData" -> $Failed, 
  "ShowCitation" -> False, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2023, 7, 20, 9, 20, 23.516651}", 
    "history" -> {"13.1", "", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"controlled exponentiation", "controlled power"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "ControlledPower[{c1, c2, ...}, op] represents the controlled power (also \
known as controlled exponentiation) of unitary operator op.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "ControlledPower", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "ControlledPower", "type" -> "Symbol", "uri" -> "Q3/ref/ControlledPower"}},
CellContext->"Global`",
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (June 3, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "13.3 for Mac OS X ARM (64-bit) (June 3, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"d33d0b56-3555-4054-8ebe-3bd36aed2ca9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[17933, 500, 1389, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"7317560c-8b4c-4791-b3a8-6af8e14cce37",
   CellTags->"PrimaryExamplesSection",
   CellID->961001519]},
 "RasterizedOutput"->{
  Cell[69434, 1918, 5012, 88, 41, "Output",ExpressionUUID->"b6e68268-9a51-498f-8384-37188c6e2b40",
   CellTags->"RasterizedOutput",
   CellID->454156173]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 137307, 3626},
 {"RasterizedOutput", 137507, 3630}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 7675, 186, 57, "AnchorBarGrid",ExpressionUUID->"6661cf18-e522-4b90-97d2-d077c1cca515",
 CellID->1],
Cell[8265, 209, 85, 0, 23, "ContextNameCell",ExpressionUUID->"5791f12f-1dd5-4017-83bb-85b2bf993ae8"],
Cell[CellGroupData[{
Cell[8375, 213, 1391, 38, 60, "ObjectNameGrid",ExpressionUUID->"1de71747-ace0-49b4-a2dc-ba568b942761"],
Cell[9769, 253, 1310, 37, 114, "Usage",ExpressionUUID->"df1e2fa1-fba5-4572-a409-864423852d21",
 CellID->64829665]
}, Open  ]],
Cell[CellGroupData[{
Cell[11116, 295, 1898, 47, 37, "NotesSection",ExpressionUUID->"5cdbbdd9-7225-47e3-b506-ec45fa645ca5",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->556126009],
Cell[13017, 344, 2383, 78, 70, "Notes",ExpressionUUID->"c2f41ce3-45e4-4d5b-bd69-e73c069eb2d7",
 CellID->100026970],
Cell[15403, 424, 726, 22, 70, "Notes",ExpressionUUID->"e8ecf42d-30e4-4ea1-837c-866382304e2f",
 CellID->2112528434],
Cell[16132, 448, 700, 21, 70, "Notes",ExpressionUUID->"0230f574-1480-4d58-a55b-4bde45981f61",
 CellID->1630510880],
Cell[16835, 471, 259, 7, 70, "Notes",ExpressionUUID->"40b1b323-1c2b-4add-a452-fd88141c903a",
 CellID->1639654363],
Cell[17097, 480, 128, 1, 70, "Notes",ExpressionUUID->"fcc911b7-0b1c-47c3-bc06-f07a9c9cab73",
 CellID->817970626],
Cell[17228, 483, 578, 11, 70, "3ColumnTableMod",ExpressionUUID->"5c00ac90-f36c-403b-97a1-9637302d42cc",
 CellID->1589486735]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[17933, 500, 1389, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"7317560c-8b4c-4791-b3a8-6af8e14cce37",
 CellTags->"PrimaryExamplesSection",
 CellID->961001519],
Cell[19325, 539, 191, 3, 31, "Input",ExpressionUUID->"3ae6a338-1c6b-4df7-90e2-76b0f0911490",
 CellID->851865642],
Cell[CellGroupData[{
Cell[19541, 546, 1367, 36, 31, "ExampleSection",ExpressionUUID->"a3253d2d-ed40-4480-a737-5f028d9da84d",
 CellID->328020746],
Cell[20911, 584, 209, 5, 29, "Input",ExpressionUUID->"014c9d9f-afb5-4ad8-8cc5-1c42a125b410",
 CellID->2076530764],
Cell[CellGroupData[{
Cell[21145, 593, 445, 13, 29, "Input",ExpressionUUID->"43e7994d-b777-4613-8787-aab3582a14a8",
 CellID->1495803151],
Cell[21593, 608, 1132, 36, 40, "Output",ExpressionUUID->"0bd262a1-1ddb-4298-a791-2164afcf392e",
 CellID->1034004646]
}, Open  ]],
Cell[CellGroupData[{
Cell[22762, 649, 395, 12, 29, "Input",ExpressionUUID->"db4b4573-02cf-42e8-9571-711f0f01a586",
 CellID->2104788460],
Cell[23160, 663, 1293, 32, 41, "Output",ExpressionUUID->"35080271-3faf-45f4-9d72-6584144e1a59",
 CellID->1547837474]
}, Open  ]],
Cell[CellGroupData[{
Cell[24490, 700, 504, 15, 48, "Input",ExpressionUUID->"ca6ccab4-701c-4904-85bc-2de3b98289cd",
 CellID->1154618494],
Cell[24997, 717, 4389, 111, 41, "Output",ExpressionUUID->"8b3a4108-3272-43f9-9a77-5a761a92eb16",
 CellID->2117441002]
}, Open  ]],
Cell[CellGroupData[{
Cell[29423, 833, 203, 5, 29, "Input",ExpressionUUID->"6c0d3b13-3e92-4232-9cc2-7eff46157e12",
 CellID->1825261592],
Cell[29629, 840, 4800, 120, 41, "Output",ExpressionUUID->"0a38929d-7946-4822-aa96-e6fbbd6f86c7",
 CellID->40362989]
}, Open  ]],
Cell[CellGroupData[{
Cell[34466, 965, 242, 5, 14, "ExampleDelimiter",ExpressionUUID->"54692882-e20b-4d8b-9f03-ff61715191fb",
 CellID->360562160],
Cell[34711, 972, 210, 4, 38, "ExampleText",ExpressionUUID->"65655618-cd8b-4b84-aaeb-c1c3298f0f8c",
 CellID->83261738],
Cell[CellGroupData[{
Cell[34946, 980, 294, 7, 48, "Input",ExpressionUUID->"fda527a0-5cc8-4730-a467-961f6ad8c0c8",
 CellID->2073621093],
Cell[35243, 989, 1489, 35, 174, "Output",ExpressionUUID->"00c4d1ce-7d36-4e54-ac0b-d862096f3966",
 CellID->267393073]
}, Open  ]],
Cell[CellGroupData[{
Cell[36769, 1029, 421, 12, 70, "Input",ExpressionUUID->"71861f93-8a49-4cb1-b2e2-addc4d6551df",
 CellID->43453953],
Cell[37193, 1043, 3143, 69, 316, "Output",ExpressionUUID->"cb53c8ee-df21-458c-a325-cc2a6a3aa9b3",
 CellID->1729498494]
}, Open  ]],
Cell[40351, 1115, 185, 3, 70, "ExampleText",ExpressionUUID->"f4e1cde4-0892-4331-b315-9e932b2aaa39",
 CellID->1098295329],
Cell[CellGroupData[{
Cell[40561, 1122, 213, 5, 70, "Input",ExpressionUUID->"3ca5008e-3096-4154-9bf8-0b46da43860f",
 CellID->337611983],
Cell[40777, 1129, 7516, 193, 84, "Output",ExpressionUUID->"a47ec22f-7a31-4a79-9608-b46adece7ddd",
 CellID->1876972792]
}, Open  ]],
Cell[CellGroupData[{
Cell[48330, 1327, 376, 11, 70, "Input",ExpressionUUID->"9efc0514-79c9-40d0-9d9f-8ff227b4e5fb",
 CellID->1061819516],
Cell[48709, 1340, 2331, 53, 304, "Output",ExpressionUUID->"f49d33ae-e9b5-4f05-9873-22b638daa9d7",
 CellID->196808537]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51089, 1399, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"17e27e71-530c-4fb8-aef8-ec274ee60c36",
 CellID->689713619],
Cell[CellGroupData[{
Cell[51356, 1408, 481, 14, 70, "Input",ExpressionUUID->"cf578579-8438-4b2c-962b-cb007b450fa6",
 CellID->2047551674],
Cell[51840, 1424, 737, 21, 52, "Output",ExpressionUUID->"a5284fe0-ef25-4555-8f52-8c367c5e6208",
 CellID->1765364494]
}, Open  ]],
Cell[CellGroupData[{
Cell[52614, 1450, 792, 22, 70, "Input",ExpressionUUID->"6aed0638-7cbc-4e07-973c-4a830dda48aa",
 CellID->629762013],
Cell[53409, 1474, 424, 8, 70, "Message",ExpressionUUID->"74d68942-d554-4402-830a-f2456ca9b6a1",
 CellID->1060667912],
Cell[53836, 1484, 4886, 117, 165, "Output",ExpressionUUID->"f7e32f2d-8222-4342-9d38-8bd996008803",
 CellID->383843237]
}, Open  ]],
Cell[CellGroupData[{
Cell[58759, 1606, 657, 19, 70, "Input",ExpressionUUID->"80aa047e-f3d4-4cc2-9d97-2ffe8cc0ca7d",
 CellID->658842380],
Cell[59419, 1627, 3390, 88, 163, "Output",ExpressionUUID->"d0f7dde2-3006-4b9a-b233-c8fbd47afe54",
 CellID->1656120149]
}, Open  ]],
Cell[CellGroupData[{
Cell[62846, 1720, 275, 7, 70, "Input",ExpressionUUID->"e6bd92c0-8044-469f-a740-4c9a5356cfd1",
 CellID->1562364716],
Cell[63124, 1729, 323, 7, 37, "Output",ExpressionUUID->"f94386d7-acde-44b1-a89c-f477b0354994",
 CellID->1799556762]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63496, 1742, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"034d79bd-3423-4766-9526-e22e165360af",
 CellID->1935006837],
Cell[CellGroupData[{
Cell[63764, 1751, 481, 14, 70, "Input",ExpressionUUID->"40b1aafd-8e07-4bbc-92be-ad01bcf309dc",
 CellID->1747542897],
Cell[64248, 1767, 737, 21, 52, "Output",ExpressionUUID->"077f9401-83e1-43e6-9a1c-8f541146dff7",
 CellID->1553916659]
}, Open  ]],
Cell[CellGroupData[{
Cell[65022, 1793, 656, 19, 70, "Input",ExpressionUUID->"e2fdfe6a-610b-4723-965d-c20fb88ec766",
 CellID->765966584],
Cell[65681, 1814, 3390, 88, 163, "Output",ExpressionUUID->"f03bdf8e-11a7-458f-9892-0fe0507aa4aa",
 CellID->1829551932]
}, Open  ]],
Cell[CellGroupData[{
Cell[69108, 1907, 323, 9, 70, "Input",ExpressionUUID->"f34e1d4c-09b7-4640-aa4d-253215d8cd32",
 CellID->538882566],
Cell[69434, 1918, 5012, 88, 41, "Output",ExpressionUUID->"b6e68268-9a51-498f-8384-37188c6e2b40",
 CellTags->"RasterizedOutput",
 CellID->454156173]
}, Open  ]],
Cell[74461, 2009, 207, 4, 70, "ExampleText",ExpressionUUID->"34cac316-4777-4267-a51a-90e9a9e4d86a",
 CellID->1730346951],
Cell[CellGroupData[{
Cell[74693, 2017, 203, 5, 70, "Input",ExpressionUUID->"f6c6be04-47e9-40ee-8e42-aaf41c6ba907",
 CellID->1719176194],
Cell[74899, 2024, 11996, 295, 61, "Output",ExpressionUUID->"bb41d7a2-dc05-468b-a512-08c4b495dcb1",
 CellID->326811059]
}, Open  ]],
Cell[86910, 2322, 176, 3, 70, "ExampleText",ExpressionUUID->"f21ebdce-16df-4873-b1f7-9388c15cc979",
 CellID->1639236511],
Cell[CellGroupData[{
Cell[87111, 2329, 690, 20, 70, "Input",ExpressionUUID->"b11bd4ac-91be-429d-9ada-0e6e343107f4",
 CellID->575394993],
Cell[87804, 2351, 1519, 38, 41, "Output",ExpressionUUID->"bf581f05-bd7b-44c9-8675-f962db13a9ac",
 CellID->292850670]
}, Open  ]],
Cell[89338, 2392, 343, 5, 70, "ExampleText",ExpressionUUID->"0001e554-d158-495e-b4cc-8210a4257698",
 CellID->1511280490],
Cell[CellGroupData[{
Cell[89706, 2401, 694, 20, 70, "Input",ExpressionUUID->"c4c249c0-6eb1-48e7-aef9-6c374328891c",
 CellID->881512640],
Cell[90403, 2423, 12582, 307, 101, "Output",ExpressionUUID->"84412f79-9118-4415-b4f1-c35801ff54ef",
 CellID->89356322]
}, Open  ]],
Cell[CellGroupData[{
Cell[103022, 2735, 1086, 28, 70, "Input",ExpressionUUID->"dde9b646-5e33-4742-963a-9e63a23dab53",
 CellID->2115899125],
Cell[104111, 2765, 116, 1, 70, "EchoTiming",ExpressionUUID->"e6418a4d-20b3-4c2a-b235-6b9077f8c207",
 CellID->1017279614],
Cell[104230, 2768, 10817, 247, 70, "Output",ExpressionUUID->"0f6d65df-44d4-4ccf-9a83-465c3ccd063f",
 CellID->1301158731]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[115208, 3024, 1394, 36, 70, "ExampleSection",ExpressionUUID->"f8debabd-17af-4e89-88e4-9f3a7b96a816",
 CellID->1911880702],
Cell[116605, 3062, 823, 25, 70, "Input",ExpressionUUID->"38768c1f-761d-42e3-b98c-d5dce2749076",
 CellID->61660548],
Cell[117431, 3089, 173, 3, 70, "ExampleText",ExpressionUUID->"80322106-2c62-4e43-a291-361e505bd093",
 CellID->834601618],
Cell[CellGroupData[{
Cell[117629, 3096, 486, 14, 70, "Input",ExpressionUUID->"ce14cacb-50ab-41a8-b266-97a0126d68f6",
 CellID->630087907],
Cell[118118, 3112, 737, 21, 52, "Output",ExpressionUUID->"f4a84ace-85ed-429c-ad89-250fbdb1fb91",
 CellID->1480978664]
}, Open  ]],
Cell[118870, 3136, 168, 3, 70, "ExampleText",ExpressionUUID->"a3187f89-ff16-4b1a-b101-5f8d142531fd",
 CellID->898727511],
Cell[CellGroupData[{
Cell[119063, 3143, 314, 8, 70, "Input",ExpressionUUID->"e7f117f7-0510-4572-9783-557308353a42",
 CellID->1336888100],
Cell[119380, 3153, 1959, 49, 167, "Output",ExpressionUUID->"d168e626-5ac1-4881-8794-754c1304194c",
 CellID->602880084]
}, Open  ]],
Cell[121354, 3205, 192, 4, 70, "ExampleText",ExpressionUUID->"4fbe218c-25ee-49f0-9197-dd6aaf8c976a",
 CellID->1066700697],
Cell[121549, 3211, 837, 22, 70, "Input",ExpressionUUID->"631b3042-275b-437a-9dea-17c411368910",
 CellID->511664418],
Cell[CellGroupData[{
Cell[122411, 3237, 354, 9, 70, "Input",ExpressionUUID->"ab6bd862-3713-4ba6-88f2-ff0d07de9504",
 CellID->1019350738],
Cell[122768, 3248, 3374, 75, 167, "Output",ExpressionUUID->"982f20ed-db0f-46cb-a18a-611c75141d25",
 CellID->105304209]
}, Open  ]],
Cell[CellGroupData[{
Cell[126179, 3328, 282, 7, 70, "Input",ExpressionUUID->"3d947bbc-b757-4143-a8c4-884bf9291eb9",
 CellID->793501579],
Cell[126464, 3337, 127, 2, 37, "Output",ExpressionUUID->"3d59796b-cd6a-4d90-a1e3-52dcf7274235",
 CellID->1488565717]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[126833, 3348, 2786, 75, 70, "SeeAlsoSection",ExpressionUUID->"5858fcce-5579-48c5-9593-e1a1d9b51e1e"],
Cell[129622, 3425, 2503, 63, 70, "TechNotesSection",ExpressionUUID->"a5f89721-9edd-4975-bd2f-2951af378a28"],
Cell[132128, 3490, 1045, 27, 70, "MoreAboutSection",ExpressionUUID->"507a7baa-2ed5-4f3d-ae86-d460061cc785"],
Cell[133176, 3519, 2106, 59, 70, "RelatedLinksSection",ExpressionUUID->"a8d6a901-14f5-4aba-b0e9-f11a389c645f"],
Cell[135285, 3580, 78, 0, 70, "FooterCell",ExpressionUUID->"14817b9d-f979-4a35-b333-953697668d7c"]
}
]
*)

(* End of internal cache information *)

