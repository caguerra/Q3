(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74432,       2372]
NotebookOptionsPosition[     65982,       2193]
NotebookOutlinePosition[     68177,       2249]
CellTagsIndexPosition[     68091,       2244]
WindowTitle->WignerAddZ
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Wigner Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/WignerQuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"WignerAdd\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/WignerAdd"], "\<\"WignerSpinSpin\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/WignerSpinSpin"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Wigner Package\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/WignerPackageGuide"], "\<\"Q3 Application\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/WignerAddZ\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/WignerAddZ"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/WignerAddZ.\
html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$177909], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], "Q3/ref/WignerAddZ", 
             ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["WignerAddZ", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"WignerAddZ", "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], ",", "..."}], "]"}]], "InlineFormula"],
     "\[LineSeparator]returns the irreducible basis of the total angular \
momentum ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], "+", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], "+"}], "..."}]], "InlineFormula"],
     " invariant under the U(1) rotation around spin z-axis."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->1936062012],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->722016340],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2000433963],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Spin", ",", "S", ",", 
   RowBox[{"Spin", "\[Rule]", 
    RowBox[{"3", "/", "2"}]}]}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->73225907],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"irb", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{"S", "[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"irc", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{"S", "[", "2", "]"}], "]"}]}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->199689218],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    FractionBox["3", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           FractionBox["1", "2"], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["1", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1686720867],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    FractionBox["3", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           FractionBox["1", "2"], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["1", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1933471269]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"irb", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"irc", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "3", "]"}], ",", 
    RowBox[{"S", "[", "4", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1945113869],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "3"}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1290489708],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "3"}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]]], 
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1823171303]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"basis1", "=", 
  RowBox[{
   RowBox[{"WignerAddZ", "[", 
    RowBox[{"irb", ",", "irc"}], "]"}], "//", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"basis2", "=", 
  RowBox[{
   RowBox[{"WignerAddZ", "[", 
    RowBox[{"S", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], "//", 
   
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"basis1", "==", "basis2"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->1485570460],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->920099904],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->89344481],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[5]=",
 CellID->521622914]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->258228157],

Cell[TextData[{
 "Here we will consider a Spin-1/2 XXZ chain. See ",
 StyleBox["Giamarchi",
  IgnoreSpellCheck->True],
 "  (2004) Chapter 6 and ",
 StyleBox["Moradmard",
  IgnoreSpellCheck->True],
 " et al (2013)."
}], "ExampleText",
 CellID->1134748374],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1603225532],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Spin", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "Jz"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->2119866525],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "L", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jz", "=", "2."}], ";"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1840908934],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"XX", "=", 
  RowBox[{
   RowBox[{"WignerSpinSpin", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}], "[", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ZZ", "=", 
  RowBox[{
   RowBox[{"WignerSpinSpin", "[", "3", "]"}], "[", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "Jz_", "]"}], ":=", 
  RowBox[{"XX", "+", 
   RowBox[{"Jz", "*", "ZZ"}]}]}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1618169042],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"5"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"5"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->909690645],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"5"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1234587522]
}, Open  ]],

Cell["We first take a naive approach.", "ExampleText",
 CellID->1621011209],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"HH", "=", 
   RowBox[{"H", "[", "1.2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matH", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"HH", "//", "Expand"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eval", ",", "evec"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "matH", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"eval", "//", "Sort"}], "]"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->940933697],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    Thickness[Large], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQDQEf7Ptid/ucqWQ4ABVw6EXhczicKOVfL7jgy34I
X8BhEQpfxEF0DsebPfPfQvkSDkwofBmHNQ4Tuj+ueAnlKzisQOErOfw2sfiU
Nv8ZlK/i8B2Fr+Yg5CCzWM37BpSv4fDeHpmv5aCSI+9pLXcJytdxEEDh6zno
yRcUW8w8bQ/hGzgYo/ANHY59Miu4zH4ZyjdyuILCN3ZIKXw3qeTzNSjfxCEN
hW/qEFNyX6nm2WMo38whEYVv7pB3YW68qc9rKN/CIR+Fb+ng9/LQ9QCnN1C+
lUMACt/a4fr+mXNCld5D+TYON1D4tg7zZJdZmW78AOXbOcxH4ds7GIPBZyjf
Ac4HAIEykiQ=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 32.}, {-2.0594717020682713`, 1.2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[5]=",
 CellID->827488504]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", 
    RowBox[{
     RowBox[{"evec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"Range", "[", "L", "]"}], "]"}]}], "]"}], "//", 
   "Chop"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"v", "=", 
    RowBox[{
     RowBox[{"KetForm", "[", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"evec", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", "Chop"}]}], " ", 
   "*)"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->613855558],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.0008339570684886555`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.041201665506340295`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.21914932698438977`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.22226266541919054`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.004435770448770176`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.3762201515965198`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.6963380127297911`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.007615018734702852`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.22226266541919115`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.003697559294966417`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.18267799029173065`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0044987870905099725`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.3762201515965217`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.01409447896430051`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.21914932698439302`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0076150187347028345`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0044987870905099595`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.04120166550634116`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.004435770448770115`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0008339570684885302`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->198812463]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->977282934],

Cell["Now let us use the Spin-Z conservation.", "ExampleText",
 CellID->727372248],

Cell["We construct the basis according to the total Sz.", "ExampleText",
 CellID->1970260413],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"basis", "=", 
   RowBox[{"WignerAddZ", "[", 
    RowBox[{"S", "[", 
     RowBox[{"Range", "@", "L"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "basis"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->1244926211],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    FractionBox["5", "2"], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}], ",", 
   RowBox[{
    FractionBox["3", "2"], "\[Rule]", 
    RowBox[{"{", "5", "}"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], "\[Rule]", 
    RowBox[{"{", "10", "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "\[Rule]", 
    RowBox[{"{", "10", "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], "\[Rule]", 
    RowBox[{"{", "5", "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["5", "2"]}], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->570657592]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"matH", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"Multiply", ",", 
        RowBox[{"Dagger", "[", "#", "]"}], ",", 
        RowBox[{"HH", "**", "#"}]}], "]"}], "&"}], ",", "basis"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->421750059],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eval", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Eigenvalues", ",", "matH"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "@", 
   RowBox[{"Catenate", "@", "eval"}]}], "]"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1657206513],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    Thickness[Large], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQDQEf7CfG7vY5U8lwACrg0IPC53DYVcq/XnDBl/0Q
voDDDhS+iAPHHI43e+a/hfIl0PgyDnsdJnR/XPESyldA4ys5fDKx+JQ2/xmU
r+LwBoWv5vDLXmaxmvcNKF/D4RMKX8vBIkfe01ruEpSvg8bXc9CULyi2mHna
HsI3cDBA4Rs6HP1kVnCZ/TKUb4TGN3ZILXw3qeTzNSjfBI1v6pBUcl+p5tlj
KN/MIRmFb+6Qf2FuvKnPayjfwqEQhW/p4Pfy0PUApzdQvhUa39rh2v6Zc0KV
3kP5Nmh8W4f5ssusTDd+gPLt0Pj2DsZg8BnKd4DzARRxk04=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 32.}, {-2.0594717020682727`, 1.2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1740703684]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WignerAdd"]], "paclet:Q3/ref/WignerAdd"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WignerSpinSpin"]], "paclet:Q3/ref/WignerSpinSpin"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Wigner Quick Start"]], "paclet:Q3/tutorial/WignerQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->341631938],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Wigner Package"]], "paclet:Q3/guide/WignerPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1646020830],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3 Application"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->787749156]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"WignerAddZ",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 5, 17, 11, 25, 9.617348}", 
    "history" -> {"XX", "", "", ""}, "context" -> "Q3`Wigner`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "WignerAddZ[s1, s2, ...] returns the irreducible basis of the total \
angular momentum s1 + s2 + ... invariant under the U(1) rotation around spin \
z-axis.", "synonyms" -> {}, "tabletags" -> {}, "title" -> "WignerAddZ", 
    "titlemodifier" -> "", "windowtitle" -> "WignerAddZ", "type" -> "Symbol", 
    "uri" -> "Q3/ref/WignerAddZ", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6044, 175, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"e9757c1d-96e0-4c04-8601-ae4463f7ef9d",
   CellTags->"PrimaryExamplesSection",
   CellID->1936062012]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 67892, 2237}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[582, 21, 4383, 111, 70, "AnchorBarGrid",ExpressionUUID->"ed9c8350-a3ce-4c4a-8202-aa3c8398bac1",
 CellID->1],
Cell[CellGroupData[{
Cell[4990, 136, 167, 6, 70, "ObjectNameGrid",ExpressionUUID->"16133501-696c-4f87-b652-8870a3ef23cb"],
Cell[5160, 144, 847, 26, 70, "Usage",ExpressionUUID->"9047187b-1ab1-4c2b-9a7b-e3acfefed489"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6044, 175, 268, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"e9757c1d-96e0-4c04-8601-ae4463f7ef9d",
 CellTags->"PrimaryExamplesSection",
 CellID->1936062012],
Cell[CellGroupData[{
Cell[6337, 189, 195, 6, 70, "ExampleSection",ExpressionUUID->"3e459ab9-986c-45ee-b0e7-265bddce14dd",
 CellID->722016340],
Cell[6535, 197, 91, 3, 70, "Input",ExpressionUUID->"1cfe2839-a98c-44fc-b940-4b5d98a12afd",
 CellID->2000433963],
Cell[6629, 202, 192, 6, 70, "Input",ExpressionUUID->"54f566c0-4d0c-4391-aadd-09cf9e12d3db",
 CellID->73225907],
Cell[CellGroupData[{
Cell[6846, 212, 280, 8, 70, "Input",ExpressionUUID->"3e52b499-b262-4221-a102-0c6554dcdb6a",
 CellID->199689218],
Cell[7129, 222, 1487, 52, 70, "Output",ExpressionUUID->"048fcb93-b1c4-4cc1-be4f-e9ef24364f0f",
 CellID->1686720867],
Cell[8619, 276, 1487, 52, 70, "Output",ExpressionUUID->"6c1ce5ef-5f8c-482c-a63a-b8156231ed42",
 CellID->1933471269]
}, Open  ]],
Cell[CellGroupData[{
Cell[10143, 333, 391, 12, 70, "Input",ExpressionUUID->"ee9a3fb0-6764-4e3f-87ee-b3e222784d68",
 CellID->1945113869],
Cell[10537, 347, 7282, 225, 70, "Output",ExpressionUUID->"2f02e47a-b74d-44e1-a874-fd1eca2f3c67",
 CellID->1290489708],
Cell[17822, 574, 7282, 225, 70, "Output",ExpressionUUID->"4b2aed63-4e29-4f2f-8849-f28590884dc8",
 CellID->1823171303]
}, Open  ]],
Cell[CellGroupData[{
Cell[25141, 804, 632, 20, 70, "Input",ExpressionUUID->"f0c7dfd9-9f79-4957-b328-a7c6b912454e",
 CellID->1485570460],
Cell[25776, 826, 5752, 174, 70, "Output",ExpressionUUID->"fe96f32d-59be-4dce-9beb-43c43d26b844",
 CellID->920099904],
Cell[31531, 1002, 5751, 174, 70, "Output",ExpressionUUID->"d93458c8-156a-4dcf-a938-7190fc003dda",
 CellID->89344481],
Cell[37285, 1178, 74, 2, 70, "Output",ExpressionUUID->"c01494b6-40d5-477d-84d2-6da55383ddd0",
 CellID->521622914]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37408, 1186, 193, 6, 70, "ExampleSection",ExpressionUUID->"9b14f0f6-c2b9-4cf1-8ce8-59964238edce",
 CellID->258228157],
Cell[37604, 1194, 254, 9, 70, "ExampleText",ExpressionUUID->"10dbdda6-ee82-49ea-b817-63e95ac843a9",
 CellID->1134748374],
Cell[37861, 1205, 91, 3, 70, "Input",ExpressionUUID->"5710359c-fdee-4b10-8b62-c5a9d3cfa4a7",
 CellID->1603225532],
Cell[37955, 1210, 212, 6, 70, "Input",ExpressionUUID->"18254258-c398-4c93-a6b3-8cf115c16e32",
 CellID->2119866525],
Cell[38170, 1218, 285, 9, 70, "Input",ExpressionUUID->"632043fe-3fbd-4fed-a8a4-19f2beed3368",
 CellID->1840908934],
Cell[CellGroupData[{
Cell[38480, 1231, 585, 18, 70, "Input",ExpressionUUID->"0589dd5e-97e1-4c6a-af81-59f6d335a270",
 CellID->1618169042],
Cell[39068, 1251, 3737, 139, 70, "Output",ExpressionUUID->"734ca97d-25fe-456b-982e-4edd122efbb0",
 CellID->909690645],
Cell[42808, 1392, 1906, 71, 70, "Output",ExpressionUUID->"56471a21-2bd8-4d06-9b54-05c4b127ddb2",
 CellID->1234587522]
}, Open  ]],
Cell[44729, 1466, 75, 1, 70, "ExampleText",ExpressionUUID->"540fe76b-fdda-499d-8a2d-d15f7208076e",
 CellID->1621011209],
Cell[CellGroupData[{
Cell[44829, 1471, 541, 17, 70, "Input",ExpressionUUID->"3024a151-2616-4182-ace3-4b0c68da4037",
 CellID->940933697],
Cell[45373, 1490, 1640, 46, 70, "Output",ExpressionUUID->"aabe648f-0b26-4d96-a89e-3a216acdce8f",
 CellID->827488504]
}, Open  ]],
Cell[CellGroupData[{
Cell[47050, 1541, 608, 21, 70, "Input",ExpressionUUID->"4e63c0b6-e372-4d1b-bdf8-8efbd8cee348",
 CellID->613855558],
Cell[47661, 1564, 12735, 403, 70, "Output",ExpressionUUID->"7af3cc31-199e-41de-ae3b-12453ca42df7",
 CellID->198812463]
}, Open  ]],
Cell[CellGroupData[{
Cell[60433, 1972, 125, 3, 70, "ExampleDelimiter",ExpressionUUID->"fa6f260b-c544-4234-b14e-ee9533596401",
 CellID->977282934],
Cell[60561, 1977, 82, 1, 70, "ExampleText",ExpressionUUID->"0df136fb-6449-4d91-a1e5-f79ab0cac328",
 CellID->727372248],
Cell[60646, 1980, 93, 1, 70, "ExampleText",ExpressionUUID->"2a7632b5-71d4-4aa6-bd0f-a269e1a67eaf",
 CellID->1970260413],
Cell[CellGroupData[{
Cell[60764, 1985, 282, 9, 70, "Input",ExpressionUUID->"2dc758a7-6ef0-489e-9e17-2f41470304d2",
 CellID->1244926211],
Cell[61049, 1996, 724, 25, 70, "Output",ExpressionUUID->"36e48d11-97d1-4eb6-8e7d-62e082271081",
 CellID->570657592]
}, Open  ]],
Cell[61788, 2024, 348, 12, 70, "Input",ExpressionUUID->"c3f61e57-d7b3-4b6c-98d9-72d2f603a252",
 CellID->421750059],
Cell[CellGroupData[{
Cell[62161, 2040, 310, 10, 70, "Input",ExpressionUUID->"d114c37d-0bde-432f-80a5-20d6c8b443e9",
 CellID->1657206513],
Cell[62474, 2052, 1616, 45, 70, "Output",ExpressionUUID->"2f967cfb-bbd0-4da2-bce4-2e5d41d222fc",
 CellID->1740703684]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[64129, 2102, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"4b3c82f3-85c8-4f61-be20-48fec2f8a97c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64197, 2107, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"e12b5f11-58dd-41e6-bde7-2efbbf65a889",
 CellID->1255426704],
Cell[64350, 2116, 558, 18, 70, "SeeAlso",ExpressionUUID->"86d8cfaf-8634-4f41-ab76-e35e1f78dcc8",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[64945, 2139, 152, 7, 70, "TutorialsSection",ExpressionUUID->"e7c7b22c-8d91-47dd-82d4-8567a7e3246d",
 CellID->250839057],
Cell[65100, 2148, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"6f71c654-1f38-4426-98ed-99e140140570"],
Cell[65134, 2150, 188, 6, 70, "Tutorials",ExpressionUUID->"e322c19b-5748-4c52-964b-2140c0e40230",
 CellID->341631938],
Cell[65325, 2158, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"7b7c3074-b1d2-467e-a487-8528f5b10c41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65393, 2163, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"7fda3a63-d7a2-42a9-9cba-40427fbecab0",
 CellID->38303248],
Cell[65552, 2172, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"1cca259a-f09b-47ad-af1c-19ff76054db6"],
Cell[65586, 2174, 184, 6, 70, "MoreAbout",ExpressionUUID->"572879d4-4b37-46f9-b6f3-aafd7d6d95b2",
 CellID->1646020830],
Cell[65773, 2182, 167, 6, 70, "MoreAbout",ExpressionUUID->"70d0a2e3-44e3-4d1f-880c-5c11b3730c69",
 CellID->787749156]
}, Open  ]],
Cell[65955, 2191, 23, 0, 70, "FooterCell",ExpressionUUID->"358e3dd1-2b8d-40e2-b80f-9b12e8ea547e"]
}
]
*)

(* End of internal cache information *)
