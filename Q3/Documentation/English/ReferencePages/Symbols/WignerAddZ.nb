(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74414,       2372]
NotebookOptionsPosition[     65982,       2193]
NotebookOutlinePosition[     68159,       2249]
CellTagsIndexPosition[     68073,       2244]
WindowTitle->WignerAddZ
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q3 SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Wigner Quick Start\"\>":>
       Documentation`HelpLookup["paclet:Q3/tutorial/WignerQuickStart"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"WignerAdd\"\>":>Documentation`HelpLookup[
       "paclet:Q3/ref/WignerAdd"], "\<\"WignerSpinSpin\"\>":>
       Documentation`HelpLookup["paclet:Q3/ref/WignerSpinSpin"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Wigner Package\"\>":>
       Documentation`HelpLookup[
       "paclet:Q3/guide/WignerPackageGuide"], "\<\"Q3 Application\"\>":>
       Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Q3/ref/WignerAddZ\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["Q3/ref/WignerAddZ"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/Q3/ref/WignerAddZ.\
html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, Visible -> 
            False]]; SelectionMove[
         DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$197124], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], "Q3/ref/WignerAddZ", 
             ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["WignerAddZ", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"WignerAddZ", "[", 
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], ",", "..."}], "]"}]], "InlineFormula"],
     "\[LineSeparator]returns the irreducible basis of the total angular \
momentum ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], "+", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], "+"}], "..."}]], "InlineFormula"],
     " invariant under the U(1) rotation around spin z-axis."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->733431070],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->219859710],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2000433963],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Spin", ",", "S", ",", 
   RowBox[{"Spin", "\[Rule]", 
    RowBox[{"3", "/", "2"}]}]}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->73225907],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"irb", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{"S", "[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"irc", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{"S", "[", "2", "]"}], "]"}]}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->199689218],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    FractionBox["3", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           FractionBox["1", "2"], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["1", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1686720867],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    FractionBox["3", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           FractionBox["1", "2"], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["1", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1933471269]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"irb", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"irc", "=", 
  RowBox[{"WignerAddZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "3", "]"}], ",", 
    RowBox[{"S", "[", "4", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1945113869],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "3"}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1290489708],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["3", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", "3"}], "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]]], 
          SubscriptBox[
           RowBox[{"-", 
             FractionBox["3", "2"]}], 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1823171303]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"basis1", "=", 
  RowBox[{
   RowBox[{"WignerAddZ", "[", 
    RowBox[{"irb", ",", "irc"}], "]"}], "//", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"basis2", "=", 
  RowBox[{
   RowBox[{"WignerAddZ", "[", 
    RowBox[{"S", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], "//", 
   
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"basis1", "==", "basis2"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->1485570460],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->920099904],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox[
            FractionBox["1", "2"], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], ",", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox[
            RowBox[{"-", 
              FractionBox["1", "2"]}], 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->89344481],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[5]=",
 CellID->521622914]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->258228157],

Cell[TextData[{
 "Here we will consider a Spin-1/2 XXZ chain. See ",
 StyleBox["Giamarchi",
  IgnoreSpellCheck->True],
 "  (2004) Chapter 6 and ",
 StyleBox["Moradmard",
  IgnoreSpellCheck->True],
 " et al (2013)."
}], "ExampleText",
 CellID->1134748374],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1603225532],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Spin", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "Jz"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->2119866525],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "L", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jz", "=", "2."}], ";"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1840908934],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"XX", "=", 
  RowBox[{
   RowBox[{"WignerSpinSpin", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}], "[", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ZZ", "=", 
  RowBox[{
   RowBox[{"WignerSpinSpin", "[", "3", "]"}], "[", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "Jz_", "]"}], ":=", 
  RowBox[{"XX", "+", 
   RowBox[{"Jz", "*", "ZZ"}]}]}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->1618169042],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"5"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"5"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->909690645],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"5"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1234587522]
}, Open  ]],

Cell["We first take a naive approach.", "ExampleText",
 CellID->1621011209],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"HH", "=", 
   RowBox[{"H", "[", "1.2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matH", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"HH", "//", "Expand"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eval", ",", "evec"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "matH", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"eval", "//", "Sort"}], "]"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->940933697],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    Thickness[Large], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQDQEf7Ptid/ucqWQ4ABVw6EXhczicKOVfL7jgy34I
X8BhEQpfxEF0DsebPfPfQvkSDkwofBmHNQ4Tuj+ueAnlKzisQOErOfw2sfiU
Nv8ZlK/i8B2Fr+Yg5CCzWM37BpSv4fDeHpmv5aCSI+9pLXcJytdxEEDh6zno
yRcUW8w8bQ/hGzgYo/ANHY59Miu4zH4ZyjdyuILCN3ZIKXw3qeTzNSjfxCEN
hW/qEFNyX6nm2WMo38whEYVv7pB3YW68qc9rKN/CIR+Fb+ng9/LQ9QCnN1C+
lUMACt/a4fr+mXNCld5D+TYON1D4tg7zZJdZmW78AOXbOcxH4ds7GIPBZyjf
Ac4HAIEykiQ=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 32.}, {-2.0594717020682713`, 1.2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[5]=",
 CellID->827488504]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", 
    RowBox[{
     RowBox[{"evec", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"Range", "[", "L", "]"}], "]"}]}], "]"}], "//", 
   "Chop"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"v", "=", 
    RowBox[{
     RowBox[{"KetForm", "[", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"evec", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", "Chop"}]}], " ", 
   "*)"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->613855558],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.0008339570684886555`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.041201665506340295`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.21914932698438977`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.22226266541919054`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.004435770448770176`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.3762201515965198`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.6963380127297911`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.007615018734702852`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.22226266541919115`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.003697559294966417`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.18267799029173065`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0044987870905099725`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.3762201515965217`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.01409447896430051`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.21914932698439302`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0076150187347028345`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0044987870905099595`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.04120166550634116`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{"0.004435770448770115`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"0.0008339570684885302`", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox[
         RowBox[{"-", 
           FractionBox["1", "2"]}], 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->198812463]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->977282934],

Cell["Now let us use the Spin-Z conservation.", "ExampleText",
 CellID->727372248],

Cell["We construct the basis according to the total Sz.", "ExampleText",
 CellID->1970260413],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"basis", "=", 
   RowBox[{"WignerAddZ", "[", 
    RowBox[{"S", "[", 
     RowBox[{"Range", "@", "L"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "basis"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->1244926211],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    FractionBox["5", "2"], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}], ",", 
   RowBox[{
    FractionBox["3", "2"], "\[Rule]", 
    RowBox[{"{", "5", "}"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], "\[Rule]", 
    RowBox[{"{", "10", "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "\[Rule]", 
    RowBox[{"{", "10", "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], "\[Rule]", 
    RowBox[{"{", "5", "}"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["5", "2"]}], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->570657592]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"matH", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"Multiply", ",", 
        RowBox[{"Dagger", "[", "#", "]"}], ",", 
        RowBox[{"HH", "**", "#"}]}], "]"}], "&"}], ",", "basis"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->421750059],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eval", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Eigenvalues", ",", "matH"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "@", 
   RowBox[{"Catenate", "@", "eval"}]}], "]"}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->1657206513],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    Thickness[Large], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQDQEf7CfG7vY5U8lwACrg0IPC53DYVcq/XnDBl/0Q
voDDDhS+iAPHHI43e+a/hfIl0PgyDnsdJnR/XPESyldA4ys5fDKx+JQ2/xmU
r+LwBoWv5vDLXmaxmvcNKF/D4RMKX8vBIkfe01ruEpSvg8bXc9CULyi2mHna
HsI3cDBA4Rs6HP1kVnCZ/TKUb4TGN3ZILXw3qeTzNSjfBI1v6pBUcl+p5tlj
KN/MIRmFb+6Qf2FuvKnPayjfwqEQhW/p4Pfy0PUApzdQvhUa39rh2v6Zc0KV
3kP5Nmh8W4f5ssusTDd+gPLt0Pj2DsZg8BnKd4DzARRxk04=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 32.}, {-2.0594717020682727`, 1.2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1740703684]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WignerAdd"]], "paclet:Q3/ref/WignerAdd"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["WignerSpinSpin"]], "paclet:Q3/ref/WignerSpinSpin"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Wigner Quick Start"]], "paclet:Q3/tutorial/WignerQuickStart"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->341631938],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Wigner Package"]], "paclet:Q3/guide/WignerPackageGuide"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1510273130],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Q3 Application"]], "paclet:Q3/guide/Q3"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->2051272017]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"WignerAddZ",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Q3 Application", ButtonData -> "paclet:Q3/guide/Q3", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> False, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 9, 8, 19, 12, 48.912228}", 
    "history" -> {"XX", "", "", ""}, "context" -> "Q3`", "keywords" -> {}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Q3 Symbol", "language" -> "en", "paclet" -> "Q3", "status" -> 
    "None", "summary" -> 
    "WignerAddZ[s1, s2, ...] returns the irreducible basis of the total \
angular momentum s1 + s2 + ... invariant under the U(1) rotation around spin \
z-axis.", "synonyms" -> {}, "tabletags" -> {}, "title" -> "WignerAddZ", 
    "titlemodifier" -> "", "windowtitle" -> "WignerAddZ", "type" -> "Symbol", 
    "uri" -> "Q3/ref/WignerAddZ", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (July 9, 2021)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[6044, 175, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"c7c704d7-bd80-486b-bbea-2884fa5cfda7",
   CellTags->"PrimaryExamplesSection",
   CellID->733431070]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 67875, 2237}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[582, 21, 4383, 111, 70, "AnchorBarGrid",ExpressionUUID->"b92e2ac4-5177-40cc-94ca-370bd96606c9",
 CellID->1],
Cell[CellGroupData[{
Cell[4990, 136, 167, 6, 70, "ObjectNameGrid",ExpressionUUID->"af9933c4-dc8d-437a-9f81-013f470df5ba"],
Cell[5160, 144, 847, 26, 70, "Usage",ExpressionUUID->"a898cc48-db72-4f7b-b127-547785f2bce1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6044, 175, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"c7c704d7-bd80-486b-bbea-2884fa5cfda7",
 CellTags->"PrimaryExamplesSection",
 CellID->733431070],
Cell[CellGroupData[{
Cell[6336, 189, 195, 6, 70, "ExampleSection",ExpressionUUID->"d1218c67-ec91-4ba6-85cd-590bc818a6fa",
 CellID->219859710],
Cell[6534, 197, 91, 3, 70, "Input",ExpressionUUID->"4b43fee1-5152-4722-841a-dfec336068e8",
 CellID->2000433963],
Cell[6628, 202, 192, 6, 70, "Input",ExpressionUUID->"5f55a847-b91c-49d2-a9c5-d6ebc700639b",
 CellID->73225907],
Cell[CellGroupData[{
Cell[6845, 212, 280, 8, 70, "Input",ExpressionUUID->"93e41589-57be-44f1-bd6f-cba0a8259785",
 CellID->199689218],
Cell[7128, 222, 1487, 52, 70, "Output",ExpressionUUID->"086f3097-7da3-46bb-857f-b3dbcc1b2e13",
 CellID->1686720867],
Cell[8618, 276, 1487, 52, 70, "Output",ExpressionUUID->"b3ccff67-b288-4b11-85a6-149ab63dd8b3",
 CellID->1933471269]
}, Open  ]],
Cell[CellGroupData[{
Cell[10142, 333, 391, 12, 70, "Input",ExpressionUUID->"760098c3-b108-400a-98dd-61dd3bbaa4d2",
 CellID->1945113869],
Cell[10536, 347, 7282, 225, 70, "Output",ExpressionUUID->"706b2d34-386e-4228-8f87-b057c11e2288",
 CellID->1290489708],
Cell[17821, 574, 7282, 225, 70, "Output",ExpressionUUID->"243cd5e3-fcdd-4cfb-9cc5-0867050183cf",
 CellID->1823171303]
}, Open  ]],
Cell[CellGroupData[{
Cell[25140, 804, 632, 20, 70, "Input",ExpressionUUID->"0cc0fac6-163c-4975-af6a-c4f4405e3826",
 CellID->1485570460],
Cell[25775, 826, 5752, 174, 70, "Output",ExpressionUUID->"0c641146-7a4b-4298-a9cd-39c58af4a3b2",
 CellID->920099904],
Cell[31530, 1002, 5751, 174, 70, "Output",ExpressionUUID->"601944f3-e93a-4890-98eb-c189813229cd",
 CellID->89344481],
Cell[37284, 1178, 74, 2, 70, "Output",ExpressionUUID->"c02d6817-98b6-4dcb-a8c6-8fbd493d4983",
 CellID->521622914]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37407, 1186, 193, 6, 70, "ExampleSection",ExpressionUUID->"c461d24c-dc7b-43ef-b157-a8d31c7792ef",
 CellID->258228157],
Cell[37603, 1194, 254, 9, 70, "ExampleText",ExpressionUUID->"69ded65c-5989-4f2b-ab50-48a70ec8a113",
 CellID->1134748374],
Cell[37860, 1205, 91, 3, 70, "Input",ExpressionUUID->"94131ec9-202f-4b13-92da-f990a221f6c4",
 CellID->1603225532],
Cell[37954, 1210, 212, 6, 70, "Input",ExpressionUUID->"fc5bb239-e32f-433c-b11f-5d65a53352c8",
 CellID->2119866525],
Cell[38169, 1218, 285, 9, 70, "Input",ExpressionUUID->"2aaf1a01-cb08-4c62-a291-7ce57759f1ef",
 CellID->1840908934],
Cell[CellGroupData[{
Cell[38479, 1231, 585, 18, 70, "Input",ExpressionUUID->"c88b2c48-4d19-4f6b-8283-658a338c3672",
 CellID->1618169042],
Cell[39067, 1251, 3737, 139, 70, "Output",ExpressionUUID->"22af1d7d-6250-4f46-87dc-733ec36fae23",
 CellID->909690645],
Cell[42807, 1392, 1906, 71, 70, "Output",ExpressionUUID->"822b991b-f5b6-4c0d-b374-8b942c7a7b07",
 CellID->1234587522]
}, Open  ]],
Cell[44728, 1466, 75, 1, 70, "ExampleText",ExpressionUUID->"1816fd33-bc9e-40da-a7d6-c33c75b202e0",
 CellID->1621011209],
Cell[CellGroupData[{
Cell[44828, 1471, 541, 17, 70, "Input",ExpressionUUID->"d7328a95-2e67-4b5e-bb66-b31ff4daedbc",
 CellID->940933697],
Cell[45372, 1490, 1640, 46, 70, "Output",ExpressionUUID->"89b73fd3-dd15-4d53-bd0f-f096a668cf9c",
 CellID->827488504]
}, Open  ]],
Cell[CellGroupData[{
Cell[47049, 1541, 608, 21, 70, "Input",ExpressionUUID->"02b254ae-f330-46c7-aa32-3c0adfdfc5ba",
 CellID->613855558],
Cell[47660, 1564, 12735, 403, 70, "Output",ExpressionUUID->"95dc69e9-b8bf-4685-8cea-e640907bc7db",
 CellID->198812463]
}, Open  ]],
Cell[CellGroupData[{
Cell[60432, 1972, 125, 3, 70, "ExampleDelimiter",ExpressionUUID->"af842739-bf21-43da-bd89-deab5ae33074",
 CellID->977282934],
Cell[60560, 1977, 82, 1, 70, "ExampleText",ExpressionUUID->"24dc7589-9b99-46bf-9d16-3d0f64331812",
 CellID->727372248],
Cell[60645, 1980, 93, 1, 70, "ExampleText",ExpressionUUID->"719df807-3290-4f77-a4b7-b99df9473394",
 CellID->1970260413],
Cell[CellGroupData[{
Cell[60763, 1985, 282, 9, 70, "Input",ExpressionUUID->"8e18460c-36cc-45bc-859f-46891f065677",
 CellID->1244926211],
Cell[61048, 1996, 724, 25, 70, "Output",ExpressionUUID->"110ee87b-8bd8-4b01-9061-742c297a83ed",
 CellID->570657592]
}, Open  ]],
Cell[61787, 2024, 348, 12, 70, "Input",ExpressionUUID->"a2c3c7d7-adf5-4583-88b4-f503542dbf1d",
 CellID->421750059],
Cell[CellGroupData[{
Cell[62160, 2040, 310, 10, 70, "Input",ExpressionUUID->"eabd9187-d197-4f72-84d8-276cdfa90887",
 CellID->1657206513],
Cell[62473, 2052, 1616, 45, 70, "Output",ExpressionUUID->"4bde304e-6e1d-4661-9e83-7f4227e59c4b",
 CellID->1740703684]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[64128, 2102, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"9ce1d65b-fbfd-4073-9aa5-f0d7b5134bc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64196, 2107, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"0c133ee9-23ea-4282-9acc-68594febf0d4",
 CellID->1255426704],
Cell[64349, 2116, 558, 18, 70, "SeeAlso",ExpressionUUID->"a56847ee-394b-49a7-a5ed-3449dba5015c",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[64944, 2139, 152, 7, 70, "TutorialsSection",ExpressionUUID->"3aadb024-bafb-4070-8053-5a6f44299997",
 CellID->250839057],
Cell[65099, 2148, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"1d9fff20-d135-43d6-b9d6-ab42ede022ca"],
Cell[65133, 2150, 188, 6, 70, "Tutorials",ExpressionUUID->"260c2e6f-7cb0-42b7-8974-b40d9e43093d",
 CellID->341631938],
Cell[65324, 2158, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"ac72ae6a-cdff-46db-a26c-7059c4f4b31c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65392, 2163, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"cdf17e80-3681-4827-bf64-e49fc685d245",
 CellID->38303248],
Cell[65551, 2172, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"bbc46d68-71da-4d97-863a-df8b7e58e413"],
Cell[65585, 2174, 184, 6, 70, "MoreAbout",ExpressionUUID->"e98d7a24-b143-48f7-adc5-81b9874fe2d5",
 CellID->1510273130],
Cell[65772, 2182, 168, 6, 70, "MoreAbout",ExpressionUUID->"caf1a769-ec85-455e-ac72-53c535798177",
 CellID->2051272017]
}, Open  ]],
Cell[65955, 2191, 23, 0, 70, "FooterCell",ExpressionUUID->"aa57095a-8e01-4772-9123-843a0862cdcb"]
}
]
*)

(* End of internal cache information *)
